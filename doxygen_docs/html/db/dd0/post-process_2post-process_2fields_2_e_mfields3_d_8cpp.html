<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iPIC3DxPEACE: post-process/post-process/fields/EMfields3D.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="iPIC3DxPEACE"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">iPIC3DxPEACE<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">iPIC3D for Planets Exoplanets Asteroids Comets and Emissions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">EMfields3D.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;mpi.h&gt;</code><br />
<code>#include &quot;ipichdf5.h&quot;</code><br />
<code>#include &quot;EMfields3D.h&quot;</code><br />
<code>#include &quot;Collective.h&quot;</code><br />
<code>#include &quot;Basic.h&quot;</code><br />
<code>#include &quot;Com3DNonblk.h&quot;</code><br />
<code>#include &quot;VCtopology3D.h&quot;</code><br />
<code>#include &quot;Grid3DCU.h&quot;</code><br />
<code>#include &quot;CG.h&quot;</code><br />
<code>#include &quot;GMRES.h&quot;</code><br />
<code>#include &quot;Particles3Dcomm.h&quot;</code><br />
<code>#include &quot;Moments.h&quot;</code><br />
<code>#include &quot;Parameters.h&quot;</code><br />
<code>#include &quot;ompdefs.h&quot;</code><br />
<code>#include &quot;debug.h&quot;</code><br />
<code>#include &quot;string.h&quot;</code><br />
<code>#include &quot;mic_particles.h&quot;</code><br />
<code>#include &quot;TimeTasks.h&quot;</code><br />
<code>#include &quot;ipicmath.h&quot;</code><br />
<code>#include &quot;Alloc.h&quot;</code><br />
<code>#include &quot;asserts.h&quot;</code><br />
<code>#include &lt;iostream&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for EMfields3D.cpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><!-- SVG 0 -->
</div>
</div>
</div>
<p><a href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a819b1d3d8bc6ca114cab4366ed4eb464"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#a819b1d3d8bc6ca114cab4366ed4eb464">compute_moments</a> (double velmoments[10], double weights[8], int i, double const *const x, double const *const y, double const *const z, double const *const u, double const *const v, double const *const w, double const *const q, double xstart, double ystart, double zstart, double inv_dx, double inv_dy, double inv_dz, int cx, int cy, int cz)</td></tr>
<tr class="separator:a819b1d3d8bc6ca114cab4366ed4eb464"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece324b5631b1a42601d46a5e9ebf2aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#aece324b5631b1a42601d46a5e9ebf2aa">add_moments_for_pcl</a> (double momentsAcc[8][10], int i, double const *const x, double const *const y, double const *const z, double const *const u, double const *const v, double const *const w, double const *const q, double xstart, double ystart, double zstart, double inv_dx, double inv_dy, double inv_dz, int cx, int cy, int cz)</td></tr>
<tr class="separator:aece324b5631b1a42601d46a5e9ebf2aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a454c3c63e953dcec7f13d01a575c7318"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#a454c3c63e953dcec7f13d01a575c7318">add_moments_for_pcl_vec</a> (double momentsAccVec[8][10][8], double velmoments[10][8], double weights[8][8], int i, int imod, double const *const x, double const *const y, double const *const z, double const *const u, double const *const v, double const *const w, double const *const q, double xstart, double ystart, double zstart, double inv_dx, double inv_dy, double inv_dz, int cx, int cy, int cz)</td></tr>
<tr class="separator:a454c3c63e953dcec7f13d01a575c7318"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3d6bacc13c6b3e4dc89adf85c92aee5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#ab3d6bacc13c6b3e4dc89adf85c92aee5">solver2phys</a> (<a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a> vectPhys, double *vectSolver, int nx, int ny, int nz)</td></tr>
<tr class="memdesc:ab3d6bacc13c6b3e4dc89adf85c92aee5"><td class="mdescLeft">&#160;</td><td class="mdescRight">method to convert a 1D field in a 3D field not considering guard cells  <a href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#ab3d6bacc13c6b3e4dc89adf85c92aee5">More...</a><br /></td></tr>
<tr class="separator:ab3d6bacc13c6b3e4dc89adf85c92aee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeff7cf8725588b388fb6a6af9137223"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#abeff7cf8725588b388fb6a6af9137223">solver2phys</a> (<a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a> vectPhys1, <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a> vectPhys2, <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a> vectPhys3, double *vectSolver, int nx, int ny, int nz)</td></tr>
<tr class="memdesc:abeff7cf8725588b388fb6a6af9137223"><td class="mdescLeft">&#160;</td><td class="mdescRight">method to convert a 1D field in a 3D field not considering guard cells  <a href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#abeff7cf8725588b388fb6a6af9137223">More...</a><br /></td></tr>
<tr class="separator:abeff7cf8725588b388fb6a6af9137223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae140bfa7593be3f1320cd9bdd2b70355"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#ae140bfa7593be3f1320cd9bdd2b70355">phys2solver</a> (double *vectSolver, const <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a> vectPhys, int nx, int ny, int nz)</td></tr>
<tr class="memdesc:ae140bfa7593be3f1320cd9bdd2b70355"><td class="mdescLeft">&#160;</td><td class="mdescRight">method to convert a 3D field in a 1D field not considering guard cells  <a href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#ae140bfa7593be3f1320cd9bdd2b70355">More...</a><br /></td></tr>
<tr class="separator:ae140bfa7593be3f1320cd9bdd2b70355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad086768f47954a95ce488691400ad54e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#ad086768f47954a95ce488691400ad54e">phys2solver</a> (double *vectSolver, const <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a> vectPhys1, const <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a> vectPhys2, const <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a> vectPhys3, int nx, int ny, int nz)</td></tr>
<tr class="memdesc:ad086768f47954a95ce488691400ad54e"><td class="mdescLeft">&#160;</td><td class="mdescRight">method to convert a 3D field in a 1D field not considering guard cells  <a href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html#ad086768f47954a95ce488691400ad54e">More...</a><br /></td></tr>
<tr class="separator:ad086768f47954a95ce488691400ad54e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aece324b5631b1a42601d46a5e9ebf2aa" name="aece324b5631b1a42601d46a5e9ebf2aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece324b5631b1a42601d46a5e9ebf2aa">&#9670;&nbsp;</a></span>add_moments_for_pcl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void add_moments_for_pcl </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>momentsAcc</em>[8][10], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ystart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html#l01524">1524</a> of file <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1542</span>{</div>
<div class="line"><span class="lineno"> 1543</span>  <span class="keywordtype">double</span> velmoments[10];</div>
<div class="line"><span class="lineno"> 1544</span>  <span class="keywordtype">double</span> weights[8];</div>
<div class="line"><span class="lineno"> 1545</span>  <a class="code hl_function" href="../../d3/d39/fields_2_e_mfields3_d_8cpp.html#a819b1d3d8bc6ca114cab4366ed4eb464">compute_moments</a>(velmoments,weights,</div>
<div class="line"><span class="lineno"> 1546</span>    <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>, <a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a73f4fab99ebb3f348065a759d9576e5a">x</a>, <a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a8925be5ed38a7ecdc935453aab6982a1">y</a>, <a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a19085578961941ab4b2d85c9a1ba16d1">z</a>, <a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a381ee9532be9e39911f0f5dfa833d35d">u</a>, <a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a361d9af8428eec34a40fac520b4cab89">v</a>, <a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a65fa774c8c290f1c9ba0df704809bb91">w</a>, <a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#ac4208e549119be12e26eeec864644829">q</a>,</div>
<div class="line"><span class="lineno"> 1547</span>    xstart, ystart, zstart,</div>
<div class="line"><span class="lineno"> 1548</span>    inv_dx, inv_dy, inv_dz,</div>
<div class="line"><span class="lineno"> 1549</span>    cx, cy, cz);</div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span>  <span class="comment">// add moments for this particle</span></div>
<div class="line"><span class="lineno"> 1552</span>  {</div>
<div class="line"><span class="lineno"> 1553</span>    <span class="comment">// which is the superior order for the following loop?</span></div>
<div class="line"><span class="lineno"> 1554</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>=0; <a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>&lt;8; <a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>++)</div>
<div class="line"><span class="lineno"> 1555</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0; m&lt;10; m++)</div>
<div class="line"><span class="lineno"> 1556</span>    {</div>
<div class="line"><span class="lineno"> 1557</span>      momentsAcc[<a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>][m] += velmoments[m]*weights[<a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>];</div>
<div class="line"><span class="lineno"> 1558</span>    }</div>
<div class="line"><span class="lineno"> 1559</span>  }</div>
<div class="line"><span class="lineno"> 1560</span>}</div>
<div class="ttc" id="afields_2_e_mfields3_d_8cpp_html_a819b1d3d8bc6ca114cab4366ed4eb464"><div class="ttname"><a href="../../d3/d39/fields_2_e_mfields3_d_8cpp.html#a819b1d3d8bc6ca114cab4366ed4eb464">compute_moments</a></div><div class="ttdeci">void compute_moments(double velmoments[10], double weights[8], int i, double const *const x, double const *const y, double const *const z, double const *const u, double const *const v, double const *const w, double const *const q, double xstart, double ystart, double zstart, double inv_dx, double inv_dy, double inv_dz, int cx, int cy, int cz)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d39/fields_2_e_mfields3_d_8cpp_source.html#l01427">EMfields3D.cpp:1427</a></div></div>
<div class="ttc" id="anamespaceplot1__paper-2__precipitation_html_a361d9af8428eec34a40fac520b4cab89"><div class="ttname"><a href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a361d9af8428eec34a40fac520b4cab89">plot1_paper-2_precipitation.v</a></div><div class="ttdeci">v</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation.py:28</a></div></div>
<div class="ttc" id="anamespaceplot1__paper-2__precipitation_html_a381ee9532be9e39911f0f5dfa833d35d"><div class="ttname"><a href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a381ee9532be9e39911f0f5dfa833d35d">plot1_paper-2_precipitation.u</a></div><div class="ttdeci">u</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation.py:28</a></div></div>
<div class="ttc" id="anamespaceplot1__paper-2__precipitation_html_a65fa774c8c290f1c9ba0df704809bb91"><div class="ttname"><a href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a65fa774c8c290f1c9ba0df704809bb91">plot1_paper-2_precipitation.w</a></div><div class="ttdeci">w</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation.py:28</a></div></div>
<div class="ttc" id="anamespaceplot1__paper-2__precipitation_html_ac4208e549119be12e26eeec864644829"><div class="ttname"><a href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#ac4208e549119be12e26eeec864644829">plot1_paper-2_precipitation.q</a></div><div class="ttdeci">q</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation.py:28</a></div></div>
<div class="ttc" id="anamespaceplot2__paper__df_html_a51e520cc64eb6858b670c5a6c3f0ae61"><div class="ttname"><a href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">plot2_paper_df.c</a></div><div class="ttdeci">c</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d41/plot2__paper__df_8py_source.html#l00026">plot2_paper_df.py:26</a></div></div>
<div class="ttc" id="anamespaceplot___jpar-planet_html_a19085578961941ab4b2d85c9a1ba16d1"><div class="ttname"><a href="../../dc/da9/namespaceplot___jpar-planet.html#a19085578961941ab4b2d85c9a1ba16d1">plot_Jpar-planet.z</a></div><div class="ttdeci">z</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d73/plot___jpar-planet_8py_source.html#l00026">plot_Jpar-planet.py:26</a></div></div>
<div class="ttc" id="anamespaceplot___jpar-planet_html_a73f4fab99ebb3f348065a759d9576e5a"><div class="ttname"><a href="../../dc/da9/namespaceplot___jpar-planet.html#a73f4fab99ebb3f348065a759d9576e5a">plot_Jpar-planet.x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d73/plot___jpar-planet_8py_source.html#l00024">plot_Jpar-planet.py:24</a></div></div>
<div class="ttc" id="anamespaceplot___jpar-planet_html_a8925be5ed38a7ecdc935453aab6982a1"><div class="ttname"><a href="../../dc/da9/namespaceplot___jpar-planet.html#a8925be5ed38a7ecdc935453aab6982a1">plot_Jpar-planet.y</a></div><div class="ttdeci">y</div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d73/plot___jpar-planet_8py_source.html#l00025">plot_Jpar-planet.py:25</a></div></div>
<div class="ttc" id="anamespacetest__new-features_html_a12edd13b4b44e13c0b817aaefef33245"><div class="ttname"><a href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">test_new-features.i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d9c/fibo_2tests_2test__new-features_8py_source.html#l00049">test_new-features.py:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d41/plot2__paper__df_8py_source.html#l00026">plot2_paper_df::c</a>, <a class="el" href="../../d3/d39/fields_2_e_mfields3_d_8cpp_source.html#l01427">compute_moments()</a>, <a class="el" href="../../d2/d9c/fibo_2tests_2test__new-features_8py_source.html#l00049">test_new-features::i</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::q</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::u</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::v</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::w</a>, <a class="el" href="../../d0/d73/plot___jpar-planet_8py_source.html#l00024">plot_Jpar-planet::x</a>, <a class="el" href="../../d0/d73/plot___jpar-planet_8py_source.html#l00025">plot_Jpar-planet::y</a>, and <a class="el" href="../../d0/d73/plot___jpar-planet_8py_source.html#l00026">plot_Jpar-planet::z</a>.</p>

</div>
</div>
<a id="a454c3c63e953dcec7f13d01a575c7318" name="a454c3c63e953dcec7f13d01a575c7318"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a454c3c63e953dcec7f13d01a575c7318">&#9670;&nbsp;</a></span>add_moments_for_pcl_vec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void add_moments_for_pcl_vec </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>momentsAccVec</em>[8][10][8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>velmoments</em>[10][8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weights</em>[8][8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>imod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ystart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html#l01565">1565</a> of file <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1585</span>{</div>
<div class="line"><span class="lineno"> 1586</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a73f4fab99ebb3f348065a759d9576e5a">x</a>);</div>
<div class="line"><span class="lineno"> 1587</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a8925be5ed38a7ecdc935453aab6982a1">y</a>);</div>
<div class="line"><span class="lineno"> 1588</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a19085578961941ab4b2d85c9a1ba16d1">z</a>);</div>
<div class="line"><span class="lineno"> 1589</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a381ee9532be9e39911f0f5dfa833d35d">u</a>);</div>
<div class="line"><span class="lineno"> 1590</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a361d9af8428eec34a40fac520b4cab89">v</a>);</div>
<div class="line"><span class="lineno"> 1591</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a65fa774c8c290f1c9ba0df704809bb91">w</a>);</div>
<div class="line"><span class="lineno"> 1592</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#ac4208e549119be12e26eeec864644829">q</a>);</div>
<div class="line"><span class="lineno"> 1593</span>  <span class="comment">// compute the quadratic moments of velocity</span></div>
<div class="line"><span class="lineno"> 1594</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1595</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ui=<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a381ee9532be9e39911f0f5dfa833d35d">u</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1596</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> vi=<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a361d9af8428eec34a40fac520b4cab89">v</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1597</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> wi=<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a65fa774c8c290f1c9ba0df704809bb91">w</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1598</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> uui=ui*ui;</div>
<div class="line"><span class="lineno"> 1599</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> uvi=ui*vi;</div>
<div class="line"><span class="lineno"> 1600</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> uwi=ui*wi;</div>
<div class="line"><span class="lineno"> 1601</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> vvi=vi*vi;</div>
<div class="line"><span class="lineno"> 1602</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> vwi=vi*wi;</div>
<div class="line"><span class="lineno"> 1603</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> wwi=wi*wi;</div>
<div class="line"><span class="lineno"> 1604</span>  <span class="comment">//double velmoments[10];</span></div>
<div class="line"><span class="lineno"> 1605</span>  velmoments[0][imod] = 1.;</div>
<div class="line"><span class="lineno"> 1606</span>  velmoments[1][imod] = ui;</div>
<div class="line"><span class="lineno"> 1607</span>  velmoments[2][imod] = vi;</div>
<div class="line"><span class="lineno"> 1608</span>  velmoments[3][imod] = wi;</div>
<div class="line"><span class="lineno"> 1609</span>  velmoments[4][imod] = uui;</div>
<div class="line"><span class="lineno"> 1610</span>  velmoments[5][imod] = uvi;</div>
<div class="line"><span class="lineno"> 1611</span>  velmoments[6][imod] = uwi;</div>
<div class="line"><span class="lineno"> 1612</span>  velmoments[7][imod] = vvi;</div>
<div class="line"><span class="lineno"> 1613</span>  velmoments[8][imod] = vwi;</div>
<div class="line"><span class="lineno"> 1614</span>  velmoments[9][imod] = wwi;</div>
<div class="line"><span class="lineno"> 1615</span> </div>
<div class="line"><span class="lineno"> 1616</span>  <span class="comment">// compute the weights to distribute the moments</span></div>
<div class="line"><span class="lineno"> 1617</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1618</span>  <span class="comment">//double weights[8];</span></div>
<div class="line"><span class="lineno"> 1619</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> abs_xpos = <a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a73f4fab99ebb3f348065a759d9576e5a">x</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1620</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> abs_ypos = <a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a8925be5ed38a7ecdc935453aab6982a1">y</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1621</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> abs_zpos = <a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a19085578961941ab4b2d85c9a1ba16d1">z</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1622</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rel_xpos = abs_xpos - xstart;</div>
<div class="line"><span class="lineno"> 1623</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rel_ypos = abs_ypos - ystart;</div>
<div class="line"><span class="lineno"> 1624</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rel_zpos = abs_zpos - zstart;</div>
<div class="line"><span class="lineno"> 1625</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> cxm1_pos = rel_xpos * inv_dx;</div>
<div class="line"><span class="lineno"> 1626</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> cym1_pos = rel_ypos * inv_dy;</div>
<div class="line"><span class="lineno"> 1627</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> czm1_pos = rel_zpos * inv_dz;</div>
<div class="line"><span class="lineno"> 1628</span>  <span class="comment">//if(true)</span></div>
<div class="line"><span class="lineno"> 1629</span>  <span class="comment">//{</span></div>
<div class="line"><span class="lineno"> 1630</span>  <span class="comment">//  const int cx_inf = int(floor(cxm1_pos));</span></div>
<div class="line"><span class="lineno"> 1631</span>  <span class="comment">//  const int cy_inf = int(floor(cym1_pos));</span></div>
<div class="line"><span class="lineno"> 1632</span>  <span class="comment">//  const int cz_inf = int(floor(czm1_pos));</span></div>
<div class="line"><span class="lineno"> 1633</span>  <span class="comment">//  assert_eq(cx-1,cx_inf);</span></div>
<div class="line"><span class="lineno"> 1634</span>  <span class="comment">//  assert_eq(cy-1,cy_inf);</span></div>
<div class="line"><span class="lineno"> 1635</span>  <span class="comment">//  assert_eq(cz-1,cz_inf);</span></div>
<div class="line"><span class="lineno"> 1636</span>  <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1637</span>  <span class="comment">// fraction of the distance from the right of the cell</span></div>
<div class="line"><span class="lineno"> 1638</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w1x = cx - cxm1_pos;</div>
<div class="line"><span class="lineno"> 1639</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w1y = cy - cym1_pos;</div>
<div class="line"><span class="lineno"> 1640</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w1z = cz - czm1_pos;</div>
<div class="line"><span class="lineno"> 1641</span>  <span class="comment">// fraction of distance from the left</span></div>
<div class="line"><span class="lineno"> 1642</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w0x = 1-w1x;</div>
<div class="line"><span class="lineno"> 1643</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w0y = 1-w1y;</div>
<div class="line"><span class="lineno"> 1644</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w0z = 1-w1z;</div>
<div class="line"><span class="lineno"> 1645</span>  <span class="comment">// we are calculating a charge moment.</span></div>
<div class="line"><span class="lineno"> 1646</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> qi=<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#ac4208e549119be12e26eeec864644829">q</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1647</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight0 = qi*w0x;</div>
<div class="line"><span class="lineno"> 1648</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight1 = qi*w1x;</div>
<div class="line"><span class="lineno"> 1649</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight00 = weight0*w0y;</div>
<div class="line"><span class="lineno"> 1650</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight01 = weight0*w1y;</div>
<div class="line"><span class="lineno"> 1651</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight10 = weight1*w0y;</div>
<div class="line"><span class="lineno"> 1652</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight11 = weight1*w1y;</div>
<div class="line"><span class="lineno"> 1653</span>  weights[0][imod] = weight00*w0z; <span class="comment">// weight000</span></div>
<div class="line"><span class="lineno"> 1654</span>  weights[1][imod] = weight00*w1z; <span class="comment">// weight001</span></div>
<div class="line"><span class="lineno"> 1655</span>  weights[2][imod] = weight01*w0z; <span class="comment">// weight010</span></div>
<div class="line"><span class="lineno"> 1656</span>  weights[3][imod] = weight01*w1z; <span class="comment">// weight011</span></div>
<div class="line"><span class="lineno"> 1657</span>  weights[4][imod] = weight10*w0z; <span class="comment">// weight100</span></div>
<div class="line"><span class="lineno"> 1658</span>  weights[5][imod] = weight10*w1z; <span class="comment">// weight101</span></div>
<div class="line"><span class="lineno"> 1659</span>  weights[6][imod] = weight11*w0z; <span class="comment">// weight110</span></div>
<div class="line"><span class="lineno"> 1660</span>  weights[7][imod] = weight11*w1z; <span class="comment">// weight111</span></div>
<div class="line"><span class="lineno"> 1661</span> </div>
<div class="line"><span class="lineno"> 1662</span>  <span class="comment">// add moments for this particle</span></div>
<div class="line"><span class="lineno"> 1663</span>  {</div>
<div class="line"><span class="lineno"> 1664</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>=0; <a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>&lt;8; <a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>++)</div>
<div class="line"><span class="lineno"> 1665</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0; m&lt;10; m++)</div>
<div class="line"><span class="lineno"> 1666</span>    {</div>
<div class="line"><span class="lineno"> 1667</span>      momentsAccVec[<a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>][m][imod] += velmoments[m][imod]*weights[<a class="code hl_variable" href="../../d2/de4/namespaceplot2__paper__df.html#a51e520cc64eb6858b670c5a6c3f0ae61">c</a>][imod];</div>
<div class="line"><span class="lineno"> 1668</span>    }</div>
<div class="line"><span class="lineno"> 1669</span>  }</div>
<div class="line"><span class="lineno"> 1670</span>}</div>
<div class="ttc" id="ainclude_2_alloc_8h_html_a9763e79ee25e85ca02c0d05e3aee7135"><div class="ttname"><a href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a></div><div class="ttdeci">#define ALIGNED(X)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/de1/include_2_alloc_8h_source.html#l00096">Alloc.h:96</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/de1/include_2_alloc_8h_source.html#l00096">ALIGNED</a>, <a class="el" href="../../dc/d41/plot2__paper__df_8py_source.html#l00026">plot2_paper_df::c</a>, <a class="el" href="../../d2/d9c/fibo_2tests_2test__new-features_8py_source.html#l00049">test_new-features::i</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::q</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::u</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::v</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::w</a>, <a class="el" href="../../d0/d73/plot___jpar-planet_8py_source.html#l00024">plot_Jpar-planet::x</a>, <a class="el" href="../../d0/d73/plot___jpar-planet_8py_source.html#l00025">plot_Jpar-planet::y</a>, and <a class="el" href="../../d0/d73/plot___jpar-planet_8py_source.html#l00026">plot_Jpar-planet::z</a>.</p>

</div>
</div>
<a id="a819b1d3d8bc6ca114cab4366ed4eb464" name="a819b1d3d8bc6ca114cab4366ed4eb464"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a819b1d3d8bc6ca114cab4366ed4eb464">&#9670;&nbsp;</a></span>compute_moments()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void compute_moments </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>velmoments</em>[10], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weights</em>[8], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double const *const&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>xstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ystart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>zstart</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_dy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>inv_dz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html#l01427">1427</a> of file <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1445</span>{</div>
<div class="line"><span class="lineno"> 1446</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a73f4fab99ebb3f348065a759d9576e5a">x</a>);</div>
<div class="line"><span class="lineno"> 1447</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a8925be5ed38a7ecdc935453aab6982a1">y</a>);</div>
<div class="line"><span class="lineno"> 1448</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a19085578961941ab4b2d85c9a1ba16d1">z</a>);</div>
<div class="line"><span class="lineno"> 1449</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a381ee9532be9e39911f0f5dfa833d35d">u</a>);</div>
<div class="line"><span class="lineno"> 1450</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a361d9af8428eec34a40fac520b4cab89">v</a>);</div>
<div class="line"><span class="lineno"> 1451</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a65fa774c8c290f1c9ba0df704809bb91">w</a>);</div>
<div class="line"><span class="lineno"> 1452</span>  <a class="code hl_define" href="../../df/de1/include_2_alloc_8h.html#a9763e79ee25e85ca02c0d05e3aee7135">ALIGNED</a>(<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#ac4208e549119be12e26eeec864644829">q</a>);</div>
<div class="line"><span class="lineno"> 1453</span>  <span class="comment">// compute the quadratic moments of velocity</span></div>
<div class="line"><span class="lineno"> 1454</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1455</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ui=<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a381ee9532be9e39911f0f5dfa833d35d">u</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1456</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> vi=<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a361d9af8428eec34a40fac520b4cab89">v</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1457</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> wi=<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#a65fa774c8c290f1c9ba0df704809bb91">w</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1458</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> uui=ui*ui;</div>
<div class="line"><span class="lineno"> 1459</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> uvi=ui*vi;</div>
<div class="line"><span class="lineno"> 1460</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> uwi=ui*wi;</div>
<div class="line"><span class="lineno"> 1461</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> vvi=vi*vi;</div>
<div class="line"><span class="lineno"> 1462</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> vwi=vi*wi;</div>
<div class="line"><span class="lineno"> 1463</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> wwi=wi*wi;</div>
<div class="line"><span class="lineno"> 1464</span>  <span class="comment">//double velmoments[10];</span></div>
<div class="line"><span class="lineno"> 1465</span>  velmoments[0] = 1.;</div>
<div class="line"><span class="lineno"> 1466</span>  velmoments[1] = ui;</div>
<div class="line"><span class="lineno"> 1467</span>  velmoments[2] = vi;</div>
<div class="line"><span class="lineno"> 1468</span>  velmoments[3] = wi;</div>
<div class="line"><span class="lineno"> 1469</span>  velmoments[4] = uui;</div>
<div class="line"><span class="lineno"> 1470</span>  velmoments[5] = uvi;</div>
<div class="line"><span class="lineno"> 1471</span>  velmoments[6] = uwi;</div>
<div class="line"><span class="lineno"> 1472</span>  velmoments[7] = vvi;</div>
<div class="line"><span class="lineno"> 1473</span>  velmoments[8] = vwi;</div>
<div class="line"><span class="lineno"> 1474</span>  velmoments[9] = wwi;</div>
<div class="line"><span class="lineno"> 1475</span> </div>
<div class="line"><span class="lineno"> 1476</span>  <span class="comment">// compute the weights to distribute the moments</span></div>
<div class="line"><span class="lineno"> 1477</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1478</span>  <span class="comment">//double weights[8];</span></div>
<div class="line"><span class="lineno"> 1479</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> abs_xpos = <a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a73f4fab99ebb3f348065a759d9576e5a">x</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1480</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> abs_ypos = <a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a8925be5ed38a7ecdc935453aab6982a1">y</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1481</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> abs_zpos = <a class="code hl_variable" href="../../dc/da9/namespaceplot___jpar-planet.html#a19085578961941ab4b2d85c9a1ba16d1">z</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1482</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rel_xpos = abs_xpos - xstart;</div>
<div class="line"><span class="lineno"> 1483</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rel_ypos = abs_ypos - ystart;</div>
<div class="line"><span class="lineno"> 1484</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rel_zpos = abs_zpos - zstart;</div>
<div class="line"><span class="lineno"> 1485</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> cxm1_pos = rel_xpos * inv_dx;</div>
<div class="line"><span class="lineno"> 1486</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> cym1_pos = rel_ypos * inv_dy;</div>
<div class="line"><span class="lineno"> 1487</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> czm1_pos = rel_zpos * inv_dz;</div>
<div class="line"><span class="lineno"> 1488</span>  <span class="comment">//if(true)</span></div>
<div class="line"><span class="lineno"> 1489</span>  <span class="comment">//{</span></div>
<div class="line"><span class="lineno"> 1490</span>  <span class="comment">//  const int cx_inf = int(floor(cxm1_pos));</span></div>
<div class="line"><span class="lineno"> 1491</span>  <span class="comment">//  const int cy_inf = int(floor(cym1_pos));</span></div>
<div class="line"><span class="lineno"> 1492</span>  <span class="comment">//  const int cz_inf = int(floor(czm1_pos));</span></div>
<div class="line"><span class="lineno"> 1493</span>  <span class="comment">//  assert_eq(cx-1,cx_inf);</span></div>
<div class="line"><span class="lineno"> 1494</span>  <span class="comment">//  assert_eq(cy-1,cy_inf);</span></div>
<div class="line"><span class="lineno"> 1495</span>  <span class="comment">//  assert_eq(cz-1,cz_inf);</span></div>
<div class="line"><span class="lineno"> 1496</span>  <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1497</span>  <span class="comment">// fraction of the distance from the right of the cell</span></div>
<div class="line"><span class="lineno"> 1498</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w1x = cx - cxm1_pos;</div>
<div class="line"><span class="lineno"> 1499</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w1y = cy - cym1_pos;</div>
<div class="line"><span class="lineno"> 1500</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w1z = cz - czm1_pos;</div>
<div class="line"><span class="lineno"> 1501</span>  <span class="comment">// fraction of distance from the left</span></div>
<div class="line"><span class="lineno"> 1502</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w0x = 1-w1x;</div>
<div class="line"><span class="lineno"> 1503</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w0y = 1-w1y;</div>
<div class="line"><span class="lineno"> 1504</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> w0z = 1-w1z;</div>
<div class="line"><span class="lineno"> 1505</span>  <span class="comment">// we are calculating a charge moment.</span></div>
<div class="line"><span class="lineno"> 1506</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> qi=<a class="code hl_variable" href="../../dd/d8d/namespaceplot1__paper-2__precipitation.html#ac4208e549119be12e26eeec864644829">q</a>[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>];</div>
<div class="line"><span class="lineno"> 1507</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight0 = qi*w0x;</div>
<div class="line"><span class="lineno"> 1508</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight1 = qi*w1x;</div>
<div class="line"><span class="lineno"> 1509</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight00 = weight0*w0y;</div>
<div class="line"><span class="lineno"> 1510</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight01 = weight0*w1y;</div>
<div class="line"><span class="lineno"> 1511</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight10 = weight1*w0y;</div>
<div class="line"><span class="lineno"> 1512</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> weight11 = weight1*w1y;</div>
<div class="line"><span class="lineno"> 1513</span>  weights[0] = weight00*w0z; <span class="comment">// weight000</span></div>
<div class="line"><span class="lineno"> 1514</span>  weights[1] = weight00*w1z; <span class="comment">// weight001</span></div>
<div class="line"><span class="lineno"> 1515</span>  weights[2] = weight01*w0z; <span class="comment">// weight010</span></div>
<div class="line"><span class="lineno"> 1516</span>  weights[3] = weight01*w1z; <span class="comment">// weight011</span></div>
<div class="line"><span class="lineno"> 1517</span>  weights[4] = weight10*w0z; <span class="comment">// weight100</span></div>
<div class="line"><span class="lineno"> 1518</span>  weights[5] = weight10*w1z; <span class="comment">// weight101</span></div>
<div class="line"><span class="lineno"> 1519</span>  weights[6] = weight11*w0z; <span class="comment">// weight110</span></div>
<div class="line"><span class="lineno"> 1520</span>  weights[7] = weight11*w1z; <span class="comment">// weight111</span></div>
<div class="line"><span class="lineno"> 1521</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/de1/include_2_alloc_8h_source.html#l00096">ALIGNED</a>, <a class="el" href="../../d2/d9c/fibo_2tests_2test__new-features_8py_source.html#l00049">test_new-features::i</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::q</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::u</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::v</a>, <a class="el" href="../../d5/d27/plot1__paper-2__precipitation_8py_source.html#l00028">plot1_paper-2_precipitation::w</a>, <a class="el" href="../../d0/d73/plot___jpar-planet_8py_source.html#l00024">plot_Jpar-planet::x</a>, <a class="el" href="../../d0/d73/plot___jpar-planet_8py_source.html#l00025">plot_Jpar-planet::y</a>, and <a class="el" href="../../d0/d73/plot___jpar-planet_8py_source.html#l00026">plot_Jpar-planet::z</a>.</p>

</div>
</div>
<a id="ae140bfa7593be3f1320cd9bdd2b70355" name="ae140bfa7593be3f1320cd9bdd2b70355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae140bfa7593be3f1320cd9bdd2b70355">&#9670;&nbsp;</a></span>phys2solver() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phys2solver </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vectSolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectPhys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>method to convert a 3D field in a 1D field not considering guard cells </p>

<p class="definition">Definition at line <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html#l02064">2064</a> of file <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2064</span>                                                                                         {</div>
<div class="line"><span class="lineno"> 2065</span>  <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a> = 1; <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a> &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#afd89bbabc0537cc9ac6c0fa1b6b52f03">nx</a> - 1; <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>++)</div>
<div class="line"><span class="lineno"> 2066</span>    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#a2f390d094d834c01ecc785c3b827c820">ny</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2067</span>      <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#a64ac13b580df062200b7eeedc31001a0">nz</a> - 1; k++)</div>
<div class="line"><span class="lineno"> 2068</span>        *vectSolver++ = vectPhys.<a class="code hl_function" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html#a736c3a149ef74c4dd9d42b7b4fded838">get</a>(<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>,j,k);</div>
<div class="line"><span class="lineno"> 2069</span>}</div>
<div class="ttc" id="aclassi_pic3_d_1_1const__array__ref3_html_a736c3a149ef74c4dd9d42b7b4fded838"><div class="ttname"><a href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html#a736c3a149ef74c4dd9d42b7b4fded838">iPic3D::const_array_ref3::get</a></div><div class="ttdeci">const type &amp; get(size_t n3, size_t n2, size_t n1) const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/de1/include_2_alloc_8h_source.html#l00652">Alloc.h:652</a></div></div>
<div class="ttc" id="anamespacetest__to2_d_html_a2f390d094d834c01ecc785c3b827c820"><div class="ttname"><a href="../../d0/d3f/namespacetest__to2_d.html#a2f390d094d834c01ecc785c3b827c820">test_to2D.ny</a></div><div class="ttdeci">ny</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D.py:48</a></div></div>
<div class="ttc" id="anamespacetest__to2_d_html_a64ac13b580df062200b7eeedc31001a0"><div class="ttname"><a href="../../d0/d3f/namespacetest__to2_d.html#a64ac13b580df062200b7eeedc31001a0">test_to2D.nz</a></div><div class="ttdeci">nz</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D.py:48</a></div></div>
<div class="ttc" id="anamespacetest__to2_d_html_afd89bbabc0537cc9ac6c0fa1b6b52f03"><div class="ttname"><a href="../../d0/d3f/namespacetest__to2_d.html#afd89bbabc0537cc9ac6c0fa1b6b52f03">test_to2D.nx</a></div><div class="ttdeci">nx</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D.py:48</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/de1/include_2_alloc_8h_source.html#l00652">iPic3D::const_array_ref3&lt; type &gt;::get()</a>, <a class="el" href="../../d2/d9c/fibo_2tests_2test__new-features_8py_source.html#l00049">test_new-features::i</a>, <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::nx</a>, <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::ny</a>, and <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::nz</a>.</p>

</div>
</div>
<a id="ad086768f47954a95ce488691400ad54e" name="ad086768f47954a95ce488691400ad54e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad086768f47954a95ce488691400ad54e">&#9670;&nbsp;</a></span>phys2solver() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void phys2solver </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vectSolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectPhys1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectPhys2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectPhys3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>method to convert a 3D field in a 1D field not considering guard cells </p>

<p class="definition">Definition at line <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html#l02071">2071</a> of file <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2071</span>                                                                                                                                                    {</div>
<div class="line"><span class="lineno"> 2072</span>  <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a> = 1; <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a> &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#afd89bbabc0537cc9ac6c0fa1b6b52f03">nx</a> - 1; <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>++)</div>
<div class="line"><span class="lineno"> 2073</span>    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#a2f390d094d834c01ecc785c3b827c820">ny</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2074</span>      <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#a64ac13b580df062200b7eeedc31001a0">nz</a> - 1; k++) {</div>
<div class="line"><span class="lineno"> 2075</span>        *vectSolver++ = vectPhys1.<a class="code hl_function" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html#a736c3a149ef74c4dd9d42b7b4fded838">get</a>(<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>,j,k);</div>
<div class="line"><span class="lineno"> 2076</span>        *vectSolver++ = vectPhys2.<a class="code hl_function" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html#a736c3a149ef74c4dd9d42b7b4fded838">get</a>(<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>,j,k);</div>
<div class="line"><span class="lineno"> 2077</span>        *vectSolver++ = vectPhys3.<a class="code hl_function" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html#a736c3a149ef74c4dd9d42b7b4fded838">get</a>(<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>,j,k);</div>
<div class="line"><span class="lineno"> 2078</span>      }</div>
<div class="line"><span class="lineno"> 2079</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../df/de1/include_2_alloc_8h_source.html#l00652">iPic3D::const_array_ref3&lt; type &gt;::get()</a>, <a class="el" href="../../d2/d9c/fibo_2tests_2test__new-features_8py_source.html#l00049">test_new-features::i</a>, <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::nx</a>, <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::ny</a>, and <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::nz</a>.</p>

</div>
</div>
<a id="ab3d6bacc13c6b3e4dc89adf85c92aee5" name="ab3d6bacc13c6b3e4dc89adf85c92aee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3d6bacc13c6b3e4dc89adf85c92aee5">&#9670;&nbsp;</a></span>solver2phys() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void solver2phys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectPhys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vectSolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>method to convert a 1D field in a 3D field not considering guard cells </p>

<p class="definition">Definition at line <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html#l02046">2046</a> of file <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2046</span>                                                                                   {</div>
<div class="line"><span class="lineno"> 2047</span>  <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a> = 1; <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a> &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#afd89bbabc0537cc9ac6c0fa1b6b52f03">nx</a> - 1; <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>++)</div>
<div class="line"><span class="lineno"> 2048</span>    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#a2f390d094d834c01ecc785c3b827c820">ny</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2049</span>      <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#a64ac13b580df062200b7eeedc31001a0">nz</a> - 1; k++)</div>
<div class="line"><span class="lineno"> 2050</span>        vectPhys[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>][j][k] = *vectSolver++;</div>
<div class="line"><span class="lineno"> 2051</span> </div>
<div class="line"><span class="lineno"> 2052</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d9c/fibo_2tests_2test__new-features_8py_source.html#l00049">test_new-features::i</a>, <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::nx</a>, <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::ny</a>, and <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::nz</a>.</p>

</div>
</div>
<a id="abeff7cf8725588b388fb6a6af9137223" name="abeff7cf8725588b388fb6a6af9137223"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeff7cf8725588b388fb6a6af9137223">&#9670;&nbsp;</a></span>solver2phys() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void solver2phys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectPhys1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectPhys2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/db3/include_2arraysfwd_8h.html#a5a31a1c9a6693b9da2d722c79fe86625">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectPhys3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vectSolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>method to convert a 1D field in a 3D field not considering guard cells </p>

<p class="definition">Definition at line <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html#l02054">2054</a> of file <a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2054</span>                                                                                                                                  {</div>
<div class="line"><span class="lineno"> 2055</span>  <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a> = 1; <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a> &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#afd89bbabc0537cc9ac6c0fa1b6b52f03">nx</a> - 1; <a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>++)</div>
<div class="line"><span class="lineno"> 2056</span>    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#a2f390d094d834c01ecc785c3b827c820">ny</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2057</span>      <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../d0/d3f/namespacetest__to2_d.html#a64ac13b580df062200b7eeedc31001a0">nz</a> - 1; k++) {</div>
<div class="line"><span class="lineno"> 2058</span>        vectPhys1[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>][j][k] = *vectSolver++;</div>
<div class="line"><span class="lineno"> 2059</span>        vectPhys2[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>][j][k] = *vectSolver++;</div>
<div class="line"><span class="lineno"> 2060</span>        vectPhys3[<a class="code hl_variable" href="../../de/de2/namespacetest__new-features.html#a12edd13b4b44e13c0b817aaefef33245">i</a>][j][k] = *vectSolver++;</div>
<div class="line"><span class="lineno"> 2061</span>      }</div>
<div class="line"><span class="lineno"> 2062</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/d9c/fibo_2tests_2test__new-features_8py_source.html#l00049">test_new-features::i</a>, <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::nx</a>, <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::ny</a>, and <a class="el" href="../../d6/d9d/test__to2_d_8py_source.html#l00048">test_to2D::nz</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_177a4997f54dcb6aa1fe4e3162845e02.html">post-process</a></li><li class="navelem"><a class="el" href="../../dir_ca1c29c1c704aef9b845aaaa8efc4bb3.html">post-process</a></li><li class="navelem"><a class="el" href="../../dir_7077ac53cff93d6073b7e0c81ce1a651.html">fields</a></li><li class="navelem"><a class="el" href="../../db/dd0/post-process_2post-process_2fields_2_e_mfields3_d_8cpp.html">EMfields3D.cpp</a></li>
    <li class="footer">Generated on Wed Jul 20 2022 08:26:07 for iPIC3DxPEACE by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
