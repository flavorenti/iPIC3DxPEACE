<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iPIC3DxPEACE: EMfields3D Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<link rel="search" href="../../search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="iPIC3DxPEACE"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">iPIC3DxPEACE<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">iPIC3D for Planets Exoplanets Asteroids Comets and Emissions</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,true,'search.php','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dd/da6/class_e_mfields3_d.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d8/d75/class_e_mfields3_d-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">EMfields3D Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Collaboration diagram for EMfields3D:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><!-- SVG 0 -->
</div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa70c95fc547dd9eaf8b6929cfb9f0073"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa70c95fc547dd9eaf8b6929cfb9f0073">EMfields3D</a> (<a class="el" href="../../db/dfb/class_collective.html">Collective</a> *col, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid, <a class="el" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct)</td></tr>
<tr class="separator:aa70c95fc547dd9eaf8b6929cfb9f0073"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f1176e551a646695816ffa55179f687"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2f1176e551a646695816ffa55179f687">~EMfields3D</a> ()</td></tr>
<tr class="separator:a2f1176e551a646695816ffa55179f687"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bd9a86dfaa4ce57736b1f477033f400"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1bd9a86dfaa4ce57736b1f477033f400">SetLambda</a> (<a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid)</td></tr>
<tr class="separator:a1bd9a86dfaa4ce57736b1f477033f400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ab5296594cf07ba6a559dc965dd8f11"><td class="memItemLeft" align="right" valign="top">double ***&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a3ab5296594cf07ba6a559dc965dd8f11">GetLambda</a> ()</td></tr>
<tr class="separator:a3ab5296594cf07ba6a559dc965dd8f11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10cca1558704e2a34abafebbdd8df8db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a> ()</td></tr>
<tr class="separator:a10cca1558704e2a34abafebbdd8df8db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1cb8641cd1ec6f1581a1e7b6daef08e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad1cb8641cd1ec6f1581a1e7b6daef08e">initBEAM</a> (double <a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>, double <a class="el" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a>, double <a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>, double radius)</td></tr>
<tr class="separator:ad1cb8641cd1ec6f1581a1e7b6daef08e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95bbd1b220ccb257c0908d28d026fd19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a95bbd1b220ccb257c0908d28d026fd19">initGEM</a> ()</td></tr>
<tr class="separator:a95bbd1b220ccb257c0908d28d026fd19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc4050255fff26fabb77d204492d1fdc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#afc4050255fff26fabb77d204492d1fdc">initOriginalGEM</a> ()</td></tr>
<tr class="separator:afc4050255fff26fabb77d204492d1fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35eb0192bf280b8507f1363975542a95"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a35eb0192bf280b8507f1363975542a95">initGEMDoubleHarris</a> ()</td></tr>
<tr class="separator:a35eb0192bf280b8507f1363975542a95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad57177cc3071efeea79e10bbfcc9ad9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad57177cc3071efeea79e10bbfcc9ad9e">initDoublePeriodicHarrisWithGaussianHumpPerturbation</a> ()</td></tr>
<tr class="separator:ad57177cc3071efeea79e10bbfcc9ad9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81c48a8b25b5a133d034bf6b339e35c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a81c48a8b25b5a133d034bf6b339e35c5">initGEMDipoleLikeTailNoPert</a> ()</td></tr>
<tr class="separator:a81c48a8b25b5a133d034bf6b339e35c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a165535d148dace01d11a9bedb89b0370"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a165535d148dace01d11a9bedb89b0370">initGEMnoPert</a> ()</td></tr>
<tr class="separator:a165535d148dace01d11a9bedb89b0370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6335e442133ba041fa5d2993fb3bc59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae6335e442133ba041fa5d2993fb3bc59">initRandomField</a> ()</td></tr>
<tr class="separator:ae6335e442133ba041fa5d2993fb3bc59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d93a724eee82bbff670ac51ade9167"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac0d93a724eee82bbff670ac51ade9167">initForceFree</a> ()</td></tr>
<tr class="separator:ac0d93a724eee82bbff670ac51ade9167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6d5e7de02d7fd26136c34c190f6b98e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af6d5e7de02d7fd26136c34c190f6b98e">initEM_rotate</a> (double B, double theta)</td></tr>
<tr class="separator:af6d5e7de02d7fd26136c34c190f6b98e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e963071baf452fbed9c71f4210a0277"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1e963071baf452fbed9c71f4210a0277">AddPerturbationRho</a> (double deltaBoB, double kx, double ky, double Bx_mod, double By_mod, double Bz_mod, double ne_mod, double ne_phase, double ni_mod, double ni_phase, double B0, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid)</td></tr>
<tr class="separator:a1e963071baf452fbed9c71f4210a0277"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a082f87b1209114be11077d5525f32a73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a082f87b1209114be11077d5525f32a73">AddPerturbation</a> (double deltaBoB, double kx, double ky, double Ex_mod, double Ex_phase, double Ey_mod, double Ey_phase, double Ez_mod, double Ez_phase, double Bx_mod, double Bx_phase, double By_mod, double By_phase, double Bz_mod, double Bz_phase, double B0, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid)</td></tr>
<tr class="separator:a082f87b1209114be11077d5525f32a73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a153421af9f17631c342457dfbe33433e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a153421af9f17631c342457dfbe33433e">initDipole</a> ()</td></tr>
<tr class="memdesc:a153421af9f17631c342457dfbe33433e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise a planet with dipole B field.  <a href="../../dd/da6/class_e_mfields3_d.html#a153421af9f17631c342457dfbe33433e">More...</a><br /></td></tr>
<tr class="separator:a153421af9f17631c342457dfbe33433e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acec82fa4f7d8956afbd121c4f4014d27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#acec82fa4f7d8956afbd121c4f4014d27">initDipole2D</a> ()</td></tr>
<tr class="separator:acec82fa4f7d8956afbd121c4f4014d27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37c415cb712c9d626a19f0a7bcdaa682"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a37c415cb712c9d626a19f0a7bcdaa682">initNullPoints</a> ()</td></tr>
<tr class="separator:a37c415cb712c9d626a19f0a7bcdaa682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad17d67dac1e9bcab764afe129a1dc20a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad17d67dac1e9bcab764afe129a1dc20a">initTaylorGreen</a> ()</td></tr>
<tr class="separator:ad17d67dac1e9bcab764afe129a1dc20a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab040c0a52d8943d378d1aecc6c62c670"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab040c0a52d8943d378d1aecc6c62c670">calculateE</a> (int cycle)</td></tr>
<tr class="separator:ab040c0a52d8943d378d1aecc6c62c670"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d3ddfa82333c03d79211c94cf7d7df9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a9d3ddfa82333c03d79211c94cf7d7df9">PoissonImage</a> (double *image, double *vector)</td></tr>
<tr class="separator:a9d3ddfa82333c03d79211c94cf7d7df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e27b63407e586437ede5e39d3e1a3d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0e27b63407e586437ede5e39d3e1a3d8">MaxwellImage</a> (double *im, double *vector)</td></tr>
<tr class="separator:a0e27b63407e586437ede5e39d3e1a3d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5575c54ce46a4de2975e662ae1cb5781"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5575c54ce46a4de2975e662ae1cb5781">MaxwellSource</a> (double *bkrylov)</td></tr>
<tr class="separator:a5575c54ce46a4de2975e662ae1cb5781"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3cdcba848fb0b5ee0dc6f6476e37398"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa3cdcba848fb0b5ee0dc6f6476e37398">ConstantChargePlanet</a> (double R, double <a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>, double <a class="el" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a>, double <a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>)</td></tr>
<tr class="separator:aa3cdcba848fb0b5ee0dc6f6476e37398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e69bff1e74eb6814b180556575ebdbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2e69bff1e74eb6814b180556575ebdbf">ConstantChargePlanet2DPlaneXZ</a> (double R, double <a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>, double <a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>)</td></tr>
<tr class="separator:a2e69bff1e74eb6814b180556575ebdbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40a106fb1177412f3b42fd2c9c5a59de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a40a106fb1177412f3b42fd2c9c5a59de">ConstantChargeOpenBC</a> ()</td></tr>
<tr class="separator:a40a106fb1177412f3b42fd2c9c5a59de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00bfc9a649ed9ceec05a26e778bb54dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a00bfc9a649ed9ceec05a26e778bb54dd">ConstantChargeOpenBCv2</a> ()</td></tr>
<tr class="separator:a00bfc9a649ed9ceec05a26e778bb54dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5140eef8f09481bcf485b06def1cf872"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5140eef8f09481bcf485b06def1cf872">calculateB</a> ()</td></tr>
<tr class="separator:a5140eef8f09481bcf485b06def1cf872"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690aae651b816a0c73795a2c8ad35b0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a690aae651b816a0c73795a2c8ad35b0e">fixBcGEM</a> ()</td></tr>
<tr class="separator:a690aae651b816a0c73795a2c8ad35b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0841d39b77e72bcb91d8da9479c596de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0841d39b77e72bcb91d8da9479c596de">fixBnGEM</a> ()</td></tr>
<tr class="separator:a0841d39b77e72bcb91d8da9479c596de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeaa9263ae0772c0b3a589e268f42684"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aaeaa9263ae0772c0b3a589e268f42684">fixBforcefree</a> ()</td></tr>
<tr class="separator:aaeaa9263ae0772c0b3a589e268f42684"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a892a9c1f5511092fbd32ac283fcbc6c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a892a9c1f5511092fbd32ac283fcbc6c1">PIdot</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> PIdotX, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> PIdotY, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> PIdotZ, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectX, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectY, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectZ, int <a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>)</td></tr>
<tr class="separator:a892a9c1f5511092fbd32ac283fcbc6c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4140d7b94234b3c31184d08445a21f40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4140d7b94234b3c31184d08445a21f40">MUdot</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> MUdotX, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> MUdotY, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> MUdotZ, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectX, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectY, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectZ)</td></tr>
<tr class="separator:a4140d7b94234b3c31184d08445a21f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64e2a62e24f815702fc0f37229fdf0e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a64e2a62e24f815702fc0f37229fdf0e2">calculateHatFunctions</a> ()</td></tr>
<tr class="separator:a64e2a62e24f815702fc0f37229fdf0e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a447393b4fced4b504366971ad8f3bfdc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a447393b4fced4b504366971ad8f3bfdc">interpDensitiesN2C</a> ()</td></tr>
<tr class="separator:a447393b4fced4b504366971ad8f3bfdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9873e7af854e4b62d6d7ffd9a9d8aef5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a9873e7af854e4b62d6d7ffd9a9d8aef5">setZeroDensities</a> ()</td></tr>
<tr class="separator:a9873e7af854e4b62d6d7ffd9a9d8aef5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8962189d5c671d7b0e3ad2516e70126e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a8962189d5c671d7b0e3ad2516e70126e">setZeroPrimaryMoments</a> ()</td></tr>
<tr class="separator:a8962189d5c671d7b0e3ad2516e70126e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a375729e23a4a80fcf1266d4539d72a1e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a375729e23a4a80fcf1266d4539d72a1e">setZeroDerivedMoments</a> ()</td></tr>
<tr class="separator:a375729e23a4a80fcf1266d4539d72a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30e3d07ce73eeef91b4e6f7d1d604f28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a30e3d07ce73eeef91b4e6f7d1d604f28">sumOverSpecies</a> ()</td></tr>
<tr class="separator:a30e3d07ce73eeef91b4e6f7d1d604f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff1a781c05a7b98517efabdf6352a547"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aff1a781c05a7b98517efabdf6352a547">sumOverSpeciesJ</a> ()</td></tr>
<tr class="separator:aff1a781c05a7b98517efabdf6352a547"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace4a00624182f44875bbd400d5c15324"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ace4a00624182f44875bbd400d5c15324">smooth</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vector, int type)</td></tr>
<tr class="separator:ace4a00624182f44875bbd400d5c15324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af10bd0fe5aee301cee0cb9491df8f292"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af10bd0fe5aee301cee0cb9491df8f292">smoothE</a> ()</td></tr>
<tr class="separator:af10bd0fe5aee301cee0cb9491df8f292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25285e5b33836e3a3e77965e887836ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a25285e5b33836e3a3e77965e887836ef">set_fieldForPcls</a> ()</td></tr>
<tr class="separator:a25285e5b33836e3a3e77965e887836ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f7cfc31e795a75ecaad608f6cb8df25"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a9f7cfc31e795a75ecaad608f6cb8df25">communicateGhostP2G</a> (int <a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>)</td></tr>
<tr class="separator:a9f7cfc31e795a75ecaad608f6cb8df25"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a995bc41931c5380945e9cb6a3b04c16a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a995bc41931c5380945e9cb6a3b04c16a">sumMoments</a> (const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *part)</td></tr>
<tr class="separator:a995bc41931c5380945e9cb6a3b04c16a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cdf1200df3db2a29bd876c9d7e33ea7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5cdf1200df3db2a29bd876c9d7e33ea7">sumMoments_AoS</a> (const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *part)</td></tr>
<tr class="separator:a5cdf1200df3db2a29bd876c9d7e33ea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa798edff9f1dab76702cbe51ef96a5ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa798edff9f1dab76702cbe51ef96a5ef">sumMoments_AoS_intr</a> (const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *part)</td></tr>
<tr class="separator:aa798edff9f1dab76702cbe51ef96a5ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad69796f3529511284f8090c70df0a952"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad69796f3529511284f8090c70df0a952">sumMoments_vectorized</a> (const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *part)</td></tr>
<tr class="separator:ad69796f3529511284f8090c70df0a952"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d54644c16e9b430a6f3b75d2f27451"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a14d54644c16e9b430a6f3b75d2f27451">sumMoments_vectorized_AoS</a> (const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *part)</td></tr>
<tr class="separator:a14d54644c16e9b430a6f3b75d2f27451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2362220c53328d811ae1d26953693c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0a2362220c53328d811ae1d26953693c">sumMomentsOld</a> (const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> &amp;pcls)</td></tr>
<tr class="separator:a0a2362220c53328d811ae1d26953693c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa72327e5d7c7aa04c083f8eeedfed9ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa72327e5d7c7aa04c083f8eeedfed9ef">addRho</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:aa72327e5d7c7aa04c083f8eeedfed9ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7746c72f05aa81fc99542bcfb5680c82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7746c72f05aa81fc99542bcfb5680c82">addJx</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:a7746c72f05aa81fc99542bcfb5680c82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3c28853467b3b3bfc17426ae693108"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7f3c28853467b3b3bfc17426ae693108">addJy</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:a7f3c28853467b3b3bfc17426ae693108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac148293b3d87704ce4ea860d17c4cac6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac148293b3d87704ce4ea860d17c4cac6">addJz</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:ac148293b3d87704ce4ea860d17c4cac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e9d0e2f5afebb6cec8fc8e2bf94f201"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2e9d0e2f5afebb6cec8fc8e2bf94f201">addPxx</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:a2e9d0e2f5afebb6cec8fc8e2bf94f201"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20ad3d02f549b15d24e9964c2147ce03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a20ad3d02f549b15d24e9964c2147ce03">addPxy</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:a20ad3d02f549b15d24e9964c2147ce03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c422a2f7d4d9703990fbecf10e25c42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4c422a2f7d4d9703990fbecf10e25c42">addPxz</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:a4c422a2f7d4d9703990fbecf10e25c42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10f59553f4b4dfdbb044b6c4bc46bc7f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a10f59553f4b4dfdbb044b6c4bc46bc7f">addPyy</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:a10f59553f4b4dfdbb044b6c4bc46bc7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ac719c2121d340e6886083295c2c921"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1ac719c2121d340e6886083295c2c921">addPyz</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:a1ac719c2121d340e6886083295c2c921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4072e7bf48c9807e6389a2d875d85dd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4072e7bf48c9807e6389a2d875d85dd0">addPzz</a> (double weight[][2][2], int X, int Y, int Z, int is)</td></tr>
<tr class="separator:a4072e7bf48c9807e6389a2d875d85dd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ba145a878a26b59fb5405da269449d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a3ba145a878a26b59fb5405da269449d1">adjustNonPeriodicDensities</a> (int is)</td></tr>
<tr class="separator:a3ba145a878a26b59fb5405da269449d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee06483ad2b6442df88503b205b0d408"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aee06483ad2b6442df88503b205b0d408">perfectConductorLeft</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> <a class="el" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> imageY, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> imageZ, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectorX, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectorY, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectorZ, int dir)</td></tr>
<tr class="separator:aee06483ad2b6442df88503b205b0d408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1072ee8da07f212a187cd2f439d157e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab1072ee8da07f212a187cd2f439d157e">perfectConductorRight</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> <a class="el" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> imageY, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> imageZ, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectorX, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectorY, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectorZ, int dir)</td></tr>
<tr class="separator:ab1072ee8da07f212a187cd2f439d157e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0a7091cc937d5c0b93341c43f9bd261"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae0a7091cc937d5c0b93341c43f9bd261">perfectConductorLeftS</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorX, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorY, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorZ, int dir)</td></tr>
<tr class="separator:ae0a7091cc937d5c0b93341c43f9bd261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6e0daf47ea065c947d9b99493418a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1e6e0daf47ea065c947d9b99493418a3">perfectConductorRightS</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorX, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorY, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorZ, int dir)</td></tr>
<tr class="separator:a1e6e0daf47ea065c947d9b99493418a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf8e3a2222c27c4370da9e45e331b46c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#abf8e3a2222c27c4370da9e45e331b46c">sustensorRightX</a> (double **susxx, double **susyx, double **suszx)</td></tr>
<tr class="separator:abf8e3a2222c27c4370da9e45e331b46c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cd4c1659be3a8e65c3f42f386b2364f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7cd4c1659be3a8e65c3f42f386b2364f">sustensorLeftX</a> (double **susxx, double **susyx, double **suszx)</td></tr>
<tr class="separator:a7cd4c1659be3a8e65c3f42f386b2364f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7be07c6d9ea694ae7ace21ee4ae67b36"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7be07c6d9ea694ae7ace21ee4ae67b36">sustensorRightY</a> (double **susxy, double **susyy, double **suszy)</td></tr>
<tr class="separator:a7be07c6d9ea694ae7ace21ee4ae67b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21a5816d7eb991b7c9a61c7e90279160"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a21a5816d7eb991b7c9a61c7e90279160">sustensorLeftY</a> (double **susxy, double **susyy, double **suszy)</td></tr>
<tr class="separator:a21a5816d7eb991b7c9a61c7e90279160"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ba6a96d31f80b1179910a118484cced"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5ba6a96d31f80b1179910a118484cced">sustensorRightZ</a> (double **susxz, double **susyz, double **suszz)</td></tr>
<tr class="separator:a5ba6a96d31f80b1179910a118484cced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff9869a55d3b0bef113147abd0819667"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aff9869a55d3b0bef113147abd0819667">sustensorLeftZ</a> (double **susxz, double **susyz, double **suszz)</td></tr>
<tr class="separator:aff9869a55d3b0bef113147abd0819667"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fb9bdbe4c10f7e59b6d1c7c415a922c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a6fb9bdbe4c10f7e59b6d1c7c415a922c">getPHI</a> ()</td></tr>
<tr class="separator:a6fb9bdbe4c10f7e59b6d1c7c415a922c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a523f1ef9c142dc21eb80d6d09e17d50c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a523f1ef9c142dc21eb80d6d09e17d50c">getEx</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:a523f1ef9c142dc21eb80d6d09e17d50c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86e69d29d9ac8b58e75ef5c36a845e1e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a86e69d29d9ac8b58e75ef5c36a845e1e">getEy</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:a86e69d29d9ac8b58e75ef5c36a845e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a954d670b4ccaf5c964fdf8905349b287"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a954d670b4ccaf5c964fdf8905349b287">getEz</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:a954d670b4ccaf5c964fdf8905349b287"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2b14c94f1a58f42c1ce7c4a6a2f5edd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af2b14c94f1a58f42c1ce7c4a6a2f5edd">getBx</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:af2b14c94f1a58f42c1ce7c4a6a2f5edd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d0001bd28b90bbb41e5e8e1d82d9d40"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a3d0001bd28b90bbb41e5e8e1d82d9d40">getBy</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:a3d0001bd28b90bbb41e5e8e1d82d9d40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7ea3b60d4f3c89d59bf687e80ce89b3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab7ea3b60d4f3c89d59bf687e80ce89b3">getBz</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:ab7ea3b60d4f3c89d59bf687e80ce89b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a126c09acf5f2dc8f3b0657cbcabb8e32"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/df4/classi_pic3_d_1_1const__array__ref4.html">const_arr4_pfloat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a126c09acf5f2dc8f3b0657cbcabb8e32">get_fieldForPcls</a> ()</td></tr>
<tr class="separator:a126c09acf5f2dc8f3b0657cbcabb8e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5aa69ea0889d2d2fac6e70bf2e973ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac5aa69ea0889d2d2fac6e70bf2e973ad">getEx</a> ()</td></tr>
<tr class="separator:ac5aa69ea0889d2d2fac6e70bf2e973ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0499a4d969b65c7ea67650daf67299d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab0499a4d969b65c7ea67650daf67299d">getEy</a> ()</td></tr>
<tr class="separator:ab0499a4d969b65c7ea67650daf67299d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9213b00dbbdaff6be976b85c45481ac4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a9213b00dbbdaff6be976b85c45481ac4">getEz</a> ()</td></tr>
<tr class="separator:a9213b00dbbdaff6be976b85c45481ac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a800573388d9fa762c7e5be4722115681"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a800573388d9fa762c7e5be4722115681">getBx</a> ()</td></tr>
<tr class="separator:a800573388d9fa762c7e5be4722115681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40b5fbe966761df8f71cd51548371251"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a40b5fbe966761df8f71cd51548371251">getBy</a> ()</td></tr>
<tr class="separator:a40b5fbe966761df8f71cd51548371251"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21704979c7783048ea5f3ecac1824a68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a21704979c7783048ea5f3ecac1824a68">getBz</a> ()</td></tr>
<tr class="separator:a21704979c7783048ea5f3ecac1824a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb749488cdde83cef28c928a19f5d1a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2cb749488cdde83cef28c928a19f5d1a">getBxc</a> ()</td></tr>
<tr class="separator:a2cb749488cdde83cef28c928a19f5d1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6bf9d0d7d2c9646659fd12597af52c1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab6bf9d0d7d2c9646659fd12597af52c1">getByc</a> ()</td></tr>
<tr class="separator:ab6bf9d0d7d2c9646659fd12597af52c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b809a4c611bf92c4fa955ffaa5b1ce9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1b809a4c611bf92c4fa955ffaa5b1ce9">getBzc</a> ()</td></tr>
<tr class="separator:a1b809a4c611bf92c4fa955ffaa5b1ce9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2f784901b90147dcd5559565c0e7ff4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae2f784901b90147dcd5559565c0e7ff4">getRHOcs</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:ae2f784901b90147dcd5559565c0e7ff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a625c2089bdde1c06cacb5be12975ae8d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a625c2089bdde1c06cacb5be12975ae8d">getRHOns</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:a625c2089bdde1c06cacb5be12975ae8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeec44f4d3764a6075790e8640dbc64c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aeec44f4d3764a6075790e8640dbc64c7">getRHOns</a> ()</td></tr>
<tr class="separator:aeec44f4d3764a6075790e8640dbc64c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affab40e1b9f06113cd78145f7c006a0a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#affab40e1b9f06113cd78145f7c006a0a">getRHOcs</a> ()</td></tr>
<tr class="separator:affab40e1b9f06113cd78145f7c006a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba32b0168ebc8c4a03051d62e0cf3e16"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aba32b0168ebc8c4a03051d62e0cf3e16">getBx_ext</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:aba32b0168ebc8c4a03051d62e0cf3e16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3172bf21e2d471c70c7edea1a1a8ccd4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a3172bf21e2d471c70c7edea1a1a8ccd4">getBy_ext</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:a3172bf21e2d471c70c7edea1a1a8ccd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a408c307e1c9dc4c8b5e655e1a82e1427"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a408c307e1c9dc4c8b5e655e1a82e1427">getBz_ext</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:a408c307e1c9dc4c8b5e655e1a82e1427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f29d2fe1b0867072bded33483b624b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a8f29d2fe1b0867072bded33483b624b5">getBx_ext</a> ()</td></tr>
<tr class="separator:a8f29d2fe1b0867072bded33483b624b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae749988609e5e91a7d00f10da9dbba8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aae749988609e5e91a7d00f10da9dbba8">getBy_ext</a> ()</td></tr>
<tr class="separator:aae749988609e5e91a7d00f10da9dbba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e4db4a14c9b340f9213cab5b09899e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a92e4db4a14c9b340f9213cab5b09899e">getBz_ext</a> ()</td></tr>
<tr class="separator:a92e4db4a14c9b340f9213cab5b09899e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d65c4b918671472042d47ebace11083"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a6d65c4b918671472042d47ebace11083">getBxTot</a> ()</td></tr>
<tr class="separator:a6d65c4b918671472042d47ebace11083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5208f8c81474a42ab08a550893292e17"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5208f8c81474a42ab08a550893292e17">getByTot</a> ()</td></tr>
<tr class="separator:a5208f8c81474a42ab08a550893292e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52159e09ba2b067c17f85223f5705274"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a52159e09ba2b067c17f85223f5705274">getBzTot</a> ()</td></tr>
<tr class="separator:a52159e09ba2b067c17f85223f5705274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a153b37bcf0ca6ddd43da47b4ecb152"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1a153b37bcf0ca6ddd43da47b4ecb152">getBxTot</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:a1a153b37bcf0ca6ddd43da47b4ecb152"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad049883ed1fdcf0f9ec3391254c640d3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad049883ed1fdcf0f9ec3391254c640d3">getByTot</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:ad049883ed1fdcf0f9ec3391254c640d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1feec1339a395023b2db859360468d11"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1feec1339a395023b2db859360468d11">getBzTot</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:a1feec1339a395023b2db859360468d11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04dfdb8e0a5c69c84ee30930d95a85bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a04dfdb8e0a5c69c84ee30930d95a85bc">getpXXsn</a> ()</td></tr>
<tr class="separator:a04dfdb8e0a5c69c84ee30930d95a85bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aeade2ed1686e894db7023ef2e8bcf5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1aeade2ed1686e894db7023ef2e8bcf5">getpXXsn</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:a1aeade2ed1686e894db7023ef2e8bcf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31abfd73cb6aa69ae77dccc2bcdce94a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a31abfd73cb6aa69ae77dccc2bcdce94a">getpXYsn</a> ()</td></tr>
<tr class="separator:a31abfd73cb6aa69ae77dccc2bcdce94a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a796a8a5a214bedee533e6ceafcdda8df"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a796a8a5a214bedee533e6ceafcdda8df">getpXYsn</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:a796a8a5a214bedee533e6ceafcdda8df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12ac83afef70d3e59fddfc57e9a99ec2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a12ac83afef70d3e59fddfc57e9a99ec2">getpXZsn</a> ()</td></tr>
<tr class="separator:a12ac83afef70d3e59fddfc57e9a99ec2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ef65147da21cc451b43fef251665324"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0ef65147da21cc451b43fef251665324">getpXZsn</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:a0ef65147da21cc451b43fef251665324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a467b8e00b722cd2c864ad6419be90538"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a467b8e00b722cd2c864ad6419be90538">getpYYsn</a> ()</td></tr>
<tr class="separator:a467b8e00b722cd2c864ad6419be90538"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade5d4564c8eeb07164c85e84b4bb25d5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ade5d4564c8eeb07164c85e84b4bb25d5">getpYYsn</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:ade5d4564c8eeb07164c85e84b4bb25d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dc0b717b256b956b647ac6e4e167d99"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1dc0b717b256b956b647ac6e4e167d99">getpYZsn</a> ()</td></tr>
<tr class="separator:a1dc0b717b256b956b647ac6e4e167d99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8989d9e7aaed280db45593d02e3ff7d5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a8989d9e7aaed280db45593d02e3ff7d5">getpYZsn</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:a8989d9e7aaed280db45593d02e3ff7d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac569958b28ed95ca23f9f2d79611e055"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac569958b28ed95ca23f9f2d79611e055">getpZZsn</a> ()</td></tr>
<tr class="separator:ac569958b28ed95ca23f9f2d79611e055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d669b6eb6ed804fb5bb426a4ba138d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab1d669b6eb6ed804fb5bb426a4ba138d">getpZZsn</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:ab1d669b6eb6ed804fb5bb426a4ba138d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab82e5760d906a5acb91abeabfc838eb4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab82e5760d906a5acb91abeabfc838eb4">getJx</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:ab82e5760d906a5acb91abeabfc838eb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4458d7550b07a97a1ed1c186cb3e454"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae4458d7550b07a97a1ed1c186cb3e454">getJy</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:ae4458d7550b07a97a1ed1c186cb3e454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bf91e860e8076a8da7ac12d292d05e4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2bf91e860e8076a8da7ac12d292d05e4">getJz</a> (int X, int Y, int Z) const</td></tr>
<tr class="separator:a2bf91e860e8076a8da7ac12d292d05e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad011afdf75158597368020dcd79f806e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad011afdf75158597368020dcd79f806e">getJx</a> ()</td></tr>
<tr class="separator:ad011afdf75158597368020dcd79f806e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd422a9c64c53482414b779ba5dba3e9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#afd422a9c64c53482414b779ba5dba3e9">getJy</a> ()</td></tr>
<tr class="separator:afd422a9c64c53482414b779ba5dba3e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923f2c457150b11d2d3d1f59675f4911"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a923f2c457150b11d2d3d1f59675f4911">getJz</a> ()</td></tr>
<tr class="separator:a923f2c457150b11d2d3d1f59675f4911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cedc7a79e1a44a0647b4ce27e6db62e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1cedc7a79e1a44a0647b4ce27e6db62e">getJxs</a> ()</td></tr>
<tr class="separator:a1cedc7a79e1a44a0647b4ce27e6db62e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1647a6bacc6a190fc75f537a1f8b2d5d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1647a6bacc6a190fc75f537a1f8b2d5d">getJys</a> ()</td></tr>
<tr class="separator:a1647a6bacc6a190fc75f537a1f8b2d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeae41158205f52df52501bd52bde6858"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aeae41158205f52df52501bd52bde6858">getJzs</a> ()</td></tr>
<tr class="separator:aeae41158205f52df52501bd52bde6858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c953a6544bedf570ace62f554a1a04"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad4c953a6544bedf570ace62f554a1a04">getJxs</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:ad4c953a6544bedf570ace62f554a1a04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2b4c5be8dc2a451becef765872e0bfa"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad2b4c5be8dc2a451becef765872e0bfa">getJys</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:ad2b4c5be8dc2a451becef765872e0bfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b5f3934f6b3d9298d6098b600847a88"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a3b5f3934f6b3d9298d6098b600847a88">getJzs</a> (int X, int Y, int Z, int is) const</td></tr>
<tr class="separator:a3b5f3934f6b3d9298d6098b600847a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b99f2e41903e87da3f06d4e05c3e07"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae1b99f2e41903e87da3f06d4e05c3e07">getEenergy</a> ()</td></tr>
<tr class="separator:ae1b99f2e41903e87da3f06d4e05c3e07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a794d16aea220c39fe864351a375cb719"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a794d16aea220c39fe864351a375cb719">getBenergy</a> ()</td></tr>
<tr class="separator:a794d16aea220c39fe864351a375cb719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc7e515ef99ef94124e57bc1ae229c75"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#adc7e515ef99ef94124e57bc1ae229c75">getBulkEnergy</a> (int is)</td></tr>
<tr class="separator:adc7e515ef99ef94124e57bc1ae229c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a497e6c49c5f051a364eb1c0972e215df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d1c/class_moments10.html">Moments10</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a497e6c49c5f051a364eb1c0972e215df">fetch_moments10Array</a> (int i)</td></tr>
<tr class="separator:a497e6c49c5f051a364eb1c0972e215df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa44b37f8a182f3290cc4ae176716c6e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa44b37f8a182f3290cc4ae176716c6e7">get_sizeMomentsArray</a> ()</td></tr>
<tr class="separator:aa44b37f8a182f3290cc4ae176716c6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee8a6a15ba29ed6dd1c53b20e0425a67"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aee8a6a15ba29ed6dd1c53b20e0425a67">print</a> (void) const</td></tr>
<tr class="separator:aee8a6a15ba29ed6dd1c53b20e0425a67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6cbf5ed8ab1cd9068ce50a113706cef"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af6cbf5ed8ab1cd9068ce50a113706cef">getCurlN2CB_x</a> (int i, int j, int k)</td></tr>
<tr class="separator:af6cbf5ed8ab1cd9068ce50a113706cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a044c847275c41effa7a40a2f62b85ec0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a044c847275c41effa7a40a2f62b85ec0">getCurlN2CB_y</a> (int i, int j, int k)</td></tr>
<tr class="separator:a044c847275c41effa7a40a2f62b85ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa18f27cdd05713a1a37c64c0163ec1b4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa18f27cdd05713a1a37c64c0163ec1b4">getCurlN2CB_z</a> (int i, int j, int k)</td></tr>
<tr class="separator:aa18f27cdd05713a1a37c64c0163ec1b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a222e0a9439e5a86ee1a325dc7624c679"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a222e0a9439e5a86ee1a325dc7624c679">getYZFacetype</a> (bool isCenterFlag)</td></tr>
<tr class="separator:a222e0a9439e5a86ee1a325dc7624c679"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec43a6826a260a632fb09bd997a58ff2"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aec43a6826a260a632fb09bd997a58ff2">getXZFacetype</a> (bool isCenterFlag)</td></tr>
<tr class="separator:aec43a6826a260a632fb09bd997a58ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae60762e98465f1fd728e530f9c944691"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae60762e98465f1fd728e530f9c944691">getXYFacetype</a> (bool isCenterFlag)</td></tr>
<tr class="separator:ae60762e98465f1fd728e530f9c944691"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab937081030496b40a35fe2e9ca98b4c5"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab937081030496b40a35fe2e9ca98b4c5">getXEdgetype</a> (bool isCenterFlag)</td></tr>
<tr class="separator:ab937081030496b40a35fe2e9ca98b4c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a887804f3a39e24b9859039131cbff4c1"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a887804f3a39e24b9859039131cbff4c1">getYEdgetype</a> (bool isCenterFlag)</td></tr>
<tr class="separator:a887804f3a39e24b9859039131cbff4c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a780a1eb044a107eb0ea95234fbf9611e"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a780a1eb044a107eb0ea95234fbf9611e">getZEdgetype</a> (bool isCenterFlag)</td></tr>
<tr class="separator:a780a1eb044a107eb0ea95234fbf9611e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34d6ae7f949af6acaee15b3a6dc04363"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a34d6ae7f949af6acaee15b3a6dc04363">getXEdgetype2</a> (bool isCenterFlag)</td></tr>
<tr class="separator:a34d6ae7f949af6acaee15b3a6dc04363"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e5dd320d6b6720021f519d050bd9407"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4e5dd320d6b6720021f519d050bd9407">getYEdgetype2</a> (bool isCenterFlag)</td></tr>
<tr class="separator:a4e5dd320d6b6720021f519d050bd9407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7f6f7a25df3324557efc2a61df9b8e5"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af7f6f7a25df3324557efc2a61df9b8e5">getZEdgetype2</a> (bool isCenterFlag)</td></tr>
<tr class="separator:af7f6f7a25df3324557efc2a61df9b8e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3fc969174371331127fc002a3f23206"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af3fc969174371331127fc002a3f23206">getCornertype</a> (bool isCenterFlag)</td></tr>
<tr class="separator:af3fc969174371331127fc002a3f23206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54546a7181bcc86d8828905764a0905b"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a54546a7181bcc86d8828905764a0905b">getProcview</a> ()</td></tr>
<tr class="separator:a54546a7181bcc86d8828905764a0905b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92a1e26001895c1ecd3566c224dbb73"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa92a1e26001895c1ecd3566c224dbb73">getXYZeType</a> ()</td></tr>
<tr class="separator:aa92a1e26001895c1ecd3566c224dbb73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a517448ea4a5e9195b1be2f3d619743a9"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a517448ea4a5e9195b1be2f3d619743a9">getProcviewXYZ</a> ()</td></tr>
<tr class="separator:a517448ea4a5e9195b1be2f3d619743a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cfff47f252873a918caae583ee4059e"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a6cfff47f252873a918caae583ee4059e">getGhostType</a> ()</td></tr>
<tr class="separator:a6cfff47f252873a918caae583ee4059e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c7748293f086b8e4960432851b8d158"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5c7748293f086b8e4960432851b8d158">freeDataType</a> ()</td></tr>
<tr class="separator:a5c7748293f086b8e4960432851b8d158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac76cfcf464c910f1546f4ebe1ff8235"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aac76cfcf464c910f1546f4ebe1ff8235">isLittleEndian</a> ()</td></tr>
<tr class="separator:aac76cfcf464c910f1546f4ebe1ff8235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc9273f97a41be42951e161b36fce65c"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../db/dfb/class_collective.html">Collective</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#abc9273f97a41be42951e161b36fce65c">get_col</a> () const</td></tr>
<tr class="separator:abc9273f97a41be42951e161b36fce65c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3b33f74af5f913a00eb37d8e79d956"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2e3b33f74af5f913a00eb37d8e79d956">get_grid</a> () const</td></tr>
<tr class="separator:a2e3b33f74af5f913a00eb37d8e79d956"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0172ec4aa44c0558f7e651867ee1ef05"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0172ec4aa44c0558f7e651867ee1ef05">get_vct</a> () const</td></tr>
<tr class="separator:a0172ec4aa44c0558f7e651867ee1ef05"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:abd42dd42c4c4bdbe4e04c6f0e0a58fe5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#abd42dd42c4c4bdbe4e04c6f0e0a58fe5">OpenBoundaryInflowB</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorX, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorY, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorZ, int nx, int ny, int nz)</td></tr>
<tr class="separator:abd42dd42c4c4bdbe4e04c6f0e0a58fe5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae27b2108b93378e11111fc791dc09a2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae27b2108b93378e11111fc791dc09a2d">OpenBoundaryInflowE</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorX, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorY, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> vectorZ, int nx, int ny, int nz)</td></tr>
<tr class="separator:ae27b2108b93378e11111fc791dc09a2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98a6b6ad2409aa124446c7b922277690"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a98a6b6ad2409aa124446c7b922277690">OpenBoundaryInflowEImage</a> (<a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> <a class="el" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> imageY, <a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> imageZ, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectorX, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectorY, <a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a> vectorZ, int nx, int ny, int nz)</td></tr>
<tr class="separator:a98a6b6ad2409aa124446c7b922277690"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:af93c298892f72654a806b9f755d38b3d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../db/dfb/class_collective.html">Collective</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af93c298892f72654a806b9f755d38b3d">_col</a></td></tr>
<tr class="separator:af93c298892f72654a806b9f755d38b3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5578936b455cf162163b43321c90350"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad5578936b455cf162163b43321c90350">_grid</a></td></tr>
<tr class="separator:ad5578936b455cf162163b43321c90350"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a892dbf10e39181c08f646df47f308d12"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a892dbf10e39181c08f646df47f308d12">_vct</a></td></tr>
<tr class="separator:a892dbf10e39181c08f646df47f308d12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36c6b4e19eaedb0ec58aae5c2d090cc8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a></td></tr>
<tr class="separator:a36c6b4e19eaedb0ec58aae5c2d090cc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a6ca6b2262f611982b2f7345e009e9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa6a6ca6b2262f611982b2f7345e009e9">FourPI</a></td></tr>
<tr class="separator:aa6a6ca6b2262f611982b2f7345e009e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a206f6017adcc96ec7fc074b5101fb2fb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a></td></tr>
<tr class="separator:a206f6017adcc96ec7fc074b5101fb2fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac87809eafbf98eb3336a670dcb3a2728"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a></td></tr>
<tr class="separator:ac87809eafbf98eb3336a670dcb3a2728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e00cd79434a2bc1f9eccfa33284768d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a></td></tr>
<tr class="separator:a9e00cd79434a2bc1f9eccfa33284768d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace7b52de028267a27294870c7396e9b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ace7b52de028267a27294870c7396e9b9">SmoothNiter</a></td></tr>
<tr class="separator:ace7b52de028267a27294870c7396e9b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6423e5405362e6401eb65b1db95fb74"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a></td></tr>
<tr class="separator:af6423e5405362e6401eb65b1db95fb74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a57d80ce246ebe6e9ba52ce3fbbceb9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a></td></tr>
<tr class="separator:a4a57d80ce246ebe6e9ba52ce3fbbceb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36e8cc446bb14517409aba077a6bab1b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a></td></tr>
<tr class="separator:a36e8cc446bb14517409aba077a6bab1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a727426b7b5e38a44414b3d62f0ff4a43"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a727426b7b5e38a44414b3d62f0ff4a43">B0y</a></td></tr>
<tr class="separator:a727426b7b5e38a44414b3d62f0ff4a43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd41fdb7bae0821184c90d652cbcdd88"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#acd41fdb7bae0821184c90d652cbcdd88">B0z</a></td></tr>
<tr class="separator:acd41fdb7bae0821184c90d652cbcdd88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0afa5eb8bc1e272c0af04b33b1209b7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa0afa5eb8bc1e272c0af04b33b1209b7">delta</a></td></tr>
<tr class="separator:aa0afa5eb8bc1e272c0af04b33b1209b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42158c86c46e0ee3ce618cfe52d63b31"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a42158c86c46e0ee3ce618cfe52d63b31">B1x</a></td></tr>
<tr class="memdesc:a42158c86c46e0ee3ce618cfe52d63b31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Earth Model parameters.  <a href="../../dd/da6/class_e_mfields3_d.html#a42158c86c46e0ee3ce618cfe52d63b31">More...</a><br /></td></tr>
<tr class="separator:a42158c86c46e0ee3ce618cfe52d63b31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a509ac4900a9de054c4963cec5c3ba09e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a509ac4900a9de054c4963cec5c3ba09e">B1y</a></td></tr>
<tr class="separator:a509ac4900a9de054c4963cec5c3ba09e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2a17c5ef59ecca7c620779fa3797e35"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad2a17c5ef59ecca7c620779fa3797e35">B1z</a></td></tr>
<tr class="separator:ad2a17c5ef59ecca7c620779fa3797e35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd424234905b5fba72af10c3a93abe86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#acd424234905b5fba72af10c3a93abe86">PlanetOffset</a></td></tr>
<tr class="separator:acd424234905b5fba72af10c3a93abe86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a877f625eaefc4a2a28c6ac7001c89060"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a></td></tr>
<tr class="separator:a877f625eaefc4a2a28c6ac7001c89060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50c0294e6845feaa8082d5f213c3b9b5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a></td></tr>
<tr class="separator:a50c0294e6845feaa8082d5f213c3b9b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c3b82612911af2afd5dfcbb4bdb3944"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0c3b82612911af2afd5dfcbb4bdb3944">ve0</a></td></tr>
<tr class="separator:a0c3b82612911af2afd5dfcbb4bdb3944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa58454dbf57fea70b7a84689ca0af4ab"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa58454dbf57fea70b7a84689ca0af4ab">we0</a></td></tr>
<tr class="separator:aa58454dbf57fea70b7a84689ca0af4ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a76656afeb6d85f3d75e7c0287ffa84"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a></td></tr>
<tr class="separator:a8a76656afeb6d85f3d75e7c0287ffa84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab06147cd3a362deaa144d6b077f23146"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a></td></tr>
<tr class="separator:ab06147cd3a362deaa144d6b077f23146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac2a4ca79acb7297ddfe0b152cc546bd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a></td></tr>
<tr class="separator:aac2a4ca79acb7297ddfe0b152cc546bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af52fe04e26da970a36638062f93adc10"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a></td></tr>
<tr class="separator:af52fe04e26da970a36638062f93adc10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8ba4df7252b5aab6ba31fe8e2b9be39"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a></td></tr>
<tr class="separator:ab8ba4df7252b5aab6ba31fe8e2b9be39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30e1eb6027a4a332d41b2ba4e49dc532"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a></td></tr>
<tr class="separator:a30e1eb6027a4a332d41b2ba4e49dc532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacdcc329cbd6c8872dce11171cc3cba3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aacdcc329cbd6c8872dce11171cc3cba3">xStart</a></td></tr>
<tr class="separator:aacdcc329cbd6c8872dce11171cc3cba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4be1f01a0a67c0d5fe8f34e0b8e18811"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4be1f01a0a67c0d5fe8f34e0b8e18811">xEnd</a></td></tr>
<tr class="separator:a4be1f01a0a67c0d5fe8f34e0b8e18811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab45c464c86449a480370d45abb67f9d5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab45c464c86449a480370d45abb67f9d5">yStart</a></td></tr>
<tr class="separator:ab45c464c86449a480370d45abb67f9d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e3b1373798ed5be0887f46f0c1005df"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1e3b1373798ed5be0887f46f0c1005df">yEnd</a></td></tr>
<tr class="separator:a1e3b1373798ed5be0887f46f0c1005df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d2a294a2433a25502655175d25e76d9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a6d2a294a2433a25502655175d25e76d9">zStart</a></td></tr>
<tr class="separator:a6d2a294a2433a25502655175d25e76d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c234c99ff15e0bb32d399812ae56b11"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4c234c99ff15e0bb32d399812ae56b11">zEnd</a></td></tr>
<tr class="separator:a4c234c99ff15e0bb32d399812ae56b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2608a0f00c2dac18a7d73417ca2c591"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a></td></tr>
<tr class="separator:ac2608a0f00c2dac18a7d73417ca2c591"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2cf61ea39a598766fd06829b43c68e8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa2cf61ea39a598766fd06829b43c68e8">dy</a></td></tr>
<tr class="separator:aa2cf61ea39a598766fd06829b43c68e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab804652fd9207fd3a7be632d2da0a2d8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab804652fd9207fd3a7be632d2da0a2d8">dz</a></td></tr>
<tr class="separator:ab804652fd9207fd3a7be632d2da0a2d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afce5b1d4a72afd981e5af2e6db2e11ab"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#afce5b1d4a72afd981e5af2e6db2e11ab">invVOL</a></td></tr>
<tr class="separator:afce5b1d4a72afd981e5af2e6db2e11ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab7ecb259c9728b0d15836e36865540"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a></td></tr>
<tr class="separator:a7ab7ecb259c9728b0d15836e36865540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97a89d811b0dc79cd53690e05fbdabc8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a></td></tr>
<tr class="separator:a97a89d811b0dc79cd53690e05fbdabc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcc5cd4f2a3bb7d91d5a93a230ae76a3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a></td></tr>
<tr class="separator:afcc5cd4f2a3bb7d91d5a93a230ae76a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7afadac85c315f7b6c17382a434e45d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a></td></tr>
<tr class="memdesc:ac7afadac85c315f7b6c17382a434e45d"><td class="mdescLeft">&#160;</td><td class="mdescRight">source center - X direction <br  />
  <a href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">More...</a><br /></td></tr>
<tr class="separator:ac7afadac85c315f7b6c17382a434e45d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b15b350e24f60d5b4418d274231c93"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a></td></tr>
<tr class="memdesc:a71b15b350e24f60d5b4418d274231c93"><td class="mdescLeft">&#160;</td><td class="mdescRight">source center - Y direction <br  />
  <a href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">More...</a><br /></td></tr>
<tr class="separator:a71b15b350e24f60d5b4418d274231c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae9e3a80d6602b3f60e56582d236ee1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a></td></tr>
<tr class="memdesc:a1ae9e3a80d6602b3f60e56582d236ee1"><td class="mdescLeft">&#160;</td><td class="mdescRight">source center - Z direction <br  />
  <a href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">More...</a><br /></td></tr>
<tr class="separator:a1ae9e3a80d6602b3f60e56582d236ee1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5faeefa7eb12e7e655923af87e2c5e7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa5faeefa7eb12e7e655923af87e2c5e7">L_square</a></td></tr>
<tr class="memdesc:aa5faeefa7eb12e7e655923af87e2c5e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Characteristic length.  <a href="../../dd/da6/class_e_mfields3_d.html#aa5faeefa7eb12e7e655923af87e2c5e7">More...</a><br /></td></tr>
<tr class="separator:aa5faeefa7eb12e7e655923af87e2c5e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f9d78fac6902b1ea3eaf5e298874768"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5f9d78fac6902b1ea3eaf5e298874768">PHI</a></td></tr>
<tr class="separator:a5f9d78fac6902b1ea3eaf5e298874768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0fc1cbc7e72163ee2b3ae1080dec3f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac0fc1cbc7e72163ee2b3ae1080dec3f5">PSI</a></td></tr>
<tr class="separator:ac0fc1cbc7e72163ee2b3ae1080dec3f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae496f72e75874cca69d7ec4c9b62671b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_pfloat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae496f72e75874cca69d7ec4c9b62671b">fieldForPcls</a></td></tr>
<tr class="separator:ae496f72e75874cca69d7ec4c9b62671b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd63e0151d659e21a59a35cf825fc9d5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#afd63e0151d659e21a59a35cf825fc9d5">Ex</a></td></tr>
<tr class="separator:afd63e0151d659e21a59a35cf825fc9d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade5d6e4d6e39f587a722cf9bdc4b5473"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ade5d6e4d6e39f587a722cf9bdc4b5473">Ey</a></td></tr>
<tr class="separator:ade5d6e4d6e39f587a722cf9bdc4b5473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab286b223f9798e3935a314f3697eebbd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab286b223f9798e3935a314f3697eebbd">Ez</a></td></tr>
<tr class="separator:ab286b223f9798e3935a314f3697eebbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70c0b71b2cf8c3139727ceacbaca8a0e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a70c0b71b2cf8c3139727ceacbaca8a0e">Exth</a></td></tr>
<tr class="separator:a70c0b71b2cf8c3139727ceacbaca8a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88c301536e8e7877fcaf0a30eaec5308"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a88c301536e8e7877fcaf0a30eaec5308">Eyth</a></td></tr>
<tr class="separator:a88c301536e8e7877fcaf0a30eaec5308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099cb2cd52e7204920325895f775fc6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a099cb2cd52e7204920325895f775fc6f">Ezth</a></td></tr>
<tr class="separator:a099cb2cd52e7204920325895f775fc6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acefa72dca852d024eb22a812186e4021"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#acefa72dca852d024eb22a812186e4021">Bxc</a></td></tr>
<tr class="separator:acefa72dca852d024eb22a812186e4021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0928f46a5a88a862d6ade6213e087632"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0928f46a5a88a862d6ade6213e087632">Byc</a></td></tr>
<tr class="separator:a0928f46a5a88a862d6ade6213e087632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e24e77203fb4f63ba12831cb058878"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad6e24e77203fb4f63ba12831cb058878">Bzc</a></td></tr>
<tr class="separator:ad6e24e77203fb4f63ba12831cb058878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a55c9ba9503567e9f91fd558bd667ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1a55c9ba9503567e9f91fd558bd667ec">Bxn</a></td></tr>
<tr class="separator:a1a55c9ba9503567e9f91fd558bd667ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c3ac370a311675e572d1fdac8f39ccf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0c3ac370a311675e572d1fdac8f39ccf">Byn</a></td></tr>
<tr class="separator:a0c3ac370a311675e572d1fdac8f39ccf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a061036230f014c40e4e87a20c79ecb3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a061036230f014c40e4e87a20c79ecb3a">Bzn</a></td></tr>
<tr class="separator:a061036230f014c40e4e87a20c79ecb3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb425fcde45789639ababbe2d847d059"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a></td></tr>
<tr class="separator:acb425fcde45789639ababbe2d847d059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa518d56183e2ae1745c261faafe0df67"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa518d56183e2ae1745c261faafe0df67">tempYC</a></td></tr>
<tr class="separator:aa518d56183e2ae1745c261faafe0df67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae84cee0738f6f6956e1e133817b8f08b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae84cee0738f6f6956e1e133817b8f08b">tempZC</a></td></tr>
<tr class="separator:ae84cee0738f6f6956e1e133817b8f08b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82fb8d93d134e0f26674c20872a7dc69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a82fb8d93d134e0f26674c20872a7dc69">tempXN</a></td></tr>
<tr class="separator:a82fb8d93d134e0f26674c20872a7dc69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a394fda928d6328882708e6311fa9eab3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a394fda928d6328882708e6311fa9eab3">tempYN</a></td></tr>
<tr class="separator:a394fda928d6328882708e6311fa9eab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42584d8f31a1a741f9a3cbf535a8da5b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a42584d8f31a1a741f9a3cbf535a8da5b">tempZN</a></td></tr>
<tr class="separator:a42584d8f31a1a741f9a3cbf535a8da5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46c3082575146e5975baaa9177284892"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a46c3082575146e5975baaa9177284892">tempC</a></td></tr>
<tr class="separator:a46c3082575146e5975baaa9177284892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a645c6e812ccf50fd2a726dd8842c95f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a645c6e812ccf50fd2a726dd8842c95f2">tempX</a></td></tr>
<tr class="separator:a645c6e812ccf50fd2a726dd8842c95f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c334155ed3610497a57e787e257b83e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5c334155ed3610497a57e787e257b83e">tempY</a></td></tr>
<tr class="separator:a5c334155ed3610497a57e787e257b83e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ee4c30e3ad0573d3d8f39623818dbc0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a3ee4c30e3ad0573d3d8f39623818dbc0">tempZ</a></td></tr>
<tr class="separator:a3ee4c30e3ad0573d3d8f39623818dbc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af082763b2a0d22c827ced87a9e5bf395"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af082763b2a0d22c827ced87a9e5bf395">temp2X</a></td></tr>
<tr class="separator:af082763b2a0d22c827ced87a9e5bf395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba287d0311059a43d392a65385d77747"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aba287d0311059a43d392a65385d77747">temp2Y</a></td></tr>
<tr class="separator:aba287d0311059a43d392a65385d77747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2457ebe192a259223b0e70fa9e5d8594"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2457ebe192a259223b0e70fa9e5d8594">temp2Z</a></td></tr>
<tr class="separator:a2457ebe192a259223b0e70fa9e5d8594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf7aa492bfe607643d07aad8323c08e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a></td></tr>
<tr class="separator:aaf7aa492bfe607643d07aad8323c08e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a021010fc1f85523aa15d279ec6cd21db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a021010fc1f85523aa15d279ec6cd21db">imageY</a></td></tr>
<tr class="separator:a021010fc1f85523aa15d279ec6cd21db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2cc4a3e3626bee386a5b5c2adbd2986"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ad2cc4a3e3626bee386a5b5c2adbd2986">imageZ</a></td></tr>
<tr class="separator:ad2cc4a3e3626bee386a5b5c2adbd2986"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d4e9e3efd3d4f9ac32df44e4c77ab7d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7d4e9e3efd3d4f9ac32df44e4c77ab7d">Dx</a></td></tr>
<tr class="separator:a7d4e9e3efd3d4f9ac32df44e4c77ab7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79c0c4f8abe2e2fd949dac7db78546d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a79c0c4f8abe2e2fd949dac7db78546d3">Dy</a></td></tr>
<tr class="separator:a79c0c4f8abe2e2fd949dac7db78546d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7c7814c7f4b04578d1ddb8d82e2cca5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab7c7814c7f4b04578d1ddb8d82e2cca5">Dz</a></td></tr>
<tr class="separator:ab7c7814c7f4b04578d1ddb8d82e2cca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a881313452b211989b697547147184f18"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a881313452b211989b697547147184f18">vectX</a></td></tr>
<tr class="separator:a881313452b211989b697547147184f18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4979519296d9a82bca93d64c788a1fe2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4979519296d9a82bca93d64c788a1fe2">vectY</a></td></tr>
<tr class="separator:a4979519296d9a82bca93d64c788a1fe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadad15331f488a86b47b8ff4f49370d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aadad15331f488a86b47b8ff4f49370d3">vectZ</a></td></tr>
<tr class="separator:aadad15331f488a86b47b8ff4f49370d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb857044d87a71286870a2b6c35975ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#abb857044d87a71286870a2b6c35975ee">divC</a></td></tr>
<tr class="separator:abb857044d87a71286870a2b6c35975ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebbab41c0fe44f7001cf5961fa8c1764"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aebbab41c0fe44f7001cf5961fa8c1764">Lambda</a></td></tr>
<tr class="separator:aebbab41c0fe44f7001cf5961fa8c1764"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87a23720e5f4aa33878292413f244855"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a87a23720e5f4aa33878292413f244855">sizeMomentsArray</a></td></tr>
<tr class="separator:a87a23720e5f4aa33878292413f244855"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2be54a1cb832cdffa4cbf8548d18d882"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d1/d1c/class_moments10.html">Moments10</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2be54a1cb832cdffa4cbf8548d18d882">moments10Array</a></td></tr>
<tr class="separator:a2be54a1cb832cdffa4cbf8548d18d882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac592e12b7cc8428fecb8219e9ebe050d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac592e12b7cc8428fecb8219e9ebe050d">rhoc</a></td></tr>
<tr class="separator:ac592e12b7cc8428fecb8219e9ebe050d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac154c0bebb127df531138a846cfde8e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac154c0bebb127df531138a846cfde8e3">rhon</a></td></tr>
<tr class="separator:ac154c0bebb127df531138a846cfde8e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d562d551ea0f165362c5679bbba07b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a43d562d551ea0f165362c5679bbba07b">rhoh</a></td></tr>
<tr class="separator:a43d562d551ea0f165362c5679bbba07b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e3c3868c15d1829fe30477a940332a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a></td></tr>
<tr class="separator:a9e3c3868c15d1829fe30477a940332a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af73b86e3e2631057b7b1818f6a1dc382"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a></td></tr>
<tr class="separator:af73b86e3e2631057b7b1818f6a1dc382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbaf10505c4eec873ac1718a0585c1d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#acbaf10505c4eec873ac1718a0585c1d3">Jx</a></td></tr>
<tr class="separator:acbaf10505c4eec873ac1718a0585c1d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cffaedf9fe02b903e8a68a65339c0c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1cffaedf9fe02b903e8a68a65339c0c8">Jy</a></td></tr>
<tr class="separator:a1cffaedf9fe02b903e8a68a65339c0c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae2283449ba35676790545748de713fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aae2283449ba35676790545748de713fc">Jz</a></td></tr>
<tr class="separator:aae2283449ba35676790545748de713fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0211859e21c477ffa58ce9e556fd92a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0211859e21c477ffa58ce9e556fd92a4">Jxh</a></td></tr>
<tr class="separator:a0211859e21c477ffa58ce9e556fd92a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a4aed2814ada972dadea02ecefd634a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a9a4aed2814ada972dadea02ecefd634a">Jyh</a></td></tr>
<tr class="separator:a9a4aed2814ada972dadea02ecefd634a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb66b9b92d950932f33693553da86fd3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#abb66b9b92d950932f33693553da86fd3">Jzh</a></td></tr>
<tr class="separator:abb66b9b92d950932f33693553da86fd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f02fd948ce11de9f60c070ab8324964"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4f02fd948ce11de9f60c070ab8324964">Jxs</a></td></tr>
<tr class="separator:a4f02fd948ce11de9f60c070ab8324964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa718386e4263b19798b15f879fd28589"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa718386e4263b19798b15f879fd28589">Jys</a></td></tr>
<tr class="separator:aa718386e4263b19798b15f879fd28589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0496a7a94cf632955eb2d90f1f334cc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae0496a7a94cf632955eb2d90f1f334cc">Jzs</a></td></tr>
<tr class="separator:ae0496a7a94cf632955eb2d90f1f334cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd0b023f271798468fde342098e488b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#afd0b023f271798468fde342098e488b2">Bx_ext</a></td></tr>
<tr class="separator:afd0b023f271798468fde342098e488b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eb9c67179a159337fb7bf9f736c229f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a1eb9c67179a159337fb7bf9f736c229f">By_ext</a></td></tr>
<tr class="separator:a1eb9c67179a159337fb7bf9f736c229f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c8d306eced51da033df750a2d5f0274"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7c8d306eced51da033df750a2d5f0274">Bz_ext</a></td></tr>
<tr class="separator:a7c8d306eced51da033df750a2d5f0274"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa979c854e86a1357b52df8364fe33b06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa979c854e86a1357b52df8364fe33b06">Bx_tot</a></td></tr>
<tr class="separator:aa979c854e86a1357b52df8364fe33b06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e994f77f91842c2e767c5cc50288ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac6e994f77f91842c2e767c5cc50288ad">By_tot</a></td></tr>
<tr class="separator:ac6e994f77f91842c2e767c5cc50288ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc696b6c951889d9778100a70977e68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aafc696b6c951889d9778100a70977e68">Bz_tot</a></td></tr>
<tr class="separator:aafc696b6c951889d9778100a70977e68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70991244373bdb4b27a3887e3b09c59f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a70991244373bdb4b27a3887e3b09c59f">Jx_ext</a></td></tr>
<tr class="separator:a70991244373bdb4b27a3887e3b09c59f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4a0aaf59e4e2ed85cad5df8476acf6a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac4a0aaf59e4e2ed85cad5df8476acf6a">Jy_ext</a></td></tr>
<tr class="separator:ac4a0aaf59e4e2ed85cad5df8476acf6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fc4b2d97e86e8eec6f2a39e1091874a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0fc4b2d97e86e8eec6f2a39e1091874a">Jz_ext</a></td></tr>
<tr class="separator:a0fc4b2d97e86e8eec6f2a39e1091874a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe08ec9affab670a5d0a0c4b06442fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#acbe08ec9affab670a5d0a0c4b06442fe">pXXsn</a></td></tr>
<tr class="separator:acbe08ec9affab670a5d0a0c4b06442fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9551afe01ebc9fa71ce7122f68356105"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a9551afe01ebc9fa71ce7122f68356105">pXYsn</a></td></tr>
<tr class="separator:a9551afe01ebc9fa71ce7122f68356105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a77bde4a1cd6b33b8975a5328c5ea96"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7a77bde4a1cd6b33b8975a5328c5ea96">pXZsn</a></td></tr>
<tr class="separator:a7a77bde4a1cd6b33b8975a5328c5ea96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09afc47efcaa331b958b72197d3693df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a09afc47efcaa331b958b72197d3693df">pYYsn</a></td></tr>
<tr class="separator:a09afc47efcaa331b958b72197d3693df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacd0d6595ed0e8acd2386b13b256db27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aacd0d6595ed0e8acd2386b13b256db27">pYZsn</a></td></tr>
<tr class="separator:aacd0d6595ed0e8acd2386b13b256db27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c4bd7c7fb5cf5b27e00ef320b0e563b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a4c4bd7c7fb5cf5b27e00ef320b0e563b">pZZsn</a></td></tr>
<tr class="separator:a4c4bd7c7fb5cf5b27e00ef320b0e563b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a12fc7eab8c39c85f8ff5be174a3c5d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7a12fc7eab8c39c85f8ff5be174a3c5d">bcPHIfaceXright</a></td></tr>
<tr class="separator:a7a12fc7eab8c39c85f8ff5be174a3c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b775cbee88cf6f0e7c3b307bcb989e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a8b775cbee88cf6f0e7c3b307bcb989e7">bcPHIfaceXleft</a></td></tr>
<tr class="separator:a8b775cbee88cf6f0e7c3b307bcb989e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a2c28d27af1b80331b95a4c2e31f909"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2a2c28d27af1b80331b95a4c2e31f909">bcPHIfaceYright</a></td></tr>
<tr class="separator:a2a2c28d27af1b80331b95a4c2e31f909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb603b99e5bca9f652183fcd6adda1d5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#afb603b99e5bca9f652183fcd6adda1d5">bcPHIfaceYleft</a></td></tr>
<tr class="separator:afb603b99e5bca9f652183fcd6adda1d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64d764d3f2ca980eee960633193c01b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a64d764d3f2ca980eee960633193c01b1">bcPHIfaceZright</a></td></tr>
<tr class="separator:a64d764d3f2ca980eee960633193c01b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5412777977eae74dc1c8b53b54f369ef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5412777977eae74dc1c8b53b54f369ef">bcPHIfaceZleft</a></td></tr>
<tr class="separator:a5412777977eae74dc1c8b53b54f369ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d090b86a16ede7b0b8d4abec332e5b9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7d090b86a16ede7b0b8d4abec332e5b9">bcEMfaceXright</a></td></tr>
<tr class="separator:a7d090b86a16ede7b0b8d4abec332e5b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa41901bd607e777ca21c96d34137f8b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#afa41901bd607e777ca21c96d34137f8b">bcEMfaceXleft</a></td></tr>
<tr class="separator:afa41901bd607e777ca21c96d34137f8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5956ed9cca9f548f259e3f34902df57e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a5956ed9cca9f548f259e3f34902df57e">bcEMfaceYright</a></td></tr>
<tr class="separator:a5956ed9cca9f548f259e3f34902df57e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a198a12992bc9ea991dade4ddd1dce304"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a198a12992bc9ea991dade4ddd1dce304">bcEMfaceYleft</a></td></tr>
<tr class="separator:a198a12992bc9ea991dade4ddd1dce304"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0fa41eace26cd5faff4d261906f86bb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab0fa41eace26cd5faff4d261906f86bb">bcEMfaceZright</a></td></tr>
<tr class="separator:ab0fa41eace26cd5faff4d261906f86bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f05ef08972c7acbf60006f86a835567"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a3f05ef08972c7acbf60006f86a835567">bcEMfaceZleft</a></td></tr>
<tr class="separator:a3f05ef08972c7acbf60006f86a835567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac13eea1faaf959ca92ff84ad03b0ce79"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a></td></tr>
<tr class="separator:ac13eea1faaf959ca92ff84ad03b0ce79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac15b1931f27db3db0d53de63848dc78a"><td class="memItemLeft" align="right" valign="top">bool *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a></td></tr>
<tr class="separator:ac15b1931f27db3db0d53de63848dc78a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ea9ae681b78a8067d4a753a486fa2fc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a8ea9ae681b78a8067d4a753a486fa2fc">PoissonCorrection</a></td></tr>
<tr class="separator:a8ea9ae681b78a8067d4a753a486fa2fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8a056e1f1b07efda595f2ea15cc4a9c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ab8a056e1f1b07efda595f2ea15cc4a9c">PoissonCorrectionCycle</a></td></tr>
<tr class="separator:ab8a056e1f1b07efda595f2ea15cc4a9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57cb50aa343b780dc7e2d4f9695af5e6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a></td></tr>
<tr class="separator:a57cb50aa343b780dc7e2d4f9695af5e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a578657d9f806d7d414c816fd81f5f93c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a578657d9f806d7d414c816fd81f5f93c">CGtol</a></td></tr>
<tr class="separator:a578657d9f806d7d414c816fd81f5f93c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18f9fef7aa44de67fa3f9742d3bb8c0d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a18f9fef7aa44de67fa3f9742d3bb8c0d">GMREStol</a></td></tr>
<tr class="separator:a18f9fef7aa44de67fa3f9742d3bb8c0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac14e00cd6c8da242bd2f31fb01672b81"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ac14e00cd6c8da242bd2f31fb01672b81">yzFacetypeC</a></td></tr>
<tr class="separator:ac14e00cd6c8da242bd2f31fb01672b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa83b1187f9e7c4370d02e10789bf306"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aaa83b1187f9e7c4370d02e10789bf306">xzFacetypeC</a></td></tr>
<tr class="separator:aaa83b1187f9e7c4370d02e10789bf306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a78928157783731b2b1589117554fe"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa1a78928157783731b2b1589117554fe">xyFacetypeC</a></td></tr>
<tr class="separator:aa1a78928157783731b2b1589117554fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91b8bc43a6fa26ce64a8673cd87509c2"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a91b8bc43a6fa26ce64a8673cd87509c2">xEdgetypeC</a></td></tr>
<tr class="separator:a91b8bc43a6fa26ce64a8673cd87509c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2affd9bbd5dbf49c442ea5e7cce5fdfe"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2affd9bbd5dbf49c442ea5e7cce5fdfe">yEdgetypeC</a></td></tr>
<tr class="separator:a2affd9bbd5dbf49c442ea5e7cce5fdfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd274a9002092788baa13e95270808e"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0bd274a9002092788baa13e95270808e">zEdgetypeC</a></td></tr>
<tr class="separator:a0bd274a9002092788baa13e95270808e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a7c038b37a7f8b3d642301c1264888c"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a3a7c038b37a7f8b3d642301c1264888c">xEdgetypeC2</a></td></tr>
<tr class="separator:a3a7c038b37a7f8b3d642301c1264888c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ac8439f8848b13213de3a7d9d319970"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a9ac8439f8848b13213de3a7d9d319970">yEdgetypeC2</a></td></tr>
<tr class="separator:a9ac8439f8848b13213de3a7d9d319970"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98c88b3043eb29bd32d2c9d75c3284c7"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a98c88b3043eb29bd32d2c9d75c3284c7">zEdgetypeC2</a></td></tr>
<tr class="separator:a98c88b3043eb29bd32d2c9d75c3284c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e789a151f7c232b36ba6076c1076a9"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae6e789a151f7c232b36ba6076c1076a9">cornertypeC</a></td></tr>
<tr class="separator:ae6e789a151f7c232b36ba6076c1076a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaac03fd8757278c0387656a2b00df0a"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#adaac03fd8757278c0387656a2b00df0a">yzFacetypeN</a></td></tr>
<tr class="separator:adaac03fd8757278c0387656a2b00df0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8e7e0f4d2555d34dcdfa85f63e79c7f"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa8e7e0f4d2555d34dcdfa85f63e79c7f">xzFacetypeN</a></td></tr>
<tr class="separator:aa8e7e0f4d2555d34dcdfa85f63e79c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a728b86d713b1afd89102ffdc84d84df2"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a728b86d713b1afd89102ffdc84d84df2">xyFacetypeN</a></td></tr>
<tr class="separator:a728b86d713b1afd89102ffdc84d84df2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7459151b378f338749302fd284baa1e0"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a7459151b378f338749302fd284baa1e0">xEdgetypeN</a></td></tr>
<tr class="separator:a7459151b378f338749302fd284baa1e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb3dc5be7043358fec0cdb8a686a574"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a2cb3dc5be7043358fec0cdb8a686a574">yEdgetypeN</a></td></tr>
<tr class="separator:a2cb3dc5be7043358fec0cdb8a686a574"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae13e0fdd7aa96b15ec45c8cb670f8065"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#ae13e0fdd7aa96b15ec45c8cb670f8065">zEdgetypeN</a></td></tr>
<tr class="separator:ae13e0fdd7aa96b15ec45c8cb670f8065"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa044964a0fef9d1c24fff7c7198bd27"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aaa044964a0fef9d1c24fff7c7198bd27">xEdgetypeN2</a></td></tr>
<tr class="separator:aaa044964a0fef9d1c24fff7c7198bd27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eb97bb1ead4a9856ea4d5e2d364a818"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0eb97bb1ead4a9856ea4d5e2d364a818">yEdgetypeN2</a></td></tr>
<tr class="separator:a0eb97bb1ead4a9856ea4d5e2d364a818"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0583c828b78a6546a64505b671ad7aab"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a0583c828b78a6546a64505b671ad7aab">zEdgetypeN2</a></td></tr>
<tr class="separator:a0583c828b78a6546a64505b671ad7aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c44fca82af3482ed57a4962ac86d77"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a17c44fca82af3482ed57a4962ac86d77">cornertypeN</a></td></tr>
<tr class="separator:a17c44fca82af3482ed57a4962ac86d77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa81688dd7301d04e351ea83e207b94b9"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#aa81688dd7301d04e351ea83e207b94b9">procviewXYZ</a></td></tr>
<tr class="separator:aa81688dd7301d04e351ea83e207b94b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a654edefc1d71678e9947cc74ddce6240"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a654edefc1d71678e9947cc74ddce6240">xyzcomp</a></td></tr>
<tr class="separator:a654edefc1d71678e9947cc74ddce6240"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a474f702e439f1fc0ec38990ae2fb7158"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a474f702e439f1fc0ec38990ae2fb7158">procview</a></td></tr>
<tr class="separator:a474f702e439f1fc0ec38990ae2fb7158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a622e08ba22217c79136661f97cdd31e0"><td class="memItemLeft" align="right" valign="top">MPI_Datatype&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a622e08ba22217c79136661f97cdd31e0">ghosttype</a></td></tr>
<tr class="separator:a622e08ba22217c79136661f97cdd31e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a189435c9228ac2142754edd79d550bab"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/da6/class_e_mfields3_d.html#a189435c9228ac2142754edd79d550bab">lEndFlag</a></td></tr>
<tr class="separator:a189435c9228ac2142754edd79d550bab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00039">39</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aa70c95fc547dd9eaf8b6929cfb9f0073" name="aa70c95fc547dd9eaf8b6929cfb9f0073"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa70c95fc547dd9eaf8b6929cfb9f0073">&#9670;&nbsp;</a></span>EMfields3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EMfields3D::EMfields3D </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../db/dfb/class_collective.html">Collective</a> *&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *&#160;</td>
          <td class="paramname"><em>vct</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >constructor </p>
<p >parameters for GEM challenge</p>
<p >Restart</p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">61</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>                                                                            : </div>
<div class="line"><span class="lineno">   62</span>  _col(*col),</div>
<div class="line"><span class="lineno">   63</span>  _grid(*grid),</div>
<div class="line"><span class="lineno">   64</span>  _vct(*vct),</div>
<div class="line"><span class="lineno">   65</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>(grid-&gt;getNXC()),</div>
<div class="line"><span class="lineno">   66</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>(grid-&gt;getNXN()),</div>
<div class="line"><span class="lineno">   67</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>(grid-&gt;getNYC()),</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>(grid-&gt;getNYN()),</div>
<div class="line"><span class="lineno">   69</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>(grid-&gt;getNZC()),</div>
<div class="line"><span class="lineno">   70</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>(grid-&gt;getNZN()),</div>
<div class="line"><span class="lineno">   71</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>(grid-&gt;getDX()),</div>
<div class="line"><span class="lineno">   72</span>  dy(grid-&gt;getDY()),</div>
<div class="line"><span class="lineno">   73</span>  dz(grid-&gt;getDZ()),</div>
<div class="line"><span class="lineno">   74</span>  invVOL(grid-&gt;getInvVOL()),</div>
<div class="line"><span class="lineno">   75</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aacdcc329cbd6c8872dce11171cc3cba3">xStart</a>(grid-&gt;getXstart()),</div>
<div class="line"><span class="lineno">   76</span>  xEnd(grid-&gt;getXend()),</div>
<div class="line"><span class="lineno">   77</span>  yStart(grid-&gt;getYstart()),</div>
<div class="line"><span class="lineno">   78</span>  yEnd(grid-&gt;getYend()),</div>
<div class="line"><span class="lineno">   79</span>  zStart(grid-&gt;getZstart()),</div>
<div class="line"><span class="lineno">   80</span>  zEnd(grid-&gt;getZend()),</div>
<div class="line"><span class="lineno">   81</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>(col-&gt;getLx()),</div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>(col-&gt;getLy()),</div>
<div class="line"><span class="lineno">   83</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>(col-&gt;getLz()),</div>
<div class="line"><span class="lineno">   84</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>(col-&gt;getNs()),</div>
<div class="line"><span class="lineno">   85</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>(col-&gt;getC()),</div>
<div class="line"><span class="lineno">   86</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>(col-&gt;getDt()),</div>
<div class="line"><span class="lineno">   87</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>(col-&gt;getTh()),</div>
<div class="line"><span class="lineno">   88</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a>(col-&gt;getU0(0)),</div>
<div class="line"><span class="lineno">   89</span>  ve0(col-&gt;getV0(0)),</div>
<div class="line"><span class="lineno">   90</span>  we0(col-&gt;getW0(0)),</div>
<div class="line"><span class="lineno">   91</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>(col-&gt;getx_center()),</div>
<div class="line"><span class="lineno">   92</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a>(col-&gt;gety_center()),</div>
<div class="line"><span class="lineno">   93</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>(col-&gt;getz_center()),</div>
<div class="line"><span class="lineno">   94</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aa5faeefa7eb12e7e655923af87e2c5e7">L_square</a>(col-&gt;getL_square()),</div>
<div class="line"><span class="lineno">   95</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>), <span class="comment">// declared after these</span></div>
<div class="line"><span class="lineno">   96</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">   97</span>  <span class="comment">// array allocation: nodes</span></div>
<div class="line"><span class="lineno">   98</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">   99</span>  fieldForPcls  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, 2*DFIELD_3or4),</div>
<div class="line"><span class="lineno">  100</span>  Ex   (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  101</span>  Ey   (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  102</span>  Ez   (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  103</span>  Exth (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  104</span>  Eyth (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  105</span>  Ezth (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  106</span>  Bxn  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  107</span>  Byn  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  108</span>  Bzn  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  109</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac154c0bebb127df531138a846cfde8e3">rhon</a> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  110</span>  Jx   (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  111</span>  Jy   (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  112</span>  Jz   (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  113</span>  Jxh  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  114</span>  Jyh  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  115</span>  Jzh  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  116</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  117</span>  <span class="comment">// species-specific quantities</span></div>
<div class="line"><span class="lineno">  118</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  119</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  120</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  121</span>  Jxs   (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  122</span>  Jys   (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  123</span>  Jzs   (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  124</span>  pXXsn (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  125</span>  pXYsn (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  126</span>  pXZsn (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  127</span>  pYYsn (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  128</span>  pYZsn (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  129</span>  pZZsn (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <span class="comment">// array allocation: central points </span></div>
<div class="line"><span class="lineno">  132</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  133</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac0fc1cbc7e72163ee2b3ae1080dec3f5">PSI</a>  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  134</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a5f9d78fac6902b1ea3eaf5e298874768">PHI</a>  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  135</span>  Bxc  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  136</span>  Byc  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  137</span>  Bzc  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  138</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac592e12b7cc8428fecb8219e9ebe050d">rhoc</a> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  139</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a43d562d551ea0f165362c5679bbba07b">rhoh</a> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  <span class="comment">// temporary arrays</span></div>
<div class="line"><span class="lineno">  142</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  143</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  144</span>  tempYC (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  145</span>  tempZC (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  146</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  147</span>  tempXN (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  148</span>  tempYN (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  149</span>  tempZN (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  150</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a46c3082575146e5975baaa9177284892">tempC</a>  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  151</span>  tempX  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  152</span>  tempY  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  153</span>  tempZ  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  154</span>  temp2X (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  155</span>  temp2Y (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  156</span>  temp2Z (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  157</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  158</span>  imageY (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  159</span>  imageZ (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  160</span>  Dx (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  161</span>  Dy (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  162</span>  Dz (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  163</span>  vectX (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  164</span>  vectY (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  165</span>  vectZ (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  166</span>  divC  (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>),</div>
<div class="line"><span class="lineno">  167</span>  Lambda (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  168</span>  <span class="comment">//arr (nxc-2,nyc-2,nzc-2),</span></div>
<div class="line"><span class="lineno">  169</span>  <span class="comment">// B_ext and J_ext should not be allocated unless used.</span></div>
<div class="line"><span class="lineno">  170</span>  Bx_ext(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  171</span>  By_ext(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  172</span>  Bz_ext(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  173</span>  Bx_tot(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  174</span>  By_tot(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  175</span>  Bz_tot(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  176</span>  Jx_ext(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  177</span>  Jy_ext(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>),</div>
<div class="line"><span class="lineno">  178</span>  Jz_ext(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>) </div>
<div class="line"><span class="lineno">  179</span>{</div>
<div class="line"><span class="lineno">  180</span>  <span class="comment">// External imposed fields</span></div>
<div class="line"><span class="lineno">  181</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  182</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a42158c86c46e0ee3ce618cfe52d63b31">B1x</a> = col-&gt;getB1x();</div>
<div class="line"><span class="lineno">  183</span>  B1y = col-&gt;getB1y();</div>
<div class="line"><span class="lineno">  184</span>  B1z = col-&gt;getB1z();</div>
<div class="line"><span class="lineno">  185</span>  <span class="comment">// read Dipole Offset from input </span></div>
<div class="line"><span class="lineno">  186</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  187</span>  PlanetOffset = col-&gt;getPlanetOffset();</div>
<div class="line"><span class="lineno">  188</span>  <span class="comment">//if(B1x!=0. || B1y !=0. || B1z!=0.)</span></div>
<div class="line"><span class="lineno">  189</span>  <span class="comment">//{</span></div>
<div class="line"><span class="lineno">  190</span>  <span class="comment">//  eprintf(&quot;This functionality has not yet been implemented&quot;);</span></div>
<div class="line"><span class="lineno">  191</span>  <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  192</span>  Bx_ext.setall(0.);</div>
<div class="line"><span class="lineno">  193</span>  By_ext.setall(0.);</div>
<div class="line"><span class="lineno">  194</span>  Bz_ext.setall(0.);</div>
<div class="line"><span class="lineno">  195</span>  Bx_tot.setall(0.);</div>
<div class="line"><span class="lineno">  196</span>  By_tot.setall(0.);</div>
<div class="line"><span class="lineno">  197</span>  Bz_tot.setall(0.);</div>
<div class="line"><span class="lineno">  198</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  199</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8ea9ae681b78a8067d4a753a486fa2fc">PoissonCorrection</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  200</span>  <span class="keywordflow">if</span> (col-&gt;getPoissonCorrection()==<span class="stringliteral">&quot;yes&quot;</span>){</div>
<div class="line"><span class="lineno">  201</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8ea9ae681b78a8067d4a753a486fa2fc">PoissonCorrection</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  202</span>          PoissonCorrectionCycle = col-&gt;getPoissonCorrectionCycle();</div>
<div class="line"><span class="lineno">  203</span>  }</div>
<div class="line"><span class="lineno">  204</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a578657d9f806d7d414c816fd81f5f93c">CGtol</a> = col-&gt;getCGtol();</div>
<div class="line"><span class="lineno">  205</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a18f9fef7aa44de67fa3f9742d3bb8c0d">GMREStol</a> = col-&gt;getGMREStol();</div>
<div class="line"><span class="lineno">  206</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>];</div>
<div class="line"><span class="lineno">  207</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++)</div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[i] = col-&gt;getQOM(i);</div>
<div class="line"><span class="lineno">  209</span>  <span class="comment">// boundary conditions: PHI and EM fields</span></div>
<div class="line"><span class="lineno">  210</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7a12fc7eab8c39c85f8ff5be174a3c5d">bcPHIfaceXright</a> = col-&gt;getBcPHIfaceXright();</div>
<div class="line"><span class="lineno">  211</span>  bcPHIfaceXleft  = col-&gt;getBcPHIfaceXleft();</div>
<div class="line"><span class="lineno">  212</span>  bcPHIfaceYright = col-&gt;getBcPHIfaceYright();</div>
<div class="line"><span class="lineno">  213</span>  bcPHIfaceYleft  = col-&gt;getBcPHIfaceYleft();</div>
<div class="line"><span class="lineno">  214</span>  bcPHIfaceZright = col-&gt;getBcPHIfaceZright();</div>
<div class="line"><span class="lineno">  215</span>  bcPHIfaceZleft  = col-&gt;getBcPHIfaceZleft();</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7d090b86a16ede7b0b8d4abec332e5b9">bcEMfaceXright</a> = col-&gt;getBcEMfaceXright();</div>
<div class="line"><span class="lineno">  218</span>  bcEMfaceXleft = col-&gt;getBcEMfaceXleft();</div>
<div class="line"><span class="lineno">  219</span>  bcEMfaceYright = col-&gt;getBcEMfaceYright();</div>
<div class="line"><span class="lineno">  220</span>  bcEMfaceYleft = col-&gt;getBcEMfaceYleft();</div>
<div class="line"><span class="lineno">  221</span>  bcEMfaceZright = col-&gt;getBcEMfaceZright();</div>
<div class="line"><span class="lineno">  222</span>  bcEMfaceZleft = col-&gt;getBcEMfaceZleft();</div>
<div class="line"><span class="lineno">  223</span>  <span class="comment">// GEM challenge parameters</span></div>
<div class="line"><span class="lineno">  224</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> = col-&gt;getB0x();</div>
<div class="line"><span class="lineno">  225</span>  B0y = col-&gt;getB0y();</div>
<div class="line"><span class="lineno">  226</span>  B0z = col-&gt;getB0z();</div>
<div class="line"><span class="lineno">  227</span>  delta = col-&gt;getDelta();</div>
<div class="line"><span class="lineno">  228</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a> = col-&gt;getSmooth();</div>
<div class="line"><span class="lineno">  229</span>  SmoothNiter = col-&gt;getSmoothNiter();</div>
<div class="line"><span class="lineno">  230</span>  <span class="comment">// get the density background for the gem Challange</span></div>
<div class="line"><span class="lineno">  231</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>];</div>
<div class="line"><span class="lineno">  232</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a> = <span class="keyword">new</span> <span class="keywordtype">bool</span>[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>];</div>
<div class="line"><span class="lineno">  233</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++) {</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i] = col-&gt;getRHOinit(i);</div>
<div class="line"><span class="lineno">  235</span>    <span class="keywordflow">if</span> ((fabs(col-&gt;getW0(i)) != 0) || (fabs(col-&gt;getU0(i)) != 0)) <span class="comment">// GEM and LHDI</span></div>
<div class="line"><span class="lineno">  236</span>      <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[i] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  237</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  238</span>      <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[i] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  239</span>  }<span class="comment"></span></div>
<div class="line"><span class="lineno">  240</span><span class="comment">  /*! parameters for GEM challenge */</span></div>
<div class="line"><span class="lineno">  241</span>  FourPI = 16 * atan(1.0);<span class="comment"></span></div>
<div class="line"><span class="lineno">  242</span><span class="comment">  /*! Restart */</span></div>
<div class="line"><span class="lineno">  243</span>  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> = col-&gt;getRestart_status();</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>  <span class="keywordflow">if</span>(Parameters::get_VECTORIZE_MOMENTS())</div>
<div class="line"><span class="lineno">  246</span>  {</div>
<div class="line"><span class="lineno">  247</span>    <span class="comment">// In this case particles are sorted</span></div>
<div class="line"><span class="lineno">  248</span>    <span class="comment">// and there is no need for each thread</span></div>
<div class="line"><span class="lineno">  249</span>    <span class="comment">// to sum moments in a separate array.</span></div>
<div class="line"><span class="lineno">  250</span>    sizeMomentsArray = 1;</div>
<div class="line"><span class="lineno">  251</span>  }</div>
<div class="line"><span class="lineno">  252</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  253</span>  {</div>
<div class="line"><span class="lineno">  254</span>    sizeMomentsArray = omp_get_max_threads();</div>
<div class="line"><span class="lineno">  255</span>  }</div>
<div class="line"><span class="lineno">  256</span>  moments10Array = <span class="keyword">new</span> <a class="code hl_class" href="../../d1/d1c/class_moments10.html">Moments10</a>*[sizeMomentsArray];</div>
<div class="line"><span class="lineno">  257</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;sizeMomentsArray;i++)</div>
<div class="line"><span class="lineno">  258</span>  {</div>
<div class="line"><span class="lineno">  259</span>    moments10Array[i] = <span class="keyword">new</span> <a class="code hl_class" href="../../d1/d1c/class_moments10.html">Moments10</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno">  260</span>  }</div>
<div class="line"><span class="lineno">  261</span>    </div>
<div class="line"><span class="lineno">  262</span>    </div>
<div class="line"><span class="lineno">  263</span>    </div>
<div class="line"><span class="lineno">  264</span>    <span class="comment">//Define MPI Derived Data types for Center Halo Exchange</span></div>
<div class="line"><span class="lineno">  265</span>    <span class="comment">//For face exchange on X dir</span></div>
<div class="line"><span class="lineno">  266</span>    MPI_Type_vector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>-2),(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-2),<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, MPI_DOUBLE, &amp;yzFacetypeC);</div>
<div class="line"><span class="lineno">  267</span>    MPI_Type_commit(&amp;yzFacetypeC);</div>
<div class="line"><span class="lineno">  268</span>    </div>
<div class="line"><span class="lineno">  269</span>    <span class="comment">//For face exchange on Y dir</span></div>
<div class="line"><span class="lineno">  270</span>    MPI_Type_create_hvector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>-2),(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-2),(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)), MPI_DOUBLE, &amp;xzFacetypeC);</div>
<div class="line"><span class="lineno">  271</span>    MPI_Type_commit(&amp;xzFacetypeC);</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>    MPI_Type_vector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>-2), 1, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, MPI_DOUBLE, &amp;yEdgetypeC);</div>
<div class="line"><span class="lineno">  274</span>    MPI_Type_commit(&amp;yEdgetypeC);</div>
<div class="line"><span class="lineno">  275</span>    </div>
<div class="line"><span class="lineno">  276</span>    <span class="comment">//For face exchangeg on Z dir</span></div>
<div class="line"><span class="lineno">  277</span>    MPI_Type_create_hvector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>-2), 1, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)), yEdgetypeC, &amp;xyFacetypeC);</div>
<div class="line"><span class="lineno">  278</span>    MPI_Type_commit(&amp;xyFacetypeC);</div>
<div class="line"><span class="lineno">  279</span>    </div>
<div class="line"><span class="lineno">  280</span>    <span class="comment">//2 yEdgeType can be merged into one message</span></div>
<div class="line"><span class="lineno">  281</span>    MPI_Type_create_hvector(2, 1,(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-1)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), yEdgetypeC, &amp;yEdgetypeC2);</div>
<div class="line"><span class="lineno">  282</span>    MPI_Type_commit(&amp;yEdgetypeC2);</div>
<div class="line"><span class="lineno">  283</span>    </div>
<div class="line"><span class="lineno">  284</span>    MPI_Type_contiguous((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-2),MPI_DOUBLE, &amp;zEdgetypeC);</div>
<div class="line"><span class="lineno">  285</span>    MPI_Type_commit(&amp;zEdgetypeC);</div>
<div class="line"><span class="lineno">  286</span>    </div>
<div class="line"><span class="lineno">  287</span>    MPI_Type_create_hvector(2, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-2),(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>-1)*(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), MPI_DOUBLE, &amp;zEdgetypeC2);</div>
<div class="line"><span class="lineno">  288</span>    MPI_Type_commit(&amp;zEdgetypeC2);</div>
<div class="line"><span class="lineno">  289</span>    </div>
<div class="line"><span class="lineno">  290</span>    MPI_Type_vector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>-2), 1, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, MPI_DOUBLE, &amp;xEdgetypeC);</div>
<div class="line"><span class="lineno">  291</span>    MPI_Type_commit(&amp;xEdgetypeC);</div>
<div class="line"><span class="lineno">  292</span>    MPI_Type_create_hvector(2, 1, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>-1)*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), xEdgetypeC, &amp;xEdgetypeC2);</div>
<div class="line"><span class="lineno">  293</span>    MPI_Type_commit(&amp;xEdgetypeC2);</div>
<div class="line"><span class="lineno">  294</span>    </div>
<div class="line"><span class="lineno">  295</span>    <span class="comment">//corner used to communicate in x direction</span></div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordtype">int</span> blocklengthC[]={1,1,1,1};</div>
<div class="line"><span class="lineno">  297</span>    <span class="keywordtype">int</span> displacementsC[]={0,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-1,(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>-1)*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-1};</div>
<div class="line"><span class="lineno">  298</span>    MPI_Type_indexed(4, blocklengthC, displacementsC, MPI_DOUBLE, &amp;cornertypeC);</div>
<div class="line"><span class="lineno">  299</span>    MPI_Type_commit(&amp;cornertypeC);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    <span class="comment">//Define MPI Derived Data types for Node Halo Exchange</span></div>
<div class="line"><span class="lineno">  304</span>    <span class="comment">//For face exchange on X dir</span></div>
<div class="line"><span class="lineno">  305</span>    MPI_Type_vector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2),(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2),<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, MPI_DOUBLE, &amp;yzFacetypeN);</div>
<div class="line"><span class="lineno">  306</span>    MPI_Type_commit(&amp;yzFacetypeN);</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>    <span class="comment">//For face exchange on Y dir</span></div>
<div class="line"><span class="lineno">  309</span>    MPI_Type_create_hvector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2),(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2),(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)), MPI_DOUBLE, &amp;xzFacetypeN);</div>
<div class="line"><span class="lineno">  310</span>    MPI_Type_commit(&amp;xzFacetypeN);</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>    MPI_Type_vector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2), 1, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, MPI_DOUBLE, &amp;yEdgetypeN);</div>
<div class="line"><span class="lineno">  313</span>    MPI_Type_commit(&amp;yEdgetypeN);</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>    <span class="comment">//For face exchangeg on Z dir</span></div>
<div class="line"><span class="lineno">  316</span>    MPI_Type_create_hvector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2), 1, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)), yEdgetypeN, &amp;xyFacetypeN);</div>
<div class="line"><span class="lineno">  317</span>    MPI_Type_commit(&amp;xyFacetypeN);</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>    <span class="comment">//2 yEdgeType can be merged into one message</span></div>
<div class="line"><span class="lineno">  320</span>    MPI_Type_create_hvector(2, 1,(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), yEdgetypeN, &amp;yEdgetypeN2);</div>
<div class="line"><span class="lineno">  321</span>    MPI_Type_commit(&amp;yEdgetypeN2);</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    MPI_Type_contiguous((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2),MPI_DOUBLE, &amp;zEdgetypeN);</div>
<div class="line"><span class="lineno">  324</span>    MPI_Type_commit(&amp;zEdgetypeN);</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    MPI_Type_create_hvector(2, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2),(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1)*(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>)*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), MPI_DOUBLE, &amp;zEdgetypeN2);</div>
<div class="line"><span class="lineno">  327</span>    MPI_Type_commit(&amp;zEdgetypeN2);</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>    MPI_Type_vector((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2), 1, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, MPI_DOUBLE, &amp;xEdgetypeN);</div>
<div class="line"><span class="lineno">  330</span>    MPI_Type_commit(&amp;xEdgetypeN);</div>
<div class="line"><span class="lineno">  331</span>    MPI_Type_create_hvector(2, 1, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1)*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>), xEdgetypeN, &amp;xEdgetypeN2);</div>
<div class="line"><span class="lineno">  332</span>    MPI_Type_commit(&amp;xEdgetypeN2);</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    <span class="comment">//corner used to communicate in x direction</span></div>
<div class="line"><span class="lineno">  335</span>    <span class="keywordtype">int</span> blocklengthN[]={1,1,1,1};</div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordtype">int</span> displacementsN[]={0,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1,(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1)*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1};</div>
<div class="line"><span class="lineno">  337</span>    MPI_Type_indexed(4, blocklengthN, displacementsN, MPI_DOUBLE, &amp;cornertypeN);</div>
<div class="line"><span class="lineno">  338</span>    MPI_Type_commit(&amp;cornertypeN);</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">if</span> (col-&gt;getWriteMethod() == <span class="stringliteral">&quot;pvtk&quot;</span> || col-&gt;getWriteMethod() == <span class="stringliteral">&quot;nbcvtk&quot;</span>){</div>
<div class="line"><span class="lineno">  341</span>        <span class="comment">//test Endian</span></div>
<div class="line"><span class="lineno">  342</span>        <span class="keywordtype">int</span> TestEndian = 1;</div>
<div class="line"><span class="lineno">  343</span>        lEndFlag =*(<span class="keywordtype">char</span>*)&amp;TestEndian;</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>         <span class="comment">//create process file view</span></div>
<div class="line"><span class="lineno">  346</span>                  <span class="keywordtype">int</span>  size[3], subsize[3], start[3];</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>                  <span class="comment">//3D subarray - reverse X, Z</span></div>
<div class="line"><span class="lineno">  349</span>                  subsize[0] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-2; subsize[1] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>-2; subsize[2] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>-2;</div>
<div class="line"><span class="lineno">  350</span>                  size[0] = (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-2)*vct-&gt;getZLEN();size[1] = (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>-2)*vct-&gt;getYLEN();size[2] = (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>-2)*vct-&gt;getXLEN();</div>
<div class="line"><span class="lineno">  351</span>                  start[0]= vct-&gt;getCoordinates(2)*subsize[0];</div>
<div class="line"><span class="lineno">  352</span>                  start[1]= vct-&gt;getCoordinates(1)*subsize[1];</div>
<div class="line"><span class="lineno">  353</span>                  start[2]= vct-&gt;getCoordinates(0)*subsize[2];</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>                  MPI_Type_contiguous(3,MPI_FLOAT, &amp;xyzcomp);</div>
<div class="line"><span class="lineno">  356</span>                  MPI_Type_commit(&amp;xyzcomp);</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>                  MPI_Type_create_subarray(3, size, subsize, start,MPI_ORDER_C, xyzcomp, &amp;procviewXYZ);</div>
<div class="line"><span class="lineno">  359</span>                  MPI_Type_commit(&amp;procviewXYZ);</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>                  MPI_Type_create_subarray(3, size, subsize, start,MPI_ORDER_C, MPI_FLOAT, &amp;procview);</div>
<div class="line"><span class="lineno">  362</span>                  MPI_Type_commit(&amp;procview);</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>                  subsize[0] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>-2; subsize[1] =<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>-2; subsize[2] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-2;</div>
<div class="line"><span class="lineno">  365</span>                  size[0]    = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>;       size[1]        =<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>;   size[2]        = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>;</div>
<div class="line"><span class="lineno">  366</span>                  start[0]       = 1;     start[1]       =1;     start[2]       = 1;</div>
<div class="line"><span class="lineno">  367</span>                  MPI_Type_create_subarray(3, size, subsize, start,MPI_ORDER_C, MPI_FLOAT, &amp;ghosttype);</div>
<div class="line"><span class="lineno">  368</span>                  MPI_Type_commit(&amp;ghosttype);</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    }</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a18f9fef7aa44de67fa3f9742d3bb8c0d"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a18f9fef7aa44de67fa3f9742d3bb8c0d">EMfields3D::GMREStol</a></div><div class="ttdeci">double GMREStol</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00568">EMfields3D.h:568</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a1ae9e3a80d6602b3f60e56582d236ee1"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">EMfields3D::z_center</a></div><div class="ttdeci">double z_center</div><div class="ttdoc">source center - Z direction</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00397">EMfields3D.h:397</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a206f6017adcc96ec7fc074b5101fb2fb"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">EMfields3D::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">EMfields3D.h:349</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a30e1eb6027a4a332d41b2ba4e49dc532"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">EMfields3D::nzn</a></div><div class="ttdeci">int nzn</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">EMfields3D.h:381</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a36c6b4e19eaedb0ec58aae5c2d090cc8"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">EMfields3D::c</a></div><div class="ttdeci">double c</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">EMfields3D.h:345</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a36e8cc446bb14517409aba077a6bab1b"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">EMfields3D::B0x</a></div><div class="ttdeci">double B0x</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">EMfields3D.h:360</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a42158c86c46e0ee3ce618cfe52d63b31"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a42158c86c46e0ee3ce618cfe52d63b31">EMfields3D::B1x</a></div><div class="ttdeci">double B1x</div><div class="ttdoc">Earth Model parameters.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00362">EMfields3D.h:362</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a43d562d551ea0f165362c5679bbba07b"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a43d562d551ea0f165362c5679bbba07b">EMfields3D::rhoh</a></div><div class="ttdeci">array3_double rhoh</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00479">EMfields3D.h:479</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a46c3082575146e5975baaa9177284892"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a46c3082575146e5975baaa9177284892">EMfields3D::tempC</a></div><div class="ttdeci">array3_double tempC</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00446">EMfields3D.h:446</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a4a57d80ce246ebe6e9ba52ce3fbbceb9"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">EMfields3D::ns</a></div><div class="ttdeci">int ns</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">EMfields3D.h:358</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a50c0294e6845feaa8082d5f213c3b9b5"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">EMfields3D::ue0</a></div><div class="ttdeci">double ue0</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00366">EMfields3D.h:366</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a578657d9f806d7d414c816fd81f5f93c"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a578657d9f806d7d414c816fd81f5f93c">EMfields3D::CGtol</a></div><div class="ttdeci">double CGtol</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00566">EMfields3D.h:566</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a57cb50aa343b780dc7e2d4f9695af5e6"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">EMfields3D::restart1</a></div><div class="ttdeci">int restart1</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">EMfields3D.h:563</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a5f9d78fac6902b1ea3eaf5e298874768"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a5f9d78fac6902b1ea3eaf5e298874768">EMfields3D::PHI</a></div><div class="ttdeci">array3_double PHI</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00402">EMfields3D.h:402</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a71b15b350e24f60d5b4418d274231c93"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">EMfields3D::y_center</a></div><div class="ttdeci">double y_center</div><div class="ttdoc">source center - Y direction</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00395">EMfields3D.h:395</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a7a12fc7eab8c39c85f8ff5be174a3c5d"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a7a12fc7eab8c39c85f8ff5be174a3c5d">EMfields3D::bcPHIfaceXright</a></div><div class="ttdeci">int bcPHIfaceXright</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00535">EMfields3D.h:535</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a7ab7ecb259c9728b0d15836e36865540"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">EMfields3D::Lx</a></div><div class="ttdeci">double Lx</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00387">EMfields3D.h:387</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a7d090b86a16ede7b0b8d4abec332e5b9"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a7d090b86a16ede7b0b8d4abec332e5b9">EMfields3D::bcEMfaceXright</a></div><div class="ttdeci">int bcEMfaceXright</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00546">EMfields3D.h:546</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a877f625eaefc4a2a28c6ac7001c89060"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">EMfields3D::qom</a></div><div class="ttdeci">double * qom</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">EMfields3D.h:364</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a8a76656afeb6d85f3d75e7c0287ffa84"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">EMfields3D::nxc</a></div><div class="ttdeci">int nxc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">EMfields3D.h:371</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a8ea9ae681b78a8067d4a753a486fa2fc"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a8ea9ae681b78a8067d4a753a486fa2fc">EMfields3D::PoissonCorrection</a></div><div class="ttdeci">bool PoissonCorrection</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00560">EMfields3D.h:560</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a97a89d811b0dc79cd53690e05fbdabc8"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">EMfields3D::Ly</a></div><div class="ttdeci">double Ly</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">EMfields3D.h:389</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a9e00cd79434a2bc1f9eccfa33284768d"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">EMfields3D::Smooth</a></div><div class="ttdeci">double Smooth</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00353">EMfields3D.h:353</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a9e3c3868c15d1829fe30477a940332a6"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">EMfields3D::rhons</a></div><div class="ttdeci">array4_double rhons</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">EMfields3D.h:481</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_aa5faeefa7eb12e7e655923af87e2c5e7"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#aa5faeefa7eb12e7e655923af87e2c5e7">EMfields3D::L_square</a></div><div class="ttdeci">double L_square</div><div class="ttdoc">Characteristic length.</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00399">EMfields3D.h:399</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_aac2a4ca79acb7297ddfe0b152cc546bd"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">EMfields3D::nyc</a></div><div class="ttdeci">int nyc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">EMfields3D.h:375</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_aacdcc329cbd6c8872dce11171cc3cba3"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#aacdcc329cbd6c8872dce11171cc3cba3">EMfields3D::xStart</a></div><div class="ttdeci">double xStart</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00383">EMfields3D.h:383</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_aaf7aa492bfe607643d07aad8323c08e5"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">EMfields3D::imageX</a></div><div class="ttdeci">array3_double imageX</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00454">EMfields3D.h:454</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ab06147cd3a362deaa144d6b077f23146"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">EMfields3D::nxn</a></div><div class="ttdeci">int nxn</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">EMfields3D.h:373</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ab8ba4df7252b5aab6ba31fe8e2b9be39"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">EMfields3D::nzc</a></div><div class="ttdeci">int nzc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">EMfields3D.h:379</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ac0fc1cbc7e72163ee2b3ae1080dec3f5"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ac0fc1cbc7e72163ee2b3ae1080dec3f5">EMfields3D::PSI</a></div><div class="ttdeci">array3_double PSI</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00404">EMfields3D.h:404</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ac13eea1faaf959ca92ff84ad03b0ce79"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">EMfields3D::rhoINIT</a></div><div class="ttdeci">double * rhoINIT</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">EMfields3D.h:555</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ac154c0bebb127df531138a846cfde8e3"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ac154c0bebb127df531138a846cfde8e3">EMfields3D::rhon</a></div><div class="ttdeci">array3_double rhon</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00477">EMfields3D.h:477</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ac15b1931f27db3db0d53de63848dc78a"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">EMfields3D::DriftSpecies</a></div><div class="ttdeci">bool * DriftSpecies</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00557">EMfields3D.h:557</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ac2608a0f00c2dac18a7d73417ca2c591"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">EMfields3D::dx</a></div><div class="ttdeci">double dx</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">EMfields3D.h:385</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ac592e12b7cc8428fecb8219e9ebe050d"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ac592e12b7cc8428fecb8219e9ebe050d">EMfields3D::rhoc</a></div><div class="ttdeci">array3_double rhoc</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00475">EMfields3D.h:475</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ac7afadac85c315f7b6c17382a434e45d"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">EMfields3D::x_center</a></div><div class="ttdeci">double x_center</div><div class="ttdoc">source center - X direction</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00393">EMfields3D.h:393</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ac87809eafbf98eb3336a670dcb3a2728"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">EMfields3D::th</a></div><div class="ttdeci">double th</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00351">EMfields3D.h:351</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_acb425fcde45789639ababbe2d847d059"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">EMfields3D::tempXC</a></div><div class="ttdeci">array3_double tempXC</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00439">EMfields3D.h:439</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_af52fe04e26da970a36638062f93adc10"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">EMfields3D::nyn</a></div><div class="ttdeci">int nyn</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">EMfields3D.h:377</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_af6423e5405362e6401eb65b1db95fb74"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">EMfields3D::delt</a></div><div class="ttdeci">double delt</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">EMfields3D.h:356</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_af73b86e3e2631057b7b1818f6a1dc382"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">EMfields3D::rhocs</a></div><div class="ttdeci">array4_double rhocs</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">EMfields3D.h:483</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_afcc5cd4f2a3bb7d91d5a93a230ae76a3"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">EMfields3D::Lz</a></div><div class="ttdeci">double Lz</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00391">EMfields3D.h:391</a></div></div>
<div class="ttc" id="aclass_moments10_html"><div class="ttname"><a href="../../d1/d1c/class_moments10.html">Moments10</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/dd9/_moments_8h_source.html#l00027">Moments.h:28</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00362">B1x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00546">bcEMfaceXright</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00535">bcPHIfaceXright</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00566">CGtol</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00557">DriftSpecies</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00568">GMREStol</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00560">PoissonCorrection</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00353">Smooth</a>.</p>

</div>
</div>
<a id="a2f1176e551a646695816ffa55179f687" name="a2f1176e551a646695816ffa55179f687"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f1176e551a646695816ffa55179f687">&#9670;&nbsp;</a></span>~EMfields3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EMfields3D::~EMfields3D </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >destructor </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05714">5714</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5714</span>                        {</div>
<div class="line"><span class="lineno"> 5715</span>  <span class="keyword">delete</span> [] <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>;</div>
<div class="line"><span class="lineno"> 5716</span>  <span class="keyword">delete</span> [] <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>;</div>
<div class="line"><span class="lineno"> 5717</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;sizeMomentsArray;i++) { <span class="keyword">delete</span> moments10Array[i]; }</div>
<div class="line"><span class="lineno"> 5718</span>  <span class="keyword">delete</span> [] moments10Array;</div>
<div class="line"><span class="lineno"> 5719</span>  freeDataType();</div>
<div class="line"><span class="lineno"> 5720</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7746c72f05aa81fc99542bcfb5680c82" name="a7746c72f05aa81fc99542bcfb5680c82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7746c72f05aa81fc99542bcfb5680c82">&#9670;&nbsp;</a></span>addJx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addJx </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add an amount of current density - direction X to current density field at node X,Y,Z</p>
<p >add an amount of charge density to current density - direction X to current density field on the node </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00616">616</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  616</span>                                                                                {</div>
<div class="line"><span class="lineno">  617</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  619</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  620</span>        Jxs[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  621</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f3c28853467b3b3bfc17426ae693108" name="a7f3c28853467b3b3bfc17426ae693108"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f3c28853467b3b3bfc17426ae693108">&#9670;&nbsp;</a></span>addJy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addJy </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add an amount of current density - direction Y to current density field at node X,Y,Z</p>
<p >add an amount of current density - direction Y to current density field on the node </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00623">623</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  623</span>                                                                                {</div>
<div class="line"><span class="lineno">  624</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  625</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  626</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  627</span>        Jys[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  628</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac148293b3d87704ce4ea860d17c4cac6" name="ac148293b3d87704ce4ea860d17c4cac6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac148293b3d87704ce4ea860d17c4cac6">&#9670;&nbsp;</a></span>addJz()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addJz </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add an amount of current density - direction Z to current density field at node X,Y,Z</p>
<p >add an amount of current density - direction Z to current density field on the node </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00630">630</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  630</span>                                                                                {</div>
<div class="line"><span class="lineno">  631</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  632</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  633</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  634</span>        Jzs[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  635</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a082f87b1209114be11077d5525f32a73" name="a082f87b1209114be11077d5525f32a73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a082f87b1209114be11077d5525f32a73">&#9670;&nbsp;</a></span>AddPerturbation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::AddPerturbation </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaBoB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ky</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ex_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ex_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ey_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ey_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ez_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ez_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bx_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bx_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>By_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>By_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bz_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bz_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>B0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >add a perturbattion to the EM field</p>
<p >Add a periodic perturbation exp i(kx - \omega t); deltaBoB is the ratio (Delta B / B0) * </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03243">3243</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3243</span>                                                                                                                                                                                                                                                                                              {</div>
<div class="line"><span class="lineno"> 3244</span> </div>
<div class="line"><span class="lineno"> 3245</span>  <span class="keywordtype">double</span> alpha;</div>
<div class="line"><span class="lineno"> 3246</span> </div>
<div class="line"><span class="lineno"> 3247</span>  alpha = deltaBoB * B0 / sqrt(Bx_mod * Bx_mod + By_mod * By_mod + Bz_mod * Bz_mod);</div>
<div class="line"><span class="lineno"> 3248</span> </div>
<div class="line"><span class="lineno"> 3249</span>  Ex_mod *= alpha;</div>
<div class="line"><span class="lineno"> 3250</span>  Ey_mod *= alpha;</div>
<div class="line"><span class="lineno"> 3251</span>  Ez_mod *= alpha;</div>
<div class="line"><span class="lineno"> 3252</span>  Bx_mod *= alpha;</div>
<div class="line"><span class="lineno"> 3253</span>  By_mod *= alpha;</div>
<div class="line"><span class="lineno"> 3254</span>  Bz_mod *= alpha;</div>
<div class="line"><span class="lineno"> 3255</span> </div>
<div class="line"><span class="lineno"> 3256</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3257</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++) {</div>
<div class="line"><span class="lineno"> 3258</span>      Ex[i][j][0] += Ex_mod * cos(kx * grid-&gt;getXN(i, j, 0) + ky * grid-&gt;getYN(i, j, 0) + Ex_phase);</div>
<div class="line"><span class="lineno"> 3259</span>      Ey[i][j][0] += Ey_mod * cos(kx * grid-&gt;getXN(i, j, 0) + ky * grid-&gt;getYN(i, j, 0) + Ey_phase);</div>
<div class="line"><span class="lineno"> 3260</span>      Ez[i][j][0] += Ez_mod * cos(kx * grid-&gt;getXN(i, j, 0) + ky * grid-&gt;getYN(i, j, 0) + Ez_phase);</div>
<div class="line"><span class="lineno"> 3261</span>      Bxn[i][j][0] += Bx_mod * cos(kx * grid-&gt;getXN(i, j, 0) + ky * grid-&gt;getYN(i, j, 0) + Bx_phase);</div>
<div class="line"><span class="lineno"> 3262</span>      Byn[i][j][0] += By_mod * cos(kx * grid-&gt;getXN(i, j, 0) + ky * grid-&gt;getYN(i, j, 0) + By_phase);</div>
<div class="line"><span class="lineno"> 3263</span>      Bzn[i][j][0] += Bz_mod * cos(kx * grid-&gt;getXN(i, j, 0) + ky * grid-&gt;getYN(i, j, 0) + Bz_phase);</div>
<div class="line"><span class="lineno"> 3264</span> </div>
<div class="line"><span class="lineno"> 3265</span>    }</div>
<div class="line"><span class="lineno"> 3266</span> </div>
<div class="line"><span class="lineno"> 3267</span>  <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 3268</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bxc, Bxn);</div>
<div class="line"><span class="lineno"> 3269</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Byc, Byn);</div>
<div class="line"><span class="lineno"> 3270</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bzc, Bzn);</div>
<div class="line"><span class="lineno"> 3271</span> </div>
<div class="line"><span class="lineno"> 3272</span>}</div>
<div class="ttc" id="aclass_grid3_d_c_u_html_a687931ef95973ad124455f8bc4056454"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C</a></div><div class="ttdeci">void interpN2C(arr3_double vecFieldC, const_arr3_double vecFieldN) const</div><div class="ttdoc">interpolate on central points from nodes</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>.</p>

</div>
</div>
<a id="a1e963071baf452fbed9c71f4210a0277" name="a1e963071baf452fbed9c71f4210a0277"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e963071baf452fbed9c71f4210a0277">&#9670;&nbsp;</a></span>AddPerturbationRho()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::AddPerturbationRho </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltaBoB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ky</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bx_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>By_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Bz_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ne_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ne_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ni_mod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ni_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>B0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >add a perturbattion to charge density</p>
<p >Add a periodic perturbation in rho exp i(kx - \omega t); deltaBoB is the ratio (Delta B / B0) * </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03223">3223</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3223</span>                                                                                                                                                                                                              {</div>
<div class="line"><span class="lineno"> 3224</span> </div>
<div class="line"><span class="lineno"> 3225</span>  <span class="keywordtype">double</span> alpha;</div>
<div class="line"><span class="lineno"> 3226</span>  alpha = deltaBoB * B0 / sqrt(Bx_mod * Bx_mod + By_mod * By_mod + Bz_mod * Bz_mod);</div>
<div class="line"><span class="lineno"> 3227</span> </div>
<div class="line"><span class="lineno"> 3228</span>  ne_mod *= alpha;</div>
<div class="line"><span class="lineno"> 3229</span>  ni_mod *= alpha;</div>
<div class="line"><span class="lineno"> 3230</span>  <span class="comment">// cout&lt;&lt;&quot; ne=&quot;&lt;&lt;ne_mod&lt;&lt;&quot; ni=&quot;&lt;&lt;ni_mod&lt;&lt;&quot; alpha=&quot;&lt;&lt;alpha&lt;&lt;endl;</span></div>
<div class="line"><span class="lineno"> 3231</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3232</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++) {</div>
<div class="line"><span class="lineno"> 3233</span>      <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[0][i][j][0] += ne_mod * cos(kx * grid-&gt;getXN(i, j, 0) + ky * grid-&gt;getYN(i, j, 0) + ne_phase);</div>
<div class="line"><span class="lineno"> 3234</span>      <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[1][i][j][0] += ni_mod * cos(kx * grid-&gt;getXN(i, j, 0) + ky * grid-&gt;getYN(i, j, 0) + ni_phase);</div>
<div class="line"><span class="lineno"> 3235</span>    }</div>
<div class="line"><span class="lineno"> 3236</span> </div>
<div class="line"><span class="lineno"> 3237</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3238</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 3239</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="a2e9d0e2f5afebb6cec8fc8e2bf94f201" name="a2e9d0e2f5afebb6cec8fc8e2bf94f201"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9d0e2f5afebb6cec8fc8e2bf94f201">&#9670;&nbsp;</a></span>addPxx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addPxx </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add an amount of pressure density - direction XX to current density field at node X,Y,Z</p>
<p >add an amount of pressure density - direction XX to current density field on the node </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00637">637</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  637</span>                                                                                 {</div>
<div class="line"><span class="lineno">  638</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  639</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  640</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  641</span>        pXXsn[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  642</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a20ad3d02f549b15d24e9964c2147ce03" name="a20ad3d02f549b15d24e9964c2147ce03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20ad3d02f549b15d24e9964c2147ce03">&#9670;&nbsp;</a></span>addPxy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addPxy </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add an amount of pressure density - direction XY to current density field at node X,Y,Z</p>
<p >add an amount of pressure density - direction XY to current density field on the node </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00644">644</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  644</span>                                                                                 {</div>
<div class="line"><span class="lineno">  645</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  647</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  648</span>        pXYsn[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  649</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4c422a2f7d4d9703990fbecf10e25c42" name="a4c422a2f7d4d9703990fbecf10e25c42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c422a2f7d4d9703990fbecf10e25c42">&#9670;&nbsp;</a></span>addPxz()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addPxz </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add an amount of pressure density - direction XZ to current density field at node X,Y,Z</p>
<p >add an amount of pressure density - direction XZ to current density field on the node </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00651">651</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  651</span>                                                                                 {</div>
<div class="line"><span class="lineno">  652</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  653</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  654</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  655</span>        pXZsn[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  656</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a10f59553f4b4dfdbb044b6c4bc46bc7f" name="a10f59553f4b4dfdbb044b6c4bc46bc7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10f59553f4b4dfdbb044b6c4bc46bc7f">&#9670;&nbsp;</a></span>addPyy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addPyy </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add an amount of pressure density - direction YY to current density field at node X,Y,Z</p>
<p >add an amount of pressure density - direction YY to current density field on the node </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00658">658</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  658</span>                                                                                 {</div>
<div class="line"><span class="lineno">  659</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  661</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  662</span>        pYYsn[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  663</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1ac719c2121d340e6886083295c2c921" name="a1ac719c2121d340e6886083295c2c921"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ac719c2121d340e6886083295c2c921">&#9670;&nbsp;</a></span>addPyz()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addPyz </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add an amount of pressure density - direction YZ to current density field at node X,Y,Z</p>
<p >add an amount of pressure density - direction YZ to current density field on the node </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00665">665</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  665</span>                                                                                 {</div>
<div class="line"><span class="lineno">  666</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  668</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  669</span>        pYZsn[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  670</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4072e7bf48c9807e6389a2d875d85dd0" name="a4072e7bf48c9807e6389a2d875d85dd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4072e7bf48c9807e6389a2d875d85dd0">&#9670;&nbsp;</a></span>addPzz()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addPzz </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add an amount of pressure density - direction ZZ to current density field at node X,Y,Z</p>
<p >add an amount of pressure density - direction ZZ to current density field on the node </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00672">672</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  672</span>                                                                                 {</div>
<div class="line"><span class="lineno">  673</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  674</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  675</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  676</span>        pZZsn[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  677</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa72327e5d7c7aa04c083f8eeedfed9ef" name="aa72327e5d7c7aa04c083f8eeedfed9ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa72327e5d7c7aa04c083f8eeedfed9ef">&#9670;&nbsp;</a></span>addRho()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::addRho </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>[][2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add accumulated moments to the moments for a given species</p>
<p >add an amount of charge density to charge density field at node X,Y,Z </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00609">609</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  609</span>                                                                                 {</div>
<div class="line"><span class="lineno">  610</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)</div>
<div class="line"><span class="lineno">  611</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 2; j++)</div>
<div class="line"><span class="lineno">  612</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; 2; k++)</div>
<div class="line"><span class="lineno">  613</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][X - i][Y - j][Z - k] += weight[i][j][k] * invVOL;</div>
<div class="line"><span class="lineno">  614</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="a3ba145a878a26b59fb5405da269449d1" name="a3ba145a878a26b59fb5405da269449d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ba145a878a26b59fb5405da269449d1">&#9670;&nbsp;</a></span>adjustNonPeriodicDensities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::adjustNonPeriodicDensities </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >adjust densities on boundaries that are not periodic </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02699">2699</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2700</span>{</div>
<div class="line"><span class="lineno"> 2701</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2702</span>  <span class="keywordflow">if</span> (vct-&gt;getXleft_neighbor_P() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2703</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2704</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++)</div>
<div class="line"><span class="lineno"> 2705</span>    {</div>
<div class="line"><span class="lineno"> 2706</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2707</span>        Jxs  [is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2708</span>        Jys  [is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2709</span>        Jzs  [is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2710</span>        pXXsn[is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2711</span>        pXYsn[is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2712</span>        pXZsn[is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2713</span>        pYYsn[is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2714</span>        pYZsn[is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2715</span>        pZZsn[is][1][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2716</span>    }</div>
<div class="line"><span class="lineno"> 2717</span>  }</div>
<div class="line"><span class="lineno"> 2718</span>  <span class="keywordflow">if</span> (vct-&gt;getYleft_neighbor_P() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2719</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2720</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++)</div>
<div class="line"><span class="lineno"> 2721</span>    {</div>
<div class="line"><span class="lineno"> 2722</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2723</span>        Jxs  [is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2724</span>        Jys  [is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2725</span>        Jzs  [is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2726</span>        pXXsn[is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2727</span>        pXYsn[is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2728</span>        pXZsn[is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2729</span>        pYYsn[is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2730</span>        pYZsn[is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2731</span>        pZZsn[is][i][1][k] *= 2;</div>
<div class="line"><span class="lineno"> 2732</span>    }</div>
<div class="line"><span class="lineno"> 2733</span>  }</div>
<div class="line"><span class="lineno"> 2734</span>  <span class="keywordflow">if</span> (vct-&gt;getZleft_neighbor_P() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2735</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2736</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2737</span>    {</div>
<div class="line"><span class="lineno"> 2738</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2739</span>        Jxs  [is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2740</span>        Jys  [is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2741</span>        Jzs  [is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2742</span>        pXXsn[is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2743</span>        pXYsn[is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2744</span>        pXZsn[is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2745</span>        pYYsn[is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2746</span>        pYZsn[is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2747</span>        pZZsn[is][i][j][1] *= 2;</div>
<div class="line"><span class="lineno"> 2748</span>    }</div>
<div class="line"><span class="lineno"> 2749</span>  }</div>
<div class="line"><span class="lineno"> 2750</span>  <span class="keywordflow">if</span> (vct-&gt;getXright_neighbor_P() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2751</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2752</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++)</div>
<div class="line"><span class="lineno"> 2753</span>    {</div>
<div class="line"><span class="lineno"> 2754</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2755</span>        Jxs  [is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2756</span>        Jys  [is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2757</span>        Jzs  [is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2758</span>        pXXsn[is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2759</span>        pXYsn[is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2760</span>        pXZsn[is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2761</span>        pYYsn[is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2762</span>        pYZsn[is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2763</span>        pZZsn[is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][i][k] *= 2;</div>
<div class="line"><span class="lineno"> 2764</span>    }</div>
<div class="line"><span class="lineno"> 2765</span>  }</div>
<div class="line"><span class="lineno"> 2766</span>  <span class="keywordflow">if</span> (vct-&gt;getYright_neighbor_P() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2767</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2768</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++)</div>
<div class="line"><span class="lineno"> 2769</span>    {</div>
<div class="line"><span class="lineno"> 2770</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2771</span>        Jxs  [is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2772</span>        Jys  [is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2773</span>        Jzs  [is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2774</span>        pXXsn[is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2775</span>        pXYsn[is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2776</span>        pXZsn[is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2777</span>        pYYsn[is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2778</span>        pYZsn[is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2779</span>        pZZsn[is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] *= 2;</div>
<div class="line"><span class="lineno"> 2780</span>    }</div>
<div class="line"><span class="lineno"> 2781</span>  }</div>
<div class="line"><span class="lineno"> 2782</span>  <span class="keywordflow">if</span> (vct-&gt;getZright_neighbor_P() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2783</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2784</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2785</span>    {</div>
<div class="line"><span class="lineno"> 2786</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2787</span>        Jxs  [is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2788</span>        Jys  [is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2789</span>        Jzs  [is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2790</span>        pXXsn[is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2791</span>        pXYsn[is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2792</span>        pXZsn[is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2793</span>        pYYsn[is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2794</span>        pYZsn[is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2795</span>        pZZsn[is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2] *= 2;</div>
<div class="line"><span class="lineno"> 2796</span>    }</div>
<div class="line"><span class="lineno"> 2797</span>  }</div>
<div class="line"><span class="lineno"> 2798</span>}</div>
<div class="ttc" id="aclass_v_ctopology3_d_html"><div class="ttname"><a href="../../d0/dd1/class_v_ctopology3_d.html">VCtopology3D</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d04/_v_ctopology3_d_8h_source.html#l00052">VCtopology3D.h:53</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03344">communicateGhostP2G()</a>.</p>

</div>
</div>
<a id="a5140eef8f09481bcf485b06def1cf872" name="a5140eef8f09481bcf485b06def1cf872"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5140eef8f09481bcf485b06def1cf872">&#9670;&nbsp;</a></span>calculateB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::calculateB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate Magnetic field with the implicit solver: calculate B defined on nodes With E(n+ theta) computed, the magnetic field is evaluated from Faraday's law </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">3040</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3041</span>{</div>
<div class="line"><span class="lineno"> 3042</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 3043</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3044</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3045</span> </div>
<div class="line"><span class="lineno"> 3046</span>  <span class="comment">// parameters for SAL (simple absorption layer) method </span></div>
<div class="line"><span class="lineno"> 3047</span>  <span class="keywordtype">int</span> yes_sal;</div>
<div class="line"><span class="lineno"> 3048</span>  <span class="keywordtype">int</span> n_layers;</div>
<div class="line"><span class="lineno"> 3049</span>  </div>
<div class="line"><span class="lineno"> 3050</span>  yes_sal  = col-&gt;getYes_sal();</div>
<div class="line"><span class="lineno"> 3051</span>  </div>
<div class="line"><span class="lineno"> 3052</span>  <span class="comment">// divide two cases: apply SAL b.c., or regular zero-gradient b.c.</span></div>
<div class="line"><span class="lineno"> 3053</span>  <span class="keywordflow">if</span>(yes_sal)</div>
<div class="line"><span class="lineno"> 3054</span>    n_layers = col-&gt;getN_layers_sal();</div>
<div class="line"><span class="lineno"> 3055</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3056</span>    n_layers = 3;</div>
<div class="line"><span class="lineno"> 3057</span> </div>
<div class="line"><span class="lineno"> 3058</span>  <span class="keywordflow">if</span> (vct-&gt;getCartesian_rank() == 0)</div>
<div class="line"><span class="lineno"> 3059</span>    cout &lt;&lt; <span class="stringliteral">&quot;*** B CALCULATION ***&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3060</span> </div>
<div class="line"><span class="lineno"> 3061</span>  <span class="comment">// calculate the curl of Eth</span></div>
<div class="line"><span class="lineno"> 3062</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#ac51689b8665db17f2edb6837e41482fa">curlN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>, tempYC, tempZC, Exth, Eyth, Ezth);</div>
<div class="line"><span class="lineno"> 3063</span> </div>
<div class="line"><span class="lineno"> 3064</span>  <span class="comment">// update the magnetic field</span></div>
<div class="line"><span class="lineno"> 3065</span>  addscale(-<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>, 1, Bxc, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3066</span>  addscale(-<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>, 1, Byc, tempYC, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3067</span>  addscale(-<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>, 1, Bzc, tempZC, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3068</span> </div>
<div class="line"><span class="lineno"> 3069</span>  <span class="comment">// communicate ghost </span></div>
<div class="line"><span class="lineno"> 3070</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bxc, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3071</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Byc, col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3072</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bzc, col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3073</span> </div>
<div class="line"><span class="lineno"> 3074</span>  <span class="comment">// OpenBC:</span></div>
<div class="line"><span class="lineno"> 3075</span>  OpenBoundaryInflowB(Bxc,Byc,Bzc,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3076</span> </div>
<div class="line"><span class="lineno"> 3077</span>  <span class="comment">// interpolate C2N</span></div>
<div class="line"><span class="lineno"> 3078</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#ab4602ae1c61cbc7cbfa73bd882bb73bd">interpC2N</a>(Bxn, Bxc);</div>
<div class="line"><span class="lineno"> 3079</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#ab4602ae1c61cbc7cbfa73bd882bb73bd">interpC2N</a>(Byn, Byc);</div>
<div class="line"><span class="lineno"> 3080</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#ab4602ae1c61cbc7cbfa73bd882bb73bd">interpC2N</a>(Bzn, Bzc);</div>
<div class="line"><span class="lineno"> 3081</span> </div>
<div class="line"><span class="lineno"> 3082</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bxn, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3083</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Byn, col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3084</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bzn, col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3085</span> </div>
<div class="line"><span class="lineno"> 3086</span>  <span class="comment">// Adjust B after BC by applying divergence cleaning, laplacian(PSI) = div(B), B = B - grad(PSI)</span></div>
<div class="line"><span class="lineno"> 3087</span>  <span class="comment">// START</span></div>
<div class="line"><span class="lineno"> 3088</span>  </div>
<div class="line"><span class="lineno"> 3089</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> divB     (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3090</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> gradPSIX (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 3091</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> gradPSIY (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 3092</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> gradPSIZ (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 3093</span> </div>
<div class="line"><span class="lineno"> 3094</span>  <span class="keywordtype">double</span> *xkrylovPoisson = <span class="keyword">new</span> <span class="keywordtype">double</span>[(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a> - 2)];</div>
<div class="line"><span class="lineno"> 3095</span>  <span class="keywordtype">double</span> *bkrylovPoisson = <span class="keyword">new</span> <span class="keywordtype">double</span>[(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a> - 2)];</div>
<div class="line"><span class="lineno"> 3096</span>  </div>
<div class="line"><span class="lineno"> 3097</span>  eqValue(0.0, divB, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3098</span>  eqValue(0.0, gradPSIX, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 3099</span>  eqValue(0.0, gradPSIY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 3100</span>  eqValue(0.0, gradPSIZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 3101</span>  eqValue(0.0, xkrylovPoisson, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a> - 2));</div>
<div class="line"><span class="lineno"> 3102</span> </div>
<div class="line"><span class="lineno"> 3103</span>  <span class="comment">// compute divB</span></div>
<div class="line"><span class="lineno"> 3104</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#afe24a532c0d6c1c357e74da6c97deddf">divN2C</a>(divB, Bxn, Byn, Bzn);</div>
<div class="line"><span class="lineno"> 3105</span>  <span class="comment">// move to krylov space the RHS</span></div>
<div class="line"><span class="lineno"> 3106</span>  phys2solver(bkrylovPoisson, divB, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3107</span>  <span class="comment">// compute solution poisson lapl(PSI)=0 using GMRES</span></div>
<div class="line"><span class="lineno"> 3108</span>  <span class="keywordflow">if</span> (col-&gt;getVerbose() and vct-&gt;getCartesian_rank() == 0) cout &lt;&lt; <span class="stringliteral">&quot;*** DIVERGENCE CLEANING div(B)=0 using GMRes***&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3109</span>  GMRES(&amp;<a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a9d3ddfa82333c03d79211c94cf7d7df9">Field::PoissonImage</a>, xkrylovPoisson, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a> - 2), bkrylovPoisson, 20, 200, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a18f9fef7aa44de67fa3f9742d3bb8c0d">GMREStol</a>, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3110</span>  <span class="comment">// solution back to physical space </span></div>
<div class="line"><span class="lineno"> 3111</span>  solver2phys(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac0fc1cbc7e72163ee2b3ae1080dec3f5">PSI</a>, xkrylovPoisson, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3112</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac0fc1cbc7e72163ee2b3ae1080dec3f5">PSI</a>, 2, 2, 2, 2, 2, 2, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3113</span>  <span class="comment">// calculate the gradient</span></div>
<div class="line"><span class="lineno"> 3114</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a23706ff7359753cd045a182fb8d20f80">gradC2N</a>(gradPSIX, gradPSIY, gradPSIZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac0fc1cbc7e72163ee2b3ae1080dec3f5">PSI</a>);</div>
<div class="line"><span class="lineno"> 3115</span>  <span class="comment">// correct B on nodes, only ABC layer</span></div>
<div class="line"><span class="lineno"> 3116</span>  <span class="comment">// X=0 boundary</span></div>
<div class="line"><span class="lineno"> 3117</span>  <span class="keywordflow">if</span>(vct-&gt;getXleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXleft ==2) {</div>
<div class="line"><span class="lineno"> 3118</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_sal=0; i_sal&lt;n_layers; i_sal++)</div>
<div class="line"><span class="lineno"> 3119</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3120</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 3121</span>          Bxn.fetch(i_sal,j,k) -= gradPSIX.get(i_sal,j,k);</div>
<div class="line"><span class="lineno"> 3122</span>          Byn.fetch(i_sal,j,k) -= gradPSIY.get(i_sal,j,k);</div>
<div class="line"><span class="lineno"> 3123</span>          Bzn.fetch(i_sal,j,k) -= gradPSIZ.get(i_sal,j,k);</div>
<div class="line"><span class="lineno"> 3124</span>        }</div>
<div class="line"><span class="lineno"> 3125</span>  }</div>
<div class="line"><span class="lineno"> 3126</span>  <span class="comment">// X=Lx boundary</span></div>
<div class="line"><span class="lineno"> 3127</span>  <span class="keywordflow">if</span>(vct-&gt;getXright_neighbor()==MPI_PROC_NULL &amp;&amp; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7d090b86a16ede7b0b8d4abec332e5b9">bcEMfaceXright</a> ==2) {</div>
<div class="line"><span class="lineno"> 3128</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_sal=0; i_sal&lt;3; i_sal++)</div>
<div class="line"><span class="lineno"> 3129</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3130</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 3131</span>          Bxn.fetch(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1-i_sal,j,k) -= gradPSIX.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1-i_sal,j,k);</div>
<div class="line"><span class="lineno"> 3132</span>          Byn.fetch(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1-i_sal,j,k) -= gradPSIY.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1-i_sal,j,k);</div>
<div class="line"><span class="lineno"> 3133</span>          Bzn.fetch(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1-i_sal,j,k) -= gradPSIZ.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1-i_sal,j,k);</div>
<div class="line"><span class="lineno"> 3134</span>        }</div>
<div class="line"><span class="lineno"> 3135</span>  }</div>
<div class="line"><span class="lineno"> 3136</span>  <span class="comment">// Y=0 boundary</span></div>
<div class="line"><span class="lineno"> 3137</span>  <span class="keywordflow">if</span>(vct-&gt;getYleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXleft ==2) {</div>
<div class="line"><span class="lineno"> 3138</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3139</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j_sal=0; j_sal &lt; n_layers; j_sal++)</div>
<div class="line"><span class="lineno"> 3140</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 3141</span>          Bxn.fetch(i,j_sal,k) -= gradPSIX.get(i,j_sal,k);</div>
<div class="line"><span class="lineno"> 3142</span>          Byn.fetch(i,j_sal,k) -= gradPSIY.get(i,j_sal,k);</div>
<div class="line"><span class="lineno"> 3143</span>          Bzn.fetch(i,j_sal,k) -= gradPSIZ.get(i,j_sal,k);</div>
<div class="line"><span class="lineno"> 3144</span>        }</div>
<div class="line"><span class="lineno"> 3145</span>  }</div>
<div class="line"><span class="lineno"> 3146</span>  <span class="comment">// Y=Ly boundary</span></div>
<div class="line"><span class="lineno"> 3147</span>  <span class="keywordflow">if</span>(vct-&gt;getYright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXleft ==2) {</div>
<div class="line"><span class="lineno"> 3148</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3149</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j_sal=0; j_sal &lt; n_layers; j_sal++)</div>
<div class="line"><span class="lineno"> 3150</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 3151</span>          Bxn.fetch(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1-j_sal,k) -= gradPSIX.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1-j_sal,k);</div>
<div class="line"><span class="lineno"> 3152</span>          Byn.fetch(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1-j_sal,k) -= gradPSIY.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1-j_sal,k);</div>
<div class="line"><span class="lineno"> 3153</span>          Bzn.fetch(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1-j_sal,k) -= gradPSIZ.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1-j_sal,k);</div>
<div class="line"><span class="lineno"> 3154</span>        }</div>
<div class="line"><span class="lineno"> 3155</span>  }</div>
<div class="line"><span class="lineno"> 3156</span>  <span class="comment">// Z=0 boundary</span></div>
<div class="line"><span class="lineno"> 3157</span>  <span class="keywordflow">if</span>(vct-&gt;getZleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXleft ==2) {</div>
<div class="line"><span class="lineno"> 3158</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3159</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3160</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k_sal=0; k_sal &lt; n_layers; k_sal++){</div>
<div class="line"><span class="lineno"> 3161</span>          Bxn.fetch(i,j,k_sal) -= gradPSIX.get(i,j,k_sal);</div>
<div class="line"><span class="lineno"> 3162</span>          Byn.fetch(i,j,k_sal) -= gradPSIY.get(i,j,k_sal);</div>
<div class="line"><span class="lineno"> 3163</span>          Bzn.fetch(i,j,k_sal) -= gradPSIZ.get(i,j,k_sal);</div>
<div class="line"><span class="lineno"> 3164</span>        }</div>
<div class="line"><span class="lineno"> 3165</span>  }</div>
<div class="line"><span class="lineno"> 3166</span>  <span class="comment">// Z=Lz boundary</span></div>
<div class="line"><span class="lineno"> 3167</span>  <span class="keywordflow">if</span>(vct-&gt;getZright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXleft ==2) {</div>
<div class="line"><span class="lineno"> 3168</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3169</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3170</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k_sal=0; k_sal &lt; n_layers; k_sal++){</div>
<div class="line"><span class="lineno"> 3171</span>          Bxn.fetch(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1-k_sal) -= gradPSIX.get(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1-k_sal);</div>
<div class="line"><span class="lineno"> 3172</span>          Byn.fetch(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1-k_sal) -= gradPSIY.get(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1-k_sal);</div>
<div class="line"><span class="lineno"> 3173</span>          Bzn.fetch(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1-k_sal) -= gradPSIZ.get(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1-k_sal);</div>
<div class="line"><span class="lineno"> 3174</span>        }</div>
<div class="line"><span class="lineno"> 3175</span>  }</div>
<div class="line"><span class="lineno"> 3176</span>  <span class="comment">// END</span></div>
<div class="line"><span class="lineno"> 3177</span> </div>
<div class="line"><span class="lineno"> 3178</span>  <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 3179</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bxn, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3180</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Byn, col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3181</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bzn, col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3182</span>  </div>
<div class="line"><span class="lineno"> 3183</span>  <span class="comment">// correct B on centers</span></div>
<div class="line"><span class="lineno"> 3184</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bxc, Bxn);</div>
<div class="line"><span class="lineno"> 3185</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Byc, Byn);</div>
<div class="line"><span class="lineno"> 3186</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bzc, Bzn);</div>
<div class="line"><span class="lineno"> 3187</span> </div>
<div class="line"><span class="lineno"> 3188</span>  <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 3189</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bxc, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3190</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Byc, col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3191</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bzc, col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3192</span> </div>
<div class="line"><span class="lineno"> 3193</span>}</div>
<div class="ttc" id="aclass_collective_html"><div class="ttname"><a href="../../db/dfb/class_collective.html">Collective</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d51/_collective_8h_source.html#l00039">Collective.h:40</a></div></div>
<div class="ttc" id="aclass_collective_html_adfaa62249e560c3afb2c73ac9e33f494"><div class="ttname"><a href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">Collective::bcBx</a></div><div class="ttdeci">int bcBx[6]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d51/_collective_8h_source.html#l00209">Collective.h:209</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a9d3ddfa82333c03d79211c94cf7d7df9"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a9d3ddfa82333c03d79211c94cf7d7df9">EMfields3D::PoissonImage</a></div><div class="ttdeci">void PoissonImage(double *image, double *vector)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03319">EMfields3D.cpp:3319</a></div></div>
<div class="ttc" id="aclass_grid3_d_c_u_html"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html">Grid3DCU</a></div><div class="ttdoc">Uniform cartesian local grid 3D.</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de0/_grid3_d_c_u_8h_source.html#l00044">Grid3DCU.h:45</a></div></div>
<div class="ttc" id="aclass_grid3_d_c_u_html_a23706ff7359753cd045a182fb8d20f80"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html#a23706ff7359753cd045a182fb8d20f80">Grid3DCU::gradC2N</a></div><div class="ttdeci">void gradC2N(arr3_double gradXN, arr3_double gradYN, arr3_double gradZN, const_arr3_double scFieldC) const</div><div class="ttdoc">calculate a derivative along a direction on nodes</div></div>
<div class="ttc" id="aclass_grid3_d_c_u_html_ab4602ae1c61cbc7cbfa73bd882bb73bd"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html#ab4602ae1c61cbc7cbfa73bd882bb73bd">Grid3DCU::interpC2N</a></div><div class="ttdeci">void interpC2N(arr3_double vecFieldN, const_arr3_double vecFieldC) const</div><div class="ttdoc">interpolate on nodes from central points</div></div>
<div class="ttc" id="aclass_grid3_d_c_u_html_ac51689b8665db17f2edb6837e41482fa"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html#ac51689b8665db17f2edb6837e41482fa">Grid3DCU::curlN2C</a></div><div class="ttdeci">void curlN2C(arr3_double curlXC, arr3_double curlYC, arr3_double curlZC, const_arr3_double vecFieldXN, const_arr3_double vecFieldYN, const_arr3_double vecFieldZN) const</div><div class="ttdoc">calculate curl on central points, given a vector field defined on nodes</div></div>
<div class="ttc" id="aclass_grid3_d_c_u_html_afe24a532c0d6c1c357e74da6c97deddf"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html#afe24a532c0d6c1c357e74da6c97deddf">Grid3DCU::divN2C</a></div><div class="ttdeci">void divN2C(arr3_double divC, const_arr3_double vecFieldXN, const_arr3_double vecFieldYN, const_arr3_double vecFieldZN) const</div><div class="ttdoc">calculate divergence on central points, given a vector field defined on nodes</div></div>
<div class="ttc" id="astructi_pic3_d_1_1array3_html"><div class="ttname"><a href="../../d4/d57/structi_pic3_d_1_1array3.html">iPic3D::array3&lt; double &gt;</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/_collective_8h_source.html#l00209">Collective::bcBx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00546">bcEMfaceXright</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#ac51689b8665db17f2edb6837e41482fa">Grid3DCU::curlN2C()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#afe24a532c0d6c1c357e74da6c97deddf">Grid3DCU::divN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00568">GMREStol</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a23706ff7359753cd045a182fb8d20f80">Grid3DCU::gradC2N()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#ab4602ae1c61cbc7cbfa73bd882bb73bd">Grid3DCU::interpC2N()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03319">PoissonImage()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00404">PSI</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00439">tempXC</a>.</p>

</div>
</div>
<a id="ab040c0a52d8943d378d1aecc6c62c670" name="ab040c0a52d8943d378d1aecc6c62c670"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab040c0a52d8943d378d1aecc6c62c670">&#9670;&nbsp;</a></span>calculateE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::calculateE </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cycle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate Electric field using the implicit Maxwell solver</p>
<p >Calculate Electric field with the implicit solver: the Maxwell solver method is called here </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">2081</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2082</span>{</div>
<div class="line"><span class="lineno"> 2083</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 2084</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> * vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2085</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2086</span> </div>
<div class="line"><span class="lineno"> 2087</span>  <span class="keywordflow">if</span> (vct-&gt;getCartesian_rank() == 0)</div>
<div class="line"><span class="lineno"> 2088</span>    cout &lt;&lt; <span class="stringliteral">&quot;*** E CALCULATION ***&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2089</span> </div>
<div class="line"><span class="lineno"> 2090</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> divE     (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 2091</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> gradPHIX (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2092</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> gradPHIY (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2093</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> gradPHIZ (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2094</span> </div>
<div class="line"><span class="lineno"> 2095</span>  <span class="keywordtype">double</span> *xkrylov = <span class="keyword">new</span> <span class="keywordtype">double</span>[3 * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2)];  <span class="comment">// 3 E components</span></div>
<div class="line"><span class="lineno"> 2096</span>  <span class="keywordtype">double</span> *bkrylov = <span class="keyword">new</span> <span class="keywordtype">double</span>[3 * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2)];  <span class="comment">// 3 components</span></div>
<div class="line"><span class="lineno"> 2097</span>  <span class="comment">// set to zero all the stuff </span></div>
<div class="line"><span class="lineno"> 2098</span>  eqValue(0.0, xkrylov, 3 * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2));</div>
<div class="line"><span class="lineno"> 2099</span>  eqValue(0.0, bkrylov, 3 * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2));</div>
<div class="line"><span class="lineno"> 2100</span>  eqValue(0.0, divE, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 2101</span>  eqValue(0.0, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a46c3082575146e5975baaa9177284892">tempC</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 2102</span>  eqValue(0.0, gradPHIX, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2103</span>  eqValue(0.0, gradPHIY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2104</span>  eqValue(0.0, gradPHIZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2105</span>  <span class="comment">// Adjust E calculating laplacian(PHI) = div(E) -4*PI*rho DIVERGENCE CLEANING</span></div>
<div class="line"><span class="lineno"> 2106</span>  </div>
<div class="line"><span class="lineno"> 2107</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8ea9ae681b78a8067d4a753a486fa2fc">PoissonCorrection</a> &amp;&amp;  cycle%PoissonCorrectionCycle == 0) {</div>
<div class="line"><span class="lineno"> 2108</span>                <span class="keywordtype">double</span> *xkrylovPoisson = <span class="keyword">new</span> <span class="keywordtype">double</span>[(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a> - 2)];</div>
<div class="line"><span class="lineno"> 2109</span>                <span class="keywordtype">double</span> *bkrylovPoisson = <span class="keyword">new</span> <span class="keywordtype">double</span>[(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a> - 2)];</div>
<div class="line"><span class="lineno"> 2110</span>                eqValue(0.0, xkrylovPoisson, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a> - 2));</div>
<div class="line"><span class="lineno"> 2111</span> </div>
<div class="line"><span class="lineno"> 2112</span>                grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#afe24a532c0d6c1c357e74da6c97deddf">divN2C</a>(divE, Ex, Ey, Ez);</div>
<div class="line"><span class="lineno"> 2113</span>                scale(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a46c3082575146e5975baaa9177284892">tempC</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac592e12b7cc8428fecb8219e9ebe050d">rhoc</a>, -FourPI, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 2114</span>                sum(divE, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a46c3082575146e5975baaa9177284892">tempC</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 2115</span>                <span class="comment">// move to krylov space</span></div>
<div class="line"><span class="lineno"> 2116</span>                phys2solver(bkrylovPoisson, divE, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 2117</span>                <span class="comment">// use conjugate gradient first</span></div>
<div class="line"><span class="lineno"> 2118</span>                <span class="comment">//if (!CG(xkrylovPoisson, (nxc - 2) * (nyc - 2) * (nzc - 2), bkrylovPoisson, 3000, CGtol, &amp;Field::PoissonImage, this)) {</span></div>
<div class="line"><span class="lineno"> 2119</span>                          <span class="comment">//if (vct-&gt;getCartesian_rank() == 0)</span></div>
<div class="line"><span class="lineno"> 2120</span>                                        <span class="comment">//cout &lt;&lt; &quot;CG not Converged. Trying with GMRes. Consider to increase the number of the CG iterations&quot; &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 2121</span>                  <span class="comment">//eqValue(0.0, xkrylovPoisson, (nxc - 2) * (nyc - 2) * (nzc - 2));</span></div>
<div class="line"><span class="lineno"> 2122</span>                  <span class="keywordflow">if</span> (vct-&gt;getCartesian_rank() == 0) cout &lt;&lt; <span class="stringliteral">&quot;*** DIVERGENCE CLEANING div(E)=rho using GMRes***&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2123</span>                  GMRES(&amp;<a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a9d3ddfa82333c03d79211c94cf7d7df9">Field::PoissonImage</a>, xkrylovPoisson, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a> - 2), bkrylovPoisson, 20, 200, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a18f9fef7aa44de67fa3f9742d3bb8c0d">GMREStol</a>, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2124</span> </div>
<div class="line"><span class="lineno"> 2125</span>                <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 2126</span>                solver2phys(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a5f9d78fac6902b1ea3eaf5e298874768">PHI</a>, xkrylovPoisson, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 2127</span>                communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a5f9d78fac6902b1ea3eaf5e298874768">PHI</a>, 2, 2, 2, 2, 2, 2, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2128</span>                <span class="comment">// calculate the gradient</span></div>
<div class="line"><span class="lineno"> 2129</span>                grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a23706ff7359753cd045a182fb8d20f80">gradC2N</a>(gradPHIX, gradPHIY, gradPHIZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a5f9d78fac6902b1ea3eaf5e298874768">PHI</a>);</div>
<div class="line"><span class="lineno"> 2130</span>                <span class="comment">// sub</span></div>
<div class="line"><span class="lineno"> 2131</span>                sub(Ex, gradPHIX, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2132</span>                sub(Ey, gradPHIY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2133</span>                sub(Ez, gradPHIZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2134</span> </div>
<div class="line"><span class="lineno"> 2135</span>                <span class="keyword">delete</span>[]xkrylovPoisson;</div>
<div class="line"><span class="lineno"> 2136</span>                <span class="keyword">delete</span>[]bkrylovPoisson;</div>
<div class="line"><span class="lineno"> 2137</span>  }                             <span class="comment">// end of divergence cleaning</span></div>
<div class="line"><span class="lineno"> 2138</span>  </div>
<div class="line"><span class="lineno"> 2139</span>  <span class="keywordflow">if</span> (col-&gt;getVerbose() and vct-&gt;getCartesian_rank() == 0)</div>
<div class="line"><span class="lineno"> 2140</span>    cout &lt;&lt; <span class="stringliteral">&quot;*** MAXWELL SOLVER ***&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2141</span>  <span class="comment">// prepare the source </span></div>
<div class="line"><span class="lineno"> 2142</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a5575c54ce46a4de2975e662ae1cb5781">MaxwellSource</a>(bkrylov);</div>
<div class="line"><span class="lineno"> 2143</span>  phys2solver(xkrylov, Ex, Ey, Ez, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2144</span>  <span class="comment">// solver</span></div>
<div class="line"><span class="lineno"> 2145</span>  GMRES(&amp;<a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a0e27b63407e586437ede5e39d3e1a3d8">Field::MaxwellImage</a>, xkrylov, 3 * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2),</div>
<div class="line"><span class="lineno"> 2146</span>    bkrylov, 20, 200, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a18f9fef7aa44de67fa3f9742d3bb8c0d">GMREStol</a>, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2147</span>  <span class="comment">// move from krylov space to physical space</span></div>
<div class="line"><span class="lineno"> 2148</span> solver2phys(Exth, Eyth, Ezth, xkrylov, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2149</span> </div>
<div class="line"><span class="lineno"> 2150</span>  addscale(1 / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>, -(1.0 - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>, Ex, Exth, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2151</span>  addscale(1 / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>, -(1.0 - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>, Ey, Eyth, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2152</span>  addscale(1 / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>, -(1.0 - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>, Ez, Ezth, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2153</span> </div>
<div class="line"><span class="lineno"> 2154</span>  <span class="comment">// apply to smooth to electric field 3 times</span></div>
<div class="line"><span class="lineno"> 2155</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#af10bd0fe5aee301cee0cb9491df8f292">smoothE</a>();</div>
<div class="line"><span class="lineno"> 2156</span> </div>
<div class="line"><span class="lineno"> 2157</span>  <span class="comment">// communicate so the interpolation can have good values</span></div>
<div class="line"><span class="lineno"> 2158</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Exth, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2159</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Eyth, col-&gt;bcEy[0],col-&gt;bcEy[1],col-&gt;bcEy[2],col-&gt;bcEy[3],col-&gt;bcEy[4],col-&gt;bcEy[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2160</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ezth, col-&gt;bcEz[0],col-&gt;bcEz[1],col-&gt;bcEz[2],col-&gt;bcEz[3],col-&gt;bcEz[4],col-&gt;bcEz[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2161</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ex,   col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2162</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ey,   col-&gt;bcEy[0],col-&gt;bcEy[1],col-&gt;bcEy[2],col-&gt;bcEy[3],col-&gt;bcEy[4],col-&gt;bcEy[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2163</span>  communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ez,   col-&gt;bcEz[0],col-&gt;bcEz[1],col-&gt;bcEz[2],col-&gt;bcEz[3],col-&gt;bcEz[4],col-&gt;bcEz[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2164</span> </div>
<div class="line"><span class="lineno"> 2165</span>  <span class="comment">// OpenBC Inflow: this needs to be integrate to Halo Exchange BC</span></div>
<div class="line"><span class="lineno"> 2166</span>  OpenBoundaryInflowE(Exth, Eyth, Ezth, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2167</span>  OpenBoundaryInflowE(Ex, Ey, Ez, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2168</span> </div>
<div class="line"><span class="lineno"> 2169</span>  <span class="comment">// deallocate temporary arrays</span></div>
<div class="line"><span class="lineno"> 2170</span>  <span class="keyword">delete</span>[]xkrylov;</div>
<div class="line"><span class="lineno"> 2171</span>  <span class="keyword">delete</span>[]bkrylov;</div>
<div class="line"><span class="lineno"> 2172</span>}</div>
<div class="ttc" id="aclass_collective_html_a49752e6fdd19b493adc0bb3034bf4570"><div class="ttname"><a href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">Collective::bcEx</a></div><div class="ttdeci">int bcEx[6]</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d51/_collective_8h_source.html#l00207">Collective.h:207</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a0e27b63407e586437ede5e39d3e1a3d8"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a0e27b63407e586437ede5e39d3e1a3d8">EMfields3D::MaxwellImage</a></div><div class="ttdeci">void MaxwellImage(double *im, double *vector)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">EMfields3D.cpp:2333</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a5575c54ce46a4de2975e662ae1cb5781"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a5575c54ce46a4de2975e662ae1cb5781">EMfields3D::MaxwellSource</a></div><div class="ttdeci">void MaxwellSource(double *bkrylov)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">EMfields3D.cpp:2175</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_af10bd0fe5aee301cee0cb9491df8f292"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#af10bd0fe5aee301cee0cb9491df8f292">EMfields3D::smoothE</a></div><div class="ttdeci">void smoothE()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02529">EMfields3D.cpp:2529</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/_collective_8h_source.html#l00207">Collective::bcEx</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#afe24a532c0d6c1c357e74da6c97deddf">Grid3DCU::divN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00568">GMREStol</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a23706ff7359753cd045a182fb8d20f80">Grid3DCU::gradC2N()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00402">PHI</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00560">PoissonCorrection</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03319">PoissonImage()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00475">rhoc</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02529">smoothE()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00446">tempC</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00351">th</a>.</p>

</div>
</div>
<a id="a64e2a62e24f815702fc0f37229fdf0e2" name="a64e2a62e24f815702fc0f37229fdf0e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64e2a62e24f815702fc0f37229fdf0e2">&#9670;&nbsp;</a></span>calculateHatFunctions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::calculateHatFunctions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate rho hat, Jx hat, Jy hat, Jz hat</p>
<p >Calculate hat rho hat, Jx hat, Jy hat, Jz hat </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">3276</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3277</span>{</div>
<div class="line"><span class="lineno"> 3278</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3279</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3280</span>  <span class="comment">// smoothing</span></div>
<div class="line"><span class="lineno"> 3281</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#ace4a00624182f44875bbd400d5c15324">smooth</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac592e12b7cc8428fecb8219e9ebe050d">rhoc</a>, 0);</div>
<div class="line"><span class="lineno"> 3282</span>  <span class="comment">// calculate j hat</span></div>
<div class="line"><span class="lineno"> 3283</span> </div>
<div class="line"><span class="lineno"> 3284</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 3285</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#acdd88bc84fd6cc2e9998eb7f2e62edb2">divSymmTensorN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>, tempYC, tempZC, pXXsn, pXYsn, pXZsn, pYYsn, pYZsn, pZZsn, is);</div>
<div class="line"><span class="lineno"> 3286</span> </div>
<div class="line"><span class="lineno"> 3287</span>    scale(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>, -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / 2.0, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3288</span>    scale(tempYC, -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / 2.0, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3289</span>    scale(tempZC, -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / 2.0, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3290</span>    <span class="comment">// communicate before interpolating</span></div>
<div class="line"><span class="lineno"> 3291</span>    communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3292</span>    communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, tempYC, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3293</span>    communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, tempZC, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3294</span> </div>
<div class="line"><span class="lineno"> 3295</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#ab4602ae1c61cbc7cbfa73bd882bb73bd">interpC2N</a>(tempXN, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>);</div>
<div class="line"><span class="lineno"> 3296</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#ab4602ae1c61cbc7cbfa73bd882bb73bd">interpC2N</a>(tempYN, tempYC);</div>
<div class="line"><span class="lineno"> 3297</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#ab4602ae1c61cbc7cbfa73bd882bb73bd">interpC2N</a>(tempZN, tempZC);</div>
<div class="line"><span class="lineno"> 3298</span>    sum(tempXN, Jxs, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, is);</div>
<div class="line"><span class="lineno"> 3299</span>    sum(tempYN, Jys, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, is);</div>
<div class="line"><span class="lineno"> 3300</span>    sum(tempZN, Jzs, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, is);</div>
<div class="line"><span class="lineno"> 3301</span>    <span class="comment">// PIDOT</span></div>
<div class="line"><span class="lineno"> 3302</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a892a9c1f5511092fbd32ac283fcbc6c1">PIdot</a>(Jxh, Jyh, Jzh, tempXN, tempYN, tempZN, is);</div>
<div class="line"><span class="lineno"> 3303</span> </div>
<div class="line"><span class="lineno"> 3304</span>  }</div>
<div class="line"><span class="lineno"> 3305</span>  <span class="comment">// smooth j</span></div>
<div class="line"><span class="lineno"> 3306</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#ace4a00624182f44875bbd400d5c15324">smooth</a>(Jxh, 1);</div>
<div class="line"><span class="lineno"> 3307</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#ace4a00624182f44875bbd400d5c15324">smooth</a>(Jyh, 1);</div>
<div class="line"><span class="lineno"> 3308</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#ace4a00624182f44875bbd400d5c15324">smooth</a>(Jzh, 1);</div>
<div class="line"><span class="lineno"> 3309</span> </div>
<div class="line"><span class="lineno"> 3310</span>  <span class="comment">// calculate rho hat = rho - (dt*theta)div(jhat)</span></div>
<div class="line"><span class="lineno"> 3311</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#afe24a532c0d6c1c357e74da6c97deddf">divN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>, Jxh, Jyh, Jzh);</div>
<div class="line"><span class="lineno"> 3312</span>  scale(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>, -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3313</span>  sum(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac592e12b7cc8428fecb8219e9ebe050d">rhoc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3314</span>  eq(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a43d562d551ea0f165362c5679bbba07b">rhoh</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#acb425fcde45789639ababbe2d847d059">tempXC</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3315</span>  <span class="comment">// communicate rhoh</span></div>
<div class="line"><span class="lineno"> 3316</span>  communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a43d562d551ea0f165362c5679bbba07b">rhoh</a>, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3317</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a892a9c1f5511092fbd32ac283fcbc6c1"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a892a9c1f5511092fbd32ac283fcbc6c1">EMfields3D::PIdot</a></div><div class="ttdeci">void PIdot(arr3_double PIdotX, arr3_double PIdotY, arr3_double PIdotZ, const_arr3_double vectX, const_arr3_double vectY, const_arr3_double vectZ, int ns)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">EMfields3D.cpp:2422</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_ace4a00624182f44875bbd400d5c15324"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#ace4a00624182f44875bbd400d5c15324">EMfields3D::smooth</a></div><div class="ttdeci">void smooth(arr3_double vector, int type)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02470">EMfields3D.cpp:2470</a></div></div>
<div class="ttc" id="aclass_grid3_d_c_u_html_acdd88bc84fd6cc2e9998eb7f2e62edb2"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html#acdd88bc84fd6cc2e9998eb7f2e62edb2">Grid3DCU::divSymmTensorN2C</a></div><div class="ttdeci">void divSymmTensorN2C(arr3_double divCX, arr3_double divCY, arr3_double divCZ, const_arr4_double pXX, const_arr4_double pXY, const_arr4_double pXZ, const_arr4_double pYY, const_arr4_double pYZ, const_arr4_double pZZ, int ns) const</div><div class="ttdoc">calculate divergence on central points, given a Tensor field defined on nodes</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#afe24a532c0d6c1c357e74da6c97deddf">Grid3DCU::divN2C()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#acdd88bc84fd6cc2e9998eb7f2e62edb2">Grid3DCU::divSymmTensorN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#ab4602ae1c61cbc7cbfa73bd882bb73bd">Grid3DCU::interpC2N()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">PIdot()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00475">rhoc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00479">rhoh</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02470">smooth()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00439">tempXC</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00351">th</a>.</p>

</div>
</div>
<a id="a9f7cfc31e795a75ecaad608f6cb8df25" name="a9f7cfc31e795a75ecaad608f6cb8df25"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f7cfc31e795a75ecaad608f6cb8df25">&#9670;&nbsp;</a></span>communicateGhostP2G()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::communicateGhostP2G </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ns</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >communicate ghost for grid -&gt; Particles interpolation </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03344">3344</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3345</span>{</div>
<div class="line"><span class="lineno"> 3346</span>  <span class="comment">// interpolate adding common nodes among processors</span></div>
<div class="line"><span class="lineno"> 3347</span>  timeTasks_set_communicating();</div>
<div class="line"><span class="lineno"> 3348</span> </div>
<div class="line"><span class="lineno"> 3349</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3350</span> </div>
<div class="line"><span class="lineno"> 3351</span>  <span class="keywordtype">double</span> ***moment0 = convert_to_arr3(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3352</span>  <span class="keywordtype">double</span> ***moment1 = convert_to_arr3(Jxs  [<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3353</span>  <span class="keywordtype">double</span> ***moment2 = convert_to_arr3(Jys  [<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3354</span>  <span class="keywordtype">double</span> ***moment3 = convert_to_arr3(Jzs  [<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3355</span>  <span class="keywordtype">double</span> ***moment4 = convert_to_arr3(pXXsn[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3356</span>  <span class="keywordtype">double</span> ***moment5 = convert_to_arr3(pXYsn[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3357</span>  <span class="keywordtype">double</span> ***moment6 = convert_to_arr3(pXZsn[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3358</span>  <span class="keywordtype">double</span> ***moment7 = convert_to_arr3(pYYsn[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3359</span>  <span class="keywordtype">double</span> ***moment8 = convert_to_arr3(pYZsn[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3360</span>  <span class="keywordtype">double</span> ***moment9 = convert_to_arr3(pZZsn[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>]);</div>
<div class="line"><span class="lineno"> 3361</span>  <span class="comment">// add the values for the shared nodes</span></div>
<div class="line"><span class="lineno"> 3362</span> </div>
<div class="line"><span class="lineno"> 3363</span>  <span class="comment">// Call NonBlocking Halo Exchange + Interpolation</span></div>
<div class="line"><span class="lineno"> 3364</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment0, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3365</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment1, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3366</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment2, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3367</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment3, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3368</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment4, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3369</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment5, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3370</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment6, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3371</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment7, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3372</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment8, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3373</span>  communicateInterp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment9, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3374</span>  <span class="comment">// calculate the correct densities on the boundaries</span></div>
<div class="line"><span class="lineno"> 3375</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a3ba145a878a26b59fb5405da269449d1">adjustNonPeriodicDensities</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>);</div>
<div class="line"><span class="lineno"> 3376</span> </div>
<div class="line"><span class="lineno"> 3377</span>  <span class="comment">// populate the ghost nodes</span></div>
<div class="line"><span class="lineno"> 3378</span> </div>
<div class="line"><span class="lineno"> 3379</span>  <span class="comment">//Call Nonblocking Halo Exchange</span></div>
<div class="line"><span class="lineno"> 3380</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment0, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3381</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment1, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3382</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3383</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment3, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3384</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment4, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3385</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment5, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3386</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment6, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3387</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment7, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3388</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment8, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3389</span>  communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment9, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3390</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a3ba145a878a26b59fb5405da269449d1"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a3ba145a878a26b59fb5405da269449d1">EMfields3D::adjustNonPeriodicDensities</a></div><div class="ttdeci">void adjustNonPeriodicDensities(int is)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02699">EMfields3D.cpp:2699</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02699">adjustNonPeriodicDensities()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">sumMoments()</a>.</p>

</div>
</div>
<a id="a40a106fb1177412f3b42fd2c9c5a59de" name="a40a106fb1177412f3b42fd2c9c5a59de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40a106fb1177412f3b42fd2c9c5a59de">&#9670;&nbsp;</a></span>ConstantChargeOpenBC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::ConstantChargeOpenBC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Impose a constant charge in the OpenBC boundaries </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02879">2879</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2880</span>{</div>
<div class="line"><span class="lineno"> 2881</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2882</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2883</span> </div>
<div class="line"><span class="lineno"> 2884</span>  <span class="keywordtype">double</span> ff;</div>
<div class="line"><span class="lineno"> 2885</span> </div>
<div class="line"><span class="lineno"> 2886</span>  <span class="keywordtype">int</span> nx = grid-&gt;getNXN();</div>
<div class="line"><span class="lineno"> 2887</span>  <span class="keywordtype">int</span> ny = grid-&gt;getNYN();</div>
<div class="line"><span class="lineno"> 2888</span>  <span class="keywordtype">int</span> nz = grid-&gt;getNZN();</div>
<div class="line"><span class="lineno"> 2889</span> </div>
<div class="line"><span class="lineno"> 2890</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 2891</span> </div>
<div class="line"><span class="lineno"> 2892</span>    ff = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is]/fabs(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is]);</div>
<div class="line"><span class="lineno"> 2893</span> </div>
<div class="line"><span class="lineno"> 2894</span>    <span class="keywordflow">if</span>(vct-&gt;getXleft_neighbor()==MPI_PROC_NULL &amp;&amp; (bcEMfaceXleft ==2)) {</div>
<div class="line"><span class="lineno"> 2895</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; ny;j++)</div>
<div class="line"><span class="lineno"> 2896</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; nz;k++){</div>
<div class="line"><span class="lineno"> 2897</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][0][j][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2898</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][1][j][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2899</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][2][j][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2900</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][3][j][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2901</span>        }</div>
<div class="line"><span class="lineno"> 2902</span>    }</div>
<div class="line"><span class="lineno"> 2903</span> </div>
<div class="line"><span class="lineno"> 2904</span>    <span class="keywordflow">if</span>(vct-&gt;getXright_neighbor()==MPI_PROC_NULL &amp;&amp; (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7d090b86a16ede7b0b8d4abec332e5b9">bcEMfaceXright</a> ==2)) {</div>
<div class="line"><span class="lineno"> 2905</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; ny;j++)</div>
<div class="line"><span class="lineno"> 2906</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; nz;k++){</div>
<div class="line"><span class="lineno"> 2907</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-4][j][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2908</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-3][j][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2909</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-2][j][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2910</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-1][j][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2911</span>        }</div>
<div class="line"><span class="lineno"> 2912</span>    }</div>
<div class="line"><span class="lineno"> 2913</span> </div>
<div class="line"><span class="lineno"> 2914</span>    <span class="keywordflow">if</span>(vct-&gt;getYleft_neighbor()==MPI_PROC_NULL &amp;&amp; (bcEMfaceYleft ==2))  {</div>
<div class="line"><span class="lineno"> 2915</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nx;i++)</div>
<div class="line"><span class="lineno"> 2916</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; nz;k++){</div>
<div class="line"><span class="lineno"> 2917</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][0][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2918</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][1][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2919</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][2][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2920</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][3][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2921</span>        }</div>
<div class="line"><span class="lineno"> 2922</span>    }</div>
<div class="line"><span class="lineno"> 2923</span> </div>
<div class="line"><span class="lineno"> 2924</span>    <span class="keywordflow">if</span>(vct-&gt;getYright_neighbor()==MPI_PROC_NULL &amp;&amp; (bcEMfaceYright ==2))  {</div>
<div class="line"><span class="lineno"> 2925</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nx;i++)</div>
<div class="line"><span class="lineno"> 2926</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; nz;k++){</div>
<div class="line"><span class="lineno"> 2927</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-4][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2928</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-3][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2929</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-2][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2930</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-1][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2931</span>        }</div>
<div class="line"><span class="lineno"> 2932</span>    }</div>
<div class="line"><span class="lineno"> 2933</span> </div>
<div class="line"><span class="lineno"> 2934</span>    <span class="keywordflow">if</span>(vct-&gt;getZleft_neighbor()==MPI_PROC_NULL &amp;&amp; (bcEMfaceZleft ==2))  {</div>
<div class="line"><span class="lineno"> 2935</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nx;i++)</div>
<div class="line"><span class="lineno"> 2936</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; ny;j++){</div>
<div class="line"><span class="lineno"> 2937</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][0] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2938</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][1] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2939</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][2] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2940</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][3] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2941</span>        }</div>
<div class="line"><span class="lineno"> 2942</span>    }</div>
<div class="line"><span class="lineno"> 2943</span> </div>
<div class="line"><span class="lineno"> 2944</span> </div>
<div class="line"><span class="lineno"> 2945</span>    <span class="keywordflow">if</span>(vct-&gt;getZright_neighbor()==MPI_PROC_NULL &amp;&amp; (bcEMfaceZright ==2))  {</div>
<div class="line"><span class="lineno"> 2946</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nx;i++)</div>
<div class="line"><span class="lineno"> 2947</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; ny;j++){</div>
<div class="line"><span class="lineno"> 2948</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-4] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2949</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-3] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2950</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-2] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2951</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-1] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 2952</span>        }</div>
<div class="line"><span class="lineno"> 2953</span>    }</div>
<div class="line"><span class="lineno"> 2954</span>  }</div>
<div class="line"><span class="lineno"> 2955</span> </div>
<div class="line"><span class="lineno"> 2956</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00546">bcEMfaceXright</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="a00bfc9a649ed9ceec05a26e778bb54dd" name="a00bfc9a649ed9ceec05a26e778bb54dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00bfc9a649ed9ceec05a26e778bb54dd">&#9670;&nbsp;</a></span>ConstantChargeOpenBCv2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::ConstantChargeOpenBCv2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Impose a constant charge in the OpenBC boundaries </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02800">2800</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2801</span>{</div>
<div class="line"><span class="lineno"> 2802</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2803</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2804</span> </div>
<div class="line"><span class="lineno"> 2805</span>  <span class="keywordtype">double</span> ff;</div>
<div class="line"><span class="lineno"> 2806</span> </div>
<div class="line"><span class="lineno"> 2807</span>  <span class="keywordtype">int</span> nx = grid-&gt;getNXN();</div>
<div class="line"><span class="lineno"> 2808</span>  <span class="keywordtype">int</span> ny = grid-&gt;getNYN();</div>
<div class="line"><span class="lineno"> 2809</span>  <span class="keywordtype">int</span> nz = grid-&gt;getNZN();</div>
<div class="line"><span class="lineno"> 2810</span> </div>
<div class="line"><span class="lineno"> 2811</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 2812</span> </div>
<div class="line"><span class="lineno"> 2813</span>        ff = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is]/fabs(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is]);</div>
<div class="line"><span class="lineno"> 2814</span> </div>
<div class="line"><span class="lineno"> 2815</span>    <span class="keywordflow">if</span>(vct-&gt;getXleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXleft ==2) {</div>
<div class="line"><span class="lineno"> 2816</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; ny;j++)</div>
<div class="line"><span class="lineno"> 2817</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; nz;k++){</div>
<div class="line"><span class="lineno"> 2818</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][0][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][4][j][k];</div>
<div class="line"><span class="lineno"> 2819</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][1][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][4][j][k];</div>
<div class="line"><span class="lineno"> 2820</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][2][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][4][j][k];</div>
<div class="line"><span class="lineno"> 2821</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][3][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][4][j][k];</div>
<div class="line"><span class="lineno"> 2822</span>        }</div>
<div class="line"><span class="lineno"> 2823</span>    }</div>
<div class="line"><span class="lineno"> 2824</span> </div>
<div class="line"><span class="lineno"> 2825</span>    <span class="keywordflow">if</span>(vct-&gt;getXright_neighbor()==MPI_PROC_NULL &amp;&amp; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7d090b86a16ede7b0b8d4abec332e5b9">bcEMfaceXright</a> ==2) {</div>
<div class="line"><span class="lineno"> 2826</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; ny;j++)</div>
<div class="line"><span class="lineno"> 2827</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; nz;k++){</div>
<div class="line"><span class="lineno"> 2828</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-4][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-5][j][k];</div>
<div class="line"><span class="lineno"> 2829</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-3][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-5][j][k];</div>
<div class="line"><span class="lineno"> 2830</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-2][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-5][j][k];</div>
<div class="line"><span class="lineno"> 2831</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-1][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx-5][j][k];</div>
<div class="line"><span class="lineno"> 2832</span>        }</div>
<div class="line"><span class="lineno"> 2833</span>    }</div>
<div class="line"><span class="lineno"> 2834</span> </div>
<div class="line"><span class="lineno"> 2835</span>    <span class="keywordflow">if</span>(vct-&gt;getYleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYleft ==2)  {</div>
<div class="line"><span class="lineno"> 2836</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nx;i++)</div>
<div class="line"><span class="lineno"> 2837</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; nz;k++){</div>
<div class="line"><span class="lineno"> 2838</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][0][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][4][k];</div>
<div class="line"><span class="lineno"> 2839</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][1][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][4][k];</div>
<div class="line"><span class="lineno"> 2840</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][2][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][4][k];</div>
<div class="line"><span class="lineno"> 2841</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][3][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][4][k];</div>
<div class="line"><span class="lineno"> 2842</span>        }</div>
<div class="line"><span class="lineno"> 2843</span>    }</div>
<div class="line"><span class="lineno"> 2844</span> </div>
<div class="line"><span class="lineno"> 2845</span>    <span class="keywordflow">if</span>(vct-&gt;getYright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYright ==2)  {</div>
<div class="line"><span class="lineno"> 2846</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nx;i++)</div>
<div class="line"><span class="lineno"> 2847</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; nz;k++){</div>
<div class="line"><span class="lineno"> 2848</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-4][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-5][k];</div>
<div class="line"><span class="lineno"> 2849</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-3][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-5][k];</div>
<div class="line"><span class="lineno"> 2850</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-2][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-5][k];</div>
<div class="line"><span class="lineno"> 2851</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-1][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][ny-5][k];</div>
<div class="line"><span class="lineno"> 2852</span>        }</div>
<div class="line"><span class="lineno"> 2853</span>    }</div>
<div class="line"><span class="lineno"> 2854</span> </div>
<div class="line"><span class="lineno"> 2855</span>    <span class="keywordflow">if</span>(vct-&gt;getZleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZleft ==2)  {</div>
<div class="line"><span class="lineno"> 2856</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nx;i++)</div>
<div class="line"><span class="lineno"> 2857</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; ny;j++){</div>
<div class="line"><span class="lineno"> 2858</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][0] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][4];</div>
<div class="line"><span class="lineno"> 2859</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][1] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][4];</div>
<div class="line"><span class="lineno"> 2860</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][2] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][4];</div>
<div class="line"><span class="lineno"> 2861</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][3] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][4];</div>
<div class="line"><span class="lineno"> 2862</span>        }</div>
<div class="line"><span class="lineno"> 2863</span>    }</div>
<div class="line"><span class="lineno"> 2864</span> </div>
<div class="line"><span class="lineno"> 2865</span> </div>
<div class="line"><span class="lineno"> 2866</span>    <span class="keywordflow">if</span>(vct-&gt;getZright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZright ==2)  {</div>
<div class="line"><span class="lineno"> 2867</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; nx;i++)</div>
<div class="line"><span class="lineno"> 2868</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; ny;j++){</div>
<div class="line"><span class="lineno"> 2869</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-4] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-5];</div>
<div class="line"><span class="lineno"> 2870</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-3] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-5];</div>
<div class="line"><span class="lineno"> 2871</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-2] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-5];</div>
<div class="line"><span class="lineno"> 2872</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-1] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][nz-5];</div>
<div class="line"><span class="lineno"> 2873</span>        }</div>
<div class="line"><span class="lineno"> 2874</span>    }</div>
<div class="line"><span class="lineno"> 2875</span>  }</div>
<div class="line"><span class="lineno"> 2876</span> </div>
<div class="line"><span class="lineno"> 2877</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00546">bcEMfaceXright</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="aa3cdcba848fb0b5ee0dc6f6476e37398" name="aa3cdcba848fb0b5ee0dc6f6476e37398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3cdcba848fb0b5ee0dc6f6476e37398">&#9670;&nbsp;</a></span>ConstantChargePlanet()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::ConstantChargePlanet </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x_center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y_center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z_center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Impose a constant charge inside a spherical zone of the domain </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">2960</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2962</span>{</div>
<div class="line"><span class="lineno"> 2963</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2964</span> </div>
<div class="line"><span class="lineno"> 2965</span>  <span class="keywordtype">double</span> xd;</div>
<div class="line"><span class="lineno"> 2966</span>  <span class="keywordtype">double</span> yd;</div>
<div class="line"><span class="lineno"> 2967</span>  <span class="keywordtype">double</span> zd;</div>
<div class="line"><span class="lineno"> 2968</span>  <span class="keywordtype">double</span> ff;</div>
<div class="line"><span class="lineno"> 2969</span> </div>
<div class="line"><span class="lineno"> 2970</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++) </div>
<div class="line"><span class="lineno"> 2971</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++) </div>
<div class="line"><span class="lineno"> 2972</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 2973</span> </div>
<div class="line"><span class="lineno"> 2974</span>        xd = grid-&gt;getXN(i,j,k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>;</div>
<div class="line"><span class="lineno"> 2975</span>        yd = grid-&gt;getYN(i,j,k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a>;</div>
<div class="line"><span class="lineno"> 2976</span>        zd = grid-&gt;getZN(i,j,k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a> - PlanetOffset;</div>
<div class="line"><span class="lineno"> 2977</span> </div>
<div class="line"><span class="lineno"> 2978</span>        <span class="keywordflow">if</span> ((xd*xd+yd*yd+zd*zd) &lt;= (R*R) ){</div>
<div class="line"><span class="lineno"> 2979</span>          </div>
<div class="line"><span class="lineno"> 2980</span>          <span class="comment">//Ex[i][j][k]=0.;</span></div>
<div class="line"><span class="lineno"> 2981</span>          <span class="comment">//Ey[i][j][k]=0.;</span></div>
<div class="line"><span class="lineno"> 2982</span>          <span class="comment">//Ez[i][j][k]=0.;</span></div>
<div class="line"><span class="lineno"> 2983</span>        </div>
<div class="line"><span class="lineno"> 2984</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 2985</span>            ff = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is]/fabs(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is]);</div>
<div class="line"><span class="lineno"> 2986</span>            <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = 0.; <span class="comment">//ff * rhoINIT[is] / FourPI;</span></div>
<div class="line"><span class="lineno"> 2987</span>          }</div>
<div class="line"><span class="lineno"> 2988</span> </div>
<div class="line"><span class="lineno"> 2989</span>        } </div>
<div class="line"><span class="lineno"> 2990</span>      }</div>
<div class="line"><span class="lineno"> 2991</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00393">x_center</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00395">y_center</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00397">z_center</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>.</p>

</div>
</div>
<a id="a2e69bff1e74eb6814b180556575ebdbf" name="a2e69bff1e74eb6814b180556575ebdbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e69bff1e74eb6814b180556575ebdbf">&#9670;&nbsp;</a></span>ConstantChargePlanet2DPlaneXZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::ConstantChargePlanet2DPlaneXZ </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x_center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z_center</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02994">2994</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2995</span>{</div>
<div class="line"><span class="lineno"> 2996</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2997</span>  </div>
<div class="line"><span class="lineno"> 2998</span>  assert_eq(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,4);</div>
<div class="line"><span class="lineno"> 2999</span>  <span class="keywordtype">double</span> xd;</div>
<div class="line"><span class="lineno"> 3000</span>  <span class="keywordtype">double</span> zd;</div>
<div class="line"><span class="lineno"> 3001</span>  <span class="keywordtype">double</span> ff;</div>
<div class="line"><span class="lineno"> 3002</span> </div>
<div class="line"><span class="lineno"> 3003</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3004</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 3005</span> </div>
<div class="line"><span class="lineno"> 3006</span>      xd = grid-&gt;getXN(i,1,k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>;</div>
<div class="line"><span class="lineno"> 3007</span>      zd = grid-&gt;getZN(i,1,k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>;</div>
<div class="line"><span class="lineno"> 3008</span>  </div>
<div class="line"><span class="lineno"> 3009</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 3010</span>        ff = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is]/fabs(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is]);</div>
<div class="line"><span class="lineno"> 3011</span>        <span class="keywordflow">if</span> ((xd*xd+zd*zd) &lt;= R*R) {</div>
<div class="line"><span class="lineno"> 3012</span>            <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][1][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 3013</span>            <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][2][k] = ff * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 3014</span>        }</div>
<div class="line"><span class="lineno"> 3015</span>      }</div>
<div class="line"><span class="lineno"> 3016</span>    }</div>
<div class="line"><span class="lineno"> 3017</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a497e6c49c5f051a364eb1c0972e215df" name="a497e6c49c5f051a364eb1c0972e215df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a497e6c49c5f051a364eb1c0972e215df">&#9670;&nbsp;</a></span>fetch_moments10Array()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d1c/class_moments10.html">Moments10</a> &amp; EMfields3D::fetch_moments10Array </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >fetch array for summing moments of thread i </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00296">296</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  296</span>                                          {</div>
<div class="line"><span class="lineno">  297</span>      assert_le(0,i);</div>
<div class="line"><span class="lineno">  298</span>      assert_lt(i,sizeMomentsArray);</div>
<div class="line"><span class="lineno">  299</span>      <span class="keywordflow">return</span> *(moments10Array[i]);</div>
<div class="line"><span class="lineno">  300</span>    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">sumMoments()</a>.</p>

</div>
</div>
<a id="a690aae651b816a0c73795a2c8ad35b0e" name="a690aae651b816a0c73795a2c8ad35b0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a690aae651b816a0c73795a2c8ad35b0e">&#9670;&nbsp;</a></span>fixBcGEM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::fixBcGEM </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >fix B on the boundary for gem challange</p>
<p >fix the B boundary when running gem , This assume non-periodic condition on Y dimension </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02603">2603</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2604</span>{</div>
<div class="line"><span class="lineno"> 2605</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2606</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2607</span> </div>
<div class="line"><span class="lineno"> 2608</span>  <span class="keywordflow">if</span> (vct-&gt;getYright_neighbor() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2609</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 2610</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 2611</span>        Bxc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYC(i, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2612</span>        Bxc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2][k] = Bxc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1][k];</div>
<div class="line"><span class="lineno"> 2613</span>        Bxc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 3][k] = Bxc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1][k];</div>
<div class="line"><span class="lineno"> 2614</span>        Byc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1][k] = B0y;</div>
<div class="line"><span class="lineno"> 2615</span>        Bzc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1][k] = B0z;</div>
<div class="line"><span class="lineno"> 2616</span>        Bzc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2][k] = B0z;</div>
<div class="line"><span class="lineno"> 2617</span>        Bzc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 3][k] = B0z;</div>
<div class="line"><span class="lineno"> 2618</span>      }</div>
<div class="line"><span class="lineno"> 2619</span>  }</div>
<div class="line"><span class="lineno"> 2620</span>  <span class="keywordflow">if</span> (vct-&gt;getYleft_neighbor() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2621</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 2622</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 2623</span>        Bxc[i][0][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYC(i, 0, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2624</span>        Bxc[i][1][k] = Bxc[i][0][k];</div>
<div class="line"><span class="lineno"> 2625</span>        Bxc[i][2][k] = Bxc[i][0][k];</div>
<div class="line"><span class="lineno"> 2626</span>        Byc[i][0][k] = B0y;</div>
<div class="line"><span class="lineno"> 2627</span>        Bzc[i][0][k] = B0z;</div>
<div class="line"><span class="lineno"> 2628</span>        Bzc[i][1][k] = B0z;</div>
<div class="line"><span class="lineno"> 2629</span>        Bzc[i][2][k] = B0z;</div>
<div class="line"><span class="lineno"> 2630</span>      }</div>
<div class="line"><span class="lineno"> 2631</span>  }</div>
<div class="line"><span class="lineno"> 2632</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">Ly</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>.</p>

</div>
</div>
<a id="aaeaa9263ae0772c0b3a589e268f42684" name="aaeaa9263ae0772c0b3a589e268f42684"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeaa9263ae0772c0b3a589e268f42684">&#9670;&nbsp;</a></span>fixBforcefree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::fixBforcefree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >fix B on the boundary for gem challange</p>
<p >fix the B boundary when running forcefree </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02666">2666</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2667</span>{</div>
<div class="line"><span class="lineno"> 2668</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2669</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2670</span> </div>
<div class="line"><span class="lineno"> 2671</span>  <span class="keywordflow">if</span> (vct-&gt;getYright_neighbor() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2672</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 2673</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 2674</span>        Bxc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYC(i, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2675</span>        Byc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1][k] = B0y;</div>
<div class="line"><span class="lineno"> 2676</span>        Bzc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1][k] = B0z / cosh((grid-&gt;getYC(i, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);;</div>
<div class="line"><span class="lineno"> 2677</span>        Bzc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2][k] = B0z / cosh((grid-&gt;getYC(i, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);;</div>
<div class="line"><span class="lineno"> 2678</span>        Bzc[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 3][k] = B0z / cosh((grid-&gt;getYC(i, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 3, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2679</span>      }</div>
<div class="line"><span class="lineno"> 2680</span>  }</div>
<div class="line"><span class="lineno"> 2681</span>  <span class="keywordflow">if</span> (vct-&gt;getYleft_neighbor() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2682</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 2683</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 2684</span>        Bxc[i][0][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYC(i, 0, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2685</span>        Byc[i][0][k] = B0y;</div>
<div class="line"><span class="lineno"> 2686</span>        Bzc[i][0][k] = B0z / cosh((grid-&gt;getYC(i, 0, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2687</span>        Bzc[i][1][k] = B0z / cosh((grid-&gt;getYC(i, 1, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2688</span>        Bzc[i][2][k] = B0z / cosh((grid-&gt;getYC(i, 2, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2689</span>      }</div>
<div class="line"><span class="lineno"> 2690</span>  }</div>
<div class="line"><span class="lineno"> 2691</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">Ly</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>.</p>

</div>
</div>
<a id="a0841d39b77e72bcb91d8da9479c596de" name="a0841d39b77e72bcb91d8da9479c596de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0841d39b77e72bcb91d8da9479c596de">&#9670;&nbsp;</a></span>fixBnGEM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::fixBnGEM </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02634">2634</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2635</span>{</div>
<div class="line"><span class="lineno"> 2636</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2637</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2638</span> </div>
<div class="line"><span class="lineno"> 2639</span>  <span class="keywordflow">if</span> (vct-&gt;getYright_neighbor() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2640</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 2641</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 2642</span>        Bxn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYC(i, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 1, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2643</span>        Bxn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] = Bxn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1][k];</div>
<div class="line"><span class="lineno"> 2644</span>        Bxn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 3][k] = Bxn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1][k];</div>
<div class="line"><span class="lineno"> 2645</span>        Byn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1][k] = B0y;</div>
<div class="line"><span class="lineno"> 2646</span>        Bzn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1][k] = B0z;</div>
<div class="line"><span class="lineno"> 2647</span>        Bzn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] = B0z;</div>
<div class="line"><span class="lineno"> 2648</span>        Bzn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 3][k] = B0z;</div>
<div class="line"><span class="lineno"> 2649</span>      }</div>
<div class="line"><span class="lineno"> 2650</span>  }</div>
<div class="line"><span class="lineno"> 2651</span>  <span class="keywordflow">if</span> (vct-&gt;getYleft_neighbor() == MPI_PROC_NULL) {</div>
<div class="line"><span class="lineno"> 2652</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 2653</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 2654</span>        Bxn[i][0][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYC(i, 0, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 2655</span>        Bxn[i][1][k] = Bxn[i][0][k];</div>
<div class="line"><span class="lineno"> 2656</span>        Bxn[i][2][k] = Bxn[i][0][k];</div>
<div class="line"><span class="lineno"> 2657</span>        Byn[i][0][k] = B0y;</div>
<div class="line"><span class="lineno"> 2658</span>        Bzn[i][0][k] = B0z;</div>
<div class="line"><span class="lineno"> 2659</span>        Bzn[i][1][k] = B0z;</div>
<div class="line"><span class="lineno"> 2660</span>        Bzn[i][2][k] = B0z;</div>
<div class="line"><span class="lineno"> 2661</span>      }</div>
<div class="line"><span class="lineno"> 2662</span>  }</div>
<div class="line"><span class="lineno"> 2663</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c7748293f086b8e4960432851b8d158" name="a5c7748293f086b8e4960432851b8d158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c7748293f086b8e4960432851b8d158">&#9670;&nbsp;</a></span>freeDataType()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::freeDataType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00373">373</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  373</span>                             {</div>
<div class="line"><span class="lineno">  374</span>        MPI_Type_free(&amp;yzFacetypeC);</div>
<div class="line"><span class="lineno">  375</span>    MPI_Type_free(&amp;xzFacetypeC);</div>
<div class="line"><span class="lineno">  376</span>    MPI_Type_free(&amp;xyFacetypeC);</div>
<div class="line"><span class="lineno">  377</span>    MPI_Type_free(&amp;xEdgetypeC);</div>
<div class="line"><span class="lineno">  378</span>    MPI_Type_free(&amp;yEdgetypeC);</div>
<div class="line"><span class="lineno">  379</span>    MPI_Type_free(&amp;zEdgetypeC);</div>
<div class="line"><span class="lineno">  380</span>    MPI_Type_free(&amp;xEdgetypeC2);</div>
<div class="line"><span class="lineno">  381</span>    MPI_Type_free(&amp;yEdgetypeC2);</div>
<div class="line"><span class="lineno">  382</span>    MPI_Type_free(&amp;zEdgetypeC2);</div>
<div class="line"><span class="lineno">  383</span>    MPI_Type_free(&amp;cornertypeC);</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>    MPI_Type_free(&amp;yzFacetypeN);</div>
<div class="line"><span class="lineno">  386</span>    MPI_Type_free(&amp;xzFacetypeN);</div>
<div class="line"><span class="lineno">  387</span>    MPI_Type_free(&amp;xyFacetypeN);</div>
<div class="line"><span class="lineno">  388</span>    MPI_Type_free(&amp;xEdgetypeN);</div>
<div class="line"><span class="lineno">  389</span>    MPI_Type_free(&amp;yEdgetypeN);</div>
<div class="line"><span class="lineno">  390</span>    MPI_Type_free(&amp;zEdgetypeN);</div>
<div class="line"><span class="lineno">  391</span>    MPI_Type_free(&amp;xEdgetypeN2);</div>
<div class="line"><span class="lineno">  392</span>    MPI_Type_free(&amp;yEdgetypeN2);</div>
<div class="line"><span class="lineno">  393</span>    MPI_Type_free(&amp;zEdgetypeN2);</div>
<div class="line"><span class="lineno">  394</span>    MPI_Type_free(&amp;cornertypeN);</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>    MPI_Type_free(&amp;procview);</div>
<div class="line"><span class="lineno">  397</span>    MPI_Type_free(&amp;xyzcomp);</div>
<div class="line"><span class="lineno">  398</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abc9273f97a41be42951e161b36fce65c" name="abc9273f97a41be42951e161b36fce65c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc9273f97a41be42951e161b36fce65c">&#9670;&nbsp;</a></span>get_col()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../db/dfb/class_collective.html">Collective</a> &amp; EMfields3D::get_col </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00334">334</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  334</span>{<span class="keywordflow">return</span> _col;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a126c09acf5f2dc8f3b0657cbcabb8e32" name="a126c09acf5f2dc8f3b0657cbcabb8e32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a126c09acf5f2dc8f3b0657cbcabb8e32">&#9670;&nbsp;</a></span>get_fieldForPcls()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/df4/classi_pic3_d_1_1const__array__ref4.html">const_arr4_pfloat</a> EMfields3D::get_fieldForPcls </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00210">210</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  210</span>{ <span class="keywordflow">return</span> fieldForPcls; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e3b33f74af5f913a00eb37d8e79d956" name="a2e3b33f74af5f913a00eb37d8e79d956"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e3b33f74af5f913a00eb37d8e79d956">&#9670;&nbsp;</a></span>get_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> &amp; EMfields3D::get_grid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00335">335</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  335</span>{<span class="keywordflow">return</span> _grid;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa44b37f8a182f3290cc4ae176716c6e7" name="aa44b37f8a182f3290cc4ae176716c6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa44b37f8a182f3290cc4ae176716c6e7">&#9670;&nbsp;</a></span>get_sizeMomentsArray()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::get_sizeMomentsArray </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00301">301</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  301</span>{ <span class="keywordflow">return</span> sizeMomentsArray; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0172ec4aa44c0558f7e651867ee1ef05" name="a0172ec4aa44c0558f7e651867ee1ef05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0172ec4aa44c0558f7e651867ee1ef05">&#9670;&nbsp;</a></span>get_vct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> &amp; EMfields3D::get_vct </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00336">336</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  336</span>{<span class="keywordflow">return</span> _vct;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a794d16aea220c39fe864351a375cb719" name="a794d16aea220c39fe864351a375cb719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a794d16aea220c39fe864351a375cb719">&#9670;&nbsp;</a></span>getBenergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBenergy </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >get the magnetic field energy </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05676">5676</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5676</span>                                  {</div>
<div class="line"><span class="lineno"> 5677</span>  <span class="keywordtype">double</span> localBenergy = 0.0;</div>
<div class="line"><span class="lineno"> 5678</span>  <span class="keywordtype">double</span> totalBenergy = 0.0;</div>
<div class="line"><span class="lineno"> 5679</span>  <span class="keywordtype">double</span> Bxt = 0.0;</div>
<div class="line"><span class="lineno"> 5680</span>  <span class="keywordtype">double</span> Byt = 0.0;</div>
<div class="line"><span class="lineno"> 5681</span>  <span class="keywordtype">double</span> Bzt = 0.0;</div>
<div class="line"><span class="lineno"> 5682</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2; i++)</div>
<div class="line"><span class="lineno"> 5683</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2; j++)</div>
<div class="line"><span class="lineno"> 5684</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2; k++){</div>
<div class="line"><span class="lineno"> 5685</span>        Bxt = Bxn[i][j][k]+Bx_ext[i][j][k];</div>
<div class="line"><span class="lineno"> 5686</span>        Byt = Byn[i][j][k]+By_ext[i][j][k];</div>
<div class="line"><span class="lineno"> 5687</span>        Bzt = Bzn[i][j][k]+Bz_ext[i][j][k];</div>
<div class="line"><span class="lineno"> 5688</span>        localBenergy += .5*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>*dy*dz*(Bxt*Bxt + Byt*Byt + Bzt*Bzt)/(FourPI);</div>
<div class="line"><span class="lineno"> 5689</span>      }</div>
<div class="line"><span class="lineno"> 5690</span> </div>
<div class="line"><span class="lineno"> 5691</span>  MPI_Allreduce(&amp;localBenergy, &amp;totalBenergy, 1, MPI_DOUBLE, MPI_SUM, (&amp;get_vct())-&gt;getFieldComm());</div>
<div class="line"><span class="lineno"> 5692</span>  <span class="keywordflow">return</span> (totalBenergy);</div>
<div class="line"><span class="lineno"> 5693</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">dx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>.</p>

</div>
</div>
<a id="adc7e515ef99ef94124e57bc1ae229c75" name="adc7e515ef99ef94124e57bc1ae229c75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc7e515ef99ef94124e57bc1ae229c75">&#9670;&nbsp;</a></span>getBulkEnergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBulkEnergy </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >get bulk kinetic energy </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05696">5696</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5696</span>                                       {</div>
<div class="line"><span class="lineno"> 5697</span>  <span class="keywordtype">double</span> localBenergy = 0.0;</div>
<div class="line"><span class="lineno"> 5698</span>  <span class="keywordtype">double</span> totalBenergy = 0.0;</div>
<div class="line"><span class="lineno"> 5699</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2; i++)</div>
<div class="line"><span class="lineno"> 5700</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2; j++)</div>
<div class="line"><span class="lineno"> 5701</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2; k++)</div>
<div class="line"><span class="lineno"> 5702</span>        <span class="comment">// Trying to avoid division by zero. Where rho iz 0, current must be 0.</span></div>
<div class="line"><span class="lineno"> 5703</span>        localBenergy += (fabs(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k]) &gt; 1.e-20) ? (0.5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a> * dy * dz * (Jxs[is][i][j][k] * Jxs[is][i][j][k] + Jys[is][i][j][k] * Jys[is][i][j][k] + Jzs[is][i][j][k] * Jzs[is][i][j][k]) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k]) : 0.0;</div>
<div class="line"><span class="lineno"> 5704</span> </div>
<div class="line"><span class="lineno"> 5705</span>  MPI_Allreduce(&amp;localBenergy, &amp;totalBenergy, 1, MPI_DOUBLE, MPI_SUM, (&amp;get_vct())-&gt;getFieldComm());</div>
<div class="line"><span class="lineno"> 5706</span>  <span class="keywordflow">return</span> (totalBenergy / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is]);</div>
<div class="line"><span class="lineno"> 5707</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">dx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="a800573388d9fa762c7e5be4722115681" name="a800573388d9fa762c7e5be4722115681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a800573388d9fa762c7e5be4722115681">&#9670;&nbsp;</a></span>getBx() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00214">214</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  214</span>{ <span class="keywordflow">return</span> Bxn; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="af2b14c94f1a58f42c1ce7c4a6a2f5edd" name="af2b14c94f1a58f42c1ce7c4a6a2f5edd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2b14c94f1a58f42c1ce7c4a6a2f5edd">&#9670;&nbsp;</a></span>getBx() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBx </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00206">206</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  206</span>{ <span class="keywordflow">return</span> Bxn.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8f29d2fe1b0867072bded33483b624b5" name="a8f29d2fe1b0867072bded33483b624b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f29d2fe1b0867072bded33483b624b5">&#9670;&nbsp;</a></span>getBx_ext() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBx_ext </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00242">242</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  242</span>{ <span class="keywordflow">return</span> Bx_ext; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba32b0168ebc8c4a03051d62e0cf3e16" name="aba32b0168ebc8c4a03051d62e0cf3e16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba32b0168ebc8c4a03051d62e0cf3e16">&#9670;&nbsp;</a></span>getBx_ext() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBx_ext </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00238">238</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  238</span>{<span class="keywordflow">return</span> Bx_ext.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2cb749488cdde83cef28c928a19f5d1a" name="a2cb749488cdde83cef28c928a19f5d1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb749488cdde83cef28c928a19f5d1a">&#9670;&nbsp;</a></span>getBxc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBxc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00220">220</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  220</span>{<span class="keywordflow">return</span> Bxc;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6d65c4b918671472042d47ebace11083" name="a6d65c4b918671472042d47ebace11083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d65c4b918671472042d47ebace11083">&#9670;&nbsp;</a></span>getBxTot() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBxTot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00248">248</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  248</span>{ addscale(1.0,Bxn,Bx_ext,Bx_tot,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>); <span class="keywordflow">return</span> Bx_tot; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a153b37bcf0ca6ddd43da47b4ecb152" name="a1a153b37bcf0ca6ddd43da47b4ecb152"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a153b37bcf0ca6ddd43da47b4ecb152">&#9670;&nbsp;</a></span>getBxTot() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBxTot </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00251">251</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  251</span>{<span class="keywordflow">return</span> Bxn.get(X,Y,Z)+Bx_ext.get(X,Y,Z);;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a40b5fbe966761df8f71cd51548371251" name="a40b5fbe966761df8f71cd51548371251"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40b5fbe966761df8f71cd51548371251">&#9670;&nbsp;</a></span>getBy() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00215">215</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  215</span>{ <span class="keywordflow">return</span> Byn; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d0001bd28b90bbb41e5e8e1d82d9d40" name="a3d0001bd28b90bbb41e5e8e1d82d9d40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d0001bd28b90bbb41e5e8e1d82d9d40">&#9670;&nbsp;</a></span>getBy() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBy </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00207">207</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  207</span>{ <span class="keywordflow">return</span> Byn.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae749988609e5e91a7d00f10da9dbba8" name="aae749988609e5e91a7d00f10da9dbba8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae749988609e5e91a7d00f10da9dbba8">&#9670;&nbsp;</a></span>getBy_ext() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBy_ext </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00243">243</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  243</span>{ <span class="keywordflow">return</span> By_ext; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3172bf21e2d471c70c7edea1a1a8ccd4" name="a3172bf21e2d471c70c7edea1a1a8ccd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3172bf21e2d471c70c7edea1a1a8ccd4">&#9670;&nbsp;</a></span>getBy_ext() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBy_ext </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00239">239</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  239</span>{<span class="keywordflow">return</span> By_ext.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6bf9d0d7d2c9646659fd12597af52c1" name="ab6bf9d0d7d2c9646659fd12597af52c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6bf9d0d7d2c9646659fd12597af52c1">&#9670;&nbsp;</a></span>getByc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getByc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00221">221</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  221</span>{<span class="keywordflow">return</span> Byc;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5208f8c81474a42ab08a550893292e17" name="a5208f8c81474a42ab08a550893292e17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5208f8c81474a42ab08a550893292e17">&#9670;&nbsp;</a></span>getByTot() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getByTot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00249">249</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  249</span>{ addscale(1.0,Byn,By_ext,By_tot,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>); <span class="keywordflow">return</span> By_tot; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad049883ed1fdcf0f9ec3391254c640d3" name="ad049883ed1fdcf0f9ec3391254c640d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad049883ed1fdcf0f9ec3391254c640d3">&#9670;&nbsp;</a></span>getByTot() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getByTot </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00252">252</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  252</span>{<span class="keywordflow">return</span> Byn.get(X,Y,Z)+By_ext.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a21704979c7783048ea5f3ecac1824a68" name="a21704979c7783048ea5f3ecac1824a68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21704979c7783048ea5f3ecac1824a68">&#9670;&nbsp;</a></span>getBz() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00216">216</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  216</span>{ <span class="keywordflow">return</span> Bzn; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7ea3b60d4f3c89d59bf687e80ce89b3" name="ab7ea3b60d4f3c89d59bf687e80ce89b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7ea3b60d4f3c89d59bf687e80ce89b3">&#9670;&nbsp;</a></span>getBz() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBz </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00208">208</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  208</span>{ <span class="keywordflow">return</span> Bzn.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a92e4db4a14c9b340f9213cab5b09899e" name="a92e4db4a14c9b340f9213cab5b09899e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92e4db4a14c9b340f9213cab5b09899e">&#9670;&nbsp;</a></span>getBz_ext() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBz_ext </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00244">244</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  244</span>{ <span class="keywordflow">return</span> Bz_ext; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a408c307e1c9dc4c8b5e655e1a82e1427" name="a408c307e1c9dc4c8b5e655e1a82e1427"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a408c307e1c9dc4c8b5e655e1a82e1427">&#9670;&nbsp;</a></span>getBz_ext() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBz_ext </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00240">240</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  240</span>{<span class="keywordflow">return</span> Bz_ext.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b809a4c611bf92c4fa955ffaa5b1ce9" name="a1b809a4c611bf92c4fa955ffaa5b1ce9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b809a4c611bf92c4fa955ffaa5b1ce9">&#9670;&nbsp;</a></span>getBzc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBzc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00222">222</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  222</span>{<span class="keywordflow">return</span> Bzc;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a52159e09ba2b067c17f85223f5705274" name="a52159e09ba2b067c17f85223f5705274"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52159e09ba2b067c17f85223f5705274">&#9670;&nbsp;</a></span>getBzTot() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getBzTot </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00250">250</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  250</span>{ addscale(1.0,Bzn,Bz_ext,Bz_tot,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>); <span class="keywordflow">return</span> Bz_tot; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1feec1339a395023b2db859360468d11" name="a1feec1339a395023b2db859360468d11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1feec1339a395023b2db859360468d11">&#9670;&nbsp;</a></span>getBzTot() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getBzTot </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00253">253</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  253</span>{<span class="keywordflow">return</span> Bzn.get(X,Y,Z)+Bz_ext.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af3fc969174371331127fc002a3f23206" name="af3fc969174371331127fc002a3f23206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3fc969174371331127fc002a3f23206">&#9670;&nbsp;</a></span>getCornertype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getCornertype </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00321">321</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  321</span>{<span class="keywordflow">return</span>  isCenterFlag ?cornertypeC : cornertypeN;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af6cbf5ed8ab1cd9068ce50a113706cef" name="af6cbf5ed8ab1cd9068ce50a113706cef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6cbf5ed8ab1cd9068ce50a113706cef">&#9670;&nbsp;</a></span>getCurlN2CB_x()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getCurlN2CB_x </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >computes rot(B) at a given point of the grid </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05723">5723</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5723</span>                                                    {</div>
<div class="line"><span class="lineno"> 5724</span>        <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> * vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 5725</span>        <span class="comment">// curl - X</span></div>
<div class="line"><span class="lineno"> 5726</span>        <span class="keywordtype">double</span> compZDY = .25 * (Bzn[i][j + 1][k] - Bzn[i][j][k]) / dy + .25 * (Bzn[i][j + 1][k + 1] - Bzn[i][j][k + 1]) / dy + .25 * (Bzn[i + 1][j + 1][k] - Bzn[i + 1][j][k]) / dy + .25 * (Bzn[i + 1][j + 1][k + 1] - Bzn[i + 1][j][k + 1]) / dy;</div>
<div class="line"><span class="lineno"> 5727</span>        <span class="keywordtype">double</span> compYDZ = .25 * (Byn[i][j][k + 1] - Byn[i][j][k]) / dz + .25 * (Byn[i + 1][j][k + 1] - Byn[i + 1][j][k]) / dz + .25 * (Byn[i][j + 1][k + 1] - Byn[i][j + 1][k]) / dz + .25 * (Byn[i + 1][j + 1][k + 1] - Byn[i + 1][j + 1][k]) / dz; </div>
<div class="line"><span class="lineno"> 5728</span>        <span class="keywordflow">return</span> compZDY - compYDZ;</div>
<div class="line"><span class="lineno"> 5729</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a044c847275c41effa7a40a2f62b85ec0" name="a044c847275c41effa7a40a2f62b85ec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a044c847275c41effa7a40a2f62b85ec0">&#9670;&nbsp;</a></span>getCurlN2CB_y()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getCurlN2CB_y </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05730">5730</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5730</span>                                                    {</div>
<div class="line"><span class="lineno"> 5731</span>        <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> * vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 5732</span>        <span class="comment">// curl - Y</span></div>
<div class="line"><span class="lineno"> 5733</span>        <span class="keywordtype">double</span> compXDZ = .25 * (Bxn[i][j][k + 1] - Bxn[i][j][k]) / dz + .25 * (Bxn[i + 1][j][k + 1] - Bxn[i + 1][j][k]) / dz + .25 * (Bxn[i][j + 1][k + 1] - Bxn[i][j + 1][k]) / dz + .25 * (Bxn[i + 1][j + 1][k + 1] - Bxn[i + 1][j + 1][k]) / dz;</div>
<div class="line"><span class="lineno"> 5734</span>        <span class="keywordtype">double</span> compZDX = .25 * (Bzn[i + 1][j][k] - Bzn[i][j][k]) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a> + .25 * (Bzn[i + 1][j][k + 1] - Bzn[i][j][k + 1]) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a> + .25 * (Bzn[i + 1][j + 1][k] - Bzn[i][j + 1][k]) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a> + .25 * (Bzn[i + 1][j + 1][k + 1] - Bzn[i][j + 1][k + 1]) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>;</div>
<div class="line"><span class="lineno"> 5735</span>        <span class="comment">//if (vct-&gt;getCartesian_rank() == 0)</span></div>
<div class="line"><span class="lineno"> 5736</span>        <span class="comment">//      cout&lt;&lt;&quot;getCurlN2CB_y roty=&quot;&lt;&lt;compXDZ - compZDX&lt;&lt;endl;</span></div>
<div class="line"><span class="lineno"> 5737</span>        <span class="keywordflow">return</span> compXDZ - compZDX;</div>
<div class="line"><span class="lineno"> 5738</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa18f27cdd05713a1a37c64c0163ec1b4" name="aa18f27cdd05713a1a37c64c0163ec1b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa18f27cdd05713a1a37c64c0163ec1b4">&#9670;&nbsp;</a></span>getCurlN2CB_z()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getCurlN2CB_z </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05739">5739</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5739</span>                                                    {</div>
<div class="line"><span class="lineno"> 5740</span>        <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> * vct = &amp;get_vct(); </div>
<div class="line"><span class="lineno"> 5741</span>        <span class="keywordtype">double</span> compYDX = .25 * (Byn[i + 1][j][k] - Byn[i][j][k]) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a> + .25 * (Byn[i + 1][j][k + 1] - Byn[i][j][k + 1]) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a> + .25 * (Byn[i + 1][j + 1][k] - Byn[i][j + 1][k]) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a> + .25 * (Byn[i + 1][j + 1][k + 1] - Byn[i][j + 1][k + 1]) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>;</div>
<div class="line"><span class="lineno"> 5742</span>        <span class="keywordtype">double</span> compXDY = .25 * (Bxn[i][j + 1][k] - Bxn[i][j][k]) / dy + .25 * (Bxn[i][j + 1][k + 1] - Bxn[i][j][k + 1]) / dy + .25 * (Bxn[i + 1][j + 1][k] - Bxn[i + 1][j][k]) / dy + .25 * (Bxn[i + 1][j + 1][k + 1] - Bxn[i + 1][j][k + 1]) / dy;</div>
<div class="line"><span class="lineno"> 5743</span>        <span class="keywordflow">return</span> compYDX - compXDY;</div>
<div class="line"><span class="lineno"> 5744</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1b99f2e41903e87da3f06d4e05c3e07" name="ae1b99f2e41903e87da3f06d4e05c3e07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1b99f2e41903e87da3f06d4e05c3e07">&#9670;&nbsp;</a></span>getEenergy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getEenergy </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >get the electric field energy</p>
<p >get Electric Field component X array cell without the ghost cells</p>
<p >get Electric Field component Y array cell without the ghost cells</p>
<p >get Electric Field component Z array cell without the ghost cells</p>
<p >get Magnetic Field component X array cell without the ghost cells</p>
<p >get Magnetic Field component Y array cell without the ghost cells</p>
<p >get Magnetic Field component Z array cell without the ghost cells</p>
<p >get species density component X array cell without the ghost cells</p>
<p >get Magnetic Field component X array species is cell without the ghost cells</p>
<p >get current component Y array species is cell without the ghost cells</p>
<p >get current component Z array species is cell without the ghost cells</p>
<p >get the electric field energy </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05663">5663</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5663</span>                                  {</div>
<div class="line"><span class="lineno"> 5664</span>  <span class="keywordtype">double</span> localEenergy = 0.0;</div>
<div class="line"><span class="lineno"> 5665</span>  <span class="keywordtype">double</span> totalEenergy = 0.0;</div>
<div class="line"><span class="lineno"> 5666</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2; i++)</div>
<div class="line"><span class="lineno"> 5667</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2; j++)</div>
<div class="line"><span class="lineno"> 5668</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2; k++)</div>
<div class="line"><span class="lineno"> 5669</span>        localEenergy += .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a> * dy * dz * (Ex[i][j][k] * Ex[i][j][k] + Ey[i][j][k] * Ey[i][j][k] + Ez[i][j][k] * Ez[i][j][k]) / (FourPI);</div>
<div class="line"><span class="lineno"> 5670</span> </div>
<div class="line"><span class="lineno"> 5671</span>  MPI_Allreduce(&amp;localEenergy, &amp;totalEenergy, 1, MPI_DOUBLE, MPI_SUM, (&amp;get_vct())-&gt;getFieldComm());</div>
<div class="line"><span class="lineno"> 5672</span>  <span class="keywordflow">return</span> (totalEenergy);</div>
<div class="line"><span class="lineno"> 5673</span> </div>
<div class="line"><span class="lineno"> 5674</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">dx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>.</p>

</div>
</div>
<a id="ac5aa69ea0889d2d2fac6e70bf2e973ad" name="ac5aa69ea0889d2d2fac6e70bf2e973ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5aa69ea0889d2d2fac6e70bf2e973ad">&#9670;&nbsp;</a></span>getEx() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getEx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00211">211</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  211</span>{ <span class="keywordflow">return</span> Ex; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a523f1ef9c142dc21eb80d6d09e17d50c" name="a523f1ef9c142dc21eb80d6d09e17d50c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a523f1ef9c142dc21eb80d6d09e17d50c">&#9670;&nbsp;</a></span>getEx() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getEx </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00203">203</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  203</span>{ <span class="keywordflow">return</span> Ex.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab0499a4d969b65c7ea67650daf67299d" name="ab0499a4d969b65c7ea67650daf67299d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0499a4d969b65c7ea67650daf67299d">&#9670;&nbsp;</a></span>getEy() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getEy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00212">212</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  212</span>{ <span class="keywordflow">return</span> Ey; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a86e69d29d9ac8b58e75ef5c36a845e1e" name="a86e69d29d9ac8b58e75ef5c36a845e1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86e69d29d9ac8b58e75ef5c36a845e1e">&#9670;&nbsp;</a></span>getEy() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getEy </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00204">204</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  204</span>{ <span class="keywordflow">return</span> Ey.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9213b00dbbdaff6be976b85c45481ac4" name="a9213b00dbbdaff6be976b85c45481ac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9213b00dbbdaff6be976b85c45481ac4">&#9670;&nbsp;</a></span>getEz() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getEz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00213">213</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  213</span>{ <span class="keywordflow">return</span> Ez; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a954d670b4ccaf5c964fdf8905349b287" name="a954d670b4ccaf5c964fdf8905349b287"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a954d670b4ccaf5c964fdf8905349b287">&#9670;&nbsp;</a></span>getEz() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getEz </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00205">205</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  205</span>{ <span class="keywordflow">return</span> Ez.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6cfff47f252873a918caae583ee4059e" name="a6cfff47f252873a918caae583ee4059e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfff47f252873a918caae583ee4059e">&#9670;&nbsp;</a></span>getGhostType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getGhostType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00328">328</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  328</span>{<span class="keywordflow">return</span>  ghosttype;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad011afdf75158597368020dcd79f806e" name="ad011afdf75158597368020dcd79f806e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad011afdf75158597368020dcd79f806e">&#9670;&nbsp;</a></span>getJx() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getJx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00277">277</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  277</span>{ <span class="keywordflow">return</span> Jx; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab82e5760d906a5acb91abeabfc838eb4" name="ab82e5760d906a5acb91abeabfc838eb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab82e5760d906a5acb91abeabfc838eb4">&#9670;&nbsp;</a></span>getJx() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getJx </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00274">274</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  274</span>{ <span class="keywordflow">return</span> Jx.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1cedc7a79e1a44a0647b4ce27e6db62e" name="a1cedc7a79e1a44a0647b4ce27e6db62e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cedc7a79e1a44a0647b4ce27e6db62e">&#9670;&nbsp;</a></span>getJxs() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getJxs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00280">280</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  280</span>{ <span class="keywordflow">return</span> Jxs; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4c953a6544bedf570ace62f554a1a04" name="ad4c953a6544bedf570ace62f554a1a04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4c953a6544bedf570ace62f554a1a04">&#9670;&nbsp;</a></span>getJxs() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getJxs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00284">284</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  284</span>{<span class="keywordflow">return</span> Jxs.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afd422a9c64c53482414b779ba5dba3e9" name="afd422a9c64c53482414b779ba5dba3e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd422a9c64c53482414b779ba5dba3e9">&#9670;&nbsp;</a></span>getJy() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getJy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00278">278</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  278</span>{ <span class="keywordflow">return</span> Jy; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae4458d7550b07a97a1ed1c186cb3e454" name="ae4458d7550b07a97a1ed1c186cb3e454"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4458d7550b07a97a1ed1c186cb3e454">&#9670;&nbsp;</a></span>getJy() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getJy </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00275">275</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  275</span>{ <span class="keywordflow">return</span> Jy.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1647a6bacc6a190fc75f537a1f8b2d5d" name="a1647a6bacc6a190fc75f537a1f8b2d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1647a6bacc6a190fc75f537a1f8b2d5d">&#9670;&nbsp;</a></span>getJys() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getJys </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00281">281</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  281</span>{ <span class="keywordflow">return</span> Jys; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2b4c5be8dc2a451becef765872e0bfa" name="ad2b4c5be8dc2a451becef765872e0bfa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2b4c5be8dc2a451becef765872e0bfa">&#9670;&nbsp;</a></span>getJys() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getJys </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00285">285</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  285</span>{<span class="keywordflow">return</span> Jys.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a923f2c457150b11d2d3d1f59675f4911" name="a923f2c457150b11d2d3d1f59675f4911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923f2c457150b11d2d3d1f59675f4911">&#9670;&nbsp;</a></span>getJz() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getJz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00279">279</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  279</span>{ <span class="keywordflow">return</span> Jz; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2bf91e860e8076a8da7ac12d292d05e4" name="a2bf91e860e8076a8da7ac12d292d05e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bf91e860e8076a8da7ac12d292d05e4">&#9670;&nbsp;</a></span>getJz() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getJz </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00276">276</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  276</span>{ <span class="keywordflow">return</span> Jz.get(X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeae41158205f52df52501bd52bde6858" name="aeae41158205f52df52501bd52bde6858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeae41158205f52df52501bd52bde6858">&#9670;&nbsp;</a></span>getJzs() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getJzs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00282">282</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  282</span>{ <span class="keywordflow">return</span> Jzs; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b5f3934f6b3d9298d6098b600847a88" name="a3b5f3934f6b3d9298d6098b600847a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b5f3934f6b3d9298d6098b600847a88">&#9670;&nbsp;</a></span>getJzs() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getJzs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00286">286</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  286</span>{<span class="keywordflow">return</span> Jzs.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ab5296594cf07ba6a559dc965dd8f11" name="a3ab5296594cf07ba6a559dc965dd8f11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ab5296594cf07ba6a559dc965dd8f11">&#9670;&nbsp;</a></span>GetLambda()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double *** EMfields3D::GetLambda </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03511">3511</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3511</span>                               {</div>
<div class="line"><span class="lineno"> 3512</span>  <span class="keywordflow">return</span>(Lambda);</div>
<div class="line"><span class="lineno"> 3513</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6fb9bdbe4c10f7e59b6d1c7c415a922c" name="a6fb9bdbe4c10f7e59b6d1c7c415a922c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fb9bdbe4c10f7e59b6d1c7c415a922c">&#9670;&nbsp;</a></span>getPHI()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a> EMfields3D::getPHI </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >get Potential array </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00199">199</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  199</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a5f9d78fac6902b1ea3eaf5e298874768">PHI</a>;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00402">PHI</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d0e/_p_s_k_output_8h_source.html#l00353">myOutputAgent&lt; Toa &gt;::output()</a>.</p>

</div>
</div>
<a id="a54546a7181bcc86d8828905764a0905b" name="a54546a7181bcc86d8828905764a0905b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54546a7181bcc86d8828905764a0905b">&#9670;&nbsp;</a></span>getProcview()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getProcview </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00325">325</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  325</span>{<span class="keywordflow">return</span>  procview;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a517448ea4a5e9195b1be2f3d619743a9" name="a517448ea4a5e9195b1be2f3d619743a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a517448ea4a5e9195b1be2f3d619743a9">&#9670;&nbsp;</a></span>getProcviewXYZ()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getProcviewXYZ </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00327">327</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  327</span>{<span class="keywordflow">return</span>  procviewXYZ;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a04dfdb8e0a5c69c84ee30930d95a85bc" name="a04dfdb8e0a5c69c84ee30930d95a85bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04dfdb8e0a5c69c84ee30930d95a85bc">&#9670;&nbsp;</a></span>getpXXsn() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getpXXsn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00255">255</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  255</span>{ <span class="keywordflow">return</span> pXXsn; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1aeade2ed1686e894db7023ef2e8bcf5" name="a1aeade2ed1686e894db7023ef2e8bcf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aeade2ed1686e894db7023ef2e8bcf5">&#9670;&nbsp;</a></span>getpXXsn() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getpXXsn </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00256">256</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  256</span>{<span class="keywordflow">return</span> pXXsn.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a31abfd73cb6aa69ae77dccc2bcdce94a" name="a31abfd73cb6aa69ae77dccc2bcdce94a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31abfd73cb6aa69ae77dccc2bcdce94a">&#9670;&nbsp;</a></span>getpXYsn() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getpXYsn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00258">258</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  258</span>{ <span class="keywordflow">return</span> pXYsn; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a796a8a5a214bedee533e6ceafcdda8df" name="a796a8a5a214bedee533e6ceafcdda8df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a796a8a5a214bedee533e6ceafcdda8df">&#9670;&nbsp;</a></span>getpXYsn() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getpXYsn </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00259">259</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  259</span>{<span class="keywordflow">return</span> pXYsn.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a12ac83afef70d3e59fddfc57e9a99ec2" name="a12ac83afef70d3e59fddfc57e9a99ec2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12ac83afef70d3e59fddfc57e9a99ec2">&#9670;&nbsp;</a></span>getpXZsn() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getpXZsn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00261">261</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  261</span>{ <span class="keywordflow">return</span> pXZsn; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ef65147da21cc451b43fef251665324" name="a0ef65147da21cc451b43fef251665324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ef65147da21cc451b43fef251665324">&#9670;&nbsp;</a></span>getpXZsn() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getpXZsn </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00262">262</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  262</span>{<span class="keywordflow">return</span> pXZsn.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a467b8e00b722cd2c864ad6419be90538" name="a467b8e00b722cd2c864ad6419be90538"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a467b8e00b722cd2c864ad6419be90538">&#9670;&nbsp;</a></span>getpYYsn() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getpYYsn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00264">264</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  264</span>{ <span class="keywordflow">return</span> pYYsn; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ade5d4564c8eeb07164c85e84b4bb25d5" name="ade5d4564c8eeb07164c85e84b4bb25d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade5d4564c8eeb07164c85e84b4bb25d5">&#9670;&nbsp;</a></span>getpYYsn() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getpYYsn </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00265">265</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  265</span>{<span class="keywordflow">return</span> pYYsn.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dc0b717b256b956b647ac6e4e167d99" name="a1dc0b717b256b956b647ac6e4e167d99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dc0b717b256b956b647ac6e4e167d99">&#9670;&nbsp;</a></span>getpYZsn() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getpYZsn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00267">267</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  267</span>{ <span class="keywordflow">return</span> pYZsn; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8989d9e7aaed280db45593d02e3ff7d5" name="a8989d9e7aaed280db45593d02e3ff7d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8989d9e7aaed280db45593d02e3ff7d5">&#9670;&nbsp;</a></span>getpYZsn() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getpYZsn </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00268">268</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  268</span>{<span class="keywordflow">return</span> pYZsn.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac569958b28ed95ca23f9f2d79611e055" name="ac569958b28ed95ca23f9f2d79611e055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac569958b28ed95ca23f9f2d79611e055">&#9670;&nbsp;</a></span>getpZZsn() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getpZZsn </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00270">270</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  270</span>{ <span class="keywordflow">return</span> pZZsn; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab1d669b6eb6ed804fb5bb426a4ba138d" name="ab1d669b6eb6ed804fb5bb426a4ba138d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1d669b6eb6ed804fb5bb426a4ba138d">&#9670;&nbsp;</a></span>getpZZsn() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getpZZsn </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00271">271</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  271</span>{<span class="keywordflow">return</span> pZZsn.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="affab40e1b9f06113cd78145f7c006a0a" name="affab40e1b9f06113cd78145f7c006a0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affab40e1b9f06113cd78145f7c006a0a">&#9670;&nbsp;</a></span>getRHOcs() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getRHOcs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00235">235</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  235</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2f784901b90147dcd5559565c0e7ff4" name="ae2f784901b90147dcd5559565c0e7ff4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2f784901b90147dcd5559565c0e7ff4">&#9670;&nbsp;</a></span>getRHOcs() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getRHOcs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00232">232</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeec44f4d3764a6075790e8640dbc64c7" name="aeec44f4d3764a6075790e8640dbc64c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeec44f4d3764a6075790e8640dbc64c7">&#9670;&nbsp;</a></span>getRHOns() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> EMfields3D::getRHOns </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00234">234</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  234</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a625c2089bdde1c06cacb5be12975ae8d" name="a625c2089bdde1c06cacb5be12975ae8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a625c2089bdde1c06cacb5be12975ae8d">&#9670;&nbsp;</a></span>getRHOns() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::getRHOns </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00233">233</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  233</span>{<span class="keywordflow">return</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>.get(is,X,Y,Z);}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab937081030496b40a35fe2e9ca98b4c5" name="ab937081030496b40a35fe2e9ca98b4c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab937081030496b40a35fe2e9ca98b4c5">&#9670;&nbsp;</a></span>getXEdgetype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getXEdgetype </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00315">315</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  315</span>{<span class="keywordflow">return</span>  isCenterFlag ?xEdgetypeC : xEdgetypeN;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a34d6ae7f949af6acaee15b3a6dc04363" name="a34d6ae7f949af6acaee15b3a6dc04363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34d6ae7f949af6acaee15b3a6dc04363">&#9670;&nbsp;</a></span>getXEdgetype2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getXEdgetype2 </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00318">318</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  318</span>{<span class="keywordflow">return</span>  isCenterFlag ?xEdgetypeC2 : xEdgetypeN2;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae60762e98465f1fd728e530f9c944691" name="ae60762e98465f1fd728e530f9c944691"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae60762e98465f1fd728e530f9c944691">&#9670;&nbsp;</a></span>getXYFacetype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getXYFacetype </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00314">314</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  314</span>{<span class="keywordflow">return</span> isCenterFlag ?xyFacetypeC : xyFacetypeN;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa92a1e26001895c1ecd3566c224dbb73" name="aa92a1e26001895c1ecd3566c224dbb73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa92a1e26001895c1ecd3566c224dbb73">&#9670;&nbsp;</a></span>getXYZeType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getXYZeType </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00326">326</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  326</span>{<span class="keywordflow">return</span> xyzcomp;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aec43a6826a260a632fb09bd997a58ff2" name="aec43a6826a260a632fb09bd997a58ff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec43a6826a260a632fb09bd997a58ff2">&#9670;&nbsp;</a></span>getXZFacetype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getXZFacetype </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00313">313</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  313</span>{<span class="keywordflow">return</span> isCenterFlag ?xzFacetypeC : xzFacetypeN;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a887804f3a39e24b9859039131cbff4c1" name="a887804f3a39e24b9859039131cbff4c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a887804f3a39e24b9859039131cbff4c1">&#9670;&nbsp;</a></span>getYEdgetype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getYEdgetype </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00316">316</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  316</span>{<span class="keywordflow">return</span>  isCenterFlag ?yEdgetypeC : yEdgetypeN;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e5dd320d6b6720021f519d050bd9407" name="a4e5dd320d6b6720021f519d050bd9407"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e5dd320d6b6720021f519d050bd9407">&#9670;&nbsp;</a></span>getYEdgetype2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getYEdgetype2 </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00319">319</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  319</span>{<span class="keywordflow">return</span>  isCenterFlag ?yEdgetypeC2 : yEdgetypeN2;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a222e0a9439e5a86ee1a325dc7624c679" name="a222e0a9439e5a86ee1a325dc7624c679"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a222e0a9439e5a86ee1a325dc7624c679">&#9670;&nbsp;</a></span>getYZFacetype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getYZFacetype </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00312">312</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  312</span>{<span class="keywordflow">return</span> isCenterFlag ?yzFacetypeC : yzFacetypeN;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a780a1eb044a107eb0ea95234fbf9611e" name="a780a1eb044a107eb0ea95234fbf9611e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a780a1eb044a107eb0ea95234fbf9611e">&#9670;&nbsp;</a></span>getZEdgetype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getZEdgetype </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00317">317</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  317</span>{<span class="keywordflow">return</span>  isCenterFlag ?zEdgetypeC : zEdgetypeN;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af7f6f7a25df3324557efc2a61df9b8e5" name="af7f6f7a25df3324557efc2a61df9b8e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7f6f7a25df3324557efc2a61df9b8e5">&#9670;&nbsp;</a></span>getZEdgetype2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::getZEdgetype2 </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>isCenterFlag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00320">320</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  320</span>{<span class="keywordflow">return</span>  isCenterFlag ?zEdgetypeC2 : zEdgetypeN2;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a10cca1558704e2a34abafebbdd8df8db" name="a10cca1558704e2a34abafebbdd8df8db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10cca1558704e2a34abafebbdd8df8db">&#9670;&nbsp;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >initialize the electromagnetic fields with constant values</p>
<p >initialize Magnetic and Electric Field with initial configuration </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">3517</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3518</span>{</div>
<div class="line"><span class="lineno"> 3519</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 3520</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3521</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3522</span> </div>
<div class="line"><span class="lineno"> 3523</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> == 0) {</div>
<div class="line"><span class="lineno"> 3524</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++) {</div>
<div class="line"><span class="lineno"> 3525</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++) {</div>
<div class="line"><span class="lineno"> 3526</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 3527</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 3528</span>            <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 3529</span>          }</div>
<div class="line"><span class="lineno"> 3530</span>          Ex[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3531</span>          Ey[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3532</span>          Ez[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3533</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>;</div>
<div class="line"><span class="lineno"> 3534</span>          Byn[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 3535</span>          Bzn[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 3536</span>        }</div>
<div class="line"><span class="lineno"> 3537</span>      }</div>
<div class="line"><span class="lineno"> 3538</span>    }</div>
<div class="line"><span class="lineno"> 3539</span> </div>
<div class="line"><span class="lineno"> 3540</span>    <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 3541</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bxc, Bxn);</div>
<div class="line"><span class="lineno"> 3542</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Byc, Byn);</div>
<div class="line"><span class="lineno"> 3543</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bzc, Bzn);</div>
<div class="line"><span class="lineno"> 3544</span> </div>
<div class="line"><span class="lineno"> 3545</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3546</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 3547</span>  }</div>
<div class="line"><span class="lineno"> 3548</span>  <span class="keywordflow">else</span> {                        <span class="comment">// READING FROM RESTART</span></div>
<div class="line"><span class="lineno"> 3549</span><span class="preprocessor">  #ifdef NO_HDF5</span></div>
<div class="line"><span class="lineno"> 3550</span>    eprintf(<span class="stringliteral">&quot;restart requires compiling with HDF5&quot;</span>);</div>
<div class="line"><span class="lineno"> 3551</span><span class="preprocessor">  #else</span></div>
<div class="line"><span class="lineno"> 3552</span>    col-&gt;read_field_restart(vct,grid,Bxn,Byn,Bzn,Ex,Ey,Ez,&amp;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>);</div>
<div class="line"><span class="lineno"> 3553</span> </div>
<div class="line"><span class="lineno"> 3554</span>    <span class="comment">// communicate species densities to ghost nodes</span></div>
<div class="line"><span class="lineno"> 3555</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 3556</span>      <span class="keywordtype">double</span> ***moment0 = convert_to_arr3(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is]);</div>
<div class="line"><span class="lineno"> 3557</span>      communicateNode_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, moment0, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3558</span>    }</div>
<div class="line"><span class="lineno"> 3559</span> </div>
<div class="line"><span class="lineno"> 3560</span>    <span class="keywordflow">if</span> (col-&gt;getCase()==<span class="stringliteral">&quot;Dipole&quot;</span>) </div>
<div class="line"><span class="lineno"> 3561</span>    {</div>
<div class="line"><span class="lineno"> 3562</span>      <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#aa3cdcba848fb0b5ee0dc6f6476e37398">ConstantChargePlanet</a>(col-&gt;getL_square(),col-&gt;getx_center(),col-&gt;gety_center(),col-&gt;getz_center()); <span class="comment">// this is new - F.Lavorenti</span></div>
<div class="line"><span class="lineno"> 3563</span>    }</div>
<div class="line"><span class="lineno"> 3564</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (col-&gt;getCase()==<span class="stringliteral">&quot;Dipole2D&quot;</span>) </div>
<div class="line"><span class="lineno"> 3565</span>    {</div>
<div class="line"><span class="lineno"> 3566</span>      ConstantChargePlanet2DPlaneXZ(col-&gt;getL_square(),col-&gt;getx_center(),col-&gt;getz_center());</div>
<div class="line"><span class="lineno"> 3567</span>    }</div>
<div class="line"><span class="lineno"> 3568</span>    <span class="comment">// I am not sure what this open BC does, but perhaps it is responsible for energy losses in the restart? Jan 2017, Slavik.</span></div>
<div class="line"><span class="lineno"> 3569</span>    <span class="comment">/*else if ((col-&gt;getCase().find(&quot;TaylorGreen&quot;) != std::string::npos) &amp;&amp; (col-&gt;getCase() != &quot;NullPoints&quot;))</span></div>
<div class="line"><span class="lineno"> 3570</span><span class="comment">    {</span></div>
<div class="line"><span class="lineno"> 3571</span><span class="comment">      ConstantChargeOpenBC();</span></div>
<div class="line"><span class="lineno"> 3572</span><span class="comment">    }*/</span> <span class="comment">// commented this part since I do not see its utility F. Lavorenti</span></div>
<div class="line"><span class="lineno"> 3573</span> </div>
<div class="line"><span class="lineno"> 3574</span>    <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 3575</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bxn, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3576</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Byn, col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3577</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bzn, col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3578</span> </div>
<div class="line"><span class="lineno"> 3579</span>    <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 3580</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bxc, Bxn);</div>
<div class="line"><span class="lineno"> 3581</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Byc, Byn);</div>
<div class="line"><span class="lineno"> 3582</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bzc, Bzn);</div>
<div class="line"><span class="lineno"> 3583</span> </div>
<div class="line"><span class="lineno"> 3584</span>    <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 3585</span>    communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bxc, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3586</span>    communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Byc, col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3587</span>    communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bzc, col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3588</span> </div>
<div class="line"><span class="lineno"> 3589</span>    <span class="comment">// communicate E</span></div>
<div class="line"><span class="lineno"> 3590</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ex, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3591</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ey, col-&gt;bcEy[0],col-&gt;bcEy[1],col-&gt;bcEy[2],col-&gt;bcEy[3],col-&gt;bcEy[4],col-&gt;bcEy[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3592</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ez, col-&gt;bcEz[0],col-&gt;bcEz[1],col-&gt;bcEz[2],col-&gt;bcEz[3],col-&gt;bcEz[4],col-&gt;bcEz[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3593</span> </div>
<div class="line"><span class="lineno"> 3594</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3595</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 3596</span><span class="preprocessor">  #endif </span><span class="comment">// NO_HDF5</span></div>
<div class="line"><span class="lineno"> 3597</span>  }</div>
<div class="line"><span class="lineno"> 3598</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_aa3cdcba848fb0b5ee0dc6f6476e37398"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#aa3cdcba848fb0b5ee0dc6f6476e37398">EMfields3D::ConstantChargePlanet</a></div><div class="ttdeci">void ConstantChargePlanet(double R, double x_center, double y_center, double z_center)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">EMfields3D.cpp:2960</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../d4/d51/_collective_8h_source.html#l00209">Collective::bcBx</a>, <a class="el" href="../../d4/d51/_collective_8h_source.html#l00207">Collective::bcEx</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>.</p>

</div>
</div>
<a id="ad1cb8641cd1ec6f1581a1e7b6daef08e" name="ad1cb8641cd1ec6f1581a1e7b6daef08e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1cb8641cd1ec6f1581a1e7b6daef08e">&#9670;&nbsp;</a></span>initBEAM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initBEAM </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x_center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y_center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z_center</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >init beam</p>
<p >Initialize the EM field with constants values or from restart </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">4435</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4437</span>{</div>
<div class="line"><span class="lineno"> 4438</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 4439</span> </div>
<div class="line"><span class="lineno"> 4440</span>  <span class="keywordtype">double</span> distance;</div>
<div class="line"><span class="lineno"> 4441</span>  <span class="comment">// initialize E and rhos on nodes</span></div>
<div class="line"><span class="lineno"> 4442</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> == 0) {</div>
<div class="line"><span class="lineno"> 4443</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4444</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 4445</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4446</span>          Ex[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4447</span>          Ey[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4448</span>          Ez[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4449</span>          Bxn[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4450</span>          Byn[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4451</span>          Bzn[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4452</span>          distance = (grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>) * (grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>) / (radius * radius) + (grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a>) * (grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a>) / (radius * radius) + (grid-&gt;getZN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>) * (grid-&gt;getZN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>) / (4 * radius * radius);</div>
<div class="line"><span class="lineno"> 4453</span>          <span class="comment">// plasma</span></div>
<div class="line"><span class="lineno"> 4454</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[0][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[0] / FourPI;  <span class="comment">// initialize with constant density</span></div>
<div class="line"><span class="lineno"> 4455</span>          <span class="comment">// electrons</span></div>
<div class="line"><span class="lineno"> 4456</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[1][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[1] / FourPI;</div>
<div class="line"><span class="lineno"> 4457</span>          <span class="comment">// beam</span></div>
<div class="line"><span class="lineno"> 4458</span>          <span class="keywordflow">if</span> (distance &lt; 1.0)</div>
<div class="line"><span class="lineno"> 4459</span>            <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[2][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[2] / FourPI;</div>
<div class="line"><span class="lineno"> 4460</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4461</span>            <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[2][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4462</span>        }</div>
<div class="line"><span class="lineno"> 4463</span>    <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 4464</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 4465</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 4466</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 4467</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 4468</span>          Bxc[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4469</span>          Byc[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4470</span>          Bzc[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4471</span> </div>
<div class="line"><span class="lineno"> 4472</span> </div>
<div class="line"><span class="lineno"> 4473</span>        }</div>
<div class="line"><span class="lineno"> 4474</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 4475</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 4476</span>  }</div>
<div class="line"><span class="lineno"> 4477</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4478</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>(); <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 4479</span>  }</div>
<div class="line"><span class="lineno"> 4480</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a10cca1558704e2a34abafebbdd8df8db"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">EMfields3D::init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">EMfields3D.cpp:3517</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00393">x_center</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00395">y_center</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00397">z_center</a>.</p>

</div>
</div>
<a id="a153421af9f17631c342457dfbe33433e" name="a153421af9f17631c342457dfbe33433e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a153421af9f17631c342457dfbe33433e">&#9670;&nbsp;</a></span>initDipole()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initDipole </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise a planet with dipole B field. </p>
<p >The dipole is initialized in three-dimensions using the formula B=... centered in point (xc,yc,zc) given as input. This initialization can be with bodies having an intrinsic strong magnetic field, usually stronger than the SW. Extension to multiple harmonics TBD. </p>
<p >&lt; Distance center planet to grid point (in code units)</p>
<p >&lt; Grid points coordinate w.r.t planet center</p>
<p >&lt; Dummy variable</p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">4482</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4483</span>{</div>
<div class="line"><span class="lineno"> 4484</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 4485</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 4486</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 4487</span> </div>
<div class="line"><span class="lineno"> 4488</span>  <span class="comment">// initialize</span></div>
<div class="line"><span class="lineno"> 4489</span>  <span class="keywordflow">if</span> (vct-&gt;getCartesian_rank() ==0){</div>
<div class="line"><span class="lineno"> 4490</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4491</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialise a Magnetic Dipole &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4492</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4493</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4494</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4495</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4496</span>      cout &lt;&lt; <span class="stringliteral">&quot;B1x   (external dipole field) - X  = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a42158c86c46e0ee3ce618cfe52d63b31">B1x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4497</span>      cout &lt;&lt; <span class="stringliteral">&quot;B1y                              = &quot;</span> &lt;&lt; B1y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4498</span>      cout &lt;&lt; <span class="stringliteral">&quot;B1z                              = &quot;</span> &lt;&lt; B1z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4499</span>      cout &lt;&lt; <span class="stringliteral">&quot;PlanetOffset [di]                = &quot;</span> &lt;&lt; PlanetOffset &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4500</span>      cout &lt;&lt; <span class="stringliteral">&quot;L_square - no magnetic field inside a sphere with radius L_square  = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aa5faeefa7eb12e7e655923af87e2c5e7">L_square</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4501</span>      cout &lt;&lt; <span class="stringliteral">&quot;Center dipole - X                = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4502</span>      cout &lt;&lt; <span class="stringliteral">&quot;Center dipole - Y                = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4503</span>      cout &lt;&lt; <span class="stringliteral">&quot;Center dipole - Z                = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4504</span>      cout &lt;&lt; <span class="stringliteral">&quot;Solar Wind drift velocity        = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4505</span>  }</div>
<div class="line"><span class="lineno"> 4506</span> </div>
<div class="line"><span class="lineno"> 4507</span>  <span class="keywordtype">double</span> distance; <span class="comment">/**&lt; Distance center planet to grid point (in code units)*/</span></div>
<div class="line"><span class="lineno"> 4508</span>  <span class="keywordtype">double</span> x_displ, y_displ, z_displ; <span class="comment">/**&lt; Grid points coordinate w.r.t planet center*/</span></div>
<div class="line"><span class="lineno"> 4509</span>  <span class="keywordtype">double</span> fac1;  <span class="comment">/**&lt; Dummy variable*/</span></div>
<div class="line"><span class="lineno"> 4510</span> </div>
<div class="line"><span class="lineno"> 4511</span> </div>
<div class="line"><span class="lineno"> 4512</span>  <span class="keywordtype">double</span> ebc[3];</div>
<div class="line"><span class="lineno"> 4513</span>  cross_product(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a>,ve0,we0,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>,B0y,B0z,ebc);</div>
<div class="line"><span class="lineno"> 4514</span>  scale(ebc,-1.0,3);</div>
<div class="line"><span class="lineno"> 4515</span> </div>
<div class="line"><span class="lineno"> 4516</span>   <span class="keywordtype">double</span> a=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aa5faeefa7eb12e7e655923af87e2c5e7">L_square</a>;</div>
<div class="line"><span class="lineno"> 4517</span> </div>
<div class="line"><span class="lineno"> 4518</span>   <span class="keywordtype">double</span> xc=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>;</div>
<div class="line"><span class="lineno"> 4519</span>   <span class="keywordtype">double</span> yc=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a>;</div>
<div class="line"><span class="lineno"> 4520</span>   <span class="keywordtype">double</span> zc=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>;</div>
<div class="line"><span class="lineno"> 4521</span> </div>
<div class="line"><span class="lineno"> 4522</span> </div>
<div class="line"><span class="lineno"> 4523</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++){</div>
<div class="line"><span class="lineno"> 4524</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++){</div>
<div class="line"><span class="lineno"> 4525</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 4526</span> </div>
<div class="line"><span class="lineno"> 4527</span>        <span class="keywordtype">double</span> x = grid-&gt;getXN(i,j,k);</div>
<div class="line"><span class="lineno"> 4528</span>        <span class="keywordtype">double</span> y = grid-&gt;getYN(i,j,k);</div>
<div class="line"><span class="lineno"> 4529</span>        <span class="keywordtype">double</span> z = grid-&gt;getZN(i,j,k);</div>
<div class="line"><span class="lineno"> 4530</span>        <span class="keywordtype">double</span> r2_dipole = ((x-xc)*(x-xc)) + ((y-yc)*(y-yc)) + ((z-zc)*(z-zc));</div>
<div class="line"><span class="lineno"> 4531</span>        <span class="keywordtype">double</span> r2_planet = ((x-xc)*(x-xc)) + ((y-yc)*(y-yc)) + ((z-zc-PlanetOffset)*(z-zc-PlanetOffset));</div>
<div class="line"><span class="lineno"> 4532</span> </div>
<div class="line"><span class="lineno"> 4533</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++){</div>
<div class="line"><span class="lineno"> 4534</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is]/FourPI;</div>
<div class="line"><span class="lineno"> 4535</span>        }</div>
<div class="line"><span class="lineno"> 4536</span> </div>
<div class="line"><span class="lineno"> 4537</span>        <span class="comment">// electric field values </span></div>
<div class="line"><span class="lineno"> 4538</span>        Ex[i][j][k] = ebc[0];</div>
<div class="line"><span class="lineno"> 4539</span>        Ey[i][j][k] = ebc[1];</div>
<div class="line"><span class="lineno"> 4540</span>        Ez[i][j][k] = ebc[2];</div>
<div class="line"><span class="lineno"> 4541</span> </div>
<div class="line"><span class="lineno"> 4542</span>        <span class="comment">// magnetic field values</span></div>
<div class="line"><span class="lineno"> 4543</span>        Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>;</div>
<div class="line"><span class="lineno"> 4544</span>        Byn[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 4545</span>        Bzn[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 4546</span> </div>
<div class="line"><span class="lineno"> 4547</span>        <span class="comment">// dipolar field B_ext</span></div>
<div class="line"><span class="lineno"> 4548</span>        <span class="keywordflow">if</span> ( r2_dipole &gt; (4*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>) ) {</div>
<div class="line"><span class="lineno"> 4549</span>          x_displ = x - xc;</div>
<div class="line"><span class="lineno"> 4550</span>          y_displ = y - yc;</div>
<div class="line"><span class="lineno"> 4551</span>          z_displ = z - zc;</div>
<div class="line"><span class="lineno"> 4552</span>          fac1 =  -B1z*a*a*a/pow(r2_dipole,2.5);</div>
<div class="line"><span class="lineno"> 4553</span>          Bx_ext[i][j][k] = 3*x_displ*z_displ*fac1;</div>
<div class="line"><span class="lineno"> 4554</span>          By_ext[i][j][k] = 3*y_displ*z_displ*fac1;</div>
<div class="line"><span class="lineno"> 4555</span>          Bz_ext[i][j][k] = (2*z_displ*z_displ -x_displ*x_displ -y_displ*y_displ)*fac1;</div>
<div class="line"><span class="lineno"> 4556</span>        }</div>
<div class="line"><span class="lineno"> 4557</span>        <span class="keywordflow">else</span> { <span class="comment">// avoid singularity</span></div>
<div class="line"><span class="lineno"> 4558</span>          Bx_ext[i][j][k]  = 0.0;</div>
<div class="line"><span class="lineno"> 4559</span>          By_ext[i][j][k]  = 0.0;</div>
<div class="line"><span class="lineno"> 4560</span>          Bz_ext[i][j][k]  = 0.0;</div>
<div class="line"><span class="lineno"> 4561</span>        }</div>
<div class="line"><span class="lineno"> 4562</span> </div>
<div class="line"><span class="lineno"> 4563</span>      }</div>
<div class="line"><span class="lineno"> 4564</span>    }</div>
<div class="line"><span class="lineno"> 4565</span>  }</div>
<div class="line"><span class="lineno"> 4566</span> </div>
<div class="line"><span class="lineno"> 4567</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bxc,Bxn);</div>
<div class="line"><span class="lineno"> 4568</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Byc,Byn);</div>
<div class="line"><span class="lineno"> 4569</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bzc,Bzn);</div>
<div class="line"><span class="lineno"> 4570</span> </div>
<div class="line"><span class="lineno"> 4571</span>  communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>,Bxc,col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5],vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4572</span>  communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>,Byc,col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5],vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4573</span>  communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>,Bzc,col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5],vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4574</span> </div>
<div class="line"><span class="lineno"> 4575</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0 ; is&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 4576</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>,is,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 4577</span> </div>
<div class="line"><span class="lineno"> 4578</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> != 0) { <span class="comment">// EM initialization from RESTART</span></div>
<div class="line"><span class="lineno"> 4579</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>();  <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 4580</span>  }</div>
<div class="line"><span class="lineno"> 4581</span> </div>
<div class="line"><span class="lineno"> 4582</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00362">B1x</a>, <a class="el" href="../../d4/d51/_collective_8h_source.html#l00209">Collective::bcBx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">dx</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00399">L_square</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00366">ue0</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00393">x_center</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00395">y_center</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00397">z_center</a>.</p>

</div>
</div>
<a id="acec82fa4f7d8956afbd121c4f4014d27" name="acec82fa4f7d8956afbd121c4f4014d27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acec82fa4f7d8956afbd121c4f4014d27">&#9670;&nbsp;</a></span>initDipole2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initDipole2D </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04585">4585</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4586</span>{</div>
<div class="line"><span class="lineno"> 4587</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 4588</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 4589</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 4590</span> </div>
<div class="line"><span class="lineno"> 4591</span>  <span class="comment">// initialize</span></div>
<div class="line"><span class="lineno"> 4592</span>  <span class="keywordflow">if</span> (vct-&gt;getCartesian_rank() ==0){</div>
<div class="line"><span class="lineno"> 4593</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4594</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialise a 2D Magnetic Dipole on XY Plane&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4595</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4596</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4597</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4598</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4599</span>      cout &lt;&lt; <span class="stringliteral">&quot;B1x   (external dipole field)    = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a42158c86c46e0ee3ce618cfe52d63b31">B1x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4600</span>      cout &lt;&lt; <span class="stringliteral">&quot;B1y                              = &quot;</span> &lt;&lt; B1y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4601</span>      cout &lt;&lt; <span class="stringliteral">&quot;B1z                              = &quot;</span> &lt;&lt; B1z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4602</span>      cout &lt;&lt; <span class="stringliteral">&quot;L_square - no magnetic field inside a sphere with radius L_square  = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aa5faeefa7eb12e7e655923af87e2c5e7">L_square</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4603</span>      cout &lt;&lt; <span class="stringliteral">&quot;Center dipole - X                = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4604</span>      cout &lt;&lt; <span class="stringliteral">&quot;Center dipole - Y                = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4605</span>      cout &lt;&lt; <span class="stringliteral">&quot;Center dipole - Z                = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4606</span>      cout &lt;&lt; <span class="stringliteral">&quot;Solar Wind drift velocity        = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4607</span>      cout &lt;&lt; <span class="stringliteral">&quot;2D Smoothing Factor              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4608</span>      cout &lt;&lt; <span class="stringliteral">&quot;Smooth Iteration                 = &quot;</span> &lt;&lt; SmoothNiter &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4609</span>  }</div>
<div class="line"><span class="lineno"> 4610</span> </div>
<div class="line"><span class="lineno"> 4611</span> </div>
<div class="line"><span class="lineno"> 4612</span>  <span class="keywordtype">double</span> distance;</div>
<div class="line"><span class="lineno"> 4613</span>  <span class="keywordtype">double</span> x_displ, z_displ, fac1;</div>
<div class="line"><span class="lineno"> 4614</span> </div>
<div class="line"><span class="lineno"> 4615</span>  <span class="keywordtype">double</span> ebc[3];</div>
<div class="line"><span class="lineno"> 4616</span>  cross_product(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a>,ve0,we0,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>,B0y,B0z,ebc);</div>
<div class="line"><span class="lineno"> 4617</span>  scale(ebc,-1.0,3);</div>
<div class="line"><span class="lineno"> 4618</span> </div>
<div class="line"><span class="lineno"> 4619</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++){</div>
<div class="line"><span class="lineno"> 4620</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++){</div>
<div class="line"><span class="lineno"> 4621</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 4622</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++){</div>
<div class="line"><span class="lineno"> 4623</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is]/FourPI;</div>
<div class="line"><span class="lineno"> 4624</span>        }</div>
<div class="line"><span class="lineno"> 4625</span>        Ex[i][j][k] = ebc[0];</div>
<div class="line"><span class="lineno"> 4626</span>        Ey[i][j][k] = ebc[1];</div>
<div class="line"><span class="lineno"> 4627</span>        Ez[i][j][k] = ebc[2];</div>
<div class="line"><span class="lineno"> 4628</span> </div>
<div class="line"><span class="lineno"> 4629</span>        <span class="keywordtype">double</span> blp[3];</div>
<div class="line"><span class="lineno"> 4630</span>        <span class="keywordtype">double</span> a=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aa5faeefa7eb12e7e655923af87e2c5e7">L_square</a>;</div>
<div class="line"><span class="lineno"> 4631</span> </div>
<div class="line"><span class="lineno"> 4632</span>        <span class="keywordtype">double</span> xc=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>;</div>
<div class="line"><span class="lineno"> 4633</span>        <span class="keywordtype">double</span> zc=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>;</div>
<div class="line"><span class="lineno"> 4634</span> </div>
<div class="line"><span class="lineno"> 4635</span>        <span class="keywordtype">double</span> x = grid-&gt;getXN(i,j,k);</div>
<div class="line"><span class="lineno"> 4636</span>        <span class="keywordtype">double</span> z = grid-&gt;getZN(i,j,k);</div>
<div class="line"><span class="lineno"> 4637</span> </div>
<div class="line"><span class="lineno"> 4638</span>        <span class="keywordtype">double</span> r2 = ((x-xc)*(x-xc)) + ((z-zc)*(z-zc));</div>
<div class="line"><span class="lineno"> 4639</span> </div>
<div class="line"><span class="lineno"> 4640</span>        <span class="comment">// Compute dipolar field B_ext</span></div>
<div class="line"><span class="lineno"> 4641</span> </div>
<div class="line"><span class="lineno"> 4642</span>        <span class="keywordflow">if</span> (r2 &gt; a*a) {</div>
<div class="line"><span class="lineno"> 4643</span>            x_displ = x - xc;</div>
<div class="line"><span class="lineno"> 4644</span>            z_displ = z - zc;</div>
<div class="line"><span class="lineno"> 4645</span> </div>
<div class="line"><span class="lineno"> 4646</span>            fac1 =  -B1z*a*a/r2;  <span class="comment">// modified F.Lavorenti</span></div>
<div class="line"><span class="lineno"> 4647</span> </div>
<div class="line"><span class="lineno"> 4648</span>                        Bx_ext[i][j][k] = 2*x_displ*z_displ*fac1;</div>
<div class="line"><span class="lineno"> 4649</span>                        By_ext[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4650</span>                        Bz_ext[i][j][k] = (z_displ*z_displ - x_displ*x_displ)*fac1;</div>
<div class="line"><span class="lineno"> 4651</span> </div>
<div class="line"><span class="lineno"> 4652</span>        }</div>
<div class="line"><span class="lineno"> 4653</span>        <span class="keywordflow">else</span> { <span class="comment">// no field inside the planet</span></div>
<div class="line"><span class="lineno"> 4654</span>            Bx_ext[i][j][k]  = 0.0;</div>
<div class="line"><span class="lineno"> 4655</span>            By_ext[i][j][k]  = 0.0;</div>
<div class="line"><span class="lineno"> 4656</span>            Bz_ext[i][j][k]  = 0.0;</div>
<div class="line"><span class="lineno"> 4657</span>        }</div>
<div class="line"><span class="lineno"> 4658</span> </div>
<div class="line"><span class="lineno"> 4659</span>        Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>;<span class="comment">// + Bx_ext[i][j][k]</span></div>
<div class="line"><span class="lineno"> 4660</span>        Byn[i][j][k] = B0y;<span class="comment">// + By_ext[i][j][k]</span></div>
<div class="line"><span class="lineno"> 4661</span>        Bzn[i][j][k] = B0z;<span class="comment">// + Bz_ext[i][j][k]</span></div>
<div class="line"><span class="lineno"> 4662</span> </div>
<div class="line"><span class="lineno"> 4663</span>      }</div>
<div class="line"><span class="lineno"> 4664</span>    }</div>
<div class="line"><span class="lineno"> 4665</span>  }</div>
<div class="line"><span class="lineno"> 4666</span> </div>
<div class="line"><span class="lineno"> 4667</span> </div>
<div class="line"><span class="lineno"> 4668</span>        grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bxc,Bxn);</div>
<div class="line"><span class="lineno"> 4669</span>        grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Byc,Byn);</div>
<div class="line"><span class="lineno"> 4670</span>        grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bzc,Bzn);</div>
<div class="line"><span class="lineno"> 4671</span> </div>
<div class="line"><span class="lineno"> 4672</span>        communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>,Bxc,col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5],vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4673</span>        communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>,Byc,col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5],vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4674</span>        communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>,Bzc,col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5],vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4675</span> </div>
<div class="line"><span class="lineno"> 4676</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0 ; is&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 4677</span>                grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>,is,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 4678</span> </div>
<div class="line"><span class="lineno"> 4679</span> </div>
<div class="line"><span class="lineno"> 4680</span> </div>
<div class="line"><span class="lineno"> 4681</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> != 0) { <span class="comment">// EM initialization from RESTART</span></div>
<div class="line"><span class="lineno"> 4682</span>                <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>();  <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 4683</span>        }</div>
<div class="line"><span class="lineno"> 4684</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad57177cc3071efeea79e10bbfcc9ad9e" name="ad57177cc3071efeea79e10bbfcc9ad9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad57177cc3071efeea79e10bbfcc9ad9e">&#9670;&nbsp;</a></span>initDoublePeriodicHarrisWithGaussianHumpPerturbation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initDoublePeriodicHarrisWithGaussianHumpPerturbation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03966">3966</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3967</span>{</div>
<div class="line"><span class="lineno"> 3968</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 3969</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3970</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3971</span>  <span class="comment">// perturbation localized in X</span></div>
<div class="line"><span class="lineno"> 3972</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> pertX = 0.4;</div>
<div class="line"><span class="lineno"> 3973</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> deltax = 8. * delta;</div>
<div class="line"><span class="lineno"> 3974</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> deltay = 4. * delta;</div>
<div class="line"><span class="lineno"> 3975</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> == 0) {</div>
<div class="line"><span class="lineno"> 3976</span>    <span class="comment">// initialize</span></div>
<div class="line"><span class="lineno"> 3977</span>    <span class="keywordflow">if</span> (get_vct().getCartesian_rank() == 0) {</div>
<div class="line"><span class="lineno"> 3978</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3979</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialize GEM Challenge with Pertubation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3980</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3981</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3982</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3983</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3984</span>      cout &lt;&lt; <span class="stringliteral">&quot;Delta (current sheet thickness) = &quot;</span> &lt;&lt; delta &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3985</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++) {</div>
<div class="line"><span class="lineno"> 3986</span>        cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i];</div>
<div class="line"><span class="lineno"> 3987</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[i])</div>
<div class="line"><span class="lineno"> 3988</span>          cout &lt;&lt; <span class="stringliteral">&quot; DRIFTING &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3989</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3990</span>          cout &lt;&lt; <span class="stringliteral">&quot; BACKGROUND &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3991</span>      }</div>
<div class="line"><span class="lineno"> 3992</span>      cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3993</span>    }</div>
<div class="line"><span class="lineno"> 3994</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3995</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3996</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 3997</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> xM = grid-&gt;getXN(i, j, k) - .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>;</div>
<div class="line"><span class="lineno"> 3998</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yB = grid-&gt;getYN(i, j, k) - .25 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>;</div>
<div class="line"><span class="lineno"> 3999</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yT = grid-&gt;getYN(i, j, k) - .75 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>;</div>
<div class="line"><span class="lineno"> 4000</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yBd = yB / delta;</div>
<div class="line"><span class="lineno"> 4001</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yTd = yT / delta;</div>
<div class="line"><span class="lineno"> 4002</span>          <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 4003</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4004</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[is]) {</div>
<div class="line"><span class="lineno"> 4005</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> sech_yBd = 1. / cosh(yBd);</div>
<div class="line"><span class="lineno"> 4006</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> sech_yTd = 1. / cosh(yTd);</div>
<div class="line"><span class="lineno"> 4007</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] * sech_yBd * sech_yBd / FourPI;</div>
<div class="line"><span class="lineno"> 4008</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] += <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] * sech_yTd * sech_yTd / FourPI;</div>
<div class="line"><span class="lineno"> 4009</span>            }</div>
<div class="line"><span class="lineno"> 4010</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4011</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 4012</span>          }</div>
<div class="line"><span class="lineno"> 4013</span>          <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 4014</span>          Ex[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4015</span>          Ey[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4016</span>          Ez[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4017</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 4018</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * (-1.0 + tanh(yBd) - tanh(yTd));</div>
<div class="line"><span class="lineno"> 4019</span>          <span class="comment">// add the initial GEM perturbation</span></div>
<div class="line"><span class="lineno"> 4020</span>          Bxn[i][j][k] += 0.;</div>
<div class="line"><span class="lineno"> 4021</span>          Byn[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 4022</span>          <span class="comment">// add the initial X perturbation</span></div>
<div class="line"><span class="lineno"> 4023</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> xMdx = xM / deltax;</div>
<div class="line"><span class="lineno"> 4024</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yBdy = yB / deltay;</div>
<div class="line"><span class="lineno"> 4025</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yTdy = yT / deltay;</div>
<div class="line"><span class="lineno"> 4026</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> humpB = exp(-xMdx * xMdx - yBdy * yBdy);</div>
<div class="line"><span class="lineno"> 4027</span>          Bxn[i][j][k] -= (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * humpB * (2.0 * yBdy);</div>
<div class="line"><span class="lineno"> 4028</span>          Byn[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * humpB * (2.0 * xMdx);</div>
<div class="line"><span class="lineno"> 4029</span>          <span class="comment">// add the second initial X perturbation</span></div>
<div class="line"><span class="lineno"> 4030</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> humpT = exp(-xMdx * xMdx - yTdy * yTdy);</div>
<div class="line"><span class="lineno"> 4031</span>          Bxn[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * humpT * (2.0 * yTdy);</div>
<div class="line"><span class="lineno"> 4032</span>          Byn[i][j][k] -= (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * humpT * (2.0 * xMdx);</div>
<div class="line"><span class="lineno"> 4033</span> </div>
<div class="line"><span class="lineno"> 4034</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 4035</span>          Bzn[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 4036</span>        }</div>
<div class="line"><span class="lineno"> 4037</span>    <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 4038</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bxn, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4039</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Byn, col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4040</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bzn, col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4041</span> </div>
<div class="line"><span class="lineno"> 4042</span>    <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 4043</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 4044</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 4045</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 4046</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> xM = grid-&gt;getXN(i, j, k) - .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>;</div>
<div class="line"><span class="lineno"> 4047</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yB = grid-&gt;getYN(i, j, k) - .25 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>;</div>
<div class="line"><span class="lineno"> 4048</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yT = grid-&gt;getYN(i, j, k) - .75 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>;</div>
<div class="line"><span class="lineno"> 4049</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yBd = yB / delta;</div>
<div class="line"><span class="lineno"> 4050</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yTd = yT / delta;</div>
<div class="line"><span class="lineno"> 4051</span>          Bxc[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * (-1.0 + tanh(yBd) - tanh(yTd));</div>
<div class="line"><span class="lineno"> 4052</span>          <span class="comment">// add the initial GEM perturbation</span></div>
<div class="line"><span class="lineno"> 4053</span>          Bxc[i][j][k] += 0.;</div>
<div class="line"><span class="lineno"> 4054</span>          Byc[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 4055</span>          <span class="comment">// add the initial X perturbation</span></div>
<div class="line"><span class="lineno"> 4056</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> xMdx = xM / deltax;</div>
<div class="line"><span class="lineno"> 4057</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yBdy = yB / deltay;</div>
<div class="line"><span class="lineno"> 4058</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yTdy = yT / deltay;</div>
<div class="line"><span class="lineno"> 4059</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> humpB = exp(-xMdx * xMdx - yBdy * yBdy);</div>
<div class="line"><span class="lineno"> 4060</span>          Bxc[i][j][k] -= (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * humpB * (2.0 * yBdy);</div>
<div class="line"><span class="lineno"> 4061</span>          Byc[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * humpB * (2.0 * xMdx);</div>
<div class="line"><span class="lineno"> 4062</span>          <span class="comment">// add the second initial X perturbation</span></div>
<div class="line"><span class="lineno"> 4063</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> humpT = exp(-xMdx * xMdx - yTdy * yTdy);</div>
<div class="line"><span class="lineno"> 4064</span>          Bxc[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * humpT * (2.0 * yTdy);</div>
<div class="line"><span class="lineno"> 4065</span>          Byc[i][j][k] -= (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * humpT * (2.0 * xMdx);</div>
<div class="line"><span class="lineno"> 4066</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 4067</span>          Bzc[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 4068</span>        }</div>
<div class="line"><span class="lineno"> 4069</span>    <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 4070</span>    communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bxc, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4071</span>    communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Byc, col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4072</span>    communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bzc, col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5], vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4073</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 4074</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 4075</span>  }</div>
<div class="line"><span class="lineno"> 4076</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4077</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>(); <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 4078</span>  }</div>
<div class="line"><span class="lineno"> 4079</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af6d5e7de02d7fd26136c34c190f6b98e" name="af6d5e7de02d7fd26136c34c190f6b98e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6d5e7de02d7fd26136c34c190f6b98e">&#9670;&nbsp;</a></span>initEM_rotate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initEM_rotate </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >initialized with rotated magnetic field</p>
<p >initialize EM field with transverse electric waves 1D and rotate anticlockwise (theta degrees) </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03196">3196</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3197</span>{</div>
<div class="line"><span class="lineno"> 3198</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3199</span> </div>
<div class="line"><span class="lineno"> 3200</span>  <span class="comment">// initialize E and rhos on nodes</span></div>
<div class="line"><span class="lineno"> 3201</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3202</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++) {</div>
<div class="line"><span class="lineno"> 3203</span>      Ex[i][j][0] = 0.0;</div>
<div class="line"><span class="lineno"> 3204</span>      Ey[i][j][0] = 0.0;</div>
<div class="line"><span class="lineno"> 3205</span>      Ez[i][j][0] = 0.0;</div>
<div class="line"><span class="lineno"> 3206</span>      Bxn[i][j][0] = B * cos(theta * M_PI / 180);</div>
<div class="line"><span class="lineno"> 3207</span>      Byn[i][j][0] = B * sin(theta * M_PI / 180);</div>
<div class="line"><span class="lineno"> 3208</span>      Bzn[i][j][0] = 0.0;</div>
<div class="line"><span class="lineno"> 3209</span>      <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[0][i][j][0] = 0.07957747154595; <span class="comment">// electrons: species is now first index</span></div>
<div class="line"><span class="lineno"> 3210</span>      <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[1][i][j][0] = 0.07957747154595; <span class="comment">// protons: species is now first index</span></div>
<div class="line"><span class="lineno"> 3211</span>    }</div>
<div class="line"><span class="lineno"> 3212</span>  <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 3213</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bxc, Bxn);</div>
<div class="line"><span class="lineno"> 3214</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Byc, Byn);</div>
<div class="line"><span class="lineno"> 3215</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bzc, Bzn);</div>
<div class="line"><span class="lineno"> 3216</span> </div>
<div class="line"><span class="lineno"> 3217</span> </div>
<div class="line"><span class="lineno"> 3218</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3219</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 3220</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="ac0d93a724eee82bbff670ac51ade9167" name="ac0d93a724eee82bbff670ac51ade9167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0d93a724eee82bbff670ac51ade9167">&#9670;&nbsp;</a></span>initForceFree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initForceFree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Init Force Free (JxB=0) </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">4376</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4377</span>{</div>
<div class="line"><span class="lineno"> 4378</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 4379</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 4380</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> == 0) {</div>
<div class="line"><span class="lineno"> 4381</span> </div>
<div class="line"><span class="lineno"> 4382</span>    <span class="comment">// initialize</span></div>
<div class="line"><span class="lineno"> 4383</span>    <span class="keywordflow">if</span> (get_vct().getCartesian_rank() == 0) {</div>
<div class="line"><span class="lineno"> 4384</span>      cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4385</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialize Force Free with Perturbation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4386</span>      cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4387</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4388</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4389</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4390</span>      cout &lt;&lt; <span class="stringliteral">&quot;Delta (current sheet thickness) = &quot;</span> &lt;&lt; delta &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4391</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++) {</div>
<div class="line"><span class="lineno"> 4392</span>        cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i];</div>
<div class="line"><span class="lineno"> 4393</span>      }</div>
<div class="line"><span class="lineno"> 4394</span>      cout &lt;&lt; <span class="stringliteral">&quot;Smoothing Factor = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4395</span>      cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4396</span>    }</div>
<div class="line"><span class="lineno"> 4397</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4398</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 4399</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4400</span>          <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 4401</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4402</span>            <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 4403</span>          }</div>
<div class="line"><span class="lineno"> 4404</span>          <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 4405</span>          Ex[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4406</span>          Ey[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4407</span>          Ez[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4408</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 4409</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 4410</span>          <span class="comment">// add the initial GEM perturbation</span></div>
<div class="line"><span class="lineno"> 4411</span>          Bxn[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> / 10.0) * (M_PI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * cos(2 * M_PI * grid-&gt;getXN(i, j, k) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(M_PI * (grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 4412</span>          Byn[i][j][k] = B0y - (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> / 10.0) * (2 * M_PI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(2 * M_PI * grid-&gt;getXN(i, j, k) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * cos(M_PI * (grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 4413</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 4414</span>          Bzn[i][j][k] = B0z / cosh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 4415</span>        }</div>
<div class="line"><span class="lineno"> 4416</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 4417</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 4418</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 4419</span>          Bxc[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 4420</span>          <span class="comment">// add the perturbation</span></div>
<div class="line"><span class="lineno"> 4421</span>          Bxc[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> / 10.0) * (M_PI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * cos(2 * M_PI * grid-&gt;getXC(i, j, k) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(M_PI * (grid-&gt;getYC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 4422</span>          Byc[i][j][k] = B0y - (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> / 10.0) * (2 * M_PI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(2 * M_PI * grid-&gt;getXC(i, j, k) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * cos(M_PI * (grid-&gt;getYC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 4423</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 4424</span>          Bzc[i][j][k] = B0z / cosh((grid-&gt;getYC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 4425</span>        }</div>
<div class="line"><span class="lineno"> 4426</span> </div>
<div class="line"><span class="lineno"> 4427</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 4428</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 4429</span>  }</div>
<div class="line"><span class="lineno"> 4430</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4431</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>(); <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 4432</span>  }</div>
<div class="line"><span class="lineno"> 4433</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00387">Lx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">Ly</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00353">Smooth</a>.</p>

</div>
</div>
<a id="a95bbd1b220ccb257c0908d28d026fd19" name="a95bbd1b220ccb257c0908d28d026fd19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95bbd1b220ccb257c0908d28d026fd19">&#9670;&nbsp;</a></span>initGEM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initGEM </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >initialize GEM challenge</p>
<p >initiliaze EM for GEM challange </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">3601</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3602</span>{</div>
<div class="line"><span class="lineno"> 3603</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3604</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3605</span>  <span class="comment">// perturbation localized in X</span></div>
<div class="line"><span class="lineno"> 3606</span>  <span class="keywordtype">double</span> pertX = 0.4;</div>
<div class="line"><span class="lineno"> 3607</span>  <span class="keywordtype">double</span> xpert, ypert, exp_pert;</div>
<div class="line"><span class="lineno"> 3608</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> == 0) {</div>
<div class="line"><span class="lineno"> 3609</span>    <span class="comment">// initialize</span></div>
<div class="line"><span class="lineno"> 3610</span>    <span class="keywordflow">if</span> (get_vct().getCartesian_rank() == 0) {</div>
<div class="line"><span class="lineno"> 3611</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3612</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialize GEM Challenge with Perturbation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3613</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3614</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3615</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3616</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3617</span>      cout &lt;&lt; <span class="stringliteral">&quot;Delta (current sheet thickness) = &quot;</span> &lt;&lt; delta &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3618</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++) {</div>
<div class="line"><span class="lineno"> 3619</span>        cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i];</div>
<div class="line"><span class="lineno"> 3620</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[i])</div>
<div class="line"><span class="lineno"> 3621</span>          cout &lt;&lt; <span class="stringliteral">&quot; DRIFTING &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3622</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3623</span>          cout &lt;&lt; <span class="stringliteral">&quot; BACKGROUND &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3624</span>      }</div>
<div class="line"><span class="lineno"> 3625</span>      cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3626</span>    }</div>
<div class="line"><span class="lineno"> 3627</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3628</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3629</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 3630</span>          <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 3631</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 3632</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[is])</div>
<div class="line"><span class="lineno"> 3633</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = ((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / (cosh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta) * cosh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta)))) / FourPI;</div>
<div class="line"><span class="lineno"> 3634</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3635</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 3636</span>          }</div>
<div class="line"><span class="lineno"> 3637</span>          <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 3638</span>          Ex[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3639</span>          Ey[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3640</span>          Ez[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3641</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 3642</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 3643</span>          <span class="comment">// add the initial GEM perturbation</span></div>
<div class="line"><span class="lineno"> 3644</span>          <span class="comment">// Bxn[i][j][k] += (B0x/10.0)*(M_PI/Ly)*cos(2*M_PI*grid-&gt;getXN(i,j,k)/Lx)*sin(M_PI*(grid-&gt;getYN(i,j,k)- Ly/2)/Ly );</span></div>
<div class="line"><span class="lineno"> 3645</span>          Byn[i][j][k] = B0y;   <span class="comment">// - (B0x/10.0)*(2*M_PI/Lx)*sin(2*M_PI*grid-&gt;getXN(i,j,k)/Lx)*cos(M_PI*(grid-&gt;getYN(i,j,k)- Ly/2)/Ly); </span></div>
<div class="line"><span class="lineno"> 3646</span>          <span class="comment">// add the initial X perturbation</span></div>
<div class="line"><span class="lineno"> 3647</span>          xpert = grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2;</div>
<div class="line"><span class="lineno"> 3648</span>          ypert = grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2;</div>
<div class="line"><span class="lineno"> 3649</span>          exp_pert = exp(-(xpert / delta) * (xpert / delta) - (ypert / delta) * (ypert / delta));</div>
<div class="line"><span class="lineno"> 3650</span>          Bxn[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * exp_pert * (-cos(M_PI * xpert / 10.0 / delta) * cos(M_PI * ypert / 10.0 / delta) * 2.0 * ypert / delta - cos(M_PI * xpert / 10.0 / delta) * sin(M_PI * ypert / 10.0 / delta) * M_PI / 10.0);</div>
<div class="line"><span class="lineno"> 3651</span>          Byn[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * exp_pert * (cos(M_PI * xpert / 10.0 / delta) * cos(M_PI * ypert / 10.0 / delta) * 2.0 * xpert / delta + sin(M_PI * xpert / 10.0 / delta) * cos(M_PI * ypert / 10.0 / delta) * M_PI / 10.0);</div>
<div class="line"><span class="lineno"> 3652</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 3653</span>          Bzn[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 3654</span>        }</div>
<div class="line"><span class="lineno"> 3655</span>    <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 3656</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 3657</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 3658</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 3659</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 3660</span>          Bxc[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 3661</span>          <span class="comment">// add the initial GEM perturbation</span></div>
<div class="line"><span class="lineno"> 3662</span>          <span class="comment">// Bxc[i][j][k] += (B0x/10.0)*(M_PI/Ly)*cos(2*M_PI*grid-&gt;getXC(i,j,k)/Lx)*sin(M_PI*(grid-&gt;getYC(i,j,k)- Ly/2)/Ly );</span></div>
<div class="line"><span class="lineno"> 3663</span>          Byc[i][j][k] = B0y;   <span class="comment">// - (B0x/10.0)*(2*M_PI/Lx)*sin(2*M_PI*grid-&gt;getXC(i,j,k)/Lx)*cos(M_PI*(grid-&gt;getYC(i,j,k)- Ly/2)/Ly); </span></div>
<div class="line"><span class="lineno"> 3664</span>          <span class="comment">// add the initial X perturbation</span></div>
<div class="line"><span class="lineno"> 3665</span>          xpert = grid-&gt;getXC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2;</div>
<div class="line"><span class="lineno"> 3666</span>          ypert = grid-&gt;getYC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2;</div>
<div class="line"><span class="lineno"> 3667</span>          exp_pert = exp(-(xpert / delta) * (xpert / delta) - (ypert / delta) * (ypert / delta));</div>
<div class="line"><span class="lineno"> 3668</span>          Bxc[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * exp_pert * (-cos(M_PI * xpert / 10.0 / delta) * cos(M_PI * ypert / 10.0 / delta) * 2.0 * ypert / delta - cos(M_PI * xpert / 10.0 / delta) * sin(M_PI * ypert / 10.0 / delta) * M_PI / 10.0);</div>
<div class="line"><span class="lineno"> 3669</span>          Byc[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * exp_pert * (cos(M_PI * xpert / 10.0 / delta) * cos(M_PI * ypert / 10.0 / delta) * 2.0 * xpert / delta + sin(M_PI * xpert / 10.0 / delta) * cos(M_PI * ypert / 10.0 / delta) * M_PI / 10.0);</div>
<div class="line"><span class="lineno"> 3670</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 3671</span>          Bzc[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 3672</span> </div>
<div class="line"><span class="lineno"> 3673</span>        }</div>
<div class="line"><span class="lineno"> 3674</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3675</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 3676</span>  }</div>
<div class="line"><span class="lineno"> 3677</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3678</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>(); <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 3679</span>  }</div>
<div class="line"><span class="lineno"> 3680</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00557">DriftSpecies</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00387">Lx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">Ly</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="a81c48a8b25b5a133d034bf6b339e35c5" name="a81c48a8b25b5a133d034bf6b339e35c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81c48a8b25b5a133d034bf6b339e35c5">&#9670;&nbsp;</a></span>initGEMDipoleLikeTailNoPert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initGEMDipoleLikeTailNoPert </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >initialize GEM challenge with dipole-like tail without perturbation</p>
<p >initialize GEM challenge with no Perturbation with dipole-like tail topology </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">4083</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4084</span>{</div>
<div class="line"><span class="lineno"> 4085</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 4086</span>  <span class="comment">// parameters controling the field topology</span></div>
<div class="line"><span class="lineno"> 4087</span>  <span class="comment">// e.g., x1=Lx/5,x2=Lx/4 give &#39;separated&#39; fields, x1=Lx/4,x2=Lx/3 give &#39;reconnected&#39; topology</span></div>
<div class="line"><span class="lineno"> 4088</span> </div>
<div class="line"><span class="lineno"> 4089</span>  <span class="keywordtype">double</span> x1 = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 6.0;         <span class="comment">// minimal position of the gaussian peak </span></div>
<div class="line"><span class="lineno"> 4090</span>  <span class="keywordtype">double</span> x2 = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 4.0;         <span class="comment">// maximal position of the gaussian peak (the one closer to the center)</span></div>
<div class="line"><span class="lineno"> 4091</span>  <span class="keywordtype">double</span> sigma = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 15;       <span class="comment">// base sigma of the gaussian - later it changes with the grid</span></div>
<div class="line"><span class="lineno"> 4092</span>  <span class="keywordtype">double</span> stretch_curve = 2.0;   <span class="comment">// stretch the sin^2 function over the x dimension - also can regulate the number of &#39;knots/reconnecitons points&#39; if less than 1</span></div>
<div class="line"><span class="lineno"> 4093</span>  <span class="keywordtype">double</span> skew_parameter = 0.50; <span class="comment">// skew of the shape of the gaussian</span></div>
<div class="line"><span class="lineno"> 4094</span>  <span class="keywordtype">double</span> pi = 3.1415927;</div>
<div class="line"><span class="lineno"> 4095</span>  <span class="keywordtype">double</span> r1, r2, delta_x1x2;</div>
<div class="line"><span class="lineno"> 4096</span> </div>
<div class="line"><span class="lineno"> 4097</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> == 0) {</div>
<div class="line"><span class="lineno"> 4098</span> </div>
<div class="line"><span class="lineno"> 4099</span>    <span class="comment">// initialize</span></div>
<div class="line"><span class="lineno"> 4100</span>    <span class="keywordflow">if</span> (get_vct().getCartesian_rank() == 0) {</div>
<div class="line"><span class="lineno"> 4101</span>      cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4102</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialize GEM Challenge without Perturbation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4103</span>      cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4104</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4105</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4106</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4107</span>      cout &lt;&lt; <span class="stringliteral">&quot;Delta (current sheet thickness) = &quot;</span> &lt;&lt; delta &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4108</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++) {</div>
<div class="line"><span class="lineno"> 4109</span>        cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i];</div>
<div class="line"><span class="lineno"> 4110</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[i])</div>
<div class="line"><span class="lineno"> 4111</span>          cout &lt;&lt; <span class="stringliteral">&quot; DRIFTING &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4112</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4113</span>          cout &lt;&lt; <span class="stringliteral">&quot; BACKGROUND &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4114</span>      }</div>
<div class="line"><span class="lineno"> 4115</span>      cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4116</span>    }</div>
<div class="line"><span class="lineno"> 4117</span> </div>
<div class="line"><span class="lineno"> 4118</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4119</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 4120</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4121</span>          <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 4122</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4123</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[is])</div>
<div class="line"><span class="lineno"> 4124</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = ((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / (cosh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta) * cosh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta)))) / FourPI;</div>
<div class="line"><span class="lineno"> 4125</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4126</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 4127</span>          }</div>
<div class="line"><span class="lineno"> 4128</span>          <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 4129</span>          Ex[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4130</span>          Ey[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4131</span>          Ez[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4132</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 4133</span> </div>
<div class="line"><span class="lineno"> 4134</span>          delta_x1x2 = x1 - x2 * (sin(((grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0 / stretch_curve) * (0.25 * FourPI) / 180.0)) * (sin(((grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0 / stretch_curve) * (0.25 * FourPI) / 180.0));</div>
<div class="line"><span class="lineno"> 4135</span> </div>
<div class="line"><span class="lineno"> 4136</span>          r1 = (grid-&gt;getYN(i, j, k) - (x1 + delta_x1x2)) * (1.0 - skew_parameter * (sin(((grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0) * (0.25 * FourPI) / 180.0)) * (sin(((grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0) * (0.25 * FourPI) / 180.0)));</div>
<div class="line"><span class="lineno"> 4137</span>          r2 = (grid-&gt;getYN(i, j, k) - ((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> - x1) - delta_x1x2)) * (1.0 - skew_parameter * (sin(((grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0) * (0.25 * FourPI) / 180.0)) * (sin(((grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0) * (0.25 * FourPI) / 180.0)));</div>
<div class="line"><span class="lineno"> 4138</span> </div>
<div class="line"><span class="lineno"> 4139</span>          <span class="comment">// tail-like field topology</span></div>
<div class="line"><span class="lineno"> 4140</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * 0.5 * (-exp(-((r1) * (r1)) / (sigma * sigma)) + exp(-((r2) * (r2)) / (sigma * sigma)));</div>
<div class="line"><span class="lineno"> 4141</span> </div>
<div class="line"><span class="lineno"> 4142</span>          Byn[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 4143</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 4144</span>          Bzn[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 4145</span>        }</div>
<div class="line"><span class="lineno"> 4146</span>    <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 4147</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 4148</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 4149</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 4150</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 4151</span> </div>
<div class="line"><span class="lineno"> 4152</span>          delta_x1x2 = x1 - x2 * (sin(((grid-&gt;getXC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0 / stretch_curve) * (0.25 * FourPI) / 180.0)) * (sin(((grid-&gt;getXC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0 / stretch_curve) * (0.25 * FourPI) / 180.0));</div>
<div class="line"><span class="lineno"> 4153</span> </div>
<div class="line"><span class="lineno"> 4154</span>          r1 = (grid-&gt;getYC(i, j, k) - (x1 + delta_x1x2)) * (1.0 - skew_parameter * (sin(((grid-&gt;getXC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0) * (0.25 * FourPI) / 180.0)) * (sin(((grid-&gt;getXC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0) * (0.25 * FourPI) / 180.0)));</div>
<div class="line"><span class="lineno"> 4155</span>          r2 = (grid-&gt;getYC(i, j, k) - ((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> - x1) - delta_x1x2)) * (1.0 - skew_parameter * (sin(((grid-&gt;getXC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0) * (0.25 * FourPI) / 180.0)) * (sin(((grid-&gt;getXC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2) / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> * 180.0) * (0.25 * FourPI) / 180.0)));</div>
<div class="line"><span class="lineno"> 4156</span> </div>
<div class="line"><span class="lineno"> 4157</span>          <span class="comment">// tail-like field topology</span></div>
<div class="line"><span class="lineno"> 4158</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * 0.5 * (-exp(-((r1) * (r1)) / (sigma * sigma)) + exp(-((r2) * (r2)) / (sigma * sigma)));</div>
<div class="line"><span class="lineno"> 4159</span> </div>
<div class="line"><span class="lineno"> 4160</span>          Byc[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 4161</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 4162</span>          Bzc[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 4163</span> </div>
<div class="line"><span class="lineno"> 4164</span>        }</div>
<div class="line"><span class="lineno"> 4165</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 4166</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 4167</span>  }</div>
<div class="line"><span class="lineno"> 4168</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4169</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>(); <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 4170</span>  }</div>
<div class="line"><span class="lineno"> 4171</span> </div>
<div class="line"><span class="lineno"> 4172</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00557">DriftSpecies</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00387">Lx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">Ly</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="a35eb0192bf280b8507f1363975542a95" name="a35eb0192bf280b8507f1363975542a95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35eb0192bf280b8507f1363975542a95">&#9670;&nbsp;</a></span>initGEMDoubleHarris()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initGEMDoubleHarris </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03881">3881</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3882</span>{</div>
<div class="line"><span class="lineno"> 3883</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 3884</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3885</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3886</span> </div>
<div class="line"><span class="lineno"> 3887</span>  <span class="keywordtype">double</span> pertX = 0.4;</div>
<div class="line"><span class="lineno"> 3888</span>  <span class="keywordtype">double</span> xpert, ypert, exp_pert;</div>
<div class="line"><span class="lineno"> 3889</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> == 0){</div>
<div class="line"><span class="lineno"> 3890</span> </div>
<div class="line"><span class="lineno"> 3891</span>    <span class="keywordflow">if</span> (vct-&gt;getCartesian_rank() ==0){</div>
<div class="line"><span class="lineno"> 3892</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3893</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialize Double Harris Sheet with Perturbation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3894</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3895</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3896</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3897</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3898</span>      cout &lt;&lt; <span class="stringliteral">&quot;Delta (current sheet thickness)  = &quot;</span> &lt;&lt; delta &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3899</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++){</div>
<div class="line"><span class="lineno"> 3900</span>        cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt;<span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i];</div>
<div class="line"><span class="lineno"> 3901</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[i])</div>
<div class="line"><span class="lineno"> 3902</span>          cout &lt;&lt; <span class="stringliteral">&quot; DRIFTING &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3903</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3904</span>          cout &lt;&lt; <span class="stringliteral">&quot; BACKGROUND &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3905</span>      }</div>
<div class="line"><span class="lineno"> 3906</span>      cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3907</span>    }</div>
<div class="line"><span class="lineno"> 3908</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3909</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3910</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 3911</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> xM = grid-&gt;getXN(i,j,k) - 0.5*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>;</div>
<div class="line"><span class="lineno"> 3912</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yB = grid-&gt;getYN(i,j,k) - 0.25*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>;</div>
<div class="line"><span class="lineno"> 3913</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yT = grid-&gt;getYN(i,j,k) - 0.75*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>;</div>
<div class="line"><span class="lineno"> 3914</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yBd = yB/delta;</div>
<div class="line"><span class="lineno"> 3915</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yTd = yT/delta;</div>
<div class="line"><span class="lineno"> 3916</span>          <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 3917</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++){</div>
<div class="line"><span class="lineno"> 3918</span>            <span class="comment">//dprintf(&quot;is=%d, DriftSpecies[is]=%d&quot;,is,DriftSpecies[is]);</span></div>
<div class="line"><span class="lineno"> 3919</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[is]){</div>
<div class="line"><span class="lineno"> 3920</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> sech_yBd = 1./cosh(yBd);<span class="comment">//+1e-5;</span></div>
<div class="line"><span class="lineno"> 3921</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> sech_yTd = 1./cosh(yTd);<span class="comment">//+1e-5;</span></div>
<div class="line"><span class="lineno"> 3922</span>              <span class="keywordflow">if</span> (is == 0 || is == 1)</div>
<div class="line"><span class="lineno"> 3923</span>                <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is]*sech_yBd*sech_yBd/FourPI;</div>
<div class="line"><span class="lineno"> 3924</span>              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is == 2 || is == 3)</div>
<div class="line"><span class="lineno"> 3925</span>                <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is]*sech_yTd*sech_yTd/FourPI;</div>
<div class="line"><span class="lineno"> 3926</span>            }</div>
<div class="line"><span class="lineno"> 3927</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3928</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is]/FourPI;</div>
<div class="line"><span class="lineno"> 3929</span>          }</div>
<div class="line"><span class="lineno"> 3930</span>          <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 3931</span>          Ex[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 3932</span>          Ey[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 3933</span>          Ez[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 3934</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 3935</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*(-1.0+tanh(yBd)-tanh(yTd));</div>
<div class="line"><span class="lineno"> 3936</span>          Byn[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 3937</span>          Bzn[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 3938</span>          <span class="comment">// add the initial X perturbation</span></div>
<div class="line"><span class="lineno"> 3939</span>          xpert = grid-&gt;getXN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a> / 2;</div>
<div class="line"><span class="lineno"> 3940</span>          ypert = yB;</div>
<div class="line"><span class="lineno"> 3941</span>          exp_pert = exp(-(xpert / delta) * (xpert / delta) - (ypert / delta) * (ypert / delta));</div>
<div class="line"><span class="lineno"> 3942</span>          Bxn[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * exp_pert * (-cos(M_PI * xpert / 10.0 / delta) * cos(M_PI * ypert / 10.0 / delta) * 2.0 * ypert / delta - cos(M_PI * xpert / 10.0 / delta) * sin(M_PI * ypert / 10.0 / delta) * M_PI / 10.0);</div>
<div class="line"><span class="lineno"> 3943</span>          Byn[i][j][k] += (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * pertX) * exp_pert * (cos(M_PI * xpert / 10.0 / delta) * cos(M_PI * ypert / 10.0 / delta) * 2.0 * xpert / delta + sin(M_PI * xpert / 10.0 / delta) * cos(M_PI * ypert / 10.0 / delta) * M_PI / 10.0);</div>
<div class="line"><span class="lineno"> 3944</span> </div>
<div class="line"><span class="lineno"> 3945</span>        }</div>
<div class="line"><span class="lineno"> 3946</span> </div>
<div class="line"><span class="lineno"> 3947</span>    <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 3948</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bxn, 1, 1, 2, 2, 1, 1, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3949</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Byn, 1, 1, 1, 1, 1, 1, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3950</span>    communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bzn, 1, 1, 2, 2, 1, 1, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3951</span>    <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 3952</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bxc, Bxn);</div>
<div class="line"><span class="lineno"> 3953</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Byc, Byn);</div>
<div class="line"><span class="lineno"> 3954</span>    grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bzc, Bzn);</div>
<div class="line"><span class="lineno"> 3955</span>    <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 3956</span>    communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bxc, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3957</span>    communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Byc, 1, 1, 1, 1, 1, 1, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3958</span>    communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bzc, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3959</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0 ; is&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3960</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>,is,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 3961</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3962</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>();  <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 3963</span>  }</div>
<div class="line"><span class="lineno"> 3964</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a165535d148dace01d11a9bedb89b0370" name="a165535d148dace01d11a9bedb89b0370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a165535d148dace01d11a9bedb89b0370">&#9670;&nbsp;</a></span>initGEMnoPert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initGEMnoPert </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >initialize GEM challenge with no Perturbation </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">4175</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4176</span>{</div>
<div class="line"><span class="lineno"> 4177</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 4178</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 4179</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 4180</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> == 0) {</div>
<div class="line"><span class="lineno"> 4181</span> </div>
<div class="line"><span class="lineno"> 4182</span>    <span class="comment">// initialize</span></div>
<div class="line"><span class="lineno"> 4183</span>    <span class="keywordflow">if</span> (get_vct().getCartesian_rank() == 0) {</div>
<div class="line"><span class="lineno"> 4184</span>      cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4185</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialize GEM Challenge without Perturbation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4186</span>      cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4187</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4188</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4189</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4190</span>      cout &lt;&lt; <span class="stringliteral">&quot;Delta (current sheet thickness) = &quot;</span> &lt;&lt; delta &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4191</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++) {</div>
<div class="line"><span class="lineno"> 4192</span>        cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i];</div>
<div class="line"><span class="lineno"> 4193</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[i])</div>
<div class="line"><span class="lineno"> 4194</span>          cout &lt;&lt; <span class="stringliteral">&quot; DRIFTING &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4195</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4196</span>          cout &lt;&lt; <span class="stringliteral">&quot; BACKGROUND &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4197</span>      }</div>
<div class="line"><span class="lineno"> 4198</span>      cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4199</span>    }</div>
<div class="line"><span class="lineno"> 4200</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4201</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 4202</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4203</span>          <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 4204</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4205</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[is])</div>
<div class="line"><span class="lineno"> 4206</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = ((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / (cosh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta) * cosh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta)))) / FourPI;</div>
<div class="line"><span class="lineno"> 4207</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4208</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 4209</span>          }</div>
<div class="line"><span class="lineno"> 4210</span>          <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 4211</span>          Ex[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4212</span>          Ey[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4213</span>          Ez[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4214</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 4215</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 4216</span>          Byn[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 4217</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 4218</span>          Bzn[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 4219</span>        }</div>
<div class="line"><span class="lineno"> 4220</span>    <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 4221</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 4222</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 4223</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 4224</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 4225</span>          Bxc[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh((grid-&gt;getYC(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta);</div>
<div class="line"><span class="lineno"> 4226</span>          Byc[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 4227</span>          <span class="comment">// guide field</span></div>
<div class="line"><span class="lineno"> 4228</span>          Bzc[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 4229</span> </div>
<div class="line"><span class="lineno"> 4230</span>        }</div>
<div class="line"><span class="lineno"> 4231</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 4232</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 4233</span>  }</div>
<div class="line"><span class="lineno"> 4234</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4235</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>(); <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 4236</span>  }</div>
<div class="line"><span class="lineno"> 4237</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00557">DriftSpecies</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">Ly</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="a37c415cb712c9d626a19f0a7bcdaa682" name="a37c415cb712c9d626a19f0a7bcdaa682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37c415cb712c9d626a19f0a7bcdaa682">&#9670;&nbsp;</a></span>initNullPoints()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initNullPoints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initialise magnetic nulls </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">3683</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3684</span>{</div>
<div class="line"><span class="lineno"> 3685</span>        <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3686</span>        <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3687</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> ==0){</div>
<div class="line"><span class="lineno"> 3688</span>                <span class="keywordflow">if</span> (vct-&gt;getCartesian_rank() ==0){</div>
<div class="line"><span class="lineno"> 3689</span>                        cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3690</span>                        cout &lt;&lt; <span class="stringliteral">&quot;       Initialize 3D null point(s)&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3691</span>                        cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3692</span>                        cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3693</span>                        cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3694</span>                        cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3695</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++){</div>
<div class="line"><span class="lineno"> 3696</span>                                cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt;<span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i] &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3697</span>                        }</div>
<div class="line"><span class="lineno"> 3698</span>                        cout &lt;&lt; <span class="stringliteral">&quot;Smoothing Factor = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3699</span>                        cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3700</span>                }</div>
<div class="line"><span class="lineno"> 3701</span> </div>
<div class="line"><span class="lineno"> 3702</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3703</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3704</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 3705</span>                   <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 3706</span>                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3707</span>                           <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is]/FourPI;</div>
<div class="line"><span class="lineno"> 3708</span> </div>
<div class="line"><span class="lineno"> 3709</span>                        <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 3710</span>                        Ex[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 3711</span>                        Ey[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 3712</span>                        Ez[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 3713</span>                        <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 3714</span>                        Bxn[i][j][k] = -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*cos(2.*M_PI*grid-&gt;getXN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>)*sin(2.*M_PI*grid-&gt;getYN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 3715</span>                        Byn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*cos(2.*M_PI*grid-&gt;getYN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>)*(-2.*sin(2.*M_PI*grid-&gt;getZN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>) + sin(2.*M_PI*grid-&gt;getXN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>));</div>
<div class="line"><span class="lineno"> 3716</span>                        Bzn[i][j][k] = 2.*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*cos(2.*M_PI*grid-&gt;getZN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>)*sin(2.*M_PI*grid-&gt;getYN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 3717</span>                }</div>
<div class="line"><span class="lineno"> 3718</span> </div>
<div class="line"><span class="lineno"> 3719</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 3720</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 3721</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 3722</span>                        Bxc[i][j][k] = -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*cos(2.*M_PI*grid-&gt;getXC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>)*sin(2.*M_PI*grid-&gt;getYC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 3723</span>                        Byc[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*cos(2.*M_PI*grid-&gt;getYC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>)*(-2.*sin(2.*M_PI*grid-&gt;getZC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>) + sin(2.*M_PI*grid-&gt;getXC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>));</div>
<div class="line"><span class="lineno"> 3724</span>                        Bzc[i][j][k] = 2.*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*cos(2.*M_PI*grid-&gt;getZC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>)*sin(2.*M_PI*grid-&gt;getYC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 3725</span>                }</div>
<div class="line"><span class="lineno"> 3726</span> </div>
<div class="line"><span class="lineno"> 3727</span>            <span class="comment">// currents are used to calculate in the Maxwell&#39;s solver</span></div>
<div class="line"><span class="lineno"> 3728</span>            <span class="comment">// The ion current is equal to 0 (all current is on electrons)</span></div>
<div class="line"><span class="lineno"> 3729</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3730</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3731</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 3732</span>                        Jxs[1][i][j][k] = 0.0; <span class="comment">// ion species is species 1</span></div>
<div class="line"><span class="lineno"> 3733</span>                        Jys[1][i][j][k] = 0.0; <span class="comment">// ion species is species 1</span></div>
<div class="line"><span class="lineno"> 3734</span>                        Jzs[1][i][j][k] = 0.0; <span class="comment">// ion species is species 1</span></div>
<div class="line"><span class="lineno"> 3735</span>                }</div>
<div class="line"><span class="lineno"> 3736</span> </div>
<div class="line"><span class="lineno"> 3737</span>            <span class="comment">// calculate the electron current from</span></div>
<div class="line"><span class="lineno"> 3738</span>        eqValue(0.0,tempXN,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 3739</span>        eqValue(0.0,tempYN,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 3740</span>        eqValue(0.0,tempZN,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 3741</span>        grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#addb84d4c44fa581db17b309195a38e44">curlC2N</a>(tempXN,tempYN,tempZN,Bxc,Byc,Bzc); <span class="comment">// here you calculate curl(B)</span></div>
<div class="line"><span class="lineno"> 3742</span>        <span class="comment">// all current is on electrons, calculated from Ampere&#39;s law</span></div>
<div class="line"><span class="lineno"> 3743</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3744</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3745</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){  <span class="comment">// electrons are species 0</span></div>
<div class="line"><span class="lineno"> 3746</span>                        Jxs[0][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>*tempXN[i][j][k]/FourPI; <span class="comment">// ion species is species 1</span></div>
<div class="line"><span class="lineno"> 3747</span>                        Jys[0][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>*tempYN[i][j][k]/FourPI; <span class="comment">// ion species is species 1</span></div>
<div class="line"><span class="lineno"> 3748</span>                        Jzs[0][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>*tempZN[i][j][k]/FourPI; <span class="comment">// ion species is species 1</span></div>
<div class="line"><span class="lineno"> 3749</span>                }</div>
<div class="line"><span class="lineno"> 3750</span> </div>
<div class="line"><span class="lineno"> 3751</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0 ; is&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3752</span>                        grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>,is,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 3753</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3754</span>                <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>();  <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 3755</span>        }</div>
<div class="line"><span class="lineno"> 3756</span>}</div>
<div class="ttc" id="aclass_grid3_d_c_u_html_addb84d4c44fa581db17b309195a38e44"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html#addb84d4c44fa581db17b309195a38e44">Grid3DCU::curlC2N</a></div><div class="ttdeci">void curlC2N(arr3_double curlXN, arr3_double curlYN, arr3_double curlZN, const_arr3_double vecFieldXC, const_arr3_double vecFieldYC, const_arr3_double vecFieldZC) const</div><div class="ttdoc">calculate curl on nodes, given a vector field defined on central points</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#addb84d4c44fa581db17b309195a38e44">Grid3DCU::curlC2N()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00387">Lx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">Ly</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00391">Lz</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00353">Smooth</a>.</p>

</div>
</div>
<a id="afc4050255fff26fabb77d204492d1fdc" name="afc4050255fff26fabb77d204492d1fdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc4050255fff26fabb77d204492d1fdc">&#9670;&nbsp;</a></span>initOriginalGEM()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initOriginalGEM </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03814">3814</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3815</span>{</div>
<div class="line"><span class="lineno"> 3816</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3817</span>  <span class="comment">// perturbation localized in X</span></div>
<div class="line"><span class="lineno"> 3818</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> == 0) {</div>
<div class="line"><span class="lineno"> 3819</span>    <span class="comment">// initialize</span></div>
<div class="line"><span class="lineno"> 3820</span>    <span class="keywordflow">if</span> (get_vct().getCartesian_rank() == 0) {</div>
<div class="line"><span class="lineno"> 3821</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3822</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialize GEM Challenge with Pertubation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3823</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3824</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3825</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3826</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3827</span>      cout &lt;&lt; <span class="stringliteral">&quot;Delta (current sheet thickness) = &quot;</span> &lt;&lt; delta &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3828</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++) {</div>
<div class="line"><span class="lineno"> 3829</span>        cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i];</div>
<div class="line"><span class="lineno"> 3830</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[i])</div>
<div class="line"><span class="lineno"> 3831</span>          cout &lt;&lt; <span class="stringliteral">&quot; DRIFTING &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3832</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3833</span>          cout &lt;&lt; <span class="stringliteral">&quot; BACKGROUND &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3834</span>      }</div>
<div class="line"><span class="lineno"> 3835</span>      cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3836</span>    }</div>
<div class="line"><span class="lineno"> 3837</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3838</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3839</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 3840</span>          <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 3841</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 3842</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[is])</div>
<div class="line"><span class="lineno"> 3843</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = ((<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / (cosh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta) * cosh((grid-&gt;getYN(i, j, k) - <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a> / 2) / delta)))) / FourPI;</div>
<div class="line"><span class="lineno"> 3844</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3845</span>              <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is] / FourPI;</div>
<div class="line"><span class="lineno"> 3846</span>          }</div>
<div class="line"><span class="lineno"> 3847</span>          <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 3848</span>          Ex[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3849</span>          Ey[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3850</span>          Ez[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3851</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 3852</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yM = grid-&gt;getYN(i, j, k) - .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>;</div>
<div class="line"><span class="lineno"> 3853</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh(yM / delta);</div>
<div class="line"><span class="lineno"> 3854</span>          <span class="comment">// add the initial GEM perturbation</span></div>
<div class="line"><span class="lineno"> 3855</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> xM = grid-&gt;getXN(i, j, k) - .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>;</div>
<div class="line"><span class="lineno"> 3856</span>          Bxn[i][j][k] -= (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> / 10.0) * (M_PI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * cos(2 * M_PI * xM / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(M_PI * yM / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 3857</span>          Byn[i][j][k] = B0y + (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> / 10.0) * (2 * M_PI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(2 * M_PI * xM / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * cos(M_PI * yM / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 3858</span>          Bzn[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 3859</span>        }</div>
<div class="line"><span class="lineno"> 3860</span>    <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 3861</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 3862</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 3863</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 3864</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 3865</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> yM = grid-&gt;getYC(i, j, k) - .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>;</div>
<div class="line"><span class="lineno"> 3866</span>          Bxc[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * tanh(yM / delta);</div>
<div class="line"><span class="lineno"> 3867</span>          <span class="comment">// add the initial GEM perturbation</span></div>
<div class="line"><span class="lineno"> 3868</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> xM = grid-&gt;getXC(i, j, k) - .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>;</div>
<div class="line"><span class="lineno"> 3869</span>          Bxc[i][j][k] -= (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> / 10.0) * (M_PI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * cos(2 * M_PI * xM / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(M_PI * yM / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 3870</span>          Byc[i][j][k] = B0y + (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> / 10.0) * (2 * M_PI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(2 * M_PI * xM / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * cos(M_PI * yM / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>);</div>
<div class="line"><span class="lineno"> 3871</span>          Bzc[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 3872</span>        }</div>
<div class="line"><span class="lineno"> 3873</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3874</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>, is, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 3875</span>  }</div>
<div class="line"><span class="lineno"> 3876</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3877</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>(); <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 3878</span>  }</div>
<div class="line"><span class="lineno"> 3879</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6335e442133ba041fa5d2993fb3bc59" name="ae6335e442133ba041fa5d2993fb3bc59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6335e442133ba041fa5d2993fb3bc59">&#9670;&nbsp;</a></span>initRandomField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initRandomField </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Random initial field </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">4240</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4241</span>{</div>
<div class="line"><span class="lineno"> 4242</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 4243</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 4244</span>  <span class="keywordtype">double</span> **modes_seed = newArr2(<span class="keywordtype">double</span>, 7, 7);</div>
<div class="line"><span class="lineno"> 4245</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> ==0){</div>
<div class="line"><span class="lineno"> 4246</span>    <span class="comment">// initialize</span></div>
<div class="line"><span class="lineno"> 4247</span>    <span class="keywordflow">if</span> (get_vct().getCartesian_rank() ==0){</div>
<div class="line"><span class="lineno"> 4248</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4249</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialize GEM Challenge with Pertubation&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4250</span>      cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4251</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0x                              = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4252</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0y                              = &quot;</span> &lt;&lt; B0y &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4253</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0z                              = &quot;</span> &lt;&lt; B0z &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4254</span>      cout &lt;&lt; <span class="stringliteral">&quot;Delta (current sheet thickness) = &quot;</span> &lt;&lt; delta &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4255</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++){</div>
<div class="line"><span class="lineno"> 4256</span>        cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt;<span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i];</div>
<div class="line"><span class="lineno"> 4257</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac15b1931f27db3db0d53de63848dc78a">DriftSpecies</a>[i])</div>
<div class="line"><span class="lineno"> 4258</span>          cout &lt;&lt; <span class="stringliteral">&quot; DRIFTING &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4259</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4260</span>          cout &lt;&lt; <span class="stringliteral">&quot; BACKGROUND &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4261</span>      }</div>
<div class="line"><span class="lineno"> 4262</span>      cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 4263</span>    }</div>
<div class="line"><span class="lineno"> 4264</span>    <span class="keywordtype">double</span> kx;</div>
<div class="line"><span class="lineno"> 4265</span>    <span class="keywordtype">double</span> ky;</div>
<div class="line"><span class="lineno"> 4266</span>        </div>
<div class="line"><span class="lineno"> 4267</span>    <span class="comment">/*       stringstream num_proc;</span></div>
<div class="line"><span class="lineno"> 4268</span><span class="comment">             num_proc &lt;&lt; vct-&gt;getCartesian_rank() ;</span></div>
<div class="line"><span class="lineno"> 4269</span><span class="comment">             string cqsat = SaveDirName + &quot;/RandomNumbers&quot; + num_proc.str() + &quot;.txt&quot;;</span></div>
<div class="line"><span class="lineno"> 4270</span><span class="comment">        ofstream my_file(cqsat.c_str(), fstream::binary);</span></div>
<div class="line"><span class="lineno"> 4271</span><span class="comment">        for (int m=-3; m &lt; 4; m++)</span></div>
<div class="line"><span class="lineno"> 4272</span><span class="comment">            for (int n=-3; n &lt; 4; n++){</span></div>
<div class="line"><span class="lineno"> 4273</span><span class="comment">            modes_seed[m+3][n+3] = rand() / (double) RAND_MAX;</span></div>
<div class="line"><span class="lineno"> 4274</span><span class="comment">            my_file &lt;&lt;&quot;modes_seed[&quot;&lt;&lt; m+3&lt;&lt;&quot;][&quot; &lt;&lt; &quot;\t&quot; &lt;&lt; n+3 &lt;&lt; &quot;] = &quot; &lt;&lt; modes_seed[m+3][n+3] &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno"> 4275</span><span class="comment">            }</span></div>
<div class="line"><span class="lineno"> 4276</span><span class="comment">              my_file.close();</span></div>
<div class="line"><span class="lineno"> 4277</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno"> 4278</span>    modes_seed[0][0] = 0.532767;</div>
<div class="line"><span class="lineno"> 4279</span>    modes_seed[0][1] = 0.218959;</div>
<div class="line"><span class="lineno"> 4280</span>    modes_seed[0][2] = 0.0470446;</div>
<div class="line"><span class="lineno"> 4281</span>    modes_seed[0][3] = 0.678865;</div>
<div class="line"><span class="lineno"> 4282</span>    modes_seed[0][4] = 0.679296;</div>
<div class="line"><span class="lineno"> 4283</span>    modes_seed[0][5] = 0.934693;</div>
<div class="line"><span class="lineno"> 4284</span>    modes_seed[0][6] = 0.383502;</div>
<div class="line"><span class="lineno"> 4285</span>    modes_seed[1][0] = 0.519416;</div>
<div class="line"><span class="lineno"> 4286</span>    modes_seed[1][1] = 0.830965;</div>
<div class="line"><span class="lineno"> 4287</span>    modes_seed[1][2] = 0.0345721;</div>
<div class="line"><span class="lineno"> 4288</span>    modes_seed[1][3] = 0.0534616;</div>
<div class="line"><span class="lineno"> 4289</span>    modes_seed[1][4] = 0.5297;</div>
<div class="line"><span class="lineno"> 4290</span>    modes_seed[1][5] = 0.671149;</div>
<div class="line"><span class="lineno"> 4291</span>    modes_seed[1][6] = 0.00769819;</div>
<div class="line"><span class="lineno"> 4292</span>    modes_seed[2][0] = 0.383416;</div>
<div class="line"><span class="lineno"> 4293</span>    modes_seed[2][1] = 0.0668422;</div>
<div class="line"><span class="lineno"> 4294</span>    modes_seed[2][2] = 0.417486;</div>
<div class="line"><span class="lineno"> 4295</span>    modes_seed[2][3] = 0.686773;</div>
<div class="line"><span class="lineno"> 4296</span>    modes_seed[2][4] = 0.588977;</div>
<div class="line"><span class="lineno"> 4297</span>    modes_seed[2][5] = 0.930436;</div>
<div class="line"><span class="lineno"> 4298</span>    modes_seed[2][6] = 0.846167;</div>
<div class="line"><span class="lineno"> 4299</span>    modes_seed[3][0] = 0.526929;</div>
<div class="line"><span class="lineno"> 4300</span>    modes_seed[3][1] = 0.0919649;</div>
<div class="line"><span class="lineno"> 4301</span>    modes_seed[3][2] = 0.653919;</div>
<div class="line"><span class="lineno"> 4302</span>    modes_seed[3][3] = 0.415999;</div>
<div class="line"><span class="lineno"> 4303</span>    modes_seed[3][4] = 0.701191;</div>
<div class="line"><span class="lineno"> 4304</span>    modes_seed[3][5] = 0.910321;</div>
<div class="line"><span class="lineno"> 4305</span>    modes_seed[3][6] = 0.762198;</div>
<div class="line"><span class="lineno"> 4306</span>    modes_seed[4][0] = 0.262453;</div>
<div class="line"><span class="lineno"> 4307</span>    modes_seed[4][1] = 0.0474645;</div>
<div class="line"><span class="lineno"> 4308</span>    modes_seed[4][2] = 0.736082;</div>
<div class="line"><span class="lineno"> 4309</span>    modes_seed[4][3] = 0.328234;</div>
<div class="line"><span class="lineno"> 4310</span>    modes_seed[4][4] = 0.632639;</div>
<div class="line"><span class="lineno"> 4311</span>    modes_seed[4][5] = 0.75641;</div>
<div class="line"><span class="lineno"> 4312</span>    modes_seed[4][6] = 0.991037;</div>
<div class="line"><span class="lineno"> 4313</span>    modes_seed[5][0] = 0.365339;</div>
<div class="line"><span class="lineno"> 4314</span>    modes_seed[5][1] = 0.247039;</div>
<div class="line"><span class="lineno"> 4315</span>    modes_seed[5][2] = 0.98255;</div>
<div class="line"><span class="lineno"> 4316</span>    modes_seed[5][3] = 0.72266;</div>
<div class="line"><span class="lineno"> 4317</span>    modes_seed[5][4] = 0.753356;</div>
<div class="line"><span class="lineno"> 4318</span>    modes_seed[5][5] = 0.651519;</div>
<div class="line"><span class="lineno"> 4319</span>    modes_seed[5][6] = 0.0726859;</div>
<div class="line"><span class="lineno"> 4320</span>    modes_seed[6][0] = 0.631635;</div>
<div class="line"><span class="lineno"> 4321</span>    modes_seed[6][1] = 0.884707;</div>
<div class="line"><span class="lineno"> 4322</span>    modes_seed[6][2] = 0.27271;</div>
<div class="line"><span class="lineno"> 4323</span>    modes_seed[6][3] = 0.436411;</div>
<div class="line"><span class="lineno"> 4324</span>    modes_seed[6][4] = 0.766495;</div>
<div class="line"><span class="lineno"> 4325</span>    modes_seed[6][5] = 0.477732;</div>
<div class="line"><span class="lineno"> 4326</span>    modes_seed[6][6] = 0.237774;</div>
<div class="line"><span class="lineno"> 4327</span> </div>
<div class="line"><span class="lineno"> 4328</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4329</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 4330</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 4331</span>          <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 4332</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++){</div>
<div class="line"><span class="lineno"> 4333</span>            <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is]/FourPI;</div>
<div class="line"><span class="lineno"> 4334</span>          }</div>
<div class="line"><span class="lineno"> 4335</span>          <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 4336</span>          Ex[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 4337</span>          Ey[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 4338</span>          Ez[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 4339</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 4340</span>          Bxn[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 4341</span>          Byn[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 4342</span>          Bzn[i][j][k] =  B0z;</div>
<div class="line"><span class="lineno"> 4343</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=-3; m &lt; 4; m++)</div>
<div class="line"><span class="lineno"> 4344</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n=-3; n &lt; 4; n++){</div>
<div class="line"><span class="lineno"> 4345</span> </div>
<div class="line"><span class="lineno"> 4346</span>              kx=2.0*M_PI*m/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>;</div>
<div class="line"><span class="lineno"> 4347</span>              ky=2.0*M_PI*n/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>;</div>
<div class="line"><span class="lineno"> 4348</span>              Bxn[i][j][k] += -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*ky*cos(grid-&gt;getXN(i,j,k)*kx+grid-&gt;getYN(i,j,k)*ky+2.0*M_PI*modes_seed[m+3][n+3]);</div>
<div class="line"><span class="lineno"> 4349</span>              Byn[i][j][k] += <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*kx*cos(grid-&gt;getXN(i,j,k)*kx+grid-&gt;getYN(i,j,k)*ky+2.0*M_PI*modes_seed[m+3][n+3]);</div>
<div class="line"><span class="lineno"> 4350</span>              <span class="comment">// Bzn[i][j][k] += B0x*cos(grid-&gt;getXN(i,j,k)*kx+grid-&gt;getYN(i,j,k)*ky+2.0*M_PI*modes_seed[m+3][n+3]);</span></div>
<div class="line"><span class="lineno"> 4351</span>            }</div>
<div class="line"><span class="lineno"> 4352</span>        }</div>
<div class="line"><span class="lineno"> 4353</span>          <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 4354</span>          communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bxn, 1, 1, 2, 2, 1, 1, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4355</span>          communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Byn, 1, 1, 1, 1, 1, 1, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4356</span>          communicateNodeBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Bzn, 1, 1, 2, 2, 1, 1, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4357</span> </div>
<div class="line"><span class="lineno"> 4358</span>          <span class="comment">// initialize B on centers</span></div>
<div class="line"><span class="lineno"> 4359</span>          grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bxc, Bxn);</div>
<div class="line"><span class="lineno"> 4360</span>          grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Byc, Byn);</div>
<div class="line"><span class="lineno"> 4361</span>          grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(Bzc, Bzn);</div>
<div class="line"><span class="lineno"> 4362</span>          <span class="comment">// communicate ghost</span></div>
<div class="line"><span class="lineno"> 4363</span>          communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bxc, 2, 2, 2, 2, 2, 2, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4364</span>          communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Byc, 1, 1, 1, 1, 1, 1, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4365</span>          communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bzc, 2, 2, 2, 2, 2, 2, vct,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 4366</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0 ; is&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 4367</span>            grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>,is,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 4368</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4369</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>(); <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 4370</span>    }</div>
<div class="line"><span class="lineno"> 4371</span>  delArr2(modes_seed, 7);</div>
<div class="line"><span class="lineno"> 4372</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00557">DriftSpecies</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00387">Lx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">Ly</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="ad17d67dac1e9bcab764afe129a1dc20a" name="ad17d67dac1e9bcab764afe129a1dc20a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad17d67dac1e9bcab764afe129a1dc20a">&#9670;&nbsp;</a></span>initTaylorGreen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::initTaylorGreen </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Initialise Taylor-Green flow </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">3758</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3759</span>{</div>
<div class="line"><span class="lineno"> 3760</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3761</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3762</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a57cb50aa343b780dc7e2d4f9695af5e6">restart1</a> ==0){</div>
<div class="line"><span class="lineno"> 3763</span>    <span class="keywordflow">if</span> (vct-&gt;getCartesian_rank() ==0){</div>
<div class="line"><span class="lineno"> 3764</span>      cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3765</span>      cout &lt;&lt; <span class="stringliteral">&quot;       Initialize Taylor-Green flow     &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3766</span>      cout &lt;&lt; <span class="stringliteral">&quot;----------------------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3767</span>      cout &lt;&lt; <span class="stringliteral">&quot;B0                               = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3768</span>      cout &lt;&lt; <span class="stringliteral">&quot;u0                               = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3769</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++){</div>
<div class="line"><span class="lineno"> 3770</span>        cout &lt;&lt; <span class="stringliteral">&quot;rho species &quot;</span> &lt;&lt; i &lt;&lt;<span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[i] &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3771</span>      }</div>
<div class="line"><span class="lineno"> 3772</span>      cout &lt;&lt; <span class="stringliteral">&quot;Smoothing Factor = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3773</span>      cout &lt;&lt; <span class="stringliteral">&quot;-------------------------&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 3774</span>    }</div>
<div class="line"><span class="lineno"> 3775</span> </div>
<div class="line"><span class="lineno"> 3776</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3777</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3778</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 3779</span>          <span class="comment">// initialize the density for species</span></div>
<div class="line"><span class="lineno"> 3780</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 3781</span>            <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac13eea1faaf959ca92ff84ad03b0ce79">rhoINIT</a>[is]/FourPI;</div>
<div class="line"><span class="lineno"> 3782</span>             </div>
<div class="line"><span class="lineno"> 3783</span>            <span class="comment">// The flow will be initialized from currents</span></div>
<div class="line"><span class="lineno"> 3784</span>            Jxs[is][i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] * sin(2.*M_PI*grid-&gt;getXC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * cos(2.*M_PI*grid-&gt;getYC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * cos(2.*M_PI*grid-&gt;getZC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>); </div>
<div class="line"><span class="lineno"> 3785</span>            Jys[is][i][j][k] = -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] * cos(2.*M_PI*grid-&gt;getXC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(2.*M_PI*grid-&gt;getYC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * cos(2.*M_PI*grid-&gt;getZC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>);</div>
<div class="line"><span class="lineno"> 3786</span>            Jzs[is][i][j][k] = 0.; <span class="comment">// Z velocity is zero</span></div>
<div class="line"><span class="lineno"> 3787</span>          }</div>
<div class="line"><span class="lineno"> 3788</span> </div>
<div class="line"><span class="lineno"> 3789</span>          <span class="comment">// electric field</span></div>
<div class="line"><span class="lineno"> 3790</span>          Ex[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 3791</span>          Ey[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 3792</span>          Ez[i][j][k] =  0.0;</div>
<div class="line"><span class="lineno"> 3793</span>          <span class="comment">// Magnetic field</span></div>
<div class="line"><span class="lineno"> 3794</span>          Bxn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * cos(2.*M_PI*grid-&gt;getXN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(2.*M_PI*grid-&gt;getYN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * sin(2.*M_PI*grid-&gt;getZN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>);</div>
<div class="line"><span class="lineno"> 3795</span>          Byn[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * sin(2.*M_PI*grid-&gt;getXN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * cos(2.*M_PI*grid-&gt;getYN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * sin(2.*M_PI*grid-&gt;getZN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>);</div>
<div class="line"><span class="lineno"> 3796</span>          Bzn[i][j][k] = -2. * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>  * sin(2.*M_PI*grid-&gt;getXN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(2.*M_PI*grid-&gt;getYN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * cos(2.*M_PI*grid-&gt;getZN(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>);</div>
<div class="line"><span class="lineno"> 3797</span>        }</div>
<div class="line"><span class="lineno"> 3798</span> </div>
<div class="line"><span class="lineno"> 3799</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 3800</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 3801</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 3802</span>          Bxc[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * cos(2.*M_PI*grid-&gt;getXC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(2.*M_PI*grid-&gt;getYC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * sin(2.*M_PI*grid-&gt;getZC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>);</div>
<div class="line"><span class="lineno"> 3803</span>          Byc[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * sin(2.*M_PI*grid-&gt;getXC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * cos(2.*M_PI*grid-&gt;getYC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * sin(2.*M_PI*grid-&gt;getZC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>);</div>
<div class="line"><span class="lineno"> 3804</span>          Bzc[i][j][k] = -2. * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a> * sin(2.*M_PI*grid-&gt;getXC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7ab7ecb259c9728b0d15836e36865540">Lx</a>) * sin(2.*M_PI*grid-&gt;getYC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a97a89d811b0dc79cd53690e05fbdabc8">Ly</a>) * cos(2.*M_PI*grid-&gt;getZC(i,j,k)/<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#afcc5cd4f2a3bb7d91d5a93a230ae76a3">Lz</a>);</div>
<div class="line"><span class="lineno"> 3805</span>        }</div>
<div class="line"><span class="lineno"> 3806</span> </div>
<div class="line"><span class="lineno"> 3807</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is=0 ; is&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3808</span>      grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af73b86e3e2631057b7b1818f6a1dc382">rhocs</a>,is,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>);</div>
<div class="line"><span class="lineno"> 3809</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3810</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a10cca1558704e2a34abafebbdd8df8db">init</a>();  <span class="comment">// use the fields from restart file</span></div>
<div class="line"><span class="lineno"> 3811</span>  }</div>
<div class="line"><span class="lineno"> 3812</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00387">Lx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">Ly</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00391">Lz</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">restart1</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">rhocs</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">rhoINIT</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00353">Smooth</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00366">ue0</a>.</p>

</div>
</div>
<a id="a447393b4fced4b504366971ad8f3bfdc" name="a447393b4fced4b504366971ad8f3bfdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a447393b4fced4b504366971ad8f3bfdc">&#9670;&nbsp;</a></span>interpDensitiesN2C()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::interpDensitiesN2C </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >communicate ghost for densities and interp rho from node to center</p>
<p >interpolate charge density and pressure density from node to center </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03338">3338</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3339</span>{</div>
<div class="line"><span class="lineno"> 3340</span>  <span class="comment">// do we need communication or not really?</span></div>
<div class="line"><span class="lineno"> 3341</span>  get_grid().<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">interpN2C</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac592e12b7cc8428fecb8219e9ebe050d">rhoc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac154c0bebb127df531138a846cfde8e3">rhon</a>);</div>
<div class="line"><span class="lineno"> 3342</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a687931ef95973ad124455f8bc4056454">Grid3DCU::interpN2C()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00475">rhoc</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00477">rhon</a>.</p>

</div>
</div>
<a id="aac76cfcf464c910f1546f4ebe1ff8235" name="aac76cfcf464c910f1546f4ebe1ff8235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac76cfcf464c910f1546f4ebe1ff8235">&#9670;&nbsp;</a></span>isLittleEndian()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool EMfields3D::isLittleEndian </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00331">331</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  331</span>{<span class="keywordflow">return</span> lEndFlag;};</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0e27b63407e586437ede5e39d3e1a3d8" name="a0e27b63407e586437ede5e39d3e1a3d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e27b63407e586437ede5e39d3e1a3d8">&#9670;&nbsp;</a></span>MaxwellImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::MaxwellImage </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Image of Maxwell Solver (for Solver)</p>
<p >Mapping of Maxwell image to give to solver </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">2333</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2334</span>{</div>
<div class="line"><span class="lineno"> 2335</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 2336</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2337</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2338</span> </div>
<div class="line"><span class="lineno"> 2339</span>  eqValue(0.0, im, 3 * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2));</div>
<div class="line"><span class="lineno"> 2340</span>  eqValue(0.0, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2341</span>  eqValue(0.0, imageY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2342</span>  eqValue(0.0, imageZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2343</span>  eqValue(0.0, tempX, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2344</span>  eqValue(0.0, tempY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2345</span>  eqValue(0.0, tempZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2346</span>  eqValue(0.0, Dx, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2347</span>  eqValue(0.0, Dy, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2348</span>  eqValue(0.0, Dz, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2349</span>  <span class="comment">// move from krylov space to physical space</span></div>
<div class="line"><span class="lineno"> 2350</span>  solver2phys(vectX, vectY, vectZ, vector, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2351</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a0a7b2bb57b3c08dd1e4ae7d763bf5c75">lapN2N</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, vectX,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2352</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a0a7b2bb57b3c08dd1e4ae7d763bf5c75">lapN2N</a>(imageY, vectY,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2353</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a0a7b2bb57b3c08dd1e4ae7d763bf5c75">lapN2N</a>(imageZ, vectZ,<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2354</span>  neg(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2355</span>  neg(imageY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2356</span>  neg(imageZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2357</span>  <span class="comment">// grad(div(mu dot E(n + theta)) mu dot E(n + theta) = D</span></div>
<div class="line"><span class="lineno"> 2358</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a4140d7b94234b3c31184d08445a21f40">MUdot</a>(Dx, Dy, Dz, vectX, vectY, vectZ);</div>
<div class="line"><span class="lineno"> 2359</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#afe24a532c0d6c1c357e74da6c97deddf">divN2C</a>(divC, Dx, Dy, Dz);</div>
<div class="line"><span class="lineno"> 2360</span>  <span class="comment">// communicate you should put BC </span></div>
<div class="line"><span class="lineno"> 2361</span>  <span class="comment">// think about the Physics </span></div>
<div class="line"><span class="lineno"> 2362</span>  <span class="comment">// communicateCenterBC(nxc,nyc,nzc,divC,1,1,1,1,1,1,vct);</span></div>
<div class="line"><span class="lineno"> 2363</span>  </div>
<div class="line"><span class="lineno"> 2364</span> </div>
<div class="line"><span class="lineno"> 2365</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, divC, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2366</span> </div>
<div class="line"><span class="lineno"> 2367</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a23706ff7359753cd045a182fb8d20f80">gradC2N</a>(tempX, tempY, tempZ, divC);</div>
<div class="line"><span class="lineno"> 2368</span> </div>
<div class="line"><span class="lineno"> 2369</span>  <span class="comment">// -lap(E(n +theta)) - grad(div(mu dot E(n + theta))</span></div>
<div class="line"><span class="lineno"> 2370</span>  sub(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, tempX, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2371</span>  sub(imageY, tempY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2372</span>  sub(imageZ, tempZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2373</span> </div>
<div class="line"><span class="lineno"> 2374</span>  <span class="comment">// scale delt*delt</span></div>
<div class="line"><span class="lineno"> 2375</span>  scale(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2376</span>  scale(imageY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2377</span>  scale(imageZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2378</span> </div>
<div class="line"><span class="lineno"> 2379</span>  <span class="comment">// -lap(E(n +theta)) - grad(div(mu dot E(n + theta)) + eps dot E(n + theta)</span></div>
<div class="line"><span class="lineno"> 2380</span>  sum(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, Dx, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2381</span>  sum(imageY, Dy, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2382</span>  sum(imageZ, Dz, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2383</span>  sum(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, vectX, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2384</span>  sum(imageY, vectY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2385</span>  sum(imageZ, vectZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2386</span> </div>
<div class="line"><span class="lineno"> 2387</span>  <span class="comment">// Temporal damping</span></div>
<div class="line"><span class="lineno"> 2388</span>  <span class="comment">/*sumscalprod(imageX, delt, vectX, Lambda, nxn, nyn, nzn);</span></div>
<div class="line"><span class="lineno"> 2389</span><span class="comment">  sumscalprod(imageY, delt, vectY, Lambda, nxn, nyn, nzn);</span></div>
<div class="line"><span class="lineno"> 2390</span><span class="comment">  sumscalprod(imageZ, delt, vectZ, Lambda, nxn, nyn, nzn);</span></div>
<div class="line"><span class="lineno"> 2391</span><span class="comment">  */</span></div>
<div class="line"><span class="lineno"> 2392</span> </div>
<div class="line"><span class="lineno"> 2393</span>  <span class="comment">/* // boundary condition: Xleft</span></div>
<div class="line"><span class="lineno"> 2394</span><span class="comment">  if (vct-&gt;getXleft_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceXleft == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2395</span><span class="comment">    perfectConductorLeft(imageX, imageY, imageZ, vectX, vectY, vectZ, 0);</span></div>
<div class="line"><span class="lineno"> 2396</span><span class="comment">  // boundary condition: Xright</span></div>
<div class="line"><span class="lineno"> 2397</span><span class="comment">  if (vct-&gt;getXright_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceXright == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2398</span><span class="comment">    perfectConductorRight(imageX, imageY, imageZ, vectX, vectY, vectZ, 0);</span></div>
<div class="line"><span class="lineno"> 2399</span><span class="comment">  // boundary condition: Yleft</span></div>
<div class="line"><span class="lineno"> 2400</span><span class="comment">  if (vct-&gt;getYleft_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceYleft == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2401</span><span class="comment">    perfectConductorLeft(imageX, imageY, imageZ, vectX, vectY, vectZ, 1);</span></div>
<div class="line"><span class="lineno"> 2402</span><span class="comment">  // boundary condition: Yright</span></div>
<div class="line"><span class="lineno"> 2403</span><span class="comment">  if (vct-&gt;getYright_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceYright == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2404</span><span class="comment">    perfectConductorRight(imageX, imageY, imageZ, vectX, vectY, vectZ, 1);</span></div>
<div class="line"><span class="lineno"> 2405</span><span class="comment">  // boundary condition: Zleft</span></div>
<div class="line"><span class="lineno"> 2406</span><span class="comment">  if (vct-&gt;getZleft_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceZleft == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2407</span><span class="comment">    perfectConductorLeft(imageX, imageY, imageZ, vectX, vectY, vectZ, 2);</span></div>
<div class="line"><span class="lineno"> 2408</span><span class="comment">  // boundary condition: Zright</span></div>
<div class="line"><span class="lineno"> 2409</span><span class="comment">  if (vct-&gt;getZright_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceZright == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2410</span><span class="comment">    perfectConductorRight(imageX, imageY, imageZ, vectX, vectY, vectZ, 2);</span></div>
<div class="line"><span class="lineno"> 2411</span><span class="comment">  */</span></div>
<div class="line"><span class="lineno"> 2412</span>  <span class="comment">// OpenBC</span></div>
<div class="line"><span class="lineno"> 2413</span>  OpenBoundaryInflowEImage(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, imageY, imageZ, vectX, vectY, vectZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2414</span> </div>
<div class="line"><span class="lineno"> 2415</span>  <span class="comment">// move from physical space to krylov space</span></div>
<div class="line"><span class="lineno"> 2416</span>  phys2solver(im, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>, imageY, imageZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2417</span> </div>
<div class="line"><span class="lineno"> 2418</span> </div>
<div class="line"><span class="lineno"> 2419</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a4140d7b94234b3c31184d08445a21f40"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a4140d7b94234b3c31184d08445a21f40">EMfields3D::MUdot</a></div><div class="ttdeci">void MUdot(arr3_double MUdotX, arr3_double MUdotY, arr3_double MUdotZ, const_arr3_double vectX, const_arr3_double vectY, const_arr3_double vectZ)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">EMfields3D.cpp:2441</a></div></div>
<div class="ttc" id="aclass_grid3_d_c_u_html_a0a7b2bb57b3c08dd1e4ae7d763bf5c75"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html#a0a7b2bb57b3c08dd1e4ae7d763bf5c75">Grid3DCU::lapN2N</a></div><div class="ttdeci">void lapN2N(arr3_double lapN, const_arr3_double scFieldN, EMfields3D *EMf) const</div><div class="ttdoc">calculate laplacian on nodes, given a scalar field defined on nodes</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">delt</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#afe24a532c0d6c1c357e74da6c97deddf">Grid3DCU::divN2C()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a23706ff7359753cd045a182fb8d20f80">Grid3DCU::gradC2N()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00454">imageX</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a0a7b2bb57b3c08dd1e4ae7d763bf5c75">Grid3DCU::lapN2N()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>.</p>

</div>
</div>
<a id="a5575c54ce46a4de2975e662ae1cb5781" name="a5575c54ce46a4de2975e662ae1cb5781"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5575c54ce46a4de2975e662ae1cb5781">&#9670;&nbsp;</a></span>MaxwellSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::MaxwellSource </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>bkrylov</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Maxwell source term (for SOLVER)</p>
<p >Calculate sorgent for Maxwell solver </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">2175</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2176</span>{</div>
<div class="line"><span class="lineno"> 2177</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 2178</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> * vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2179</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2180</span> </div>
<div class="line"><span class="lineno"> 2181</span>  eqValue(0.0, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a46c3082575146e5975baaa9177284892">tempC</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 2182</span>  eqValue(0.0, tempX, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2183</span>  eqValue(0.0, tempY, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2184</span>  eqValue(0.0, tempZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2185</span>  eqValue(0.0, tempXN, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2186</span>  eqValue(0.0, tempYN, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2187</span>  eqValue(0.0, tempZN, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2188</span>  eqValue(0.0, temp2X, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2189</span>  eqValue(0.0, temp2Y, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2190</span>  eqValue(0.0, temp2Z, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2191</span> </div>
<div class="line"><span class="lineno"> 2192</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bxc, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#adfaa62249e560c3afb2c73ac9e33f494">bcBx</a>[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2193</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Byc, col-&gt;bcBy[0],col-&gt;bcBy[1],col-&gt;bcBy[2],col-&gt;bcBy[3],col-&gt;bcBy[4],col-&gt;bcBy[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2194</span>  communicateCenterBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, Bzc, col-&gt;bcBz[0],col-&gt;bcBz[1],col-&gt;bcBz[2],col-&gt;bcBz[3],col-&gt;bcBz[4],col-&gt;bcBz[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2195</span> </div>
<div class="line"><span class="lineno"> 2196</span>  <span class="keywordflow">if</span> (get_col().getCase()==<span class="stringliteral">&quot;ForceFree&quot;</span>)                 <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#aaeaa9263ae0772c0b3a589e268f42684">fixBforcefree</a>();</div>
<div class="line"><span class="lineno"> 2197</span>  <span class="keywordflow">if</span> (get_col().getCase()==<span class="stringliteral">&quot;GEM&quot;</span>)                       fixBnGEM();</div>
<div class="line"><span class="lineno"> 2198</span>  <span class="keywordflow">if</span> (get_col().getCase()==<span class="stringliteral">&quot;GEMnoPert&quot;</span>)                 fixBnGEM();</div>
<div class="line"><span class="lineno"> 2199</span>  <span class="keywordflow">if</span> (get_col().getCase()==<span class="stringliteral">&quot;GEMDoubleHarris&quot;</span>)           fixBnGEM();</div>
<div class="line"><span class="lineno"> 2200</span> </div>
<div class="line"><span class="lineno"> 2201</span>  <span class="comment">// OpenBC:</span></div>
<div class="line"><span class="lineno"> 2202</span>  OpenBoundaryInflowB(Bxc,Byc,Bzc,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 2203</span> </div>
<div class="line"><span class="lineno"> 2204</span>  <span class="keywordflow">if</span> (get_col().getCase()==<span class="stringliteral">&quot;GEM&quot;</span>)                       <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a690aae651b816a0c73795a2c8ad35b0e">fixBcGEM</a>();</div>
<div class="line"><span class="lineno"> 2205</span>  <span class="keywordflow">if</span> (get_col().getCase()==<span class="stringliteral">&quot;GEMnoPert&quot;</span>)                 <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a690aae651b816a0c73795a2c8ad35b0e">fixBcGEM</a>();</div>
<div class="line"><span class="lineno"> 2206</span>  <span class="keywordflow">if</span> (get_col().getCase()==<span class="stringliteral">&quot;GEMDoubleHarris&quot;</span>)           <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a690aae651b816a0c73795a2c8ad35b0e">fixBcGEM</a>();</div>
<div class="line"><span class="lineno"> 2207</span> </div>
<div class="line"><span class="lineno"> 2208</span>  <span class="comment">// prepare curl of B for known term of Maxwell solver: for the source term</span></div>
<div class="line"><span class="lineno"> 2209</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#addb84d4c44fa581db17b309195a38e44">curlC2N</a>(tempXN, tempYN, tempZN, Bxc, Byc, Bzc);</div>
<div class="line"><span class="lineno"> 2210</span>  scale(temp2X, Jxh, -FourPI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2211</span>  scale(temp2Y, Jyh, -FourPI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2212</span>  scale(temp2Z, Jzh, -FourPI / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2213</span> </div>
<div class="line"><span class="lineno"> 2214</span>  <span class="comment">/* -- dipole SOURCE version using J_ext,This is not initialized, causing program crash over 2048 processes</span></div>
<div class="line"><span class="lineno"> 2215</span><span class="comment">  addscale(-FourPI/c,temp2X,Jx_ext,nxn,nyn,nzn);</span></div>
<div class="line"><span class="lineno"> 2216</span><span class="comment">  addscale(-FourPI/c,temp2Y,Jy_ext,nxn,nyn,nzn);</span></div>
<div class="line"><span class="lineno"> 2217</span><span class="comment">  addscale(-FourPI/c,temp2Z,Jz_ext,nxn,nyn,nzn);</span></div>
<div class="line"><span class="lineno"> 2218</span><span class="comment">  // -- end of dipole SOURCE version using J_ext*/</span></div>
<div class="line"><span class="lineno"> 2219</span> </div>
<div class="line"><span class="lineno"> 2220</span>  sum(temp2X, tempXN, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2221</span>  sum(temp2Y, tempYN, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2222</span>  sum(temp2Z, tempZN, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2223</span>  scale(temp2X, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2224</span>  scale(temp2Y, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2225</span>  scale(temp2Z, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2226</span> </div>
<div class="line"><span class="lineno"> 2227</span>  communicateCenterBC_P(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a43d562d551ea0f165362c5679bbba07b">rhoh</a>, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2228</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#a23706ff7359753cd045a182fb8d20f80">gradC2N</a>(tempX, tempY, tempZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a43d562d551ea0f165362c5679bbba07b">rhoh</a>);</div>
<div class="line"><span class="lineno"> 2229</span> </div>
<div class="line"><span class="lineno"> 2230</span>  scale(tempX, -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * FourPI, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2231</span>  scale(tempY, -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * FourPI, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2232</span>  scale(tempZ, -<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * FourPI, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2233</span>  <span class="comment">// sum E, past values</span></div>
<div class="line"><span class="lineno"> 2234</span>  sum(tempX, Ex, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2235</span>  sum(tempY, Ey, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2236</span>  sum(tempZ, Ez, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2237</span>  <span class="comment">// sum curl(B) + jhat part</span></div>
<div class="line"><span class="lineno"> 2238</span>  sum(tempX, temp2X, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2239</span>  sum(tempY, temp2Y, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2240</span>  sum(tempZ, temp2Z, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2241</span> </div>
<div class="line"><span class="lineno"> 2242</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 2243</span><span class="comment">  // Boundary condition in the known term</span></div>
<div class="line"><span class="lineno"> 2244</span><span class="comment">  // boundary condition: Xleft</span></div>
<div class="line"><span class="lineno"> 2245</span><span class="comment">  if (vct-&gt;getXleft_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceXleft == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2246</span><span class="comment">    perfectConductorLeftS(tempX, tempY, tempZ, 0);</span></div>
<div class="line"><span class="lineno"> 2247</span><span class="comment">  // boundary condition: Xright</span></div>
<div class="line"><span class="lineno"> 2248</span><span class="comment">  if (vct-&gt;getXright_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceXright == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2249</span><span class="comment">    perfectConductorRightS(tempX, tempY, tempZ, 0);</span></div>
<div class="line"><span class="lineno"> 2250</span><span class="comment">  // boundary condition: Yleft</span></div>
<div class="line"><span class="lineno"> 2251</span><span class="comment">  if (vct-&gt;getYleft_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceYleft == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2252</span><span class="comment">    perfectConductorLeftS(tempX, tempY, tempZ, 1);</span></div>
<div class="line"><span class="lineno"> 2253</span><span class="comment">  // boundary condition: Yright</span></div>
<div class="line"><span class="lineno"> 2254</span><span class="comment">  if (vct-&gt;getYright_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceYright == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2255</span><span class="comment">    perfectConductorRightS(tempX, tempY, tempZ, 1);</span></div>
<div class="line"><span class="lineno"> 2256</span><span class="comment">  // boundary condition: Zleft</span></div>
<div class="line"><span class="lineno"> 2257</span><span class="comment">  if (vct-&gt;getZleft_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceZleft == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2258</span><span class="comment">    perfectConductorLeftS(tempX, tempY, tempZ, 2);</span></div>
<div class="line"><span class="lineno"> 2259</span><span class="comment">  // boundary condition: Zright</span></div>
<div class="line"><span class="lineno"> 2260</span><span class="comment">  if (vct-&gt;getZright_neighbor() == MPI_PROC_NULL &amp;&amp; bcEMfaceZright == 0)  // perfect conductor</span></div>
<div class="line"><span class="lineno"> 2261</span><span class="comment">    perfectConductorRightS(tempX, tempY, tempZ, 2);</span></div>
<div class="line"><span class="lineno"> 2262</span><span class="comment">  */</span></div>
<div class="line"><span class="lineno"> 2263</span> </div>
<div class="line"><span class="lineno"> 2264</span>  <span class="comment">// physical space -&gt; Krylov space</span></div>
<div class="line"><span class="lineno"> 2265</span>  phys2solver(bkrylov, tempX, tempY, tempZ, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2266</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a690aae651b816a0c73795a2c8ad35b0e"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a690aae651b816a0c73795a2c8ad35b0e">EMfields3D::fixBcGEM</a></div><div class="ttdeci">void fixBcGEM()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02603">EMfields3D.cpp:2603</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_aaeaa9263ae0772c0b3a589e268f42684"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#aaeaa9263ae0772c0b3a589e268f42684">EMfields3D::fixBforcefree</a></div><div class="ttdeci">void fixBforcefree()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02666">EMfields3D.cpp:2666</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/_collective_8h_source.html#l00209">Collective::bcBx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#addb84d4c44fa581db17b309195a38e44">Grid3DCU::curlC2N()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">delt</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02603">fixBcGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02666">fixBforcefree()</a>, <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#a23706ff7359753cd045a182fb8d20f80">Grid3DCU::gradC2N()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00479">rhoh</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00446">tempC</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>.</p>

</div>
</div>
<a id="a4140d7b94234b3c31184d08445a21f40" name="a4140d7b94234b3c31184d08445a21f40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4140d7b94234b3c31184d08445a21f40">&#9670;&nbsp;</a></span>MUdot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::MUdot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>MUdotX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>MUdotY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>MUdotZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the three components of mu (implicit permeattivity) cross image vector</p>
<p >Calculate MU dot (vectX, vectY, vectZ) </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">2441</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2443</span>{</div>
<div class="line"><span class="lineno"> 2444</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2445</span>  <span class="keywordtype">double</span> beta, edotb, omcx, omcy, omcz, denom;</div>
<div class="line"><span class="lineno"> 2446</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2447</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2448</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++) {</div>
<div class="line"><span class="lineno"> 2449</span>        MUdotX[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 2450</span>        MUdotY[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 2451</span>        MUdotZ[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 2452</span>      }</div>
<div class="line"><span class="lineno"> 2453</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 2454</span>    beta = .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>;</div>
<div class="line"><span class="lineno"> 2455</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2456</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2457</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++) {</div>
<div class="line"><span class="lineno"> 2458</span>          omcx = beta * (Bxn[i][j][k] + Bx_ext[i][j][k]);</div>
<div class="line"><span class="lineno"> 2459</span>          omcy = beta * (Byn[i][j][k] + By_ext[i][j][k]);</div>
<div class="line"><span class="lineno"> 2460</span>          omcz = beta * (Bzn[i][j][k] + Bz_ext[i][j][k]);</div>
<div class="line"><span class="lineno"> 2461</span>          edotb = vectX.get(i,j,k) * omcx + vectY.get(i,j,k) * omcy + vectZ.get(i,j,k) * omcz;</div>
<div class="line"><span class="lineno"> 2462</span>          denom = FourPI / 2 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] / (1.0 + omcx * omcx + omcy * omcy + omcz * omcz);</div>
<div class="line"><span class="lineno"> 2463</span>          MUdotX.fetch(i,j,k) += (vectX.get(i,j,k) + (vectY.get(i,j,k) * omcz - vectZ.get(i,j,k) * omcy + edotb * omcx)) * denom;</div>
<div class="line"><span class="lineno"> 2464</span>          MUdotY.fetch(i,j,k) += (vectY.get(i,j,k) + (vectZ.get(i,j,k) * omcx - vectX.get(i,j,k) * omcz + edotb * omcy)) * denom;</div>
<div class="line"><span class="lineno"> 2465</span>          MUdotZ.fetch(i,j,k) += (vectZ.get(i,j,k) + (vectX.get(i,j,k) * omcy - vectY.get(i,j,k) * omcx + edotb * omcz)) * denom;</div>
<div class="line"><span class="lineno"> 2466</span>        }</div>
<div class="line"><span class="lineno"> 2467</span>  }</div>
<div class="line"><span class="lineno"> 2468</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">delt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>.</p>

</div>
</div>
<a id="abd42dd42c4c4bdbe4e04c6f0e0a58fe5" name="abd42dd42c4c4bdbe4e04c6f0e0a58fe5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd42dd42c4c4bdbe4e04c6f0e0a58fe5">&#9670;&nbsp;</a></span>OpenBoundaryInflowB()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::OpenBoundaryInflowB </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05122">5122</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5123</span>{</div>
<div class="line"><span class="lineno"> 5124</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 5125</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 5126</span>  </div>
<div class="line"><span class="lineno"> 5127</span>  <span class="comment">// parameters for SAL (simple absorption layer) method </span></div>
<div class="line"><span class="lineno"> 5128</span>  <span class="keywordtype">double</span> sal; </div>
<div class="line"><span class="lineno"> 5129</span>  <span class="keywordtype">int</span> yes_sal; </div>
<div class="line"><span class="lineno"> 5130</span>  <span class="keywordtype">int</span> n_layers;</div>
<div class="line"><span class="lineno"> 5131</span> </div>
<div class="line"><span class="lineno"> 5132</span>  yes_sal  = col-&gt;getYes_sal();</div>
<div class="line"><span class="lineno"> 5133</span> </div>
<div class="line"><span class="lineno"> 5134</span>  <span class="comment">// divide two cases: apply SAL b.c., or regular zero-gradient b.c.</span></div>
<div class="line"><span class="lineno"> 5135</span>  <span class="keywordflow">if</span>(yes_sal)</div>
<div class="line"><span class="lineno"> 5136</span>      n_layers = col-&gt;getN_layers_sal();</div>
<div class="line"><span class="lineno"> 5137</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5138</span>      n_layers = 3;</div>
<div class="line"><span class="lineno"> 5139</span> </div>
<div class="line"><span class="lineno"> 5140</span>  <span class="comment">// X=0 boundary</span></div>
<div class="line"><span class="lineno"> 5141</span>  <span class="keywordflow">if</span>(vct-&gt;getXleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXleft ==2 &amp;&amp; nx&gt;10) {</div>
<div class="line"><span class="lineno"> 5142</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;=n_layers; i++){</div>
<div class="line"><span class="lineno"> 5143</span>      sal = (double)i/n_layers;</div>
<div class="line"><span class="lineno"> 5144</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;ny; j++)</div>
<div class="line"><span class="lineno"> 5145</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nz; k++){</div>
<div class="line"><span class="lineno"> 5146</span>          </div>
<div class="line"><span class="lineno"> 5147</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5148</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*(1.-sal);</div>
<div class="line"><span class="lineno"> 5149</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + B0y*(1.-sal);</div>
<div class="line"><span class="lineno"> 5150</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + B0z*(1.-sal);</div>
<div class="line"><span class="lineno"> 5151</span>          }</div>
<div class="line"><span class="lineno"> 5152</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5153</span>            vectorX[i][j][k] = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>;</div>
<div class="line"><span class="lineno"> 5154</span>            vectorY[i][j][k] = B0y;</div>
<div class="line"><span class="lineno"> 5155</span>            vectorZ[i][j][k] = B0z;</div>
<div class="line"><span class="lineno"> 5156</span>          }</div>
<div class="line"><span class="lineno"> 5157</span>          </div>
<div class="line"><span class="lineno"> 5158</span>        }</div>
<div class="line"><span class="lineno"> 5159</span>    }</div>
<div class="line"><span class="lineno"> 5160</span>  }</div>
<div class="line"><span class="lineno"> 5161</span> </div>
<div class="line"><span class="lineno"> 5162</span>  <span class="comment">// X=Lx boundary</span></div>
<div class="line"><span class="lineno"> 5163</span>  <span class="keywordflow">if</span>(vct-&gt;getXright_neighbor()==MPI_PROC_NULL &amp;&amp; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7d090b86a16ede7b0b8d4abec332e5b9">bcEMfaceXright</a> ==2 &amp;&amp; nx&gt;10 ) {</div>
<div class="line"><span class="lineno"> 5164</span>    <span class="comment">// force not to apply sal in Xright</span></div>
<div class="line"><span class="lineno"> 5165</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=nx-3-1; i&lt;nx; i++){</div>
<div class="line"><span class="lineno"> 5166</span>      sal = (double)(nx-1-i)/n_layers;</div>
<div class="line"><span class="lineno"> 5167</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;ny; j++)</div>
<div class="line"><span class="lineno"> 5168</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nz; k++){</div>
<div class="line"><span class="lineno"> 5169</span>         <span class="comment">/*if(yes_sal){</span></div>
<div class="line"><span class="lineno"> 5170</span><span class="comment">            vectorX[i][j][k] = vectorX[i][j][k]*sal + B0x*(1.-sal);</span></div>
<div class="line"><span class="lineno"> 5171</span><span class="comment">            vectorY[i][j][k] = vectorY[i][j][k]*sal + B0y*(1.-sal);</span></div>
<div class="line"><span class="lineno"> 5172</span><span class="comment">            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + B0z*(1.-sal);</span></div>
<div class="line"><span class="lineno"> 5173</span><span class="comment">          }</span></div>
<div class="line"><span class="lineno"> 5174</span><span class="comment">          else{*/</span></div>
<div class="line"><span class="lineno"> 5175</span>            vectorX[i][j][k] = vectorX[nx-2-n_layers][j][k];</div>
<div class="line"><span class="lineno"> 5176</span>            vectorY[i][j][k] = vectorY[nx-2-n_layers][j][k];</div>
<div class="line"><span class="lineno"> 5177</span>            vectorZ[i][j][k] = vectorZ[nx-2-n_layers][j][k];</div>
<div class="line"><span class="lineno"> 5178</span>         <span class="comment">// }</span></div>
<div class="line"><span class="lineno"> 5179</span>        }</div>
<div class="line"><span class="lineno"> 5180</span>    }</div>
<div class="line"><span class="lineno"> 5181</span>  }</div>
<div class="line"><span class="lineno"> 5182</span> </div>
<div class="line"><span class="lineno"> 5183</span>  <span class="comment">// Y=0 boundary</span></div>
<div class="line"><span class="lineno"> 5184</span>  <span class="keywordflow">if</span>(vct-&gt;getYleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYleft ==2 &amp;&amp; ny&gt; 10)  {</div>
<div class="line"><span class="lineno"> 5185</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;=n_layers; j++){</div>
<div class="line"><span class="lineno"> 5186</span>      sal = (double)j/n_layers;</div>
<div class="line"><span class="lineno"> 5187</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nx; i++)</div>
<div class="line"><span class="lineno"> 5188</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nz; k++){</div>
<div class="line"><span class="lineno"> 5189</span> </div>
<div class="line"><span class="lineno"> 5190</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5191</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*(1.-sal);</div>
<div class="line"><span class="lineno"> 5192</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + B0y*(1.-sal);</div>
<div class="line"><span class="lineno"> 5193</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + B0z*(1.-sal);</div>
<div class="line"><span class="lineno"> 5194</span>          }</div>
<div class="line"><span class="lineno"> 5195</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5196</span>            vectorX[i][j][k] = vectorX[i][n_layers+1][k];</div>
<div class="line"><span class="lineno"> 5197</span>            vectorY[i][j][k] = vectorY[i][n_layers+1][k];</div>
<div class="line"><span class="lineno"> 5198</span>            vectorZ[i][j][k] = vectorZ[i][n_layers+1][k];</div>
<div class="line"><span class="lineno"> 5199</span>          }</div>
<div class="line"><span class="lineno"> 5200</span>        }</div>
<div class="line"><span class="lineno"> 5201</span>    } </div>
<div class="line"><span class="lineno"> 5202</span>  }</div>
<div class="line"><span class="lineno"> 5203</span>  </div>
<div class="line"><span class="lineno"> 5204</span>  <span class="comment">// Y=Ly boundary</span></div>
<div class="line"><span class="lineno"> 5205</span>  <span class="keywordflow">if</span>(vct-&gt;getYright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYright==2 &amp;&amp; ny&gt;10)  {</div>
<div class="line"><span class="lineno"> 5206</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=ny-n_layers-1; j&lt;ny; j++){</div>
<div class="line"><span class="lineno"> 5207</span>      sal = (double)(ny-1-j)/n_layers;</div>
<div class="line"><span class="lineno"> 5208</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nx; i++)</div>
<div class="line"><span class="lineno"> 5209</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nz; k++){</div>
<div class="line"><span class="lineno"> 5210</span>        </div>
<div class="line"><span class="lineno"> 5211</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5212</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*(1.-sal);</div>
<div class="line"><span class="lineno"> 5213</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + B0y*(1.-sal);</div>
<div class="line"><span class="lineno"> 5214</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + B0z*(1.-sal);</div>
<div class="line"><span class="lineno"> 5215</span>          }</div>
<div class="line"><span class="lineno"> 5216</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5217</span>            vectorX[i][j][k] = vectorX[i][ny-2-n_layers][k];</div>
<div class="line"><span class="lineno"> 5218</span>            vectorY[i][j][k] = vectorY[i][ny-2-n_layers][k];</div>
<div class="line"><span class="lineno"> 5219</span>            vectorZ[i][j][k] = vectorZ[i][ny-2-n_layers][k];</div>
<div class="line"><span class="lineno"> 5220</span>          }</div>
<div class="line"><span class="lineno"> 5221</span>        }</div>
<div class="line"><span class="lineno"> 5222</span>    }</div>
<div class="line"><span class="lineno"> 5223</span>  }</div>
<div class="line"><span class="lineno"> 5224</span> </div>
<div class="line"><span class="lineno"> 5225</span>  <span class="comment">// Z=0 boundary</span></div>
<div class="line"><span class="lineno"> 5226</span>  <span class="keywordflow">if</span>(vct-&gt;getZleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZleft ==2 &amp;&amp; nz&gt; 10)  {</div>
<div class="line"><span class="lineno"> 5227</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=n_layers; k++){</div>
<div class="line"><span class="lineno"> 5228</span>      sal = (double)k/n_layers;</div>
<div class="line"><span class="lineno"> 5229</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nx; i++)</div>
<div class="line"><span class="lineno"> 5230</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;ny; j++){</div>
<div class="line"><span class="lineno"> 5231</span> </div>
<div class="line"><span class="lineno"> 5232</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5233</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*(1.-sal);</div>
<div class="line"><span class="lineno"> 5234</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + B0y*(1.-sal);</div>
<div class="line"><span class="lineno"> 5235</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + B0z*(1.-sal);</div>
<div class="line"><span class="lineno"> 5236</span>          }</div>
<div class="line"><span class="lineno"> 5237</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5238</span>            vectorX[i][j][k] = vectorX[i][j][n_layers+1];</div>
<div class="line"><span class="lineno"> 5239</span>            vectorY[i][j][k] = vectorY[i][j][n_layers+1];</div>
<div class="line"><span class="lineno"> 5240</span>            vectorZ[i][j][k] = vectorZ[i][j][n_layers+1];</div>
<div class="line"><span class="lineno"> 5241</span>          }</div>
<div class="line"><span class="lineno"> 5242</span>        }</div>
<div class="line"><span class="lineno"> 5243</span>    }</div>
<div class="line"><span class="lineno"> 5244</span>  }</div>
<div class="line"><span class="lineno"> 5245</span> </div>
<div class="line"><span class="lineno"> 5246</span>  <span class="comment">// Z=Lz boundary</span></div>
<div class="line"><span class="lineno"> 5247</span>  <span class="keywordflow">if</span>(vct-&gt;getZright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZright==2 &amp;&amp; nz&gt;10)  {</div>
<div class="line"><span class="lineno"> 5248</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=nz-n_layers-1; k&lt;nz; k++){</div>
<div class="line"><span class="lineno"> 5249</span>      sal = (double)(nz-1-k)/n_layers;</div>
<div class="line"><span class="lineno"> 5250</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nx; i++)</div>
<div class="line"><span class="lineno"> 5251</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;ny; j++){</div>
<div class="line"><span class="lineno"> 5252</span> </div>
<div class="line"><span class="lineno"> 5253</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5254</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>*(1.-sal);</div>
<div class="line"><span class="lineno"> 5255</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + B0y*(1.-sal);</div>
<div class="line"><span class="lineno"> 5256</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + B0z*(1.-sal);</div>
<div class="line"><span class="lineno"> 5257</span>          }</div>
<div class="line"><span class="lineno"> 5258</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5259</span>            vectorX[i][j][k] = vectorX[i][j][nz-2-n_layers];</div>
<div class="line"><span class="lineno"> 5260</span>            vectorY[i][j][k] = vectorY[i][j][nz-2-n_layers];</div>
<div class="line"><span class="lineno"> 5261</span>            vectorZ[i][j][k] = vectorZ[i][j][nz-2-n_layers];</div>
<div class="line"><span class="lineno"> 5262</span>          }</div>
<div class="line"><span class="lineno"> 5263</span>        }</div>
<div class="line"><span class="lineno"> 5264</span>    }</div>
<div class="line"><span class="lineno"> 5265</span>  }</div>
<div class="line"><span class="lineno"> 5266</span> </div>
<div class="line"><span class="lineno"> 5267</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 5268</span><span class="comment">  if(vct-&gt;getXright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXright ==2) {</span></div>
<div class="line"><span class="lineno"> 5269</span><span class="comment">    for (int j=0; j &lt; ny;j++)</span></div>
<div class="line"><span class="lineno"> 5270</span><span class="comment">      for (int k=0; k &lt; nz;k++){</span></div>
<div class="line"><span class="lineno"> 5271</span><span class="comment">                vectorX[nx-2][j][k] = B0x;</span></div>
<div class="line"><span class="lineno"> 5272</span><span class="comment">                vectorY[nx-2][j][k] = B0y;</span></div>
<div class="line"><span class="lineno"> 5273</span><span class="comment">                vectorZ[nx-2][j][k] = B0z;</span></div>
<div class="line"><span class="lineno"> 5274</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5275</span><span class="comment">        vectorX[nx-1][j][k] = B0x;</span></div>
<div class="line"><span class="lineno"> 5276</span><span class="comment">        vectorY[nx-1][j][k] = B0y;</span></div>
<div class="line"><span class="lineno"> 5277</span><span class="comment">        vectorZ[nx-1][j][k] = B0z;</span></div>
<div class="line"><span class="lineno"> 5278</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5279</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5280</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5281</span><span class="comment">  if(vct-&gt;getYleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYleft ==2)  {</span></div>
<div class="line"><span class="lineno"> 5282</span><span class="comment">    for (int i=0; i &lt; nx;i++)</span></div>
<div class="line"><span class="lineno"> 5283</span><span class="comment">      for (int k=0; k &lt; nz;k++){</span></div>
<div class="line"><span class="lineno"> 5284</span><span class="comment">                vectorX[i][1][k] = B0x;</span></div>
<div class="line"><span class="lineno"> 5285</span><span class="comment">                vectorY[i][1][k] = B0y;</span></div>
<div class="line"><span class="lineno"> 5286</span><span class="comment">                vectorZ[i][1][k] = B0z;</span></div>
<div class="line"><span class="lineno"> 5287</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5288</span><span class="comment">        vectorX[i][0][k] = B0x;</span></div>
<div class="line"><span class="lineno"> 5289</span><span class="comment">        vectorY[i][0][k] = B0y;</span></div>
<div class="line"><span class="lineno"> 5290</span><span class="comment">        vectorZ[i][0][k] = B0z;</span></div>
<div class="line"><span class="lineno"> 5291</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5292</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5293</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5294</span><span class="comment">  if(vct-&gt;getYright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYright ==2)  {</span></div>
<div class="line"><span class="lineno"> 5295</span><span class="comment">    for (int i=0; i &lt; nx;i++)</span></div>
<div class="line"><span class="lineno"> 5296</span><span class="comment">      for (int k=0; k &lt; nz;k++){</span></div>
<div class="line"><span class="lineno"> 5297</span><span class="comment">                vectorX[i][ny-2][k] = B0x;</span></div>
<div class="line"><span class="lineno"> 5298</span><span class="comment">                vectorY[i][ny-2][k] = B0y;</span></div>
<div class="line"><span class="lineno"> 5299</span><span class="comment">                vectorZ[i][ny-2][k] = B0z;</span></div>
<div class="line"><span class="lineno"> 5300</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5301</span><span class="comment">        vectorX[i][ny-1][k] = B0x;</span></div>
<div class="line"><span class="lineno"> 5302</span><span class="comment">        vectorY[i][ny-1][k] = B0y;</span></div>
<div class="line"><span class="lineno"> 5303</span><span class="comment">        vectorZ[i][ny-1][k] = B0z;</span></div>
<div class="line"><span class="lineno"> 5304</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5305</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5306</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5307</span><span class="comment">  if(vct-&gt;getZleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZleft ==2)  {</span></div>
<div class="line"><span class="lineno"> 5308</span><span class="comment">    for (int i=0; i &lt; nx;i++)</span></div>
<div class="line"><span class="lineno"> 5309</span><span class="comment">      for (int j=0; j &lt; ny;j++){</span></div>
<div class="line"><span class="lineno"> 5310</span><span class="comment">                vectorX[i][j][1] = B0x;</span></div>
<div class="line"><span class="lineno"> 5311</span><span class="comment">                vectorY[i][j][1] = B0y;</span></div>
<div class="line"><span class="lineno"> 5312</span><span class="comment">                vectorZ[i][j][1] = B0z;</span></div>
<div class="line"><span class="lineno"> 5313</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5314</span><span class="comment">        vectorX[i][j][0] = B0x;</span></div>
<div class="line"><span class="lineno"> 5315</span><span class="comment">        vectorY[i][j][0] = B0y;</span></div>
<div class="line"><span class="lineno"> 5316</span><span class="comment">        vectorZ[i][j][0] = B0z;</span></div>
<div class="line"><span class="lineno"> 5317</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5318</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5319</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5320</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5321</span><span class="comment">  if(vct-&gt;getZright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZright ==2)  {</span></div>
<div class="line"><span class="lineno"> 5322</span><span class="comment">    for (int i=0; i &lt; nx;i++)</span></div>
<div class="line"><span class="lineno"> 5323</span><span class="comment">      for (int j=0; j &lt; ny;j++){</span></div>
<div class="line"><span class="lineno"> 5324</span><span class="comment">                vectorX[i][j][nz-2] = B0x;</span></div>
<div class="line"><span class="lineno"> 5325</span><span class="comment">                vectorY[i][j][nz-2] = B0y;</span></div>
<div class="line"><span class="lineno"> 5326</span><span class="comment">                vectorZ[i][j][nz-2] = B0z;</span></div>
<div class="line"><span class="lineno"> 5327</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5328</span><span class="comment">        vectorX[i][j][nz-1] = B0x;</span></div>
<div class="line"><span class="lineno"> 5329</span><span class="comment">        vectorY[i][j][nz-1] = B0y;</span></div>
<div class="line"><span class="lineno"> 5330</span><span class="comment">        vectorZ[i][j][nz-1] = B0z;</span></div>
<div class="line"><span class="lineno"> 5331</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5332</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5333</span><span class="comment">  */</span></div>
<div class="line"><span class="lineno"> 5334</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae27b2108b93378e11111fc791dc09a2d" name="ae27b2108b93378e11111fc791dc09a2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae27b2108b93378e11111fc791dc09a2d">&#9670;&nbsp;</a></span>OpenBoundaryInflowE()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::OpenBoundaryInflowE </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05336">5336</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5338</span>{</div>
<div class="line"><span class="lineno"> 5339</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 5340</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 5341</span>  <span class="comment">// Assuming E = - ve x B</span></div>
<div class="line"><span class="lineno"> 5342</span>  <span class="keywordtype">double</span> injE[3];</div>
<div class="line"><span class="lineno"> 5343</span>  cross_product(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a>,ve0,we0,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>,B0y,B0z,injE);</div>
<div class="line"><span class="lineno"> 5344</span>  scale(injE,-1.0,3);</div>
<div class="line"><span class="lineno"> 5345</span> </div>
<div class="line"><span class="lineno"> 5346</span>  <span class="comment">// parameters for SAL (simple absorbing layer) method</span></div>
<div class="line"><span class="lineno"> 5347</span>  <span class="keywordtype">double</span> sal;</div>
<div class="line"><span class="lineno"> 5348</span>  <span class="keywordtype">int</span> yes_sal;</div>
<div class="line"><span class="lineno"> 5349</span>  <span class="keywordtype">int</span> n_layers=3;</div>
<div class="line"><span class="lineno"> 5350</span> </div>
<div class="line"><span class="lineno"> 5351</span>  yes_sal  = col-&gt;getYes_sal();</div>
<div class="line"><span class="lineno"> 5352</span> </div>
<div class="line"><span class="lineno"> 5353</span>  <span class="comment">// divide two cases: apply SAL b.c., or regular zero-gradient b.c.</span></div>
<div class="line"><span class="lineno"> 5354</span>  <span class="keywordflow">if</span>(yes_sal)</div>
<div class="line"><span class="lineno"> 5355</span>    n_layers = col-&gt;getN_layers_sal();</div>
<div class="line"><span class="lineno"> 5356</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5357</span>    n_layers = 3;</div>
<div class="line"><span class="lineno"> 5358</span> </div>
<div class="line"><span class="lineno"> 5359</span>  <span class="comment">//cout &lt;&lt; &quot;yes_sal, n_layers = &quot; &lt;&lt; yes_sal &lt;&lt; &quot;  &quot; &lt;&lt;  n_layers &lt;&lt;endl;</span></div>
<div class="line"><span class="lineno"> 5360</span> </div>
<div class="line"><span class="lineno"> 5361</span>  <span class="comment">// X=0  boundary</span></div>
<div class="line"><span class="lineno"> 5362</span>  <span class="keywordflow">if</span>(vct-&gt;getXleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXleft ==2) {</div>
<div class="line"><span class="lineno"> 5363</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;=n_layers; i++){</div>
<div class="line"><span class="lineno"> 5364</span>      sal = (double)i/n_layers;</div>
<div class="line"><span class="lineno"> 5365</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;ny;j++)</div>
<div class="line"><span class="lineno"> 5366</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nz;k++){</div>
<div class="line"><span class="lineno"> 5367</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5368</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + injE[0]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5369</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + injE[1]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5370</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + injE[2]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5371</span>          }</div>
<div class="line"><span class="lineno"> 5372</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5373</span>            vectorX[i][j][k] = injE[0];</div>
<div class="line"><span class="lineno"> 5374</span>            vectorY[i][j][k] = injE[1];</div>
<div class="line"><span class="lineno"> 5375</span>            vectorZ[i][j][k] = injE[2];</div>
<div class="line"><span class="lineno"> 5376</span>          }</div>
<div class="line"><span class="lineno"> 5377</span>        }</div>
<div class="line"><span class="lineno"> 5378</span>    }</div>
<div class="line"><span class="lineno"> 5379</span>  }</div>
<div class="line"><span class="lineno"> 5380</span> </div>
<div class="line"><span class="lineno"> 5381</span>  <span class="comment">// X=Lx boundary</span></div>
<div class="line"><span class="lineno"> 5382</span>  <span class="keywordflow">if</span>(vct-&gt;getXright_neighbor()==MPI_PROC_NULL &amp;&amp; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a7d090b86a16ede7b0b8d4abec332e5b9">bcEMfaceXright</a> ==2) {</div>
<div class="line"><span class="lineno"> 5383</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=nx-3-1; i&lt;nx; i++){</div>
<div class="line"><span class="lineno"> 5384</span>      sal = (double)(nx-1.-i)/n_layers;</div>
<div class="line"><span class="lineno"> 5385</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;ny;j++)</div>
<div class="line"><span class="lineno"> 5386</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nz;k++){</div>
<div class="line"><span class="lineno"> 5387</span>        <span class="comment">/*if(yes_sal){</span></div>
<div class="line"><span class="lineno"> 5388</span><span class="comment">            vectorX[i][j][k] = vectorX[i][j][k]*sal + injE[0]*(1.-sal);</span></div>
<div class="line"><span class="lineno"> 5389</span><span class="comment">            vectorY[i][j][k] = vectorY[i][j][k]*sal + injE[1]*(1.-sal);</span></div>
<div class="line"><span class="lineno"> 5390</span><span class="comment">            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + injE[2]*(1.-sal);</span></div>
<div class="line"><span class="lineno"> 5391</span><span class="comment">          }</span></div>
<div class="line"><span class="lineno"> 5392</span><span class="comment">          else{*/</span></div>
<div class="line"><span class="lineno"> 5393</span>            vectorX[i][j][k] = vectorX[nx-2-n_layers][j][k];</div>
<div class="line"><span class="lineno"> 5394</span>            vectorY[i][j][k] = vectorY[nx-2-n_layers][j][k];</div>
<div class="line"><span class="lineno"> 5395</span>            vectorZ[i][j][k] = vectorZ[nx-2-n_layers][j][k];</div>
<div class="line"><span class="lineno"> 5396</span>          <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 5397</span>        } </div>
<div class="line"><span class="lineno"> 5398</span>    }  </div>
<div class="line"><span class="lineno"> 5399</span>  }</div>
<div class="line"><span class="lineno"> 5400</span> </div>
<div class="line"><span class="lineno"> 5401</span>  <span class="comment">// Y=0 boundary</span></div>
<div class="line"><span class="lineno"> 5402</span>  <span class="keywordflow">if</span>(vct-&gt;getYleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYleft==2)  {</div>
<div class="line"><span class="lineno"> 5403</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;=n_layers; j++){</div>
<div class="line"><span class="lineno"> 5404</span>      sal = (double)j/n_layers;</div>
<div class="line"><span class="lineno"> 5405</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nx; i++)</div>
<div class="line"><span class="lineno"> 5406</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nz; k++){</div>
<div class="line"><span class="lineno"> 5407</span> </div>
<div class="line"><span class="lineno"> 5408</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5409</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + injE[0]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5410</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + injE[1]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5411</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + injE[2]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5412</span>          }</div>
<div class="line"><span class="lineno"> 5413</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5414</span>            vectorX[i][j][k] = vectorX[i][n_layers+1][k];</div>
<div class="line"><span class="lineno"> 5415</span>            vectorY[i][j][k] = vectorY[i][n_layers+1][k];</div>
<div class="line"><span class="lineno"> 5416</span>            vectorZ[i][j][k] = vectorZ[i][n_layers+1][k];</div>
<div class="line"><span class="lineno"> 5417</span>          }</div>
<div class="line"><span class="lineno"> 5418</span>        }</div>
<div class="line"><span class="lineno"> 5419</span>    } </div>
<div class="line"><span class="lineno"> 5420</span>  }</div>
<div class="line"><span class="lineno"> 5421</span>  </div>
<div class="line"><span class="lineno"> 5422</span>  <span class="comment">// Y=Ly boundary</span></div>
<div class="line"><span class="lineno"> 5423</span>  <span class="keywordflow">if</span>(vct-&gt;getYright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYright==2)  {</div>
<div class="line"><span class="lineno"> 5424</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=ny-n_layers-1; j&lt;ny; j++){</div>
<div class="line"><span class="lineno"> 5425</span>      sal = (double)(ny-1-j)/n_layers;</div>
<div class="line"><span class="lineno"> 5426</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nx; i++)</div>
<div class="line"><span class="lineno"> 5427</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;nz; k++){</div>
<div class="line"><span class="lineno"> 5428</span>        </div>
<div class="line"><span class="lineno"> 5429</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5430</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + injE[0]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5431</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + injE[1]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5432</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + injE[2]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5433</span>          }</div>
<div class="line"><span class="lineno"> 5434</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5435</span>            vectorX[i][j][k] = vectorX[i][ny-2-n_layers][k];</div>
<div class="line"><span class="lineno"> 5436</span>            vectorY[i][j][k] = vectorY[i][ny-2-n_layers][k];</div>
<div class="line"><span class="lineno"> 5437</span>            vectorZ[i][j][k] = vectorZ[i][ny-2-n_layers][k];</div>
<div class="line"><span class="lineno"> 5438</span>          }</div>
<div class="line"><span class="lineno"> 5439</span>        }</div>
<div class="line"><span class="lineno"> 5440</span>    }</div>
<div class="line"><span class="lineno"> 5441</span>  }</div>
<div class="line"><span class="lineno"> 5442</span> </div>
<div class="line"><span class="lineno"> 5443</span>  <span class="comment">// Z=0 boundary</span></div>
<div class="line"><span class="lineno"> 5444</span>  <span class="keywordflow">if</span>(vct-&gt;getZleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZleft==2)  {</div>
<div class="line"><span class="lineno"> 5445</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;=n_layers; k++){</div>
<div class="line"><span class="lineno"> 5446</span>      sal = (double)k/n_layers;</div>
<div class="line"><span class="lineno"> 5447</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nx; i++)</div>
<div class="line"><span class="lineno"> 5448</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;ny; j++){</div>
<div class="line"><span class="lineno"> 5449</span> </div>
<div class="line"><span class="lineno"> 5450</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5451</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + injE[0]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5452</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + injE[1]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5453</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + injE[2]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5454</span>          }</div>
<div class="line"><span class="lineno"> 5455</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5456</span>            vectorX[i][j][k] = vectorX[i][j][n_layers+1];</div>
<div class="line"><span class="lineno"> 5457</span>            vectorY[i][j][k] = vectorY[i][j][n_layers+1];</div>
<div class="line"><span class="lineno"> 5458</span>            vectorZ[i][j][k] = vectorZ[i][j][n_layers+1];</div>
<div class="line"><span class="lineno"> 5459</span>          }</div>
<div class="line"><span class="lineno"> 5460</span>        }</div>
<div class="line"><span class="lineno"> 5461</span>    }</div>
<div class="line"><span class="lineno"> 5462</span>  }</div>
<div class="line"><span class="lineno"> 5463</span> </div>
<div class="line"><span class="lineno"> 5464</span>  <span class="comment">// Z=Lz boundary</span></div>
<div class="line"><span class="lineno"> 5465</span>  <span class="keywordflow">if</span>(vct-&gt;getZright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZright==2)  {</div>
<div class="line"><span class="lineno"> 5466</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=nz-n_layers-1; k&lt;nz; k++){</div>
<div class="line"><span class="lineno"> 5467</span>      sal = (double)(nz-1-k)/n_layers;</div>
<div class="line"><span class="lineno"> 5468</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nx; i++)</div>
<div class="line"><span class="lineno"> 5469</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;ny; j++){</div>
<div class="line"><span class="lineno"> 5470</span> </div>
<div class="line"><span class="lineno"> 5471</span>          <span class="keywordflow">if</span>(yes_sal){</div>
<div class="line"><span class="lineno"> 5472</span>            vectorX[i][j][k] = vectorX[i][j][k]*sal + injE[0]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5473</span>            vectorY[i][j][k] = vectorY[i][j][k]*sal + injE[1]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5474</span>            vectorZ[i][j][k] = vectorZ[i][j][k]*sal + injE[2]*(1.-sal);</div>
<div class="line"><span class="lineno"> 5475</span>          }</div>
<div class="line"><span class="lineno"> 5476</span>          <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 5477</span>            vectorX[i][j][k] = vectorX[i][j][nz-2-n_layers];</div>
<div class="line"><span class="lineno"> 5478</span>            vectorY[i][j][k] = vectorY[i][j][nz-2-n_layers];</div>
<div class="line"><span class="lineno"> 5479</span>            vectorZ[i][j][k] = vectorZ[i][j][nz-2-n_layers];</div>
<div class="line"><span class="lineno"> 5480</span>          }</div>
<div class="line"><span class="lineno"> 5481</span>        }</div>
<div class="line"><span class="lineno"> 5482</span>    }</div>
<div class="line"><span class="lineno"> 5483</span>  }</div>
<div class="line"><span class="lineno"> 5484</span> </div>
<div class="line"><span class="lineno"> 5485</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 5486</span><span class="comment">  if(vct-&gt;getXright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXright ==2) {</span></div>
<div class="line"><span class="lineno"> 5487</span><span class="comment">    for (int j=0; j &lt; ny;j++)</span></div>
<div class="line"><span class="lineno"> 5488</span><span class="comment">      for (int k=0; k &lt; nz;k++){</span></div>
<div class="line"><span class="lineno"> 5489</span><span class="comment">        //vectorX[nx-2][j][k] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5490</span><span class="comment">        //      vectorY[nx-2][j][k] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5491</span><span class="comment">        //      vectorZ[nx-2][j][k] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5492</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5493</span><span class="comment">        vectorX[nx-1][j][k] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5494</span><span class="comment">        vectorY[nx-1][j][k] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5495</span><span class="comment">        vectorZ[nx-1][j][k] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5496</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5497</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5498</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5499</span><span class="comment">  if(vct-&gt;getYleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYleft ==2) {</span></div>
<div class="line"><span class="lineno"> 5500</span><span class="comment">    for (int i=0; i &lt; nx;i++)</span></div>
<div class="line"><span class="lineno"> 5501</span><span class="comment">      for (int k=0; k &lt; nz;k++){</span></div>
<div class="line"><span class="lineno"> 5502</span><span class="comment">        //vectorX[i][1][k] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5503</span><span class="comment">        //ectorY[i][1][k] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5504</span><span class="comment">        //vectorZ[i][1][k] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5505</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5506</span><span class="comment">        vectorX[i][0][k] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5507</span><span class="comment">        vectorY[i][0][k] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5508</span><span class="comment">        vectorZ[i][0][k] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5509</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5510</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5511</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5512</span><span class="comment">  if(vct-&gt;getYright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYright ==2) {</span></div>
<div class="line"><span class="lineno"> 5513</span><span class="comment">    for (int i=0; i &lt; nx;i++)</span></div>
<div class="line"><span class="lineno"> 5514</span><span class="comment">      for (int k=0; k &lt; nz;k++){</span></div>
<div class="line"><span class="lineno"> 5515</span><span class="comment">        //vectorX[i][ny-2][k] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5516</span><span class="comment">        //vectorY[i][ny-2][k] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5517</span><span class="comment">        //vectorZ[i][ny-2][k] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5518</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5519</span><span class="comment">        vectorX[i][ny-1][k] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5520</span><span class="comment">        vectorY[i][ny-1][k] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5521</span><span class="comment">        vectorZ[i][ny-1][k] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5522</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5523</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5524</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5525</span><span class="comment">  if(vct-&gt;getZleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZleft ==2) {</span></div>
<div class="line"><span class="lineno"> 5526</span><span class="comment">    for (int i=0; i &lt; nx;i++)</span></div>
<div class="line"><span class="lineno"> 5527</span><span class="comment">      for (int j=0; j &lt; ny;j++){</span></div>
<div class="line"><span class="lineno"> 5528</span><span class="comment">        //vectorX[i][j][1] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5529</span><span class="comment">        //vectorY[i][j][1] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5530</span><span class="comment">        //vectorZ[i][j][1] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5531</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5532</span><span class="comment">        vectorX[i][j][0] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5533</span><span class="comment">        vectorY[i][j][0] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5534</span><span class="comment">        vectorZ[i][j][0] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5535</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5536</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5537</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5538</span><span class="comment">  if(vct-&gt;getZright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZright ==2) {</span></div>
<div class="line"><span class="lineno"> 5539</span><span class="comment">    for (int i=0; i &lt; nx;i++)</span></div>
<div class="line"><span class="lineno"> 5540</span><span class="comment">      for (int j=0; j &lt; ny;j++){</span></div>
<div class="line"><span class="lineno"> 5541</span><span class="comment">        //vectorX[i][j][nz-2] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5542</span><span class="comment">        //vectorY[i][j][nz-2] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5543</span><span class="comment">        //vectorZ[i][j][nz-2] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5544</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5545</span><span class="comment">        vectorX[i][j][nz-1] = injE[0];</span></div>
<div class="line"><span class="lineno"> 5546</span><span class="comment">        vectorY[i][j][nz-1] = injE[1];</span></div>
<div class="line"><span class="lineno"> 5547</span><span class="comment">        vectorZ[i][j][nz-1] = injE[2];</span></div>
<div class="line"><span class="lineno"> 5548</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5549</span><span class="comment">   }*/</span></div>
<div class="line"><span class="lineno"> 5550</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a98a6b6ad2409aa124446c7b922277690" name="a98a6b6ad2409aa124446c7b922277690"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98a6b6ad2409aa124446c7b922277690">&#9670;&nbsp;</a></span>OpenBoundaryInflowEImage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::OpenBoundaryInflowEImage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>imageX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>imageY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>imageZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05053">5053</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5056</span>{</div>
<div class="line"><span class="lineno"> 5057</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 5058</span>  <span class="comment">// Assuming E = - ve x B</span></div>
<div class="line"><span class="lineno"> 5059</span>  <span class="keywordtype">double</span> injE[3];</div>
<div class="line"><span class="lineno"> 5060</span>  cross_product(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a>,ve0,we0,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>,B0y,B0z,injE);</div>
<div class="line"><span class="lineno"> 5061</span>  scale(injE,-1.0,3);</div>
<div class="line"><span class="lineno"> 5062</span> </div>
<div class="line"><span class="lineno"> 5063</span>  <span class="keywordflow">if</span>(vct-&gt;getXleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXleft == 2) {</div>
<div class="line"><span class="lineno"> 5064</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt; ny-1;j++)</div>
<div class="line"><span class="lineno"> 5065</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=1; k &lt; nz-1;k++){</div>
<div class="line"><span class="lineno"> 5066</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>[0][j][k] = vectorX[0][j][k] - injE[0];</div>
<div class="line"><span class="lineno"> 5067</span>        imageY[0][j][k] = vectorY[0][j][k] - injE[1];</div>
<div class="line"><span class="lineno"> 5068</span>        imageZ[0][j][k] = vectorZ[0][j][k] - injE[2];</div>
<div class="line"><span class="lineno"> 5069</span>      }</div>
<div class="line"><span class="lineno"> 5070</span>  }</div>
<div class="line"><span class="lineno"> 5071</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 5072</span><span class="comment">  if(vct-&gt;getXright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceXright == 2) {</span></div>
<div class="line"><span class="lineno"> 5073</span><span class="comment">    for (int j=1; j &lt; ny-1;j++)</span></div>
<div class="line"><span class="lineno"> 5074</span><span class="comment">      for (int k=1; k &lt; nz-1;k++){</span></div>
<div class="line"><span class="lineno"> 5075</span><span class="comment">        imageX[nx-1][j][k] = vectorX[nx-1][j][k]- injE[0];</span></div>
<div class="line"><span class="lineno"> 5076</span><span class="comment">        imageY[nx-1][j][k] = vectorY[nx-1][j][k]- injE[1];</span></div>
<div class="line"><span class="lineno"> 5077</span><span class="comment">        imageZ[nx-1][j][k] = vectorZ[nx-1][j][k]- injE[2];</span></div>
<div class="line"><span class="lineno"> 5078</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5079</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5080</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5081</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5082</span><span class="comment">  if(vct-&gt;getYleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYleft ==2) {</span></div>
<div class="line"><span class="lineno"> 5083</span><span class="comment">    for (int i=1; i &lt; nx-1;i++)</span></div>
<div class="line"><span class="lineno"> 5084</span><span class="comment">      for (int k=1; k &lt; nz-1;k++){</span></div>
<div class="line"><span class="lineno"> 5085</span><span class="comment">        imageX[i][0][k] = vectorX[i][0][k]-injE[0];</span></div>
<div class="line"><span class="lineno"> 5086</span><span class="comment">        imageY[i][0][k] = vectorY[i][0][k]-injE[1];</span></div>
<div class="line"><span class="lineno"> 5087</span><span class="comment">        imageZ[i][0][k] = vectorZ[i][0][k]-injE[2];</span></div>
<div class="line"><span class="lineno"> 5088</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5089</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5090</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5091</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5092</span><span class="comment">  if(vct-&gt;getYright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceYright ==2) {</span></div>
<div class="line"><span class="lineno"> 5093</span><span class="comment">    for (int i=1; i &lt; nx-1;i++)</span></div>
<div class="line"><span class="lineno"> 5094</span><span class="comment">      for (int k=1; k &lt; nz-1;k++){</span></div>
<div class="line"><span class="lineno"> 5095</span><span class="comment">        imageX[i][ny-1][k] = vectorX[i][ny-1][k]-injE[0];</span></div>
<div class="line"><span class="lineno"> 5096</span><span class="comment">        imageY[i][ny-1][k] = vectorY[i][ny-1][k]-injE[1];</span></div>
<div class="line"><span class="lineno"> 5097</span><span class="comment">        imageZ[i][ny-1][k] = vectorZ[i][ny-1][k]-injE[2];</span></div>
<div class="line"><span class="lineno"> 5098</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5099</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5100</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5101</span><span class="comment">  if(vct-&gt;getZleft_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZright ==2) {</span></div>
<div class="line"><span class="lineno"> 5102</span><span class="comment">    for (int i=1; i &lt; nx-1;i++)</span></div>
<div class="line"><span class="lineno"> 5103</span><span class="comment">      for (int j=1; j &lt; ny-1;j++){</span></div>
<div class="line"><span class="lineno"> 5104</span><span class="comment">        imageX[i][j][0] = vectorX[i][j][0]-injE[0];</span></div>
<div class="line"><span class="lineno"> 5105</span><span class="comment">        imageY[i][j][0] = vectorY[i][j][0]-injE[1];</span></div>
<div class="line"><span class="lineno"> 5106</span><span class="comment">        imageZ[i][j][0] = vectorZ[i][j][0]-injE[2];</span></div>
<div class="line"><span class="lineno"> 5107</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5108</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5109</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 5110</span><span class="comment">  if(vct-&gt;getZright_neighbor()==MPI_PROC_NULL &amp;&amp; bcEMfaceZleft ==2) {</span></div>
<div class="line"><span class="lineno"> 5111</span><span class="comment">    for (int i=1; i &lt; nx-1;i++)</span></div>
<div class="line"><span class="lineno"> 5112</span><span class="comment">      for (int j=1; j &lt; ny-1;j++){</span></div>
<div class="line"><span class="lineno"> 5113</span><span class="comment">        imageX[i][j][nz-1] = vectorX[i][j][nz-1]-injE[0];</span></div>
<div class="line"><span class="lineno"> 5114</span><span class="comment">        imageY[i][j][nz-1] = vectorY[i][j][nz-1]-injE[1];</span></div>
<div class="line"><span class="lineno"> 5115</span><span class="comment">        imageZ[i][j][nz-1] = vectorZ[i][j][nz-1]-injE[2];</span></div>
<div class="line"><span class="lineno"> 5116</span><span class="comment">      }</span></div>
<div class="line"><span class="lineno"> 5117</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno"> 5118</span><span class="comment">  */</span></div>
<div class="line"><span class="lineno"> 5119</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aee06483ad2b6442df88503b205b0d408" name="aee06483ad2b6442df88503b205b0d408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee06483ad2b6442df88503b205b0d408">&#9670;&nbsp;</a></span>perfectConductorLeft()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::perfectConductorLeft </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>imageX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>imageY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>imageZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Perfect conductor boundary conditions LEFT wall</p>
<p >Perfect conductor boundary conditions: LEFT wall </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">4831</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4834</span>{</div>
<div class="line"><span class="lineno"> 4835</span>  <span class="keywordtype">double</span>** susxy;</div>
<div class="line"><span class="lineno"> 4836</span>  <span class="keywordtype">double</span>** susyy;</div>
<div class="line"><span class="lineno"> 4837</span>  <span class="keywordtype">double</span>** suszy;</div>
<div class="line"><span class="lineno"> 4838</span>  <span class="keywordtype">double</span>** susxx;</div>
<div class="line"><span class="lineno"> 4839</span>  <span class="keywordtype">double</span>** susyx;</div>
<div class="line"><span class="lineno"> 4840</span>  <span class="keywordtype">double</span>** suszx;</div>
<div class="line"><span class="lineno"> 4841</span>  <span class="keywordtype">double</span>** susxz;</div>
<div class="line"><span class="lineno"> 4842</span>  <span class="keywordtype">double</span>** susyz;</div>
<div class="line"><span class="lineno"> 4843</span>  <span class="keywordtype">double</span>** suszz;</div>
<div class="line"><span class="lineno"> 4844</span>  <span class="keywordflow">switch</span>(dir){</div>
<div class="line"><span class="lineno"> 4845</span>    <span class="keywordflow">case</span> 0:  <span class="comment">// boundary condition on X-DIRECTION </span></div>
<div class="line"><span class="lineno"> 4846</span>      susxx = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4847</span>      susyx = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4848</span>      suszx = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4849</span>      <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a7cd4c1659be3a8e65c3f42f386b2364f">sustensorLeftX</a>(susxx, susyx, suszx);</div>
<div class="line"><span class="lineno"> 4850</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt;  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 4851</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt;  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 4852</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>[1][i][j] = vectorX.get(1,i,j) - (Ex[1][i][j] - susyx[i][j]*vectorY.get(1,i,j) - suszx[i][j]*vectorZ.get(1,i,j) - Jxh[1][i][j]*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>*FourPI)/susxx[i][j];</div>
<div class="line"><span class="lineno"> 4853</span>          imageY[1][i][j] = vectorY.get(1,i,j) - 0.0*vectorY.get(2,i,j);</div>
<div class="line"><span class="lineno"> 4854</span>          imageZ[1][i][j] = vectorZ.get(1,i,j) - 0.0*vectorZ.get(2,i,j);</div>
<div class="line"><span class="lineno"> 4855</span>        }</div>
<div class="line"><span class="lineno"> 4856</span>      delArr2(susxx,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4857</span>      delArr2(susyx,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4858</span>      delArr2(suszx,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4859</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4860</span>    <span class="keywordflow">case</span> 1: <span class="comment">// boundary condition on Y-DIRECTION</span></div>
<div class="line"><span class="lineno"> 4861</span>      susxy = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4862</span>      susyy = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4863</span>      suszy = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4864</span>      <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a21a5816d7eb991b7c9a61c7e90279160">sustensorLeftY</a>(susxy, susyy, suszy);</div>
<div class="line"><span class="lineno"> 4865</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 4866</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt;  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 4867</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>[i][1][j] = vectorX.get(i,1,j) - 0.0*vectorX.get(i,2,j);</div>
<div class="line"><span class="lineno"> 4868</span>          imageY[i][1][j] = vectorY.get(i,1,j) - (Ey[i][1][j] - susxy[i][j]*vectorX.get(i,1,j) - suszy[i][j]*vectorZ.get(i,1,j) - Jyh[i][1][j]*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>*FourPI)/susyy[i][j];</div>
<div class="line"><span class="lineno"> 4869</span>          imageZ[i][1][j] = vectorZ.get(i,1,j) - 0.0*vectorZ.get(i,2,j);</div>
<div class="line"><span class="lineno"> 4870</span>        }</div>
<div class="line"><span class="lineno"> 4871</span>      delArr2(susxy,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4872</span>      delArr2(susyy,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4873</span>      delArr2(suszy,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4874</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4875</span>    <span class="keywordflow">case</span> 2: <span class="comment">// boundary condition on Z-DIRECTION</span></div>
<div class="line"><span class="lineno"> 4876</span>      susxz = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>);</div>
<div class="line"><span class="lineno"> 4877</span>      susyz = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>);</div>
<div class="line"><span class="lineno"> 4878</span>      suszz = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>);</div>
<div class="line"><span class="lineno"> 4879</span>      <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#aff9869a55d3b0bef113147abd0819667">sustensorLeftZ</a>(susxz, susyz, suszz);</div>
<div class="line"><span class="lineno"> 4880</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt;  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 4881</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt;  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 4882</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>[i][j][1] = vectorX.get(i,j,1);</div>
<div class="line"><span class="lineno"> 4883</span>          imageY[i][j][1] = vectorX.get(i,j,1);</div>
<div class="line"><span class="lineno"> 4884</span>          imageZ[i][j][1] = vectorZ.get(i,j,1) - (Ez[i][j][1] - susxz[i][j]*vectorX.get(i,j,1) - susyz[i][j]*vectorY.get(i,j,1) - Jzh[i][j][1]*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>*FourPI)/suszz[i][j];</div>
<div class="line"><span class="lineno"> 4885</span>        }</div>
<div class="line"><span class="lineno"> 4886</span>      delArr2(susxz,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4887</span>      delArr2(susyz,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4888</span>      delArr2(suszz,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4889</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4890</span>  }</div>
<div class="line"><span class="lineno"> 4891</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a21a5816d7eb991b7c9a61c7e90279160"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a21a5816d7eb991b7c9a61c7e90279160">EMfields3D::sustensorLeftY</a></div><div class="ttdeci">void sustensorLeftY(double **susxy, double **susyy, double **suszy)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">EMfields3D.cpp:4735</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a7cd4c1659be3a8e65c3f42f386b2364f"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a7cd4c1659be3a8e65c3f42f386b2364f">EMfields3D::sustensorLeftX</a></div><div class="ttdeci">void sustensorLeftX(double **susxx, double **susyx, double **suszx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">EMfields3D.cpp:4687</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_aff9869a55d3b0bef113147abd0819667"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#aff9869a55d3b0bef113147abd0819667">EMfields3D::sustensorLeftZ</a></div><div class="ttdeci">void sustensorLeftZ(double **susxz, double **susyz, double **suszz)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">EMfields3D.cpp:4783</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00454">imageX</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">sustensorLeftX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">sustensorLeftY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">sustensorLeftZ()</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00351">th</a>.</p>

</div>
</div>
<a id="ae0a7091cc937d5c0b93341c43f9bd261" name="ae0a7091cc937d5c0b93341c43f9bd261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0a7091cc937d5c0b93341c43f9bd261">&#9670;&nbsp;</a></span>perfectConductorLeftS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::perfectConductorLeftS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Perfect conductor boundary conditions for source LEFT wall</p>
<p >Perfect conductor boundary conditions for source: LEFT WALL </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04961">4961</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4961</span>                                                                                                             {</div>
<div class="line"><span class="lineno"> 4962</span> </div>
<div class="line"><span class="lineno"> 4963</span>  <span class="keywordtype">double</span> ebc[3];</div>
<div class="line"><span class="lineno"> 4964</span> </div>
<div class="line"><span class="lineno"> 4965</span>  <span class="comment">// Assuming E = - ve x B</span></div>
<div class="line"><span class="lineno"> 4966</span>  cross_product(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a>,ve0,we0,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>,B0y,B0z,ebc);</div>
<div class="line"><span class="lineno"> 4967</span>  scale(ebc,-1.0,3);</div>
<div class="line"><span class="lineno"> 4968</span> </div>
<div class="line"><span class="lineno"> 4969</span>  <span class="keywordflow">switch</span>(dir){</div>
<div class="line"><span class="lineno"> 4970</span>    <span class="keywordflow">case</span> 0: <span class="comment">// boundary condition on X-DIRECTION LEFT</span></div>
<div class="line"><span class="lineno"> 4971</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 4972</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 4973</span>          vectorX[1][i][j] = 0.0;</div>
<div class="line"><span class="lineno"> 4974</span>          vectorY[1][i][j] = ebc[1];</div>
<div class="line"><span class="lineno"> 4975</span>          vectorZ[1][i][j] = ebc[2];</div>
<div class="line"><span class="lineno"> 4976</span>          <span class="comment">//+//          vectorX[1][i][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 4977</span>          <span class="comment">//+//          vectorY[1][i][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 4978</span>          <span class="comment">//+//          vectorZ[1][i][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 4979</span>        }</div>
<div class="line"><span class="lineno"> 4980</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4981</span>    <span class="keywordflow">case</span> 1: <span class="comment">// boundary condition on Y-DIRECTION LEFT</span></div>
<div class="line"><span class="lineno"> 4982</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 4983</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 4984</span>          vectorX[i][1][j] = ebc[0];</div>
<div class="line"><span class="lineno"> 4985</span>          vectorY[i][1][j] = 0.0;</div>
<div class="line"><span class="lineno"> 4986</span>          vectorZ[i][1][j] = ebc[2];</div>
<div class="line"><span class="lineno"> 4987</span>          <span class="comment">//+//          vectorX[i][1][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 4988</span>          <span class="comment">//+//          vectorY[i][1][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 4989</span>          <span class="comment">//+//          vectorZ[i][1][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 4990</span>        }</div>
<div class="line"><span class="lineno"> 4991</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4992</span>    <span class="keywordflow">case</span> 2: <span class="comment">// boundary condition on Z-DIRECTION LEFT</span></div>
<div class="line"><span class="lineno"> 4993</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 4994</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt;  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 4995</span>          vectorX[i][j][1] = ebc[0];</div>
<div class="line"><span class="lineno"> 4996</span>          vectorY[i][j][1] = ebc[1];</div>
<div class="line"><span class="lineno"> 4997</span>          vectorZ[i][j][1] = 0.0;</div>
<div class="line"><span class="lineno"> 4998</span>          <span class="comment">//+//          vectorX[i][j][1] = 0.0;</span></div>
<div class="line"><span class="lineno"> 4999</span>          <span class="comment">//+//          vectorY[i][j][1] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5000</span>          <span class="comment">//+//          vectorZ[i][j][1] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5001</span>        }</div>
<div class="line"><span class="lineno"> 5002</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5003</span>  }</div>
<div class="line"><span class="lineno"> 5004</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00366">ue0</a>.</p>

</div>
</div>
<a id="ab1072ee8da07f212a187cd2f439d157e" name="ab1072ee8da07f212a187cd2f439d157e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1072ee8da07f212a187cd2f439d157e">&#9670;&nbsp;</a></span>perfectConductorRight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::perfectConductorRight </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>imageX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>imageY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>imageZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Perfect conductor boundary conditions RIGHT wall</p>
<p >Perfect conductor boundary conditions: RIGHT wall </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">4894</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4900</span>{</div>
<div class="line"><span class="lineno"> 4901</span>  <span class="keywordtype">double</span> beta, omcx, omcy, omcz, denom;</div>
<div class="line"><span class="lineno"> 4902</span>  <span class="keywordtype">double</span>** susxy;</div>
<div class="line"><span class="lineno"> 4903</span>  <span class="keywordtype">double</span>** susyy;</div>
<div class="line"><span class="lineno"> 4904</span>  <span class="keywordtype">double</span>** suszy;</div>
<div class="line"><span class="lineno"> 4905</span>  <span class="keywordtype">double</span>** susxx;</div>
<div class="line"><span class="lineno"> 4906</span>  <span class="keywordtype">double</span>** susyx;</div>
<div class="line"><span class="lineno"> 4907</span>  <span class="keywordtype">double</span>** suszx;</div>
<div class="line"><span class="lineno"> 4908</span>  <span class="keywordtype">double</span>** susxz;</div>
<div class="line"><span class="lineno"> 4909</span>  <span class="keywordtype">double</span>** susyz;</div>
<div class="line"><span class="lineno"> 4910</span>  <span class="keywordtype">double</span>** suszz;</div>
<div class="line"><span class="lineno"> 4911</span>  <span class="keywordflow">switch</span>(dir){</div>
<div class="line"><span class="lineno"> 4912</span>    <span class="keywordflow">case</span> 0: <span class="comment">// boundary condition on X-DIRECTION RIGHT</span></div>
<div class="line"><span class="lineno"> 4913</span>      susxx = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4914</span>      susyx = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4915</span>      suszx = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4916</span>      <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#abf8e3a2222c27c4370da9e45e331b46c">sustensorRightX</a>(susxx, susyx, suszx);</div>
<div class="line"><span class="lineno"> 4917</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 4918</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt;  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 4919</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2][i][j] = vectorX.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2,i,j) - (Ex[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2][i][j] - susyx[i][j]*vectorY.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2,i,j) - suszx[i][j]*vectorZ.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2,i,j) - Jxh[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2][i][j]*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>*FourPI)/susxx[i][j];</div>
<div class="line"><span class="lineno"> 4920</span>          imageY[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2][i][j] = vectorY.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2,i,j) - 0.0 * vectorY.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-3,i,j);</div>
<div class="line"><span class="lineno"> 4921</span>          imageZ[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2][i][j] = vectorZ.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2,i,j) - 0.0 * vectorZ.get(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-3,i,j);</div>
<div class="line"><span class="lineno"> 4922</span>        }</div>
<div class="line"><span class="lineno"> 4923</span>      delArr2(susxx,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4924</span>      delArr2(susyx,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);       </div>
<div class="line"><span class="lineno"> 4925</span>      delArr2(suszx,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4926</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4927</span>    <span class="keywordflow">case</span> 1: <span class="comment">// boundary condition on Y-DIRECTION RIGHT</span></div>
<div class="line"><span class="lineno"> 4928</span>      susxy = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4929</span>      susyy = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4930</span>      suszy = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 4931</span>      <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a7be07c6d9ea694ae7ace21ee4ae67b36">sustensorRightY</a>(susxy, susyy, suszy);</div>
<div class="line"><span class="lineno"> 4932</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 4933</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 4934</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2][j] = vectorX.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2,j) - 0.0*vectorX.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-3,j);</div>
<div class="line"><span class="lineno"> 4935</span>          imageY[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2][j] = vectorY.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2,j) - (Ey[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2][j] - susxy[i][j]*vectorX.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2,j) - suszy[i][j]*vectorZ.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2,j) - Jyh[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2][j]*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>*FourPI)/susyy[i][j];</div>
<div class="line"><span class="lineno"> 4936</span>          imageZ[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2][j] = vectorZ.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2,j) - 0.0*vectorZ.get(i,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-3,j);</div>
<div class="line"><span class="lineno"> 4937</span>        }</div>
<div class="line"><span class="lineno"> 4938</span>      delArr2(susxy,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4939</span>      delArr2(susyy,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4940</span>      delArr2(suszy,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4941</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4942</span>    <span class="keywordflow">case</span> 2: <span class="comment">// boundary condition on Z-DIRECTION RIGHT</span></div>
<div class="line"><span class="lineno"> 4943</span>      susxz = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>);</div>
<div class="line"><span class="lineno"> 4944</span>      susyz = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>);</div>
<div class="line"><span class="lineno"> 4945</span>      suszz = newArr2(<span class="keywordtype">double</span>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>);</div>
<div class="line"><span class="lineno"> 4946</span>      <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a5ba6a96d31f80b1179910a118484cced">sustensorRightZ</a>(susxz, susyz, suszz);</div>
<div class="line"><span class="lineno"> 4947</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 4948</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 4949</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aaf7aa492bfe607643d07aad8323c08e5">imageX</a>[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2] = vectorX.get(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2);</div>
<div class="line"><span class="lineno"> 4950</span>          imageY[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2] = vectorY.get(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2);</div>
<div class="line"><span class="lineno"> 4951</span>          imageZ[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2] = vectorZ.get(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2) - (Ez[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2] - susxz[i][j]*vectorX.get(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2) - susyz[i][j]*vectorY.get(i,j,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2) - Jzh[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2]*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a>*<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac87809eafbf98eb3336a670dcb3a2728">th</a>*FourPI)/suszz[i][j];</div>
<div class="line"><span class="lineno"> 4952</span>        }</div>
<div class="line"><span class="lineno"> 4953</span>      delArr2(susxz,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4954</span>      delArr2(susyz,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);       </div>
<div class="line"><span class="lineno"> 4955</span>      delArr2(suszz,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>);</div>
<div class="line"><span class="lineno"> 4956</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4957</span>  }</div>
<div class="line"><span class="lineno"> 4958</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a5ba6a96d31f80b1179910a118484cced"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a5ba6a96d31f80b1179910a118484cced">EMfields3D::sustensorRightZ</a></div><div class="ttdeci">void sustensorRightZ(double **susxz, double **susyz, double **suszz)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">EMfields3D.cpp:4807</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a7be07c6d9ea694ae7ace21ee4ae67b36"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a7be07c6d9ea694ae7ace21ee4ae67b36">EMfields3D::sustensorRightY</a></div><div class="ttdeci">void sustensorRightY(double **susxy, double **susyy, double **suszy)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">EMfields3D.cpp:4759</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_abf8e3a2222c27c4370da9e45e331b46c"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#abf8e3a2222c27c4370da9e45e331b46c">EMfields3D::sustensorRightX</a></div><div class="ttdeci">void sustensorRightX(double **susxx, double **susyx, double **suszx)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">EMfields3D.cpp:4711</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00454">imageX</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00351">th</a>.</p>

</div>
</div>
<a id="a1e6e0daf47ea065c947d9b99493418a3" name="a1e6e0daf47ea065c947d9b99493418a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e6e0daf47ea065c947d9b99493418a3">&#9670;&nbsp;</a></span>perfectConductorRightS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::perfectConductorRightS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectorZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Perfect conductor boundary conditions for source RIGHT wall</p>
<p >Perfect conductor boundary conditions for source: RIGHT WALL </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05007">5007</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5007</span>                                                                                                              {</div>
<div class="line"><span class="lineno"> 5008</span> </div>
<div class="line"><span class="lineno"> 5009</span>  <span class="keywordtype">double</span> ebc[3];</div>
<div class="line"><span class="lineno"> 5010</span> </div>
<div class="line"><span class="lineno"> 5011</span>  <span class="comment">// Assuming E = - ve x B</span></div>
<div class="line"><span class="lineno"> 5012</span>  cross_product(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a50c0294e6845feaa8082d5f213c3b9b5">ue0</a>,ve0,we0,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36e8cc446bb14517409aba077a6bab1b">B0x</a>,B0y,B0z,ebc);</div>
<div class="line"><span class="lineno"> 5013</span>  scale(ebc,-1.0,3);</div>
<div class="line"><span class="lineno"> 5014</span> </div>
<div class="line"><span class="lineno"> 5015</span>  <span class="keywordflow">switch</span>(dir){</div>
<div class="line"><span class="lineno"> 5016</span>    <span class="keywordflow">case</span> 0: <span class="comment">// boundary condition on X-DIRECTION RIGHT</span></div>
<div class="line"><span class="lineno"> 5017</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 5018</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 5019</span>          vectorX[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2][i][j] = 0.0;</div>
<div class="line"><span class="lineno"> 5020</span>          vectorY[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2][i][j] = ebc[1];</div>
<div class="line"><span class="lineno"> 5021</span>          vectorZ[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-2][i][j] = ebc[2];</div>
<div class="line"><span class="lineno"> 5022</span>          <span class="comment">//+//          vectorX[nxn-2][i][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5023</span>          <span class="comment">//+//          vectorY[nxn-2][i][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5024</span>          <span class="comment">//+//          vectorZ[nxn-2][i][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5025</span>        }</div>
<div class="line"><span class="lineno"> 5026</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5027</span>    <span class="keywordflow">case</span> 1: <span class="comment">// boundary condition on Y-DIRECTION RIGHT</span></div>
<div class="line"><span class="lineno"> 5028</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 5029</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 5030</span>          vectorX[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2][j] = ebc[0];</div>
<div class="line"><span class="lineno"> 5031</span>          vectorY[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2][j] = 0.0;</div>
<div class="line"><span class="lineno"> 5032</span>          vectorZ[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-2][j] = ebc[2];</div>
<div class="line"><span class="lineno"> 5033</span>          <span class="comment">//+//          vectorX[i][nyn-2][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5034</span>          <span class="comment">//+//          vectorY[i][nyn-2][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5035</span>          <span class="comment">//+//          vectorZ[i][nyn-2][j] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5036</span>        }</div>
<div class="line"><span class="lineno"> 5037</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5038</span>    <span class="keywordflow">case</span> 2:</div>
<div class="line"><span class="lineno"> 5039</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1; i &lt;  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>-1;i++)</div>
<div class="line"><span class="lineno"> 5040</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=1; j &lt;  <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>-1;j++){</div>
<div class="line"><span class="lineno"> 5041</span>          vectorX[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2] = ebc[0];</div>
<div class="line"><span class="lineno"> 5042</span>          vectorY[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2] = ebc[1];</div>
<div class="line"><span class="lineno"> 5043</span>          vectorZ[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>-2] = 0.0;</div>
<div class="line"><span class="lineno"> 5044</span>          <span class="comment">//+//          vectorX[i][j][nzn-2] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5045</span>          <span class="comment">//+//          vectorY[i][j][nzn-2] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5046</span>          <span class="comment">//+//          vectorZ[i][j][nzn-2] = 0.0;</span></div>
<div class="line"><span class="lineno"> 5047</span>        }</div>
<div class="line"><span class="lineno"> 5048</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5049</span>  }</div>
<div class="line"><span class="lineno"> 5050</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">B0x</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00366">ue0</a>.</p>

</div>
</div>
<a id="a892a9c1f5511092fbd32ac283fcbc6c1" name="a892a9c1f5511092fbd32ac283fcbc6c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a892a9c1f5511092fbd32ac283fcbc6c1">&#9670;&nbsp;</a></span>PIdot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::PIdot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>PIdotX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>PIdotY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>PIdotZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d3b/classi_pic3_d_1_1const__array__ref3.html">const_arr3_double</a>&#160;</td>
          <td class="paramname"><em>vectZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the three components of Pi(implicit pressure) cross image vector</p>
<p >Calculate PI dot (vectX, vectY, vectZ) </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">2422</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2423</span>{</div>
<div class="line"><span class="lineno"> 2424</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2425</span>  <span class="keywordtype">double</span> beta, edotb, omcx, omcy, omcz, denom;</div>
<div class="line"><span class="lineno"> 2426</span>  beta = .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>;</div>
<div class="line"><span class="lineno"> 2427</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2428</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2429</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++) {</div>
<div class="line"><span class="lineno"> 2430</span>        omcx = beta * (Bxn[i][j][k] + Bx_ext[i][j][k]);</div>
<div class="line"><span class="lineno"> 2431</span>        omcy = beta * (Byn[i][j][k] + By_ext[i][j][k]);</div>
<div class="line"><span class="lineno"> 2432</span>        omcz = beta * (Bzn[i][j][k] + Bz_ext[i][j][k]);</div>
<div class="line"><span class="lineno"> 2433</span>        edotb = vectX.get(i,j,k) * omcx + vectY.get(i,j,k) * omcy + vectZ.get(i,j,k) * omcz;</div>
<div class="line"><span class="lineno"> 2434</span>        denom = 1 / (1.0 + omcx * omcx + omcy * omcy + omcz * omcz);</div>
<div class="line"><span class="lineno"> 2435</span>        PIdotX.fetch(i,j,k) += (vectX.get(i,j,k) + (vectY.get(i,j,k) * omcz - vectZ.get(i,j,k) * omcy + edotb * omcx)) * denom;</div>
<div class="line"><span class="lineno"> 2436</span>        PIdotY.fetch(i,j,k) += (vectY.get(i,j,k) + (vectZ.get(i,j,k) * omcx - vectX.get(i,j,k) * omcz + edotb * omcy)) * denom;</div>
<div class="line"><span class="lineno"> 2437</span>        PIdotZ.fetch(i,j,k) += (vectZ.get(i,j,k) + (vectX.get(i,j,k) * omcy - vectY.get(i,j,k) * omcx + edotb * omcz)) * denom;</div>
<div class="line"><span class="lineno"> 2438</span>      }</div>
<div class="line"><span class="lineno"> 2439</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>.</p>

</div>
</div>
<a id="a9d3ddfa82333c03d79211c94cf7d7df9" name="a9d3ddfa82333c03d79211c94cf7d7df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d3ddfa82333c03d79211c94cf7d7df9">&#9670;&nbsp;</a></span>PoissonImage()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::PoissonImage </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vector</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Image of Poisson Solver (for SOLVER)</p>
<p >Image of Poisson Solver </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03319">3319</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3320</span>{</div>
<div class="line"><span class="lineno"> 3321</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 3322</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 3323</span> </div>
<div class="line"><span class="lineno"> 3324</span>  <span class="comment">// allocate 2 three dimensional service vectors</span></div>
<div class="line"><span class="lineno"> 3325</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> temp(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3326</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> im(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3327</span>  eqValue(0.0, image, (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a> - 2) * (<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a> - 2));</div>
<div class="line"><span class="lineno"> 3328</span>  eqValue(0.0, temp, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3329</span>  eqValue(0.0, im, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3330</span>  <span class="comment">// move from krylov space to physical space and communicate ghost cells</span></div>
<div class="line"><span class="lineno"> 3331</span>  solver2phys(temp, vector, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3332</span>  <span class="comment">// calculate the laplacian</span></div>
<div class="line"><span class="lineno"> 3333</span>  grid-&gt;<a class="code hl_function" href="../../d2/dd3/class_grid3_d_c_u.html#ab124d7656b81ed604fa0b5daa5a7c8f7">lapC2Cpoisson</a>(im, temp, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3334</span>  <span class="comment">// move from physical space to krylov space</span></div>
<div class="line"><span class="lineno"> 3335</span>  phys2solver(image, im, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>);</div>
<div class="line"><span class="lineno"> 3336</span>}</div>
<div class="ttc" id="aclass_grid3_d_c_u_html_ab124d7656b81ed604fa0b5daa5a7c8f7"><div class="ttname"><a href="../../d2/dd3/class_grid3_d_c_u.html#ab124d7656b81ed604fa0b5daa5a7c8f7">Grid3DCU::lapC2Cpoisson</a></div><div class="ttdeci">void lapC2Cpoisson(arr3_double lapC, arr3_double scFieldC, EMfields3D *EMf) const</div><div class="ttdoc">calculate laplacian on central points, given a scalar field defined on central points for Poisson</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html#ab124d7656b81ed604fa0b5daa5a7c8f7">Grid3DCU::lapC2Cpoisson()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>.</p>

</div>
</div>
<a id="aee8a6a15ba29ed6dd1c53b20e0425a67" name="aee8a6a15ba29ed6dd1c53b20e0425a67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee8a6a15ba29ed6dd1c53b20e0425a67">&#9670;&nbsp;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::print </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >print electromagnetic fields info</p>
<p >Print info about electromagnetic field </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05710">5710</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 5710</span>                                 {</div>
<div class="line"><span class="lineno"> 5711</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a25285e5b33836e3a3e77965e887836ef" name="a25285e5b33836e3a3e77965e887836ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25285e5b33836e3a3e77965e887836ef">&#9670;&nbsp;</a></span>set_fieldForPcls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::set_fieldForPcls </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >copy the field data to the array used to move the particles</p>
<p >Populate the field data used to push particles </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03023">3023</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3024</span>{</div>
<div class="line"><span class="lineno"> 3025</span><span class="preprocessor">  #pragma omp parallel for collapse(3)</span></div>
<div class="line"><span class="lineno"> 3026</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++)</div>
<div class="line"><span class="lineno"> 3027</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++)</div>
<div class="line"><span class="lineno"> 3028</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno"> 3029</span>  {</div>
<div class="line"><span class="lineno"> 3030</span>    fieldForPcls[i][j][k][0] = (pfloat) (Bxn[i][j][k] + Bx_ext[i][j][k]);</div>
<div class="line"><span class="lineno"> 3031</span>    fieldForPcls[i][j][k][1] = (pfloat) (Byn[i][j][k] + By_ext[i][j][k]);</div>
<div class="line"><span class="lineno"> 3032</span>    fieldForPcls[i][j][k][2] = (pfloat) (Bzn[i][j][k] + Bz_ext[i][j][k]);</div>
<div class="line"><span class="lineno"> 3033</span>    fieldForPcls[i][j][k][0+DFIELD_3or4] = (pfloat) Ex[i][j][k];</div>
<div class="line"><span class="lineno"> 3034</span>    fieldForPcls[i][j][k][1+DFIELD_3or4] = (pfloat) Ey[i][j][k];</div>
<div class="line"><span class="lineno"> 3035</span>    fieldForPcls[i][j][k][2+DFIELD_3or4] = (pfloat) Ez[i][j][k];</div>
<div class="line"><span class="lineno"> 3036</span>  }</div>
<div class="line"><span class="lineno"> 3037</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>.</p>

</div>
</div>
<a id="a1bd9a86dfaa4ce57736b1f477033f400" name="a1bd9a86dfaa4ce57736b1f477033f400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bd9a86dfaa4ce57736b1f477033f400">&#9670;&nbsp;</a></span>SetLambda()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::SetLambda </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *&#160;</td>
          <td class="paramname"><em>grid</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03482">3482</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3482</span>                                    {</div>
<div class="line"><span class="lineno"> 3483</span> </div>
<div class="line"><span class="lineno"> 3484</span>  <span class="keywordtype">double</span> a=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aa5faeefa7eb12e7e655923af87e2c5e7">L_square</a>;</div>
<div class="line"><span class="lineno"> 3485</span> </div>
<div class="line"><span class="lineno"> 3486</span>  <span class="keywordtype">double</span> xc=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac7afadac85c315f7b6c17382a434e45d">x_center</a>;</div>
<div class="line"><span class="lineno"> 3487</span>  <span class="keywordtype">double</span> yc=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a71b15b350e24f60d5b4418d274231c93">y_center</a>;</div>
<div class="line"><span class="lineno"> 3488</span>  <span class="keywordtype">double</span> zc=<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a1ae9e3a80d6602b3f60e56582d236ee1">z_center</a>;</div>
<div class="line"><span class="lineno"> 3489</span> </div>
<div class="line"><span class="lineno"> 3490</span>  <span class="keywordtype">double</span> dr = sqrt(pow(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>,2)+pow(dy,2)+pow(dz,2));</div>
<div class="line"><span class="lineno"> 3491</span> </div>
<div class="line"><span class="lineno"> 3492</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++){</div>
<div class="line"><span class="lineno"> 3493</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++){</div>
<div class="line"><span class="lineno"> 3494</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++){</div>
<div class="line"><span class="lineno"> 3495</span> </div>
<div class="line"><span class="lineno"> 3496</span>        <span class="keywordtype">double</span> x = grid-&gt;getXN(i,j,k);</div>
<div class="line"><span class="lineno"> 3497</span>        <span class="keywordtype">double</span> y = grid-&gt;getYN(i,j,k);</div>
<div class="line"><span class="lineno"> 3498</span>        <span class="keywordtype">double</span> z = grid-&gt;getZN(i,j,k);</div>
<div class="line"><span class="lineno"> 3499</span> </div>
<div class="line"><span class="lineno"> 3500</span>        <span class="keywordtype">double</span> r2_planet = ((x-xc)*(x-xc)) + ((y-yc)*(y-yc)) + ((z-zc-PlanetOffset)*(z-zc-PlanetOffset));</div>
<div class="line"><span class="lineno"> 3501</span> </div>
<div class="line"><span class="lineno"> 3502</span>        <span class="keywordflow">if</span> (r2_planet&gt;a*a) Lambda[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3503</span>        <span class="keywordflow">else</span>               Lambda[i][j][k] = (a-sqrt(r2_planet))*4.*M_PI/dr;</div>
<div class="line"><span class="lineno"> 3504</span> </div>
<div class="line"><span class="lineno"> 3505</span>      }</div>
<div class="line"><span class="lineno"> 3506</span>    }</div>
<div class="line"><span class="lineno"> 3507</span>  }</div>
<div class="line"><span class="lineno"> 3508</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9873e7af854e4b62d6d7ffd9a9d8aef5" name="a9873e7af854e4b62d6d7ffd9a9d8aef5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9873e7af854e4b62d6d7ffd9a9d8aef5">&#9670;&nbsp;</a></span>setZeroDensities()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::setZeroDensities </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >set to 0 all the densities fields </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03454">3454</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3454</span>                                  {</div>
<div class="line"><span class="lineno"> 3455</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a375729e23a4a80fcf1266d4539d72a1e">setZeroDerivedMoments</a>();</div>
<div class="line"><span class="lineno"> 3456</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a8962189d5c671d7b0e3ad2516e70126e">setZeroPrimaryMoments</a>();</div>
<div class="line"><span class="lineno"> 3457</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a375729e23a4a80fcf1266d4539d72a1e"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a375729e23a4a80fcf1266d4539d72a1e">EMfields3D::setZeroDerivedMoments</a></div><div class="ttdeci">void setZeroDerivedMoments()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">EMfields3D.cpp:3411</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a8962189d5c671d7b0e3ad2516e70126e"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a8962189d5c671d7b0e3ad2516e70126e">EMfields3D::setZeroPrimaryMoments</a></div><div class="ttdeci">void setZeroPrimaryMoments()</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03432">EMfields3D.cpp:3432</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03432">setZeroPrimaryMoments()</a>.</p>

</div>
</div>
<a id="a375729e23a4a80fcf1266d4539d72a1e" name="a375729e23a4a80fcf1266d4539d72a1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a375729e23a4a80fcf1266d4539d72a1e">&#9670;&nbsp;</a></span>setZeroDerivedMoments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::setZeroDerivedMoments </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >set to 0 all densities derived from primary moments</p>
<p >communicate ghost for grid -&gt; Particles interpolation </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">3411</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3412</span>{</div>
<div class="line"><span class="lineno"> 3413</span>  <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3414</span>    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3415</span>      <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 3416</span>        Jx  [i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3417</span>        Jxh [i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3418</span>        Jy  [i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3419</span>        Jyh [i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3420</span>        Jz  [i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3421</span>        Jzh [i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3422</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac154c0bebb127df531138a846cfde8e3">rhon</a>[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3423</span>      }</div>
<div class="line"><span class="lineno"> 3424</span>  <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>; i++)</div>
<div class="line"><span class="lineno"> 3425</span>    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>; j++)</div>
<div class="line"><span class="lineno"> 3426</span>      <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>; k++) {</div>
<div class="line"><span class="lineno"> 3427</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac592e12b7cc8428fecb8219e9ebe050d">rhoc</a>[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3428</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a43d562d551ea0f165362c5679bbba07b">rhoh</a>[i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3429</span>      }</div>
<div class="line"><span class="lineno"> 3430</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">nxc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">nyc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">nzc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00475">rhoc</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00479">rhoh</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00477">rhon</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03454">setZeroDensities()</a>.</p>

</div>
</div>
<a id="a8962189d5c671d7b0e3ad2516e70126e" name="a8962189d5c671d7b0e3ad2516e70126e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8962189d5c671d7b0e3ad2516e70126e">&#9670;&nbsp;</a></span>setZeroPrimaryMoments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::setZeroPrimaryMoments </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >set to 0 primary moments </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03432">3432</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3432</span>                                       {</div>
<div class="line"><span class="lineno"> 3433</span> </div>
<div class="line"><span class="lineno"> 3434</span>  <span class="comment">// set primary moments to zero</span></div>
<div class="line"><span class="lineno"> 3435</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 3436</span>  <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> kk = 0; kk &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; kk++)</div>
<div class="line"><span class="lineno"> 3437</span>    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3438</span>      <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3439</span>        <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 3440</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3441</span>          Jxs  [kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3442</span>          Jys  [kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3443</span>          Jzs  [kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3444</span>          pXXsn[kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3445</span>          pXYsn[kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3446</span>          pXZsn[kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3447</span>          pYYsn[kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3448</span>          pYZsn[kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3449</span>          pZZsn[kk][i][j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 3450</span>        }</div>
<div class="line"><span class="lineno"> 3451</span> </div>
<div class="line"><span class="lineno"> 3452</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03454">setZeroDensities()</a>.</p>

</div>
</div>
<a id="ace4a00624182f44875bbd400d5c15324" name="ace4a00624182f44875bbd400d5c15324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace4a00624182f44875bbd400d5c15324">&#9670;&nbsp;</a></span>smooth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::smooth </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d5a/classi_pic3_d_1_1array__ref3.html">arr3_double</a>&#160;</td>
          <td class="paramname"><em>vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Smoothing after the interpolation* </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02470">2470</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2471</span>{</div>
<div class="line"><span class="lineno"> 2472</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a>==1.0) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2473</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 2474</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2475</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 2476</span> </div>
<div class="line"><span class="lineno"> 2477</span>  <span class="keywordtype">double</span> alpha   = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a>;</div>
<div class="line"><span class="lineno"> 2478</span>  <span class="keywordtype">double</span> beta3D  = (1-alpha)/6.0;</div>
<div class="line"><span class="lineno"> 2479</span>  <span class="keywordtype">double</span> beta2D  = (1-alpha)/4.0;</div>
<div class="line"><span class="lineno"> 2480</span>  <span class="keywordtype">int</span> nx, ny, nz;</div>
<div class="line"><span class="lineno"> 2481</span> </div>
<div class="line"><span class="lineno"> 2482</span>  <span class="keywordflow">if</span> (col-&gt;getVerbose() and vct-&gt;getCartesian_rank() == 0)</div>
<div class="line"><span class="lineno"> 2483</span>    cout &lt;&lt; <span class="stringliteral">&quot;*** smooth rho,Jx,Jy,Jz &quot;</span>&lt;&lt; SmoothNiter &lt;&lt;<span class="stringliteral">&quot; times, strength (in range 0-1) = &quot;</span>&lt;&lt; 1.-alpha &lt;&lt;<span class="stringliteral">&quot; ***&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2484</span>    </div>
<div class="line"><span class="lineno"> 2485</span>  <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><span class="lineno"> 2486</span>          <span class="keywordflow">case</span> (0):</div>
<div class="line"><span class="lineno"> 2487</span>                           nx = grid-&gt;getNXC();</div>
<div class="line"><span class="lineno"> 2488</span>                           ny = grid-&gt;getNYC();</div>
<div class="line"><span class="lineno"> 2489</span>                           nz = grid-&gt;getNZC();</div>
<div class="line"><span class="lineno"> 2490</span>                           <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2491</span>          <span class="keywordflow">case</span> (1):</div>
<div class="line"><span class="lineno"> 2492</span>                           nx = grid-&gt;getNXN();</div>
<div class="line"><span class="lineno"> 2493</span>                           ny = grid-&gt;getNYN();</div>
<div class="line"><span class="lineno"> 2494</span>                           nz = grid-&gt;getNZN();</div>
<div class="line"><span class="lineno"> 2495</span>                           <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2496</span>  }</div>
<div class="line"><span class="lineno"> 2497</span>  <span class="keywordtype">double</span> ***temp = newArr3(<span class="keywordtype">double</span>, nx, ny, nz);</div>
<div class="line"><span class="lineno"> 2498</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icount = 1; icount &lt; SmoothNiter + 1; icount++) {</div>
<div class="line"><span class="lineno"> 2499</span>      <span class="keywordflow">switch</span> (type) {</div>
<div class="line"><span class="lineno"> 2500</span>        <span class="keywordflow">case</span> (0):</div>
<div class="line"><span class="lineno"> 2501</span>          communicateCenterBoxStencilBC_P(nx, ny, nz, vector, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2502</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2503</span>        <span class="keywordflow">case</span> (1):</div>
<div class="line"><span class="lineno"> 2504</span>          communicateNodeBoxStencilBC_P(nx, ny, nz, vector, 2, 2, 2, 2, 2, 2, vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2505</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2506</span>      }</div>
<div class="line"><span class="lineno"> 2507</span> </div>
<div class="line"><span class="lineno"> 2508</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; nx - 1; i++)</div>
<div class="line"><span class="lineno"> 2509</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; ny - 1; j++)</div>
<div class="line"><span class="lineno"> 2510</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; nz - 1; k++){</div>
<div class="line"><span class="lineno"> 2511</span>            <span class="keywordflow">if</span> ( <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>&gt;1 ) </div>
<div class="line"><span class="lineno"> 2512</span>              temp[i][j][k] = alpha * vector[i][j][k] + beta3D * (vector[i - 1][j][k] + vector[i + 1][j][k] + vector[i][j - 1][k] + vector[i][j + 1][k] + vector[i][j][k - 1] + vector[i][j][k + 1]);</div>
<div class="line"><span class="lineno"> 2513</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2514</span>              temp[i][j][k] = alpha * vector[i][j][k] + beta2D * (vector[i - 1][j][k] + vector[i + 1][j][k] + vector[i][j][k - 1] + vector[i][j][k + 1]);<span class="comment">//2D smooth in XZ dimension</span></div>
<div class="line"><span class="lineno"> 2515</span>          }</div>
<div class="line"><span class="lineno"> 2516</span>              <span class="comment">//temp[i][j][k] = alpha * vector[i][j][k] + beta2D * (vector[i - 1][j][k] + vector[i + 1][j][k] + vector[i][j-1][k] + vector[i][j+1][k]);//2D smooth in XY dimension</span></div>
<div class="line"><span class="lineno"> 2517</span> </div>
<div class="line"><span class="lineno"> 2518</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; nx - 1; i++)</div>
<div class="line"><span class="lineno"> 2519</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; ny - 1; j++)</div>
<div class="line"><span class="lineno"> 2520</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; nz - 1; k++)</div>
<div class="line"><span class="lineno"> 2521</span>            vector[i][j][k] = temp[i][j][k];</div>
<div class="line"><span class="lineno"> 2522</span> </div>
<div class="line"><span class="lineno"> 2523</span>  }</div>
<div class="line"><span class="lineno"> 2524</span>  delArr3(temp, nx, ny);</div>
<div class="line"><span class="lineno"> 2525</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00353">Smooth</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>.</p>

</div>
</div>
<a id="af10bd0fe5aee301cee0cb9491df8f292" name="af10bd0fe5aee301cee0cb9491df8f292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af10bd0fe5aee301cee0cb9491df8f292">&#9670;&nbsp;</a></span>smoothE()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::smoothE </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >smooth the electric field </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02529">2529</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2530</span>{</div>
<div class="line"><span class="lineno"> 2531</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a>==1.0) <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2532</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../db/dfb/class_collective.html">Collective</a> *col = &amp;get_col();</div>
<div class="line"><span class="lineno"> 2533</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a> *vct = &amp;get_vct();</div>
<div class="line"><span class="lineno"> 2534</span> </div>
<div class="line"><span class="lineno"> 2535</span>  <span class="keywordtype">double</span> alpha   = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e00cd79434a2bc1f9eccfa33284768d">Smooth</a>;</div>
<div class="line"><span class="lineno"> 2536</span>  <span class="keywordtype">double</span> beta3D  = (1-alpha)/6.0;</div>
<div class="line"><span class="lineno"> 2537</span>  <span class="keywordtype">double</span> beta2D  = (1-alpha)/4.0;</div>
<div class="line"><span class="lineno"> 2538</span> </div>
<div class="line"><span class="lineno"> 2539</span>  <span class="keywordtype">double</span> ***temp = newArr3(<span class="keywordtype">double</span>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 2540</span> </div>
<div class="line"><span class="lineno"> 2541</span>  <span class="keywordflow">if</span> (col-&gt;getVerbose() and vct-&gt;getCartesian_rank() == 0)</div>
<div class="line"><span class="lineno"> 2542</span>    cout &lt;&lt; <span class="stringliteral">&quot;*** smoothE &quot;</span>&lt;&lt; SmoothNiter &lt;&lt;<span class="stringliteral">&quot; times, strength (in range 0-1) = &quot;</span>&lt;&lt; 1.-alpha &lt;&lt;<span class="stringliteral">&quot; ***&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno"> 2543</span> </div>
<div class="line"><span class="lineno"> 2544</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> icount = 1; icount &lt; SmoothNiter + 1; icount++) {</div>
<div class="line"><span class="lineno"> 2545</span>      communicateNodeBoxStencilBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ex, col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[0],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[1],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[2],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[3],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[4],col-&gt;<a class="code hl_variable" href="../../db/dfb/class_collective.html#a49752e6fdd19b493adc0bb3034bf4570">bcEx</a>[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2546</span>      communicateNodeBoxStencilBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ey, col-&gt;bcEy[0],col-&gt;bcEy[1],col-&gt;bcEy[2],col-&gt;bcEy[3],col-&gt;bcEy[4],col-&gt;bcEy[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2547</span>      communicateNodeBoxStencilBC(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>, Ez, col-&gt;bcEz[0],col-&gt;bcEz[1],col-&gt;bcEz[2],col-&gt;bcEz[3],col-&gt;bcEz[4],col-&gt;bcEz[5], vct, <span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2548</span> </div>
<div class="line"><span class="lineno"> 2549</span>      <span class="comment">// Exth</span></div>
<div class="line"><span class="lineno"> 2550</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2551</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2552</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++){</div>
<div class="line"><span class="lineno"> 2553</span>              <span class="keywordflow">if</span> ( <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>&gt;1 )</div>
<div class="line"><span class="lineno"> 2554</span>                temp[i][j][k] = alpha * Ex[i][j][k] + beta3D * (Ex[i - 1][j][k] + Ex[i + 1][j][k] + Ex[i][j - 1][k] + Ex[i][j + 1][k] + Ex[i][j][k - 1] + Ex[i][j][k + 1]);</div>
<div class="line"><span class="lineno"> 2555</span>              <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2556</span>              temp[i][j][k] = alpha * Ex[i][j][k] + beta2D * (Ex[i - 1][j][k] + Ex[i + 1][j][k] + Ex[i][j][k - 1] + Ex[i][j][k + 1]);<span class="comment">//2D smooth in XZ dimension</span></div>
<div class="line"><span class="lineno"> 2557</span>              <span class="comment">//temp[i][j][k] = alpha * Ex[i][j][k] + beta2D * (Ex[i - 1][j][k] + Ex[i + 1][j][k] + Ex[i][j-1][k] + Ex[i][j+1][k]);//2D smooth in XY dimension</span></div>
<div class="line"><span class="lineno"> 2558</span>          }</div>
<div class="line"><span class="lineno"> 2559</span> </div>
<div class="line"><span class="lineno"> 2560</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2561</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2562</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++)</div>
<div class="line"><span class="lineno"> 2563</span>            Ex[i][j][k] = temp[i][j][k];</div>
<div class="line"><span class="lineno"> 2564</span> </div>
<div class="line"><span class="lineno"> 2565</span>      <span class="comment">// Eyth</span></div>
<div class="line"><span class="lineno"> 2566</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2567</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2568</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++){</div>
<div class="line"><span class="lineno"> 2569</span>                 <span class="keywordflow">if</span> ( <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>&gt;1 )</div>
<div class="line"><span class="lineno"> 2570</span>                   temp[i][j][k] = alpha * Ey[i][j][k] + beta3D * (Ey[i - 1][j][k] + Ey[i + 1][j][k] + Ey[i][j - 1][k] + Ey[i][j + 1][k] + Ey[i][j][k - 1] + Ey[i][j][k + 1]);</div>
<div class="line"><span class="lineno"> 2571</span>                 <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2572</span>                   temp[i][j][k] = alpha * Ey[i][j][k] + beta2D * (Ey[i - 1][j][k] + Ey[i + 1][j][k] + Ey[i][j][k - 1] + Ey[i][j][k + 1]);<span class="comment">//2D smooth in XZ dimension</span></div>
<div class="line"><span class="lineno"> 2573</span>                   <span class="comment">//temp[i][j][k] = alpha * Ey[i][j][k] + beta2D * (Ey[i - 1][j][k] + Ey[i + 1][j][k] + Ey[i][j-1][k]   + Ey[i][j+1][k]);//2D smooth in XY dimension</span></div>
<div class="line"><span class="lineno"> 2574</span>          }</div>
<div class="line"><span class="lineno"> 2575</span> </div>
<div class="line"><span class="lineno"> 2576</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2577</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2578</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++)</div>
<div class="line"><span class="lineno"> 2579</span>            Ey[i][j][k] = temp[i][j][k];</div>
<div class="line"><span class="lineno"> 2580</span> </div>
<div class="line"><span class="lineno"> 2581</span>      <span class="comment">// Ezth</span></div>
<div class="line"><span class="lineno"> 2582</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2583</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2584</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++){</div>
<div class="line"><span class="lineno"> 2585</span>             <span class="keywordflow">if</span> ( <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>&gt;1 )</div>
<div class="line"><span class="lineno"> 2586</span>               temp[i][j][k] = alpha * Ez[i][j][k] + beta3D * (Ez[i - 1][j][k] + Ez[i + 1][j][k] + Ez[i][j - 1][k] + Ez[i][j + 1][k] + Ez[i][j][k - 1] + Ez[i][j][k + 1]);</div>
<div class="line"><span class="lineno"> 2587</span>             <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2588</span>               temp[i][j][k] = alpha * Ez[i][j][k] + beta2D * (Ez[i - 1][j][k] + Ez[i + 1][j][k] + Ez[i][j][k - 1] + Ez[i][j][k + 1]);<span class="comment">//2D smooth in XZ dimension</span></div>
<div class="line"><span class="lineno"> 2589</span>               <span class="comment">//temp[i][j][k] = alpha * Ez[i][j][k] + beta2D * (Ez[i - 1][j][k] + Ez[i + 1][j][k] + Ez[i][j-1][k]   + Ez[i][j+1][k]);//2D smooth in XY dimension</span></div>
<div class="line"><span class="lineno"> 2590</span>          }</div>
<div class="line"><span class="lineno"> 2591</span> </div>
<div class="line"><span class="lineno"> 2592</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 1; i++)</div>
<div class="line"><span class="lineno"> 2593</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 1; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 1; j++)</div>
<div class="line"><span class="lineno"> 2594</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 1; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 1; k++)</div>
<div class="line"><span class="lineno"> 2595</span>            Ez[i][j][k] = temp[i][j][k];</div>
<div class="line"><span class="lineno"> 2596</span> </div>
<div class="line"><span class="lineno"> 2597</span>  }</div>
<div class="line"><span class="lineno"> 2598</span>  delArr3(temp, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>, <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>);</div>
<div class="line"><span class="lineno"> 2599</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d51/_collective_8h_source.html#l00207">Collective::bcEx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00353">Smooth</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>.</p>

</div>
</div>
<a id="a995bc41931c5380945e9cb6a3b04c16a" name="a995bc41931c5380945e9cb6a3b04c16a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a995bc41931c5380945e9cb6a3b04c16a">&#9670;&nbsp;</a></span>sumMoments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sumMoments </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *&#160;</td>
          <td class="paramname"><em>part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >sum moments (interp_P2G) versions </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">607</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  608</span>{</div>
<div class="line"><span class="lineno">  609</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dx = 1.0 / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>;</div>
<div class="line"><span class="lineno">  612</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dy = 1.0 / dy;</div>
<div class="line"><span class="lineno">  613</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dz = 1.0 / dz;</div>
<div class="line"><span class="lineno">  614</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> = grid-&gt;getNXN();</div>
<div class="line"><span class="lineno">  615</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> = grid-&gt;getNYN();</div>
<div class="line"><span class="lineno">  616</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> = grid-&gt;getNZN();</div>
<div class="line"><span class="lineno">  617</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> xstart = grid-&gt;getXstart();</div>
<div class="line"><span class="lineno">  618</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ystart = grid-&gt;getYstart();</div>
<div class="line"><span class="lineno">  619</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> zstart = grid-&gt;getZstart();</div>
<div class="line"><span class="lineno">  620</span>  <span class="comment">// To make memory use scale to a large number of threads, we</span></div>
<div class="line"><span class="lineno">  621</span>  <span class="comment">// could first apply an efficient parallel sorting algorithm</span></div>
<div class="line"><span class="lineno">  622</span>  <span class="comment">// to the particles and then accumulate moments in smaller</span></div>
<div class="line"><span class="lineno">  623</span>  <span class="comment">// subarrays.</span></div>
<div class="line"><span class="lineno">  624</span>  <span class="comment">//#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  625</span><span class="preprocessor">  #pragma omp parallel</span></div>
<div class="line"><span class="lineno">  626</span>  {</div>
<div class="line"><span class="lineno">  627</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++)</div>
<div class="line"><span class="lineno">  628</span>  {</div>
<div class="line"><span class="lineno">  629</span>    <span class="keyword">const</span> <a class="code hl_class" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a>&amp; pcls = part[i];</div>
<div class="line"><span class="lineno">  630</span>    assert_eq(pcls.get_particleType(), ParticleType::SoA);</div>
<div class="line"><span class="lineno">  631</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> is = pcls.get_species_num();</div>
<div class="line"><span class="lineno">  632</span>    assert_eq(i,is);</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> x = pcls.getXall();</div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> y = pcls.getYall();</div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> z = pcls.getZall();</div>
<div class="line"><span class="lineno">  637</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> u = pcls.getUall();</div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> v = pcls.getVall();</div>
<div class="line"><span class="lineno">  639</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> w = pcls.getWall();</div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> q = pcls.getQall();</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> nop = pcls.getNOP();</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>    <span class="keywordtype">int</span> thread_num = omp_get_thread_num();</div>
<div class="line"><span class="lineno">  645</span>    </div>
<div class="line"><span class="lineno">  646</span>    <a class="code hl_class" href="../../d1/d1c/class_moments10.html">Moments10</a>&amp; speciesMoments10 = <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a497e6c49c5f051a364eb1c0972e215df">fetch_moments10Array</a>(thread_num);</div>
<div class="line"><span class="lineno">  647</span>    <a class="code hl_class" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> moments = speciesMoments10.fetch_arr();</div>
<div class="line"><span class="lineno">  648</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  649</span>    <span class="comment">// moments.setmode(ompmode::mine);</span></div>
<div class="line"><span class="lineno">  650</span>    <span class="comment">// moments.setall(0.);</span></div>
<div class="line"><span class="lineno">  651</span>    <span class="comment">// </span></div>
<div class="line"><span class="lineno">  652</span>    <span class="keywordtype">double</span> *moments1d = &amp;moments[0][0][0][0];</div>
<div class="line"><span class="lineno">  653</span>    <span class="keywordtype">int</span> moments1dsize = moments.get_size();</div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;moments1dsize; i++) moments1d[i]=0;</div>
<div class="line"><span class="lineno">  655</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  656</span>    <span class="comment">// This barrier is not needed</span></div>
<div class="line"><span class="lineno">  657</span><span class="preprocessor">    #pragma omp barrier</span></div>
<div class="line"><span class="lineno">  658</span>    <span class="comment">// The following loop is expensive, so it is wise to assume that the</span></div>
<div class="line"><span class="lineno">  659</span>    <span class="comment">// compiler is stupid.  Therefore we should on the one hand</span></div>
<div class="line"><span class="lineno">  660</span>    <span class="comment">// expand things out and on the other hand avoid repeating computations.</span></div>
<div class="line"><span class="lineno">  661</span><span class="preprocessor">    #pragma omp for </span><span class="comment">// used nowait with the old way</span></div>
<div class="line"><span class="lineno">  662</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nop; i++)</div>
<div class="line"><span class="lineno">  663</span>    {</div>
<div class="line"><span class="lineno">  664</span>      <span class="comment">// compute the quadratic moments of velocity</span></div>
<div class="line"><span class="lineno">  665</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  666</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> ui=u[i];</div>
<div class="line"><span class="lineno">  667</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vi=v[i];</div>
<div class="line"><span class="lineno">  668</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> wi=w[i];</div>
<div class="line"><span class="lineno">  669</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> uui=ui*ui;</div>
<div class="line"><span class="lineno">  670</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> uvi=ui*vi;</div>
<div class="line"><span class="lineno">  671</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> uwi=ui*wi;</div>
<div class="line"><span class="lineno">  672</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vvi=vi*vi;</div>
<div class="line"><span class="lineno">  673</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vwi=vi*wi;</div>
<div class="line"><span class="lineno">  674</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> wwi=wi*wi;</div>
<div class="line"><span class="lineno">  675</span>      <span class="keywordtype">double</span> velmoments[10];</div>
<div class="line"><span class="lineno">  676</span>      velmoments[0] = 1.;</div>
<div class="line"><span class="lineno">  677</span>      velmoments[1] = ui;</div>
<div class="line"><span class="lineno">  678</span>      velmoments[2] = vi;</div>
<div class="line"><span class="lineno">  679</span>      velmoments[3] = wi;</div>
<div class="line"><span class="lineno">  680</span>      velmoments[4] = uui;</div>
<div class="line"><span class="lineno">  681</span>      velmoments[5] = uvi;</div>
<div class="line"><span class="lineno">  682</span>      velmoments[6] = uwi;</div>
<div class="line"><span class="lineno">  683</span>      velmoments[7] = vvi;</div>
<div class="line"><span class="lineno">  684</span>      velmoments[8] = vwi;</div>
<div class="line"><span class="lineno">  685</span>      velmoments[9] = wwi;</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  688</span>      <span class="comment">// compute the weights to distribute the moments</span></div>
<div class="line"><span class="lineno">  689</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  690</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> ix = 2 + int (floor((x[i] - xstart) * inv_dx));</div>
<div class="line"><span class="lineno">  691</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> iy = 2 + int (floor((y[i] - ystart) * inv_dy));</div>
<div class="line"><span class="lineno">  692</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> iz = 2 + int (floor((z[i] - zstart) * inv_dz));</div>
<div class="line"><span class="lineno">  693</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> xi0   = x[i] - grid-&gt;getXN(ix-1);</div>
<div class="line"><span class="lineno">  694</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> eta0  = y[i] - grid-&gt;getYN(iy-1);</div>
<div class="line"><span class="lineno">  695</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zeta0 = z[i] - grid-&gt;getZN(iz-1);</div>
<div class="line"><span class="lineno">  696</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> xi1   = grid-&gt;getXN(ix) - x[i];</div>
<div class="line"><span class="lineno">  697</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> eta1  = grid-&gt;getYN(iy) - y[i];</div>
<div class="line"><span class="lineno">  698</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zeta1 = grid-&gt;getZN(iz) - z[i];</div>
<div class="line"><span class="lineno">  699</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> qi = q[i];</div>
<div class="line"><span class="lineno">  700</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> invVOLqi = invVOL*qi;</div>
<div class="line"><span class="lineno">  701</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight0 = invVOLqi * xi0;</div>
<div class="line"><span class="lineno">  702</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight1 = invVOLqi * xi1;</div>
<div class="line"><span class="lineno">  703</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight00 = weight0*eta0;</div>
<div class="line"><span class="lineno">  704</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight01 = weight0*eta1;</div>
<div class="line"><span class="lineno">  705</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight10 = weight1*eta0;</div>
<div class="line"><span class="lineno">  706</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight11 = weight1*eta1;</div>
<div class="line"><span class="lineno">  707</span>      <span class="keywordtype">double</span> weights[8];</div>
<div class="line"><span class="lineno">  708</span>      weights[0] = weight00*zeta0; <span class="comment">// weight000</span></div>
<div class="line"><span class="lineno">  709</span>      weights[1] = weight00*zeta1; <span class="comment">// weight001</span></div>
<div class="line"><span class="lineno">  710</span>      weights[2] = weight01*zeta0; <span class="comment">// weight010</span></div>
<div class="line"><span class="lineno">  711</span>      weights[3] = weight01*zeta1; <span class="comment">// weight011</span></div>
<div class="line"><span class="lineno">  712</span>      weights[4] = weight10*zeta0; <span class="comment">// weight100</span></div>
<div class="line"><span class="lineno">  713</span>      weights[5] = weight10*zeta1; <span class="comment">// weight101</span></div>
<div class="line"><span class="lineno">  714</span>      weights[6] = weight11*zeta0; <span class="comment">// weight110</span></div>
<div class="line"><span class="lineno">  715</span>      weights[7] = weight11*zeta1; <span class="comment">// weight111</span></div>
<div class="line"><span class="lineno">  716</span>      <span class="comment">//weights[0] = xi0 * eta0 * zeta0 * qi * invVOL; // weight000</span></div>
<div class="line"><span class="lineno">  717</span>      <span class="comment">//weights[1] = xi0 * eta0 * zeta1 * qi * invVOL; // weight001</span></div>
<div class="line"><span class="lineno">  718</span>      <span class="comment">//weights[2] = xi0 * eta1 * zeta0 * qi * invVOL; // weight010</span></div>
<div class="line"><span class="lineno">  719</span>      <span class="comment">//weights[3] = xi0 * eta1 * zeta1 * qi * invVOL; // weight011</span></div>
<div class="line"><span class="lineno">  720</span>      <span class="comment">//weights[4] = xi1 * eta0 * zeta0 * qi * invVOL; // weight100</span></div>
<div class="line"><span class="lineno">  721</span>      <span class="comment">//weights[5] = xi1 * eta0 * zeta1 * qi * invVOL; // weight101</span></div>
<div class="line"><span class="lineno">  722</span>      <span class="comment">//weights[6] = xi1 * eta1 * zeta0 * qi * invVOL; // weight110</span></div>
<div class="line"><span class="lineno">  723</span>      <span class="comment">//weights[7] = xi1 * eta1 * zeta1 * qi * invVOL; // weight111</span></div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>      <span class="comment">// add particle to moments</span></div>
<div class="line"><span class="lineno">  726</span>      {</div>
<div class="line"><span class="lineno">  727</span>        arr1_double_fetch momentsArray[8];</div>
<div class="line"><span class="lineno">  728</span>        arr2_double_fetch moments00 = moments[ix  ][iy  ];</div>
<div class="line"><span class="lineno">  729</span>        arr2_double_fetch moments01 = moments[ix  ][iy-1];</div>
<div class="line"><span class="lineno">  730</span>        arr2_double_fetch moments10 = moments[ix-1][iy  ];</div>
<div class="line"><span class="lineno">  731</span>        arr2_double_fetch moments11 = moments[ix-1][iy-1];</div>
<div class="line"><span class="lineno">  732</span>        momentsArray[0] = moments00[iz  ]; <span class="comment">// moments000 </span></div>
<div class="line"><span class="lineno">  733</span>        momentsArray[1] = moments00[iz-1]; <span class="comment">// moments001 </span></div>
<div class="line"><span class="lineno">  734</span>        momentsArray[2] = moments01[iz  ]; <span class="comment">// moments010 </span></div>
<div class="line"><span class="lineno">  735</span>        momentsArray[3] = moments01[iz-1]; <span class="comment">// moments011 </span></div>
<div class="line"><span class="lineno">  736</span>        momentsArray[4] = moments10[iz  ]; <span class="comment">// moments100 </span></div>
<div class="line"><span class="lineno">  737</span>        momentsArray[5] = moments10[iz-1]; <span class="comment">// moments101 </span></div>
<div class="line"><span class="lineno">  738</span>        momentsArray[6] = moments11[iz  ]; <span class="comment">// moments110 </span></div>
<div class="line"><span class="lineno">  739</span>        momentsArray[7] = moments11[iz-1]; <span class="comment">// moments111 </span></div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0; m&lt;10; m++)</div>
<div class="line"><span class="lineno">  742</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>=0; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>&lt;8; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>++)</div>
<div class="line"><span class="lineno">  743</span>        {</div>
<div class="line"><span class="lineno">  744</span>          momentsArray[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m] += velmoments[m]*weights[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>];</div>
<div class="line"><span class="lineno">  745</span>        }</div>
<div class="line"><span class="lineno">  746</span>      }</div>
<div class="line"><span class="lineno">  747</span>    }</div>
<div class="line"><span class="lineno">  748</span>    </div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>    <span class="comment">// reduction</span></div>
<div class="line"><span class="lineno">  751</span>    </div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>    <span class="comment">// reduce moments in parallel</span></div>
<div class="line"><span class="lineno">  754</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  755</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> thread_num=0;thread_num&lt;get_sizeMomentsArray();thread_num++)</div>
<div class="line"><span class="lineno">  756</span>    {</div>
<div class="line"><span class="lineno">  757</span>      <a class="code hl_class" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> moments = <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a497e6c49c5f051a364eb1c0972e215df">fetch_moments10Array</a>(thread_num).fetch_arr();</div>
<div class="line"><span class="lineno">  758</span><span class="preprocessor">      #pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno">  759</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++)</div>
<div class="line"><span class="lineno">  760</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++)</div>
<div class="line"><span class="lineno">  761</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  762</span>      {</div>
<div class="line"><span class="lineno">  763</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] += invVOL*moments[i][j][k][0];</div>
<div class="line"><span class="lineno">  764</span>        Jxs  [is][i][j][k] += invVOL*moments[i][j][k][1];</div>
<div class="line"><span class="lineno">  765</span>        Jys  [is][i][j][k] += invVOL*moments[i][j][k][2];</div>
<div class="line"><span class="lineno">  766</span>        Jzs  [is][i][j][k] += invVOL*moments[i][j][k][3];</div>
<div class="line"><span class="lineno">  767</span>        pXXsn[is][i][j][k] += invVOL*moments[i][j][k][4];</div>
<div class="line"><span class="lineno">  768</span>        pXYsn[is][i][j][k] += invVOL*moments[i][j][k][5];</div>
<div class="line"><span class="lineno">  769</span>        pXZsn[is][i][j][k] += invVOL*moments[i][j][k][6];</div>
<div class="line"><span class="lineno">  770</span>        pYYsn[is][i][j][k] += invVOL*moments[i][j][k][7];</div>
<div class="line"><span class="lineno">  771</span>        pYZsn[is][i][j][k] += invVOL*moments[i][j][k][8];</div>
<div class="line"><span class="lineno">  772</span>        pZZsn[is][i][j][k] += invVOL*moments[i][j][k][9];</div>
<div class="line"><span class="lineno">  773</span>      }</div>
<div class="line"><span class="lineno">  774</span>    }</div>
<div class="line"><span class="lineno">  775</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  776</span>    <span class="comment">// This was the old way of reducing;</span></div>
<div class="line"><span class="lineno">  777</span>    <span class="comment">// did not scale well to large number of threads</span></div>
<div class="line"><span class="lineno">  778</span>    <span class="comment">//{</span></div>
<div class="line"><span class="lineno">  779</span>    <span class="comment">//  #pragma omp critical (reduceMoment0)</span></div>
<div class="line"><span class="lineno">  780</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  781</span>    <span class="comment">//    { rhons[is][i][j][k] += invVOL*moments[i][j][k][0]; }}</span></div>
<div class="line"><span class="lineno">  782</span>    <span class="comment">//  #pragma omp critical (reduceMoment1)</span></div>
<div class="line"><span class="lineno">  783</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  784</span>    <span class="comment">//    { Jxs  [is][i][j][k] += invVOL*moments[i][j][k][1]; }}</span></div>
<div class="line"><span class="lineno">  785</span>    <span class="comment">//  #pragma omp critical (reduceMoment2)</span></div>
<div class="line"><span class="lineno">  786</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  787</span>    <span class="comment">//    { Jys  [is][i][j][k] += invVOL*moments[i][j][k][2]; }}</span></div>
<div class="line"><span class="lineno">  788</span>    <span class="comment">//  #pragma omp critical (reduceMoment3)</span></div>
<div class="line"><span class="lineno">  789</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  790</span>    <span class="comment">//    { Jzs  [is][i][j][k] += invVOL*moments[i][j][k][3]; }}</span></div>
<div class="line"><span class="lineno">  791</span>    <span class="comment">//  #pragma omp critical (reduceMoment4)</span></div>
<div class="line"><span class="lineno">  792</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  793</span>    <span class="comment">//    { pXXsn[is][i][j][k] += invVOL*moments[i][j][k][4]; }}</span></div>
<div class="line"><span class="lineno">  794</span>    <span class="comment">//  #pragma omp critical (reduceMoment5)</span></div>
<div class="line"><span class="lineno">  795</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  796</span>    <span class="comment">//    { pXYsn[is][i][j][k] += invVOL*moments[i][j][k][5]; }}</span></div>
<div class="line"><span class="lineno">  797</span>    <span class="comment">//  #pragma omp critical (reduceMoment6)</span></div>
<div class="line"><span class="lineno">  798</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  799</span>    <span class="comment">//    { pXZsn[is][i][j][k] += invVOL*moments[i][j][k][6]; }}</span></div>
<div class="line"><span class="lineno">  800</span>    <span class="comment">//  #pragma omp critical (reduceMoment7)</span></div>
<div class="line"><span class="lineno">  801</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  802</span>    <span class="comment">//    { pYYsn[is][i][j][k] += invVOL*moments[i][j][k][7]; }}</span></div>
<div class="line"><span class="lineno">  803</span>    <span class="comment">//  #pragma omp critical (reduceMoment8)</span></div>
<div class="line"><span class="lineno">  804</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  805</span>    <span class="comment">//    { pYZsn[is][i][j][k] += invVOL*moments[i][j][k][8]; }}</span></div>
<div class="line"><span class="lineno">  806</span>    <span class="comment">//  #pragma omp critical (reduceMoment9)</span></div>
<div class="line"><span class="lineno">  807</span>    <span class="comment">//  for(int i=0;i&lt;nxn;i++){for(int j=0;j&lt;nyn;j++) for(int k=0;k&lt;nzn;k++)</span></div>
<div class="line"><span class="lineno">  808</span>    <span class="comment">//    { pZZsn[is][i][j][k] += invVOL*moments[i][j][k][9]; }}</span></div>
<div class="line"><span class="lineno">  809</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  810</span>    </div>
<div class="line"><span class="lineno">  811</span>    <span class="comment">// uncomment this and remove the loop below</span></div>
<div class="line"><span class="lineno">  812</span>    <span class="comment">// when we change to use asynchronous communication.</span></div>
<div class="line"><span class="lineno">  813</span>    <span class="comment">// communicateGhostP2G(is, vct);</span></div>
<div class="line"><span class="lineno">  814</span>  }</div>
<div class="line"><span class="lineno">  815</span>  }</div>
<div class="line"><span class="lineno">  816</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++)</div>
<div class="line"><span class="lineno">  817</span>  {</div>
<div class="line"><span class="lineno">  818</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a9f7cfc31e795a75ecaad608f6cb8df25">communicateGhostP2G</a>(i);</div>
<div class="line"><span class="lineno">  819</span>  }</div>
<div class="line"><span class="lineno">  820</span>}</div>
<div class="ttc" id="aclass_e_mfields3_d_html_a497e6c49c5f051a364eb1c0972e215df"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a497e6c49c5f051a364eb1c0972e215df">EMfields3D::fetch_moments10Array</a></div><div class="ttdeci">Moments10 &amp; fetch_moments10Array(int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00296">EMfields3D.h:296</a></div></div>
<div class="ttc" id="aclass_e_mfields3_d_html_a9f7cfc31e795a75ecaad608f6cb8df25"><div class="ttname"><a href="../../dd/da6/class_e_mfields3_d.html#a9f7cfc31e795a75ecaad608f6cb8df25">EMfields3D::communicateGhostP2G</a></div><div class="ttdeci">void communicateGhostP2G(int ns)</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03344">EMfields3D.cpp:3344</a></div></div>
<div class="ttc" id="aclass_particles3_dcomm_html"><div class="ttname"><a href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a></div><div class="ttdoc">class for particles of the same species with communications methods</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d96/_particles3_dcomm_8h_source.html#l00059">Particles3Dcomm.h:60</a></div></div>
<div class="ttc" id="aclassi_pic3_d_1_1array__ref4_html"><div class="ttname"><a href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">iPic3D::array_ref4&lt; double &gt;</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03344">communicateGhostP2G()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">dx</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00296">fetch_moments10Array()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="a5cdf1200df3db2a29bd876c9d7e33ea7" name="a5cdf1200df3db2a29bd876c9d7e33ea7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cdf1200df3db2a29bd876c9d7e33ea7">&#9670;&nbsp;</a></span>sumMoments_AoS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sumMoments_AoS </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *&#160;</td>
          <td class="paramname"><em>part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00822">822</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  823</span>{</div>
<div class="line"><span class="lineno">  824</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dx = 1.0 / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>;</div>
<div class="line"><span class="lineno">  827</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dy = 1.0 / dy;</div>
<div class="line"><span class="lineno">  828</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dz = 1.0 / dz;</div>
<div class="line"><span class="lineno">  829</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> = grid-&gt;getNXN();</div>
<div class="line"><span class="lineno">  830</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> = grid-&gt;getNYN();</div>
<div class="line"><span class="lineno">  831</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> = grid-&gt;getNZN();</div>
<div class="line"><span class="lineno">  832</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> xstart = grid-&gt;getXstart();</div>
<div class="line"><span class="lineno">  833</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ystart = grid-&gt;getYstart();</div>
<div class="line"><span class="lineno">  834</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> zstart = grid-&gt;getZstart();</div>
<div class="line"><span class="lineno">  835</span>  <span class="comment">// To make memory use scale to a large number of threads, we</span></div>
<div class="line"><span class="lineno">  836</span>  <span class="comment">// could first apply an efficient parallel sorting algorithm</span></div>
<div class="line"><span class="lineno">  837</span>  <span class="comment">// to the particles and then accumulate moments in smaller</span></div>
<div class="line"><span class="lineno">  838</span>  <span class="comment">// subarrays.</span></div>
<div class="line"><span class="lineno">  839</span>  <span class="comment">//#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  840</span><span class="preprocessor">  #pragma omp parallel</span></div>
<div class="line"><span class="lineno">  841</span>  {</div>
<div class="line"><span class="lineno">  842</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> species_idx = 0; species_idx &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; species_idx++)</div>
<div class="line"><span class="lineno">  843</span>  {</div>
<div class="line"><span class="lineno">  844</span>    <span class="keyword">const</span> <a class="code hl_class" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a>&amp; pcls = part[species_idx];</div>
<div class="line"><span class="lineno">  845</span>    assert_eq(pcls.get_particleType(), ParticleType::AoS);</div>
<div class="line"><span class="lineno">  846</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> is = pcls.get_species_num();</div>
<div class="line"><span class="lineno">  847</span>    assert_eq(species_idx,is);</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> nop = pcls.getNOP();</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordtype">int</span> thread_num = omp_get_thread_num();</div>
<div class="line"><span class="lineno">  852</span>    <a class="code hl_class" href="../../d1/d1c/class_moments10.html">Moments10</a>&amp; speciesMoments10 = <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a497e6c49c5f051a364eb1c0972e215df">fetch_moments10Array</a>(thread_num);</div>
<div class="line"><span class="lineno">  853</span>    <a class="code hl_class" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> moments = speciesMoments10.fetch_arr();</div>
<div class="line"><span class="lineno">  854</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  855</span>    <span class="comment">// moments.setmode(ompmode::mine);</span></div>
<div class="line"><span class="lineno">  856</span>    <span class="comment">// moments.setall(0.);</span></div>
<div class="line"><span class="lineno">  857</span>    <span class="comment">// </span></div>
<div class="line"><span class="lineno">  858</span>    <span class="keywordtype">double</span> *moments1d = &amp;moments[0][0][0][0];</div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordtype">int</span> moments1dsize = moments.get_size();</div>
<div class="line"><span class="lineno">  860</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;moments1dsize; i++) moments1d[i]=0;</div>
<div class="line"><span class="lineno">  861</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  862</span><span class="preprocessor">    #pragma omp barrier</span></div>
<div class="line"><span class="lineno">  863</span><span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><span class="lineno">  864</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pidx = 0; pidx &lt; nop; pidx++)</div>
<div class="line"><span class="lineno">  865</span>    {</div>
<div class="line"><span class="lineno">  866</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../d8/d2e/class_species_particle.html">SpeciesParticle</a>&amp; pcl = pcls.get_pcl(pidx);</div>
<div class="line"><span class="lineno">  867</span>      <span class="comment">// compute the quadratic moments of velocity</span></div>
<div class="line"><span class="lineno">  868</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  869</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> ui=pcl.get_u();</div>
<div class="line"><span class="lineno">  870</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vi=pcl.get_v();</div>
<div class="line"><span class="lineno">  871</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> wi=pcl.get_w();</div>
<div class="line"><span class="lineno">  872</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> uui=ui*ui;</div>
<div class="line"><span class="lineno">  873</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> uvi=ui*vi;</div>
<div class="line"><span class="lineno">  874</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> uwi=ui*wi;</div>
<div class="line"><span class="lineno">  875</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vvi=vi*vi;</div>
<div class="line"><span class="lineno">  876</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vwi=vi*wi;</div>
<div class="line"><span class="lineno">  877</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> wwi=wi*wi;</div>
<div class="line"><span class="lineno">  878</span>      <span class="keywordtype">double</span> velmoments[10];</div>
<div class="line"><span class="lineno">  879</span>      velmoments[0] = 1.;</div>
<div class="line"><span class="lineno">  880</span>      velmoments[1] = ui;</div>
<div class="line"><span class="lineno">  881</span>      velmoments[2] = vi;</div>
<div class="line"><span class="lineno">  882</span>      velmoments[3] = wi;</div>
<div class="line"><span class="lineno">  883</span>      velmoments[4] = uui;</div>
<div class="line"><span class="lineno">  884</span>      velmoments[5] = uvi;</div>
<div class="line"><span class="lineno">  885</span>      velmoments[6] = uwi;</div>
<div class="line"><span class="lineno">  886</span>      velmoments[7] = vvi;</div>
<div class="line"><span class="lineno">  887</span>      velmoments[8] = vwi;</div>
<div class="line"><span class="lineno">  888</span>      velmoments[9] = wwi;</div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  891</span>      <span class="comment">// compute the weights to distribute the moments</span></div>
<div class="line"><span class="lineno">  892</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  893</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> ix = 2 + int (floor((pcl.get_x() - xstart) * inv_dx));</div>
<div class="line"><span class="lineno">  894</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> iy = 2 + int (floor((pcl.get_y() - ystart) * inv_dy));</div>
<div class="line"><span class="lineno">  895</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> iz = 2 + int (floor((pcl.get_z() - zstart) * inv_dz));</div>
<div class="line"><span class="lineno">  896</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> xi0   = pcl.get_x() - grid-&gt;getXN(ix-1);</div>
<div class="line"><span class="lineno">  897</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> eta0  = pcl.get_y() - grid-&gt;getYN(iy-1);</div>
<div class="line"><span class="lineno">  898</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zeta0 = pcl.get_z() - grid-&gt;getZN(iz-1);</div>
<div class="line"><span class="lineno">  899</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> xi1   = grid-&gt;getXN(ix) - pcl.get_x();</div>
<div class="line"><span class="lineno">  900</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> eta1  = grid-&gt;getYN(iy) - pcl.get_y();</div>
<div class="line"><span class="lineno">  901</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zeta1 = grid-&gt;getZN(iz) - pcl.get_z();</div>
<div class="line"><span class="lineno">  902</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> qi = pcl.get_q();</div>
<div class="line"><span class="lineno">  903</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> invVOLqi = invVOL*qi;</div>
<div class="line"><span class="lineno">  904</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight0 = invVOLqi * xi0;</div>
<div class="line"><span class="lineno">  905</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight1 = invVOLqi * xi1;</div>
<div class="line"><span class="lineno">  906</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight00 = weight0*eta0;</div>
<div class="line"><span class="lineno">  907</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight01 = weight0*eta1;</div>
<div class="line"><span class="lineno">  908</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight10 = weight1*eta0;</div>
<div class="line"><span class="lineno">  909</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight11 = weight1*eta1;</div>
<div class="line"><span class="lineno">  910</span>      <span class="keywordtype">double</span> weights[8];</div>
<div class="line"><span class="lineno">  911</span>      weights[0] = weight00*zeta0; <span class="comment">// weight000</span></div>
<div class="line"><span class="lineno">  912</span>      weights[1] = weight00*zeta1; <span class="comment">// weight001</span></div>
<div class="line"><span class="lineno">  913</span>      weights[2] = weight01*zeta0; <span class="comment">// weight010</span></div>
<div class="line"><span class="lineno">  914</span>      weights[3] = weight01*zeta1; <span class="comment">// weight011</span></div>
<div class="line"><span class="lineno">  915</span>      weights[4] = weight10*zeta0; <span class="comment">// weight100</span></div>
<div class="line"><span class="lineno">  916</span>      weights[5] = weight10*zeta1; <span class="comment">// weight101</span></div>
<div class="line"><span class="lineno">  917</span>      weights[6] = weight11*zeta0; <span class="comment">// weight110</span></div>
<div class="line"><span class="lineno">  918</span>      weights[7] = weight11*zeta1; <span class="comment">// weight111</span></div>
<div class="line"><span class="lineno">  919</span>      <span class="comment">//weights[0] = xi0 * eta0 * zeta0 * qi * invVOL; // weight000</span></div>
<div class="line"><span class="lineno">  920</span>      <span class="comment">//weights[1] = xi0 * eta0 * zeta1 * qi * invVOL; // weight001</span></div>
<div class="line"><span class="lineno">  921</span>      <span class="comment">//weights[2] = xi0 * eta1 * zeta0 * qi * invVOL; // weight010</span></div>
<div class="line"><span class="lineno">  922</span>      <span class="comment">//weights[3] = xi0 * eta1 * zeta1 * qi * invVOL; // weight011</span></div>
<div class="line"><span class="lineno">  923</span>      <span class="comment">//weights[4] = xi1 * eta0 * zeta0 * qi * invVOL; // weight100</span></div>
<div class="line"><span class="lineno">  924</span>      <span class="comment">//weights[5] = xi1 * eta0 * zeta1 * qi * invVOL; // weight101</span></div>
<div class="line"><span class="lineno">  925</span>      <span class="comment">//weights[6] = xi1 * eta1 * zeta0 * qi * invVOL; // weight110</span></div>
<div class="line"><span class="lineno">  926</span>      <span class="comment">//weights[7] = xi1 * eta1 * zeta1 * qi * invVOL; // weight111</span></div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span>      <span class="comment">// add particle to moments</span></div>
<div class="line"><span class="lineno">  929</span>      {</div>
<div class="line"><span class="lineno">  930</span>        arr1_double_fetch momentsArray[8];</div>
<div class="line"><span class="lineno">  931</span>        arr2_double_fetch moments00 = moments[ix  ][iy  ];</div>
<div class="line"><span class="lineno">  932</span>        arr2_double_fetch moments01 = moments[ix  ][iy-1];</div>
<div class="line"><span class="lineno">  933</span>        arr2_double_fetch moments10 = moments[ix-1][iy  ];</div>
<div class="line"><span class="lineno">  934</span>        arr2_double_fetch moments11 = moments[ix-1][iy-1];</div>
<div class="line"><span class="lineno">  935</span>        momentsArray[0] = moments00[iz  ]; <span class="comment">// moments000 </span></div>
<div class="line"><span class="lineno">  936</span>        momentsArray[1] = moments00[iz-1]; <span class="comment">// moments001 </span></div>
<div class="line"><span class="lineno">  937</span>        momentsArray[2] = moments01[iz  ]; <span class="comment">// moments010 </span></div>
<div class="line"><span class="lineno">  938</span>        momentsArray[3] = moments01[iz-1]; <span class="comment">// moments011 </span></div>
<div class="line"><span class="lineno">  939</span>        momentsArray[4] = moments10[iz  ]; <span class="comment">// moments100 </span></div>
<div class="line"><span class="lineno">  940</span>        momentsArray[5] = moments10[iz-1]; <span class="comment">// moments101 </span></div>
<div class="line"><span class="lineno">  941</span>        momentsArray[6] = moments11[iz  ]; <span class="comment">// moments110 </span></div>
<div class="line"><span class="lineno">  942</span>        momentsArray[7] = moments11[iz-1]; <span class="comment">// moments111 </span></div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0; m&lt;10; m++)</div>
<div class="line"><span class="lineno">  945</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>=0; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>&lt;8; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>++)</div>
<div class="line"><span class="lineno">  946</span>        {</div>
<div class="line"><span class="lineno">  947</span>          momentsArray[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m] += velmoments[m]*weights[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>];</div>
<div class="line"><span class="lineno">  948</span>        }</div>
<div class="line"><span class="lineno">  949</span>      }</div>
<div class="line"><span class="lineno">  950</span>    }</div>
<div class="line"><span class="lineno">  951</span>   </div>
<div class="line"><span class="lineno">  952</span> </div>
<div class="line"><span class="lineno">  953</span>    <span class="comment">// reduction</span></div>
<div class="line"><span class="lineno">  954</span>   </div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>    <span class="comment">// reduce moments in parallel</span></div>
<div class="line"><span class="lineno">  957</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  958</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> thread_num=0;thread_num&lt;get_sizeMomentsArray();thread_num++)</div>
<div class="line"><span class="lineno">  959</span>    {</div>
<div class="line"><span class="lineno">  960</span>      <a class="code hl_class" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> moments = <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a497e6c49c5f051a364eb1c0972e215df">fetch_moments10Array</a>(thread_num).fetch_arr();</div>
<div class="line"><span class="lineno">  961</span><span class="preprocessor">      #pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno">  962</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++)</div>
<div class="line"><span class="lineno">  963</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++)</div>
<div class="line"><span class="lineno">  964</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  965</span>      {</div>
<div class="line"><span class="lineno">  966</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] += invVOL*moments[i][j][k][0];</div>
<div class="line"><span class="lineno">  967</span>        Jxs  [is][i][j][k] += invVOL*moments[i][j][k][1];</div>
<div class="line"><span class="lineno">  968</span>        Jys  [is][i][j][k] += invVOL*moments[i][j][k][2];</div>
<div class="line"><span class="lineno">  969</span>        Jzs  [is][i][j][k] += invVOL*moments[i][j][k][3];</div>
<div class="line"><span class="lineno">  970</span>        pXXsn[is][i][j][k] += invVOL*moments[i][j][k][4];</div>
<div class="line"><span class="lineno">  971</span>        pXYsn[is][i][j][k] += invVOL*moments[i][j][k][5];</div>
<div class="line"><span class="lineno">  972</span>        pXZsn[is][i][j][k] += invVOL*moments[i][j][k][6];</div>
<div class="line"><span class="lineno">  973</span>        pYYsn[is][i][j][k] += invVOL*moments[i][j][k][7];</div>
<div class="line"><span class="lineno">  974</span>        pYZsn[is][i][j][k] += invVOL*moments[i][j][k][8];</div>
<div class="line"><span class="lineno">  975</span>        pZZsn[is][i][j][k] += invVOL*moments[i][j][k][9];</div>
<div class="line"><span class="lineno">  976</span>      }</div>
<div class="line"><span class="lineno">  977</span>    }</div>
<div class="line"><span class="lineno">  978</span>    </div>
<div class="line"><span class="lineno">  979</span>  }</div>
<div class="line"><span class="lineno">  980</span>  }</div>
<div class="line"><span class="lineno">  981</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++)</div>
<div class="line"><span class="lineno">  982</span>  {</div>
<div class="line"><span class="lineno">  983</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a9f7cfc31e795a75ecaad608f6cb8df25">communicateGhostP2G</a>(i);</div>
<div class="line"><span class="lineno">  984</span>  }</div>
<div class="line"><span class="lineno">  985</span>}</div>
<div class="ttc" id="aclass_species_particle_html"><div class="ttname"><a href="../../d8/d2e/class_species_particle.html">SpeciesParticle</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d15/_particle_8h_source.html#l00046">Particle.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa798edff9f1dab76702cbe51ef96a5ef" name="aa798edff9f1dab76702cbe51ef96a5ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa798edff9f1dab76702cbe51ef96a5ef">&#9670;&nbsp;</a></span>sumMoments_AoS_intr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sumMoments_AoS_intr </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *&#160;</td>
          <td class="paramname"><em>part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l01057">1057</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1058</span>{</div>
<div class="line"><span class="lineno"> 1059</span><span class="preprocessor">#ifndef __MIC__</span></div>
<div class="line"><span class="lineno"> 1060</span>  eprintf(<span class="stringliteral">&quot;not implemented&quot;</span>);</div>
<div class="line"><span class="lineno"> 1061</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1062</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>  <span class="comment">// define global parameters</span></div>
<div class="line"><span class="lineno"> 1065</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1066</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dx = 1.0 / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>;</div>
<div class="line"><span class="lineno"> 1067</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dy = 1.0 / dy;</div>
<div class="line"><span class="lineno"> 1068</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dz = 1.0 / dz;</div>
<div class="line"><span class="lineno"> 1069</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> = grid-&gt;getNXN();</div>
<div class="line"><span class="lineno"> 1070</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> = grid-&gt;getNYN();</div>
<div class="line"><span class="lineno"> 1071</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> = grid-&gt;getNZN();</div>
<div class="line"><span class="lineno"> 1072</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> xstart = grid-&gt;getXstart();</div>
<div class="line"><span class="lineno"> 1073</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ystart = grid-&gt;getYstart();</div>
<div class="line"><span class="lineno"> 1074</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> zstart = grid-&gt;getZstart();</div>
<div class="line"><span class="lineno"> 1075</span>  <span class="comment">// Here and below x stands for all 3 physical position coordinates</span></div>
<div class="line"><span class="lineno"> 1076</span>  <span class="keyword">const</span> F64vec8 dx_inv = make_F64vec8(inv_dx, inv_dy, inv_dz);</div>
<div class="line"><span class="lineno"> 1077</span>  <span class="comment">// starting physical position of proper subdomain (&quot;pdom&quot;, without ghosts)</span></div>
<div class="line"><span class="lineno"> 1078</span>  <span class="keyword">const</span> F64vec8 pdom_xlow = make_F64vec8(xstart,ystart, zstart);</div>
<div class="line"><span class="lineno"> 1079</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1080</span>  <span class="comment">// X = canonical coordinates.</span></div>
<div class="line"><span class="lineno"> 1081</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1082</span>  <span class="comment">// starting position of cell in lower corner</span></div>
<div class="line"><span class="lineno"> 1083</span>  <span class="comment">// of proper subdomain (without ghosts);</span></div>
<div class="line"><span class="lineno"> 1084</span>  <span class="comment">// probably this is an integer value, but we won&#39;t rely on it.</span></div>
<div class="line"><span class="lineno"> 1085</span>  <span class="keyword">const</span> F64vec8 pdom_Xlow = dx_inv*pdom_xlow;</div>
<div class="line"><span class="lineno"> 1086</span>  <span class="comment">// g = including ghosts</span></div>
<div class="line"><span class="lineno"> 1087</span>  <span class="comment">// starting position of cell in low corner</span></div>
<div class="line"><span class="lineno"> 1088</span>  <span class="keyword">const</span> F64vec8 gdom_Xlow = pdom_Xlow - F64vec8(1.);</div>
<div class="line"><span class="lineno"> 1089</span>  <span class="comment">// starting position of cell in high corner of physical domain</span></div>
<div class="line"><span class="lineno"> 1090</span>  <span class="comment">// in canonical coordinates of ghost domain</span></div>
<div class="line"><span class="lineno"> 1091</span>  <span class="keyword">const</span> F64vec8 nXcm1 = make_F64vec8(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>-1,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>-1,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>-1);</div>
<div class="line"><span class="lineno"> 1092</span> </div>
<div class="line"><span class="lineno"> 1093</span>  <span class="comment">// allocate memory per mesh cell for accumulating moments</span></div>
<div class="line"><span class="lineno"> 1094</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1095</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> num_threads = omp_get_max_threads();</div>
<div class="line"><span class="lineno"> 1096</span>  <a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;F64vec8&gt;</a>* cell_moments_per_thr</div>
<div class="line"><span class="lineno"> 1097</span>    = (<a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;F64vec8&gt;</a>*) malloc(num_threads*<span class="keyword">sizeof</span>(<a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;F64vec8&gt;</a>));</div>
<div class="line"><span class="lineno"> 1098</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> thread_num=0;thread_num&lt;num_threads;thread_num++)</div>
<div class="line"><span class="lineno"> 1099</span>  {</div>
<div class="line"><span class="lineno"> 1100</span>    <span class="comment">// use placement new to allocate array to accumulate moments for thread</span></div>
<div class="line"><span class="lineno"> 1101</span>    <span class="keyword">new</span>(&amp;cell_moments_per_thr[thread_num]) <a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;F64vec8&gt;</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>,10);</div>
<div class="line"><span class="lineno"> 1102</span>  }</div>
<div class="line"><span class="lineno"> 1103</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1104</span>  <span class="comment">// allocate memory per mesh node for accumulating moments</span></div>
<div class="line"><span class="lineno"> 1105</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1106</span>  <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3&lt;F64vec8&gt;</a>* node_moments_first8_per_thr</div>
<div class="line"><span class="lineno"> 1107</span>    = (<a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3&lt;F64vec8&gt;</a>*) malloc(num_threads*<span class="keyword">sizeof</span>(<a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3&lt;F64vec8&gt;</a>));</div>
<div class="line"><span class="lineno"> 1108</span>  <a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;double&gt;</a>* node_moments_last2_per_thr</div>
<div class="line"><span class="lineno"> 1109</span>    = (<a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;double&gt;</a>*) malloc(num_threads*<span class="keyword">sizeof</span>(<a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;double&gt;</a>));</div>
<div class="line"><span class="lineno"> 1110</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> thread_num=0;thread_num&lt;num_threads;thread_num++)</div>
<div class="line"><span class="lineno"> 1111</span>  {</div>
<div class="line"><span class="lineno"> 1112</span>    <span class="comment">// use placement new to allocate array to accumulate moments for thread</span></div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keyword">new</span>(&amp;node_moments_first8_per_thr[thread_num]) <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3&lt;F64vec8&gt;</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>);</div>
<div class="line"><span class="lineno"> 1114</span>    <span class="keyword">new</span>(&amp;node_moments_last2_per_thr[thread_num]) <a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;double&gt;</a>(<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>,<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>,2);</div>
<div class="line"><span class="lineno"> 1115</span>  }</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span>  <span class="comment">// The moments of a particle must be distributed to the 8 nodes of the cell</span></div>
<div class="line"><span class="lineno"> 1118</span>  <span class="comment">// in proportion to the weight of each node.</span></div>
<div class="line"><span class="lineno"> 1119</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1120</span>  <span class="comment">// Refer to the kronecker product of weights and moments as</span></div>
<div class="line"><span class="lineno"> 1121</span>  <span class="comment">// &quot;weighted moments&quot; or &quot;moment weights&quot;.</span></div>
<div class="line"><span class="lineno"> 1122</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1123</span>  <span class="comment">// Each thread accumulates moment weights in cells.</span></div>
<div class="line"><span class="lineno"> 1124</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1125</span>  <span class="comment">// Because particles are not assumed to be sorted by mesh cell,</span></div>
<div class="line"><span class="lineno"> 1126</span>  <span class="comment">// we have to wait until all particles have been processed</span></div>
<div class="line"><span class="lineno"> 1127</span>  <span class="comment">// before we transpose moment weights to weighted moments;</span></div>
<div class="line"><span class="lineno"> 1128</span>  <span class="comment">// the memory that we must allocate to sum moments is thus</span></div>
<div class="line"><span class="lineno"> 1129</span>  <span class="comment">// num_thread*8 times as much as if particles were pre-sorted</span></div>
<div class="line"><span class="lineno"> 1130</span>  <span class="comment">// by mesh cell (and num_threads times as much as if particles</span></div>
<div class="line"><span class="lineno"> 1131</span>  <span class="comment">// were sorted by thread subdomain).</span></div>
<div class="line"><span class="lineno"> 1132</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1133</span><span class="preprocessor">  #pragma omp parallel</span></div>
<div class="line"><span class="lineno"> 1134</span>  {</div>
<div class="line"><span class="lineno"> 1135</span>    <span class="comment">// array4&lt;F64vec8&gt; cell_moments(nxc,nyc,nzc,10);</span></div>
<div class="line"><span class="lineno"> 1136</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> this_thread = omp_get_thread_num();</div>
<div class="line"><span class="lineno"> 1137</span>    assert_lt(this_thread,num_threads);</div>
<div class="line"><span class="lineno"> 1138</span>    <a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;F64vec8&gt;</a>&amp; cell_moments = cell_moments_per_thr[this_thread];</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> species_idx = 0; species_idx &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; species_idx++)</div>
<div class="line"><span class="lineno"> 1141</span>    {</div>
<div class="line"><span class="lineno"> 1142</span>      <span class="keyword">const</span> <a class="code hl_class" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a>&amp; pcls = part[species_idx];</div>
<div class="line"><span class="lineno"> 1143</span>      assert_eq(pcls.get_particleType(), ParticleType::AoS);</div>
<div class="line"><span class="lineno"> 1144</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> is = pcls.get_species_num();</div>
<div class="line"><span class="lineno"> 1145</span>      assert_eq(species_idx,is);</div>
<div class="line"><span class="lineno"> 1146</span> </div>
<div class="line"><span class="lineno"> 1147</span>      <span class="comment">// moments.setmode(ompmode::mine);</span></div>
<div class="line"><span class="lineno"> 1148</span>      <span class="comment">// moments.setall(0.);</span></div>
<div class="line"><span class="lineno"> 1149</span>      <span class="comment">// </span></div>
<div class="line"><span class="lineno"> 1150</span>      F64vec8 *cell_moments1d = &amp;cell_moments[0][0][0][0];</div>
<div class="line"><span class="lineno"> 1151</span>      <span class="keywordtype">int</span> moments1dsize = cell_moments.get_size();</div>
<div class="line"><span class="lineno"> 1152</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;moments1dsize; i++) cell_moments1d[i]=F64vec8(0.);</div>
<div class="line"><span class="lineno"> 1153</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1154</span>      <span class="comment">// number or particles processed at a time</span></div>
<div class="line"><span class="lineno"> 1155</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> num_pcls_per_loop = 2;</div>
<div class="line"><span class="lineno"> 1156</span>      <span class="keyword">const</span> vector_SpeciesParticle&amp; pcl_list = pcls.get_pcl_list();</div>
<div class="line"><span class="lineno"> 1157</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> nop = pcl_list.size();</div>
<div class="line"><span class="lineno"> 1158</span>      <span class="comment">// if the number of particles is odd, then make</span></div>
<div class="line"><span class="lineno"> 1159</span>      <span class="comment">// sure that the data after the last particle</span></div>
<div class="line"><span class="lineno"> 1160</span>      <span class="comment">// will not contribute to the moments.</span></div>
<div class="line"><span class="lineno"> 1161</span><span class="preprocessor">      #pragma omp single </span><span class="comment">// the implied omp barrier is needed</span></div>
<div class="line"><span class="lineno"> 1162</span>      {</div>
<div class="line"><span class="lineno"> 1163</span>        <span class="comment">// make sure that we will not overrun the array</span></div>
<div class="line"><span class="lineno"> 1164</span>        assert_divides(num_pcls_per_loop,pcl_list.capacity());</div>
<div class="line"><span class="lineno"> 1165</span>        <span class="comment">// round up number of particles</span></div>
<div class="line"><span class="lineno"> 1166</span>        <span class="keywordtype">int</span> nop_rounded_up = roundup_to_multiple(nop,num_pcls_per_loop);</div>
<div class="line"><span class="lineno"> 1167</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> pidx=nop; pidx&lt;nop_rounded_up; pidx++)</div>
<div class="line"><span class="lineno"> 1168</span>        {</div>
<div class="line"><span class="lineno"> 1169</span>          <span class="comment">// (This is a benign violation of particle</span></div>
<div class="line"><span class="lineno"> 1170</span>          <span class="comment">// encapsulation and requires a cast).</span></div>
<div class="line"><span class="lineno"> 1171</span>          <a class="code hl_class" href="../../d8/d2e/class_species_particle.html">SpeciesParticle</a>&amp; pcl = (<a class="code hl_class" href="../../d8/d2e/class_species_particle.html">SpeciesParticle</a>&amp;) pcl_list[pidx];</div>
<div class="line"><span class="lineno"> 1172</span>          pcl.set_to_zero();</div>
<div class="line"><span class="lineno"> 1173</span>        }</div>
<div class="line"><span class="lineno"> 1174</span>      }</div>
<div class="line"><span class="lineno"> 1175</span><span class="preprocessor">      #pragma omp for</span></div>
<div class="line"><span class="lineno"> 1176</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pidx = 0; pidx &lt; nop; pidx+=2)</div>
<div class="line"><span class="lineno"> 1177</span>      {</div>
<div class="line"><span class="lineno"> 1178</span>        <span class="comment">// cast particles as vectors</span></div>
<div class="line"><span class="lineno"> 1179</span>        <span class="comment">// (assumes each particle exactly fits a cache line)</span></div>
<div class="line"><span class="lineno"> 1180</span>        <span class="keyword">const</span> F64vec8&amp; pcl0 = (<span class="keyword">const</span> F64vec8&amp;)pcl_list[pidx];</div>
<div class="line"><span class="lineno"> 1181</span>        <span class="keyword">const</span> F64vec8&amp; pcl1 = (<span class="keyword">const</span> F64vec8&amp;)pcl_list[pidx+1];</div>
<div class="line"><span class="lineno"> 1182</span>        <span class="comment">// gather position data from particles</span></div>
<div class="line"><span class="lineno"> 1183</span>        <span class="comment">// (assumes position vectors are in upper half)</span></div>
<div class="line"><span class="lineno"> 1184</span>        <span class="keyword">const</span> F64vec8 xpos = cat_hgh_halves(pcl0,pcl1);</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>        <span class="comment">// convert to canonical coordinates relative to subdomain with ghosts</span></div>
<div class="line"><span class="lineno"> 1187</span>        <span class="keyword">const</span> F64vec8 gX = dx_inv*xpos - gdom_Xlow;</div>
<div class="line"><span class="lineno"> 1188</span>        F64vec8 cellXstart = floor(gX);</div>
<div class="line"><span class="lineno"> 1189</span>        <span class="comment">// all particles at this point should be inside the</span></div>
<div class="line"><span class="lineno"> 1190</span>        <span class="comment">// proper subdomain of this process, but maybe we</span></div>
<div class="line"><span class="lineno"> 1191</span>        <span class="comment">// will need to enforce this because of inconsistency</span></div>
<div class="line"><span class="lineno"> 1192</span>        <span class="comment">// of floating point arithmetic?</span></div>
<div class="line"><span class="lineno"> 1193</span>        <span class="comment">//cellXstart = maximum(cellXstart,F64vec8(1.));</span></div>
<div class="line"><span class="lineno"> 1194</span>        <span class="comment">//cellXstart = minimum(cellXstart,nXcm1);</span></div>
<div class="line"><span class="lineno"> 1195</span>        assert(!test_lt(cellXstart,F64vec8(1.)));</div>
<div class="line"><span class="lineno"> 1196</span>        assert(!test_gt(cellXstart,nXcm1));</div>
<div class="line"><span class="lineno"> 1197</span> </div>
<div class="line"><span class="lineno"> 1198</span>        <span class="comment">// get weights for field_components based on particle position</span></div>
<div class="line"><span class="lineno"> 1199</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1200</span>        F64vec8 weights[2];</div>
<div class="line"><span class="lineno"> 1201</span>        <span class="keyword">const</span> F64vec8 X = gX - cellXstart;</div>
<div class="line"><span class="lineno"> 1202</span>        construct_weights_for_2pcls(weights, X);</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>        <span class="comment">// add scaled weights to all ten moments for the cell of each particle</span></div>
<div class="line"><span class="lineno"> 1205</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1206</span>        <span class="comment">// the cell that we will write to</span></div>
<div class="line"><span class="lineno"> 1207</span>        <span class="keyword">const</span> I32vec16 cell = round_to_nearest(cellXstart);</div>
<div class="line"><span class="lineno"> 1208</span>        <span class="keyword">const</span> <span class="keywordtype">int</span>* <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>=(<span class="keywordtype">int</span>*)&amp;cell;</div>
<div class="line"><span class="lineno"> 1209</span>        F64vec8* cell_moments0 = &amp;cell_moments[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>[0]][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>[1]][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>[2]][0];</div>
<div class="line"><span class="lineno"> 1210</span>        F64vec8* cell_moments1 = &amp;cell_moments[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>[4]][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>[5]][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>[6]][0];</div>
<div class="line"><span class="lineno"> 1211</span>        addto_cell_moments(cell_moments0, weights[0], pcl0);</div>
<div class="line"><span class="lineno"> 1212</span>        addto_cell_moments(cell_moments1, weights[1], pcl1);</div>
<div class="line"><span class="lineno"> 1213</span>      }</div>
<div class="line"><span class="lineno"> 1214</span>      <span class="keywordflow">if</span>(!this_thread) timeTasks_end_task(TimeTasks::MOMENT_ACCUMULATION);</div>
<div class="line"><span class="lineno"> 1215</span> </div>
<div class="line"><span class="lineno"> 1216</span>      <span class="comment">// reduction</span></div>
<div class="line"><span class="lineno"> 1217</span>      <span class="keywordflow">if</span>(!this_thread) timeTasks_begin_task(TimeTasks::MOMENT_REDUCTION);</div>
<div class="line"><span class="lineno"> 1218</span> </div>
<div class="line"><span class="lineno"> 1219</span>      <span class="comment">// reduce moments in parallel</span></div>
<div class="line"><span class="lineno"> 1220</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1221</span>      <span class="comment">// this code currently makes no sense for multiple threads.</span></div>
<div class="line"><span class="lineno"> 1222</span>      assert_eq(num_threads,1);</div>
<div class="line"><span class="lineno"> 1223</span>      {</div>
<div class="line"><span class="lineno"> 1224</span>        <span class="comment">// For each thread, distribute moments from cells to nodes</span></div>
<div class="line"><span class="lineno"> 1225</span>        <span class="comment">// and then sum moments at each node over all threads.</span></div>
<div class="line"><span class="lineno"> 1226</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1227</span>        <span class="comment">// (Alternatively we could sum over all threads and then</span></div>
<div class="line"><span class="lineno"> 1228</span>        <span class="comment">// distribute to nodes; this alternative would be preferable</span></div>
<div class="line"><span class="lineno"> 1229</span>        <span class="comment">// for vectorization efficiency but more difficult to parallelize</span></div>
<div class="line"><span class="lineno"> 1230</span>        <span class="comment">// across threads).</span></div>
<div class="line"><span class="lineno"> 1231</span> </div>
<div class="line"><span class="lineno"> 1232</span>        <span class="comment">// initialize moment accumulators</span></div>
<div class="line"><span class="lineno"> 1233</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1234</span>        memset(&amp;node_moments_first8_per_thr[this_thread][0][0][0],</div>
<div class="line"><span class="lineno"> 1235</span>          0, <span class="keyword">sizeof</span>(F64vec8)*node_moments_first8_per_thr[0].get_size());</div>
<div class="line"><span class="lineno"> 1236</span>        memset(&amp;node_moments_last2_per_thr[this_thread][0][0][0][0],</div>
<div class="line"><span class="lineno"> 1237</span>          0, <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*node_moments_last2_per_thr[0].get_size());</div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span>        <span class="comment">// distribute moments from cells to nodes</span></div>
<div class="line"><span class="lineno"> 1240</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1241</span><span class="preprocessor">        #pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno"> 1242</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cx=1;cx&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>;cx++)</div>
<div class="line"><span class="lineno"> 1243</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cy=1;cy&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>;cy++)</div>
<div class="line"><span class="lineno"> 1244</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cz=1;cz&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>;cz++)</div>
<div class="line"><span class="lineno"> 1245</span>        {</div>
<div class="line"><span class="lineno"> 1246</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> ix=cx+1;</div>
<div class="line"><span class="lineno"> 1247</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> iy=cy+1;</div>
<div class="line"><span class="lineno"> 1248</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> iz=cz+1;</div>
<div class="line"><span class="lineno"> 1249</span>          F64vec8* cell_mom = &amp;cell_moments[cx][cy][cz][0];</div>
<div class="line"><span class="lineno"> 1250</span> </div>
<div class="line"><span class="lineno"> 1251</span>          <span class="comment">// scatter the cell&#39;s first 8 moments to its nodes</span></div>
<div class="line"><span class="lineno"> 1252</span>          <span class="comment">// for each thread</span></div>
<div class="line"><span class="lineno"> 1253</span>          {</div>
<div class="line"><span class="lineno"> 1254</span>            F64vec8* cell_mom_first8 = cell_mom;</div>
<div class="line"><span class="lineno"> 1255</span>            <span class="comment">// regard cell_mom_first8 as a pointer to 8x8 data and transpose</span></div>
<div class="line"><span class="lineno"> 1256</span>            transpose_8x8_double((<span class="keywordtype">double</span>(*)[8]) cell_mom_first8);</div>
<div class="line"><span class="lineno"> 1257</span>            <span class="comment">// scatter the moment vectors to the nodes</span></div>
<div class="line"><span class="lineno"> 1258</span>            <a class="code hl_class" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3&lt;F64vec8&gt;</a>&amp; node_moments_first8 = node_moments_first8_per_thr[this_thread];</div>
<div class="line"><span class="lineno"> 1259</span>            arr_fetch2(F64vec8) node_moments0 = node_moments_first8[ix];</div>
<div class="line"><span class="lineno"> 1260</span>            arr_fetch2(F64vec8) node_moments1 = node_moments_first8[cx];</div>
<div class="line"><span class="lineno"> 1261</span>            arr_fetch1(F64vec8) node_moments00 = node_moments0[iy];</div>
<div class="line"><span class="lineno"> 1262</span>            arr_fetch1(F64vec8) node_moments01 = node_moments0[cy];</div>
<div class="line"><span class="lineno"> 1263</span>            arr_fetch1(F64vec8) node_moments10 = node_moments1[iy];</div>
<div class="line"><span class="lineno"> 1264</span>            arr_fetch1(F64vec8) node_moments11 = node_moments1[cy];</div>
<div class="line"><span class="lineno"> 1265</span>            node_moments00[iz] += cell_mom_first8[0]; <span class="comment">// node_moments_first8[ix][iy][iz]</span></div>
<div class="line"><span class="lineno"> 1266</span>            node_moments00[cz] += cell_mom_first8[1]; <span class="comment">// node_moments_first8[ix][iy][cz]</span></div>
<div class="line"><span class="lineno"> 1267</span>            node_moments01[iz] += cell_mom_first8[2]; <span class="comment">// node_moments_first8[ix][cy][iz]</span></div>
<div class="line"><span class="lineno"> 1268</span>            node_moments01[cz] += cell_mom_first8[3]; <span class="comment">// node_moments_first8[ix][cy][cz]</span></div>
<div class="line"><span class="lineno"> 1269</span>            node_moments10[iz] += cell_mom_first8[4]; <span class="comment">// node_moments_first8[cx][iy][iz]</span></div>
<div class="line"><span class="lineno"> 1270</span>            node_moments10[cz] += cell_mom_first8[5]; <span class="comment">// node_moments_first8[cx][iy][cz]</span></div>
<div class="line"><span class="lineno"> 1271</span>            node_moments11[iz] += cell_mom_first8[6]; <span class="comment">// node_moments_first8[cx][cy][iz]</span></div>
<div class="line"><span class="lineno"> 1272</span>            node_moments11[cz] += cell_mom_first8[7]; <span class="comment">// node_moments_first8[cx][cy][cz]</span></div>
<div class="line"><span class="lineno"> 1273</span>          }</div>
<div class="line"><span class="lineno"> 1274</span> </div>
<div class="line"><span class="lineno"> 1275</span>          <span class="comment">// scatter the cell&#39;s last 2 moments to its nodes</span></div>
<div class="line"><span class="lineno"> 1276</span>          {</div>
<div class="line"><span class="lineno"> 1277</span>            <a class="code hl_class" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4&lt;double&gt;</a>&amp; node_moments_last2 = node_moments_last2_per_thr[this_thread];</div>
<div class="line"><span class="lineno"> 1278</span>            arr3_double_fetch node_moments0 = node_moments_last2[ix];</div>
<div class="line"><span class="lineno"> 1279</span>            arr3_double_fetch node_moments1 = node_moments_last2[cx];</div>
<div class="line"><span class="lineno"> 1280</span>            arr2_double_fetch node_moments00 = node_moments0[iy];</div>
<div class="line"><span class="lineno"> 1281</span>            arr2_double_fetch node_moments01 = node_moments0[cy];</div>
<div class="line"><span class="lineno"> 1282</span>            arr2_double_fetch node_moments10 = node_moments1[iy];</div>
<div class="line"><span class="lineno"> 1283</span>            arr2_double_fetch node_moments11 = node_moments1[cy];</div>
<div class="line"><span class="lineno"> 1284</span>            <span class="keywordtype">double</span>* node_moments000 = node_moments00[iz];</div>
<div class="line"><span class="lineno"> 1285</span>            <span class="keywordtype">double</span>* node_moments001 = node_moments00[cz];</div>
<div class="line"><span class="lineno"> 1286</span>            <span class="keywordtype">double</span>* node_moments010 = node_moments01[iz];</div>
<div class="line"><span class="lineno"> 1287</span>            <span class="keywordtype">double</span>* node_moments011 = node_moments01[cz];</div>
<div class="line"><span class="lineno"> 1288</span>            <span class="keywordtype">double</span>* node_moments100 = node_moments10[iz];</div>
<div class="line"><span class="lineno"> 1289</span>            <span class="keywordtype">double</span>* node_moments101 = node_moments10[cz];</div>
<div class="line"><span class="lineno"> 1290</span>            <span class="keywordtype">double</span>* node_moments110 = node_moments11[iz];</div>
<div class="line"><span class="lineno"> 1291</span>            <span class="keywordtype">double</span>* node_moments111 = node_moments11[cz];</div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span>            <span class="keyword">const</span> F64vec8 mom8 = cell_mom[8];</div>
<div class="line"><span class="lineno"> 1294</span>            <span class="keyword">const</span> F64vec8 mom9 = cell_mom[9];</div>
<div class="line"><span class="lineno"> 1295</span> </div>
<div class="line"><span class="lineno"> 1296</span>            <span class="keywordtype">bool</span> naive_last2 = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1297</span>            <span class="keywordflow">if</span>(naive_last2)</div>
<div class="line"><span class="lineno"> 1298</span>            {</div>
<div class="line"><span class="lineno"> 1299</span>              node_moments000[0] += mom8[0]; node_moments000[1] += mom9[0];</div>
<div class="line"><span class="lineno"> 1300</span>              node_moments001[0] += mom8[1]; node_moments001[1] += mom9[1];</div>
<div class="line"><span class="lineno"> 1301</span>              node_moments010[0] += mom8[2]; node_moments010[1] += mom9[2];</div>
<div class="line"><span class="lineno"> 1302</span>              node_moments011[0] += mom8[3]; node_moments011[1] += mom9[3];</div>
<div class="line"><span class="lineno"> 1303</span>              node_moments100[0] += mom8[4]; node_moments100[1] += mom9[4];</div>
<div class="line"><span class="lineno"> 1304</span>              node_moments101[0] += mom8[5]; node_moments101[1] += mom9[5];</div>
<div class="line"><span class="lineno"> 1305</span>              node_moments110[0] += mom8[6]; node_moments110[1] += mom9[6];</div>
<div class="line"><span class="lineno"> 1306</span>              node_moments111[0] += mom8[7]; node_moments111[1] += mom9[7];</div>
<div class="line"><span class="lineno"> 1307</span>            }</div>
<div class="line"><span class="lineno"> 1308</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1309</span>            {</div>
<div class="line"><span class="lineno"> 1310</span>              <span class="comment">// Let a=moment#8 and b=moment#9.</span></div>
<div class="line"><span class="lineno"> 1311</span>              <span class="comment">// Number the nodes 0 through 7.</span></div>
<div class="line"><span class="lineno"> 1312</span>              <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1313</span>              <span class="comment">// This transpose changes data from the form</span></div>
<div class="line"><span class="lineno"> 1314</span>              <span class="comment">//   [a0 a1 a2 a3 a4 a5 a6 a7]=mom8</span></div>
<div class="line"><span class="lineno"> 1315</span>              <span class="comment">//   [b0 b1 b2 b3 b4 b5 b6 b7]=mom9</span></div>
<div class="line"><span class="lineno"> 1316</span>              <span class="comment">// into the form</span></div>
<div class="line"><span class="lineno"> 1317</span>              <span class="comment">//   [a0 b0 a2 b2 a4 b4 a6 b6]=out8</span></div>
<div class="line"><span class="lineno"> 1318</span>              <span class="comment">//   [a1 b1 a3 b3 a5 b5 a7 b7]=out9</span></div>
<div class="line"><span class="lineno"> 1319</span>              F64vec8 out8, out9;</div>
<div class="line"><span class="lineno"> 1320</span>              trans2x2(out8, out9, mom8, mom9);</div>
<div class="line"><span class="lineno"> 1321</span> </div>
<div class="line"><span class="lineno"> 1322</span>              <span class="comment">// probably the compiler is not smart enough to recognize that</span></div>
<div class="line"><span class="lineno"> 1323</span>              <span class="comment">// each line can be done with a single vector instruction:</span></div>
<div class="line"><span class="lineno"> 1324</span>              node_moments000[0] += out8[0]; node_moments000[1] += out8[1];</div>
<div class="line"><span class="lineno"> 1325</span>              node_moments001[0] += out9[0]; node_moments001[1] += out9[1];</div>
<div class="line"><span class="lineno"> 1326</span>              node_moments010[0] += out8[2]; node_moments010[1] += out8[3];</div>
<div class="line"><span class="lineno"> 1327</span>              node_moments011[0] += out9[2]; node_moments011[1] += out9[3];</div>
<div class="line"><span class="lineno"> 1328</span>              node_moments100[0] += out8[4]; node_moments100[1] += out8[5];</div>
<div class="line"><span class="lineno"> 1329</span>              node_moments101[0] += out9[4]; node_moments101[1] += out9[5];</div>
<div class="line"><span class="lineno"> 1330</span>              node_moments110[0] += out8[6]; node_moments110[1] += out8[7];</div>
<div class="line"><span class="lineno"> 1331</span>              node_moments111[0] += out9[6]; node_moments111[1] += out9[7];</div>
<div class="line"><span class="lineno"> 1332</span>            }</div>
<div class="line"><span class="lineno"> 1333</span>          }</div>
<div class="line"><span class="lineno"> 1334</span>        }</div>
<div class="line"><span class="lineno"> 1335</span> </div>
<div class="line"><span class="lineno"> 1336</span>        <span class="comment">// at each node add moments to moments of first thread</span></div>
<div class="line"><span class="lineno"> 1337</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1338</span><span class="preprocessor">        #pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno"> 1339</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nx=1;nx&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;nx++)</div>
<div class="line"><span class="lineno"> 1340</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ny=1;ny&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;ny++)</div>
<div class="line"><span class="lineno"> 1341</span>        {</div>
<div class="line"><span class="lineno"> 1342</span>          arr_fetch1(F64vec8) node_moments8_for_master</div>
<div class="line"><span class="lineno"> 1343</span>            = node_moments_first8_per_thr[0][nx][ny];</div>
<div class="line"><span class="lineno"> 1344</span>          arr_fetch2(<span class="keywordtype">double</span>) node_moments2_for_master</div>
<div class="line"><span class="lineno"> 1345</span>            = node_moments_last2_per_thr[0][nx][ny];</div>
<div class="line"><span class="lineno"> 1346</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> thread_num=1;thread_num&lt;num_threads;thread_num++)</div>
<div class="line"><span class="lineno"> 1347</span>          {</div>
<div class="line"><span class="lineno"> 1348</span>            arr_fetch1(F64vec8) node_moments8_for_thr</div>
<div class="line"><span class="lineno"> 1349</span>              = node_moments_first8_per_thr[thread_num][nx][ny];</div>
<div class="line"><span class="lineno"> 1350</span>            arr_fetch2(<span class="keywordtype">double</span>) node_moments2_for_thr</div>
<div class="line"><span class="lineno"> 1351</span>              = node_moments_last2_per_thr[thread_num][nx][ny];</div>
<div class="line"><span class="lineno"> 1352</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nz=1;nz&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;nz++)</div>
<div class="line"><span class="lineno"> 1353</span>            {</div>
<div class="line"><span class="lineno"> 1354</span>              node_moments8_for_master[nz] += node_moments8_for_thr[nz];</div>
<div class="line"><span class="lineno"> 1355</span>              node_moments2_for_master[nz][0] += node_moments2_for_thr[nz][0];</div>
<div class="line"><span class="lineno"> 1356</span>              node_moments2_for_master[nz][1] += node_moments2_for_thr[nz][1];</div>
<div class="line"><span class="lineno"> 1357</span>            }</div>
<div class="line"><span class="lineno"> 1358</span>          }</div>
<div class="line"><span class="lineno"> 1359</span>        }</div>
<div class="line"><span class="lineno"> 1360</span> </div>
<div class="line"><span class="lineno"> 1361</span>        <span class="comment">// transpose moments for field solver</span></div>
<div class="line"><span class="lineno"> 1362</span>        <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1363</span><span class="preprocessor">        #pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno"> 1364</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nx=1;nx&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;nx++)</div>
<div class="line"><span class="lineno"> 1365</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ny=1;ny&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;ny++)</div>
<div class="line"><span class="lineno"> 1366</span>        {</div>
<div class="line"><span class="lineno"> 1367</span>          arr_fetch1(F64vec8) node_moments8_for_master</div>
<div class="line"><span class="lineno"> 1368</span>            = node_moments_first8_per_thr[0][nx][ny];</div>
<div class="line"><span class="lineno"> 1369</span>          arr_fetch2(<span class="keywordtype">double</span>) node_moments2_for_master</div>
<div class="line"><span class="lineno"> 1370</span>            = node_moments_last2_per_thr[0][nx][ny];</div>
<div class="line"><span class="lineno"> 1371</span>          arr_fetch1(<span class="keywordtype">double</span>) rho_sxy = <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][nx][ny];</div>
<div class="line"><span class="lineno"> 1372</span>          arr_fetch1(<span class="keywordtype">double</span>) Jx__sxy = Jxs  [is][nx][ny];</div>
<div class="line"><span class="lineno"> 1373</span>          arr_fetch1(<span class="keywordtype">double</span>) Jy__sxy = Jys  [is][nx][ny];</div>
<div class="line"><span class="lineno"> 1374</span>          arr_fetch1(<span class="keywordtype">double</span>) Jz__sxy = Jzs  [is][nx][ny];</div>
<div class="line"><span class="lineno"> 1375</span>          arr_fetch1(<span class="keywordtype">double</span>) pXX_sxy = pXXsn[is][nx][ny];</div>
<div class="line"><span class="lineno"> 1376</span>          arr_fetch1(<span class="keywordtype">double</span>) pXY_sxy = pXYsn[is][nx][ny];</div>
<div class="line"><span class="lineno"> 1377</span>          arr_fetch1(<span class="keywordtype">double</span>) pXZ_sxy = pXZsn[is][nx][ny];</div>
<div class="line"><span class="lineno"> 1378</span>          arr_fetch1(<span class="keywordtype">double</span>) pYY_sxy = pYYsn[is][nx][ny];</div>
<div class="line"><span class="lineno"> 1379</span>          arr_fetch1(<span class="keywordtype">double</span>) pYZ_sxy = pYZsn[is][nx][ny];</div>
<div class="line"><span class="lineno"> 1380</span>          arr_fetch1(<span class="keywordtype">double</span>) pZZ_sxy = pZZsn[is][nx][ny];</div>
<div class="line"><span class="lineno"> 1381</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nz=0;nz&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;nz++)</div>
<div class="line"><span class="lineno"> 1382</span>          {</div>
<div class="line"><span class="lineno"> 1383</span>            rho_sxy[nz] = invVOL*node_moments8_for_master[nz][0];</div>
<div class="line"><span class="lineno"> 1384</span>            Jx__sxy[nz] = invVOL*node_moments8_for_master[nz][1];</div>
<div class="line"><span class="lineno"> 1385</span>            Jy__sxy[nz] = invVOL*node_moments8_for_master[nz][2];</div>
<div class="line"><span class="lineno"> 1386</span>            Jz__sxy[nz] = invVOL*node_moments8_for_master[nz][3];</div>
<div class="line"><span class="lineno"> 1387</span>            pXX_sxy[nz] = invVOL*node_moments8_for_master[nz][4];</div>
<div class="line"><span class="lineno"> 1388</span>            pXY_sxy[nz] = invVOL*node_moments8_for_master[nz][5];</div>
<div class="line"><span class="lineno"> 1389</span>            pXZ_sxy[nz] = invVOL*node_moments8_for_master[nz][6];</div>
<div class="line"><span class="lineno"> 1390</span>            pYY_sxy[nz] = invVOL*node_moments8_for_master[nz][7];</div>
<div class="line"><span class="lineno"> 1391</span>            pYZ_sxy[nz] = invVOL*node_moments2_for_master[nz][0];</div>
<div class="line"><span class="lineno"> 1392</span>            pZZ_sxy[nz] = invVOL*node_moments2_for_master[nz][1];</div>
<div class="line"><span class="lineno"> 1393</span>          }</div>
<div class="line"><span class="lineno"> 1394</span>        }</div>
<div class="line"><span class="lineno"> 1395</span>      }</div>
<div class="line"><span class="lineno"> 1396</span>      <span class="keywordflow">if</span>(!this_thread) timeTasks_end_task(TimeTasks::MOMENT_REDUCTION);</div>
<div class="line"><span class="lineno"> 1397</span>    }</div>
<div class="line"><span class="lineno"> 1398</span>  }</div>
<div class="line"><span class="lineno"> 1399</span> </div>
<div class="line"><span class="lineno"> 1400</span>  <span class="comment">// deallocate memory per mesh node for accumulating moments</span></div>
<div class="line"><span class="lineno"> 1401</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1402</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> thread_num=0;thread_num&lt;num_threads;thread_num++)</div>
<div class="line"><span class="lineno"> 1403</span>  {</div>
<div class="line"><span class="lineno"> 1404</span>    <span class="comment">// call destructor to deallocate arrays</span></div>
<div class="line"><span class="lineno"> 1405</span>    node_moments_first8_per_thr[thread_num].~array3&lt;F64vec8&gt;();</div>
<div class="line"><span class="lineno"> 1406</span>    node_moments_last2_per_thr[thread_num].~array4&lt;<span class="keywordtype">double</span>&gt;();</div>
<div class="line"><span class="lineno"> 1407</span>  }</div>
<div class="line"><span class="lineno"> 1408</span>  free(node_moments_first8_per_thr);</div>
<div class="line"><span class="lineno"> 1409</span>  free(node_moments_last2_per_thr);</div>
<div class="line"><span class="lineno"> 1410</span> </div>
<div class="line"><span class="lineno"> 1411</span>  <span class="comment">// deallocate memory for accumulating moments</span></div>
<div class="line"><span class="lineno"> 1412</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1413</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> thread_num=0;thread_num&lt;num_threads;thread_num++)</div>
<div class="line"><span class="lineno"> 1414</span>  {</div>
<div class="line"><span class="lineno"> 1415</span>    <span class="comment">// deallocate array to accumulate moments for thread</span></div>
<div class="line"><span class="lineno"> 1416</span>    cell_moments_per_thr[thread_num].~array4&lt;F64vec8&gt;();</div>
<div class="line"><span class="lineno"> 1417</span>  }</div>
<div class="line"><span class="lineno"> 1418</span>  free(cell_moments_per_thr);</div>
<div class="line"><span class="lineno"> 1419</span> </div>
<div class="line"><span class="lineno"> 1420</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++)</div>
<div class="line"><span class="lineno"> 1421</span>  {</div>
<div class="line"><span class="lineno"> 1422</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a9f7cfc31e795a75ecaad608f6cb8df25">communicateGhostP2G</a>(i);</div>
<div class="line"><span class="lineno"> 1423</span>  }</div>
<div class="line"><span class="lineno"> 1424</span><span class="preprocessor">#endif </span><span class="comment">// __MIC__</span></div>
<div class="line"><span class="lineno"> 1425</span>}</div>
<div class="ttc" id="astructi_pic3_d_1_1array4_html"><div class="ttname"><a href="../../dd/d8c/structi_pic3_d_1_1array4.html">iPic3D::array4</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d0/d00/_alloc_8h_source.html#l00869">Alloc.h:870</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad69796f3529511284f8090c70df0a952" name="ad69796f3529511284f8090c70df0a952"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad69796f3529511284f8090c70df0a952">&#9670;&nbsp;</a></span>sumMoments_vectorized()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sumMoments_vectorized </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *&#160;</td>
          <td class="paramname"><em>part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l01672">1672</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1673</span>{</div>
<div class="line"><span class="lineno"> 1674</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 1675</span> </div>
<div class="line"><span class="lineno"> 1676</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dx = grid-&gt;get_invdx();</div>
<div class="line"><span class="lineno"> 1677</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dy = grid-&gt;get_invdy();</div>
<div class="line"><span class="lineno"> 1678</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dz = grid-&gt;get_invdz();</div>
<div class="line"><span class="lineno"> 1679</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> = grid-&gt;getNXN();</div>
<div class="line"><span class="lineno"> 1680</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> = grid-&gt;getNYN();</div>
<div class="line"><span class="lineno"> 1681</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> = grid-&gt;getNZN();</div>
<div class="line"><span class="lineno"> 1682</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> xstart = grid-&gt;getXstart();</div>
<div class="line"><span class="lineno"> 1683</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ystart = grid-&gt;getYstart();</div>
<div class="line"><span class="lineno"> 1684</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> zstart = grid-&gt;getZstart();</div>
<div class="line"><span class="lineno"> 1685</span><span class="preprocessor">  #pragma omp parallel</span></div>
<div class="line"><span class="lineno"> 1686</span>  {</div>
<div class="line"><span class="lineno"> 1687</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> species_idx = 0; species_idx &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; species_idx++)</div>
<div class="line"><span class="lineno"> 1688</span>  {</div>
<div class="line"><span class="lineno"> 1689</span>    <span class="keyword">const</span> <a class="code hl_class" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a>&amp; pcls = part[species_idx];</div>
<div class="line"><span class="lineno"> 1690</span>    assert_eq(pcls.get_particleType(), ParticleType::SoA);</div>
<div class="line"><span class="lineno"> 1691</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> is = pcls.get_species_num();</div>
<div class="line"><span class="lineno"> 1692</span>    assert_eq(species_idx,is);</div>
<div class="line"><span class="lineno"> 1693</span> </div>
<div class="line"><span class="lineno"> 1694</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> x = pcls.getXall();</div>
<div class="line"><span class="lineno"> 1695</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> y = pcls.getYall();</div>
<div class="line"><span class="lineno"> 1696</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> z = pcls.getZall();</div>
<div class="line"><span class="lineno"> 1697</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> u = pcls.getUall();</div>
<div class="line"><span class="lineno"> 1698</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> v = pcls.getVall();</div>
<div class="line"><span class="lineno"> 1699</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> w = pcls.getWall();</div>
<div class="line"><span class="lineno"> 1700</span>    <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> q = pcls.getQall();</div>
<div class="line"><span class="lineno"> 1701</span> </div>
<div class="line"><span class="lineno"> 1702</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> nop = pcls.getNOP();</div>
<div class="line"><span class="lineno"> 1703</span><span class="preprocessor">    #pragma omp master</span></div>
<div class="line"><span class="lineno"> 1704</span>    { timeTasks_begin_task(TimeTasks::MOMENT_ACCUMULATION); }</div>
<div class="line"><span class="lineno"> 1705</span>    <a class="code hl_class" href="../../d1/d1c/class_moments10.html">Moments10</a>&amp; speciesMoments10 = <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a497e6c49c5f051a364eb1c0972e215df">fetch_moments10Array</a>(0);</div>
<div class="line"><span class="lineno"> 1706</span>    <a class="code hl_class" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> moments = speciesMoments10.fetch_arr();</div>
<div class="line"><span class="lineno"> 1707</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1708</span>    <span class="comment">// moments.setmode(ompmode::ompfor);</span></div>
<div class="line"><span class="lineno"> 1709</span>    <span class="comment">//moments.setall(0.);</span></div>
<div class="line"><span class="lineno"> 1710</span>    <span class="keywordtype">double</span> *moments1d = &amp;moments[0][0][0][0];</div>
<div class="line"><span class="lineno"> 1711</span>    <span class="keywordtype">int</span> moments1dsize = moments.get_size();</div>
<div class="line"><span class="lineno"> 1712</span><span class="preprocessor">    #pragma omp for </span><span class="comment">// because shared</span></div>
<div class="line"><span class="lineno"> 1713</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;moments1dsize; i++) moments1d[i]=0;</div>
<div class="line"><span class="lineno"> 1714</span>    </div>
<div class="line"><span class="lineno"> 1715</span>    <span class="comment">// prevent threads from writing to the same location</span></div>
<div class="line"><span class="lineno"> 1716</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cxmod2=0; cxmod2&lt;2; cxmod2++)</div>
<div class="line"><span class="lineno"> 1717</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cymod2=0; cymod2&lt;2; cymod2++)</div>
<div class="line"><span class="lineno"> 1718</span>    <span class="comment">// each mesh cell is handled by its own thread</span></div>
<div class="line"><span class="lineno"> 1719</span>    #pragma omp <span class="keywordflow">for</span> collapse(2)</div>
<div class="line"><span class="lineno"> 1720</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cx=cxmod2;cx&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>;cx+=2)</div>
<div class="line"><span class="lineno"> 1721</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cy=cymod2;cy&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>;cy+=2)</div>
<div class="line"><span class="lineno"> 1722</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cz=0;cz&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>;cz++)</div>
<div class="line"><span class="lineno"> 1723</span>    {</div>
<div class="line"><span class="lineno"> 1724</span>     <span class="comment">//dprint(cz);</span></div>
<div class="line"><span class="lineno"> 1725</span>     <span class="comment">// index of interface to right of cell</span></div>
<div class="line"><span class="lineno"> 1726</span>     <span class="keyword">const</span> <span class="keywordtype">int</span> ix = cx + 1;</div>
<div class="line"><span class="lineno"> 1727</span>     <span class="keyword">const</span> <span class="keywordtype">int</span> iy = cy + 1;</div>
<div class="line"><span class="lineno"> 1728</span>     <span class="keyword">const</span> <span class="keywordtype">int</span> iz = cz + 1;</div>
<div class="line"><span class="lineno"> 1729</span>     {</div>
<div class="line"><span class="lineno"> 1730</span>      <span class="comment">// reference the 8 nodes to which we will</span></div>
<div class="line"><span class="lineno"> 1731</span>      <span class="comment">// write moment data for particles in this mesh cell.</span></div>
<div class="line"><span class="lineno"> 1732</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1733</span>      arr1_double_fetch momentsArray[8];</div>
<div class="line"><span class="lineno"> 1734</span>      arr2_double_fetch moments00 = moments[ix][iy];</div>
<div class="line"><span class="lineno"> 1735</span>      arr2_double_fetch moments01 = moments[ix][cy];</div>
<div class="line"><span class="lineno"> 1736</span>      arr2_double_fetch moments10 = moments[cx][iy];</div>
<div class="line"><span class="lineno"> 1737</span>      arr2_double_fetch moments11 = moments[cx][cy];</div>
<div class="line"><span class="lineno"> 1738</span>      momentsArray[0] = moments00[iz]; <span class="comment">// moments000 </span></div>
<div class="line"><span class="lineno"> 1739</span>      momentsArray[1] = moments00[cz]; <span class="comment">// moments001 </span></div>
<div class="line"><span class="lineno"> 1740</span>      momentsArray[2] = moments01[iz]; <span class="comment">// moments010 </span></div>
<div class="line"><span class="lineno"> 1741</span>      momentsArray[3] = moments01[cz]; <span class="comment">// moments011 </span></div>
<div class="line"><span class="lineno"> 1742</span>      momentsArray[4] = moments10[iz]; <span class="comment">// moments100 </span></div>
<div class="line"><span class="lineno"> 1743</span>      momentsArray[5] = moments10[cz]; <span class="comment">// moments101 </span></div>
<div class="line"><span class="lineno"> 1744</span>      momentsArray[6] = moments11[iz]; <span class="comment">// moments110 </span></div>
<div class="line"><span class="lineno"> 1745</span>      momentsArray[7] = moments11[cz]; <span class="comment">// moments111 </span></div>
<div class="line"><span class="lineno"> 1746</span> </div>
<div class="line"><span class="lineno"> 1747</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> numpcls_in_cell = pcls.get_numpcls_in_bucket(cx,cy,cz);</div>
<div class="line"><span class="lineno"> 1748</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> bucket_offset = pcls.get_bucket_offset(cx,cy,cz);</div>
<div class="line"><span class="lineno"> 1749</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> bucket_end = bucket_offset+numpcls_in_cell;</div>
<div class="line"><span class="lineno"> 1750</span> </div>
<div class="line"><span class="lineno"> 1751</span>      <span class="keywordtype">bool</span> vectorized=<span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1752</span>      <span class="keywordflow">if</span>(!vectorized)</div>
<div class="line"><span class="lineno"> 1753</span>      {</div>
<div class="line"><span class="lineno"> 1754</span>        <span class="comment">// accumulators for moments per each of 8 threads</span></div>
<div class="line"><span class="lineno"> 1755</span>        <span class="keywordtype">double</span> momentsAcc[8][10];</div>
<div class="line"><span class="lineno"> 1756</span>        memset(momentsAcc,0,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*8*10);</div>
<div class="line"><span class="lineno"> 1757</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=bucket_offset; i&lt;bucket_end; i++)</div>
<div class="line"><span class="lineno"> 1758</span>        {</div>
<div class="line"><span class="lineno"> 1759</span>          add_moments_for_pcl(momentsAcc, i,</div>
<div class="line"><span class="lineno"> 1760</span>            x, y, z, u, v, w, q,</div>
<div class="line"><span class="lineno"> 1761</span>            xstart, ystart, zstart,</div>
<div class="line"><span class="lineno"> 1762</span>            inv_dx, inv_dy, inv_dz,</div>
<div class="line"><span class="lineno"> 1763</span>            cx, cy, cz);</div>
<div class="line"><span class="lineno"> 1764</span>        }</div>
<div class="line"><span class="lineno"> 1765</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>=0; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>&lt;8; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>++)</div>
<div class="line"><span class="lineno"> 1766</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0; m&lt;10; m++)</div>
<div class="line"><span class="lineno"> 1767</span>        {</div>
<div class="line"><span class="lineno"> 1768</span>          momentsArray[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m] += momentsAcc[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m];</div>
<div class="line"><span class="lineno"> 1769</span>        }</div>
<div class="line"><span class="lineno"> 1770</span>      }</div>
<div class="line"><span class="lineno"> 1771</span>      <span class="keywordflow">if</span>(vectorized)</div>
<div class="line"><span class="lineno"> 1772</span>      {</div>
<div class="line"><span class="lineno"> 1773</span>        <span class="keywordtype">double</span> velmoments[10][8];</div>
<div class="line"><span class="lineno"> 1774</span>        <span class="keywordtype">double</span> weights[8][8];</div>
<div class="line"><span class="lineno"> 1775</span>        <span class="keywordtype">double</span> momentsAccVec[8][10][8];</div>
<div class="line"><span class="lineno"> 1776</span>        memset(momentsAccVec,0,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*8*10*8);</div>
<div class="line"><span class="lineno"> 1777</span><span class="preprocessor">        #pragma simd</span></div>
<div class="line"><span class="lineno"> 1778</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=bucket_offset; i&lt;bucket_end; i++)</div>
<div class="line"><span class="lineno"> 1779</span>        {</div>
<div class="line"><span class="lineno"> 1780</span>          add_moments_for_pcl_vec(momentsAccVec, velmoments, weights,</div>
<div class="line"><span class="lineno"> 1781</span>            i, i%8,</div>
<div class="line"><span class="lineno"> 1782</span>            x, y, z, u, v, w, q,</div>
<div class="line"><span class="lineno"> 1783</span>            xstart, ystart, zstart,</div>
<div class="line"><span class="lineno"> 1784</span>            inv_dx, inv_dy, inv_dz,</div>
<div class="line"><span class="lineno"> 1785</span>            cx, cy, cz);</div>
<div class="line"><span class="lineno"> 1786</span>        }</div>
<div class="line"><span class="lineno"> 1787</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>=0; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>&lt;8; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>++)</div>
<div class="line"><span class="lineno"> 1788</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0; m&lt;10; m++)</div>
<div class="line"><span class="lineno"> 1789</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;8; i++)</div>
<div class="line"><span class="lineno"> 1790</span>        {</div>
<div class="line"><span class="lineno"> 1791</span>          momentsArray[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m] += momentsAccVec[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m][i];</div>
<div class="line"><span class="lineno"> 1792</span>        }</div>
<div class="line"><span class="lineno"> 1793</span>      }</div>
<div class="line"><span class="lineno"> 1794</span>     }</div>
<div class="line"><span class="lineno"> 1795</span>    }</div>
<div class="line"><span class="lineno"> 1796</span><span class="preprocessor">    #pragma omp master</span></div>
<div class="line"><span class="lineno"> 1797</span>    { timeTasks_end_task(TimeTasks::MOMENT_ACCUMULATION); }</div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span>    <span class="comment">// reduction</span></div>
<div class="line"><span class="lineno"> 1800</span><span class="preprocessor">    #pragma omp master</span></div>
<div class="line"><span class="lineno"> 1801</span>    { timeTasks_begin_task(TimeTasks::MOMENT_REDUCTION); }</div>
<div class="line"><span class="lineno"> 1802</span>    {</div>
<div class="line"><span class="lineno"> 1803</span><span class="preprocessor">      #pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno"> 1804</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){</div>
<div class="line"><span class="lineno"> 1805</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++){</div>
<div class="line"><span class="lineno"> 1806</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno"> 1807</span>      {</div>
<div class="line"><span class="lineno"> 1808</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = invVOL*moments[i][j][k][0];</div>
<div class="line"><span class="lineno"> 1809</span>        Jxs  [is][i][j][k] = invVOL*moments[i][j][k][1];</div>
<div class="line"><span class="lineno"> 1810</span>        Jys  [is][i][j][k] = invVOL*moments[i][j][k][2];</div>
<div class="line"><span class="lineno"> 1811</span>        Jzs  [is][i][j][k] = invVOL*moments[i][j][k][3];</div>
<div class="line"><span class="lineno"> 1812</span>        pXXsn[is][i][j][k] = invVOL*moments[i][j][k][4];</div>
<div class="line"><span class="lineno"> 1813</span>        pXYsn[is][i][j][k] = invVOL*moments[i][j][k][5];</div>
<div class="line"><span class="lineno"> 1814</span>        pXZsn[is][i][j][k] = invVOL*moments[i][j][k][6];</div>
<div class="line"><span class="lineno"> 1815</span>        pYYsn[is][i][j][k] = invVOL*moments[i][j][k][7];</div>
<div class="line"><span class="lineno"> 1816</span>        pYZsn[is][i][j][k] = invVOL*moments[i][j][k][8];</div>
<div class="line"><span class="lineno"> 1817</span>        pZZsn[is][i][j][k] = invVOL*moments[i][j][k][9];</div>
<div class="line"><span class="lineno"> 1818</span>      }}}</div>
<div class="line"><span class="lineno"> 1819</span>    }</div>
<div class="line"><span class="lineno"> 1820</span><span class="preprocessor">    #pragma omp master</span></div>
<div class="line"><span class="lineno"> 1821</span>    { timeTasks_end_task(TimeTasks::MOMENT_REDUCTION); }</div>
<div class="line"><span class="lineno"> 1822</span>    <span class="comment">// uncomment this and remove the loop below</span></div>
<div class="line"><span class="lineno"> 1823</span>    <span class="comment">// when we change to use asynchronous communication.</span></div>
<div class="line"><span class="lineno"> 1824</span>    <span class="comment">// communicateGhostP2G(is);</span></div>
<div class="line"><span class="lineno"> 1825</span>  }</div>
<div class="line"><span class="lineno"> 1826</span>  }</div>
<div class="line"><span class="lineno"> 1827</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++)</div>
<div class="line"><span class="lineno"> 1828</span>  {</div>
<div class="line"><span class="lineno"> 1829</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a9f7cfc31e795a75ecaad608f6cb8df25">communicateGhostP2G</a>(i);</div>
<div class="line"><span class="lineno"> 1830</span>  }</div>
<div class="line"><span class="lineno"> 1831</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14d54644c16e9b430a6f3b75d2f27451" name="a14d54644c16e9b430a6f3b75d2f27451"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14d54644c16e9b430a6f3b75d2f27451">&#9670;&nbsp;</a></span>sumMoments_vectorized_AoS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sumMoments_vectorized_AoS </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> *&#160;</td>
          <td class="paramname"><em>part</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l01833">1833</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1834</span>{</div>
<div class="line"><span class="lineno"> 1835</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno"> 1836</span> </div>
<div class="line"><span class="lineno"> 1837</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dx = grid-&gt;get_invdx();</div>
<div class="line"><span class="lineno"> 1838</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dy = grid-&gt;get_invdy();</div>
<div class="line"><span class="lineno"> 1839</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dz = grid-&gt;get_invdz();</div>
<div class="line"><span class="lineno"> 1840</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> = grid-&gt;getNXN();</div>
<div class="line"><span class="lineno"> 1841</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> = grid-&gt;getNYN();</div>
<div class="line"><span class="lineno"> 1842</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> = grid-&gt;getNZN();</div>
<div class="line"><span class="lineno"> 1843</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> xstart = grid-&gt;getXstart();</div>
<div class="line"><span class="lineno"> 1844</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ystart = grid-&gt;getYstart();</div>
<div class="line"><span class="lineno"> 1845</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> zstart = grid-&gt;getZstart();</div>
<div class="line"><span class="lineno"> 1846</span><span class="preprocessor">  #pragma omp parallel</span></div>
<div class="line"><span class="lineno"> 1847</span>  {</div>
<div class="line"><span class="lineno"> 1848</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> species_idx = 0; species_idx &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; species_idx++)</div>
<div class="line"><span class="lineno"> 1849</span>  {</div>
<div class="line"><span class="lineno"> 1850</span>    <span class="keyword">const</span> <a class="code hl_class" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a>&amp; pcls = part[species_idx];</div>
<div class="line"><span class="lineno"> 1851</span>    assert_eq(pcls.get_particleType(), ParticleType::AoS);</div>
<div class="line"><span class="lineno"> 1852</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> is = pcls.get_species_num();</div>
<div class="line"><span class="lineno"> 1853</span>    assert_eq(species_idx,is);</div>
<div class="line"><span class="lineno"> 1854</span> </div>
<div class="line"><span class="lineno"> 1855</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> nop = pcls.getNOP();</div>
<div class="line"><span class="lineno"> 1856</span><span class="preprocessor">    #pragma omp master</span></div>
<div class="line"><span class="lineno"> 1857</span>    { timeTasks_begin_task(TimeTasks::MOMENT_ACCUMULATION); }</div>
<div class="line"><span class="lineno"> 1858</span>    <a class="code hl_class" href="../../d1/d1c/class_moments10.html">Moments10</a>&amp; speciesMoments10 = <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a497e6c49c5f051a364eb1c0972e215df">fetch_moments10Array</a>(0);</div>
<div class="line"><span class="lineno"> 1859</span>    <a class="code hl_class" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> moments = speciesMoments10.fetch_arr();</div>
<div class="line"><span class="lineno"> 1860</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1861</span>    <span class="comment">// moments.setmode(ompmode::ompfor);</span></div>
<div class="line"><span class="lineno"> 1862</span>    <span class="comment">//moments.setall(0.);</span></div>
<div class="line"><span class="lineno"> 1863</span>    <span class="keywordtype">double</span> *moments1d = &amp;moments[0][0][0][0];</div>
<div class="line"><span class="lineno"> 1864</span>    <span class="keywordtype">int</span> moments1dsize = moments.get_size();</div>
<div class="line"><span class="lineno"> 1865</span><span class="preprocessor">    #pragma omp for </span><span class="comment">// because shared</span></div>
<div class="line"><span class="lineno"> 1866</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;moments1dsize; i++) moments1d[i]=0;</div>
<div class="line"><span class="lineno"> 1867</span>    </div>
<div class="line"><span class="lineno"> 1868</span>    <span class="comment">// prevent threads from writing to the same location</span></div>
<div class="line"><span class="lineno"> 1869</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cxmod2=0; cxmod2&lt;2; cxmod2++)</div>
<div class="line"><span class="lineno"> 1870</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cymod2=0; cymod2&lt;2; cymod2++)</div>
<div class="line"><span class="lineno"> 1871</span>    <span class="comment">// each mesh cell is handled by its own thread</span></div>
<div class="line"><span class="lineno"> 1872</span>    #pragma omp <span class="keywordflow">for</span> collapse(2)</div>
<div class="line"><span class="lineno"> 1873</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cx=cxmod2;cx&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a8a76656afeb6d85f3d75e7c0287ffa84">nxc</a>;cx+=2)</div>
<div class="line"><span class="lineno"> 1874</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cy=cymod2;cy&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#aac2a4ca79acb7297ddfe0b152cc546bd">nyc</a>;cy+=2)</div>
<div class="line"><span class="lineno"> 1875</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cz=0;cz&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab8ba4df7252b5aab6ba31fe8e2b9be39">nzc</a>;cz++)</div>
<div class="line"><span class="lineno"> 1876</span>    {</div>
<div class="line"><span class="lineno"> 1877</span>     <span class="comment">//dprint(cz);</span></div>
<div class="line"><span class="lineno"> 1878</span>     <span class="comment">// index of interface to right of cell</span></div>
<div class="line"><span class="lineno"> 1879</span>     <span class="keyword">const</span> <span class="keywordtype">int</span> ix = cx + 1;</div>
<div class="line"><span class="lineno"> 1880</span>     <span class="keyword">const</span> <span class="keywordtype">int</span> iy = cy + 1;</div>
<div class="line"><span class="lineno"> 1881</span>     <span class="keyword">const</span> <span class="keywordtype">int</span> iz = cz + 1;</div>
<div class="line"><span class="lineno"> 1882</span>     {</div>
<div class="line"><span class="lineno"> 1883</span>      <span class="comment">// reference the 8 nodes to which we will</span></div>
<div class="line"><span class="lineno"> 1884</span>      <span class="comment">// write moment data for particles in this mesh cell.</span></div>
<div class="line"><span class="lineno"> 1885</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1886</span>      arr1_double_fetch momentsArray[8];</div>
<div class="line"><span class="lineno"> 1887</span>      arr2_double_fetch moments00 = moments[ix][iy];</div>
<div class="line"><span class="lineno"> 1888</span>      arr2_double_fetch moments01 = moments[ix][cy];</div>
<div class="line"><span class="lineno"> 1889</span>      arr2_double_fetch moments10 = moments[cx][iy];</div>
<div class="line"><span class="lineno"> 1890</span>      arr2_double_fetch moments11 = moments[cx][cy];</div>
<div class="line"><span class="lineno"> 1891</span>      momentsArray[0] = moments00[iz]; <span class="comment">// moments000 </span></div>
<div class="line"><span class="lineno"> 1892</span>      momentsArray[1] = moments00[cz]; <span class="comment">// moments001 </span></div>
<div class="line"><span class="lineno"> 1893</span>      momentsArray[2] = moments01[iz]; <span class="comment">// moments010 </span></div>
<div class="line"><span class="lineno"> 1894</span>      momentsArray[3] = moments01[cz]; <span class="comment">// moments011 </span></div>
<div class="line"><span class="lineno"> 1895</span>      momentsArray[4] = moments10[iz]; <span class="comment">// moments100 </span></div>
<div class="line"><span class="lineno"> 1896</span>      momentsArray[5] = moments10[cz]; <span class="comment">// moments101 </span></div>
<div class="line"><span class="lineno"> 1897</span>      momentsArray[6] = moments11[iz]; <span class="comment">// moments110 </span></div>
<div class="line"><span class="lineno"> 1898</span>      momentsArray[7] = moments11[cz]; <span class="comment">// moments111 </span></div>
<div class="line"><span class="lineno"> 1899</span> </div>
<div class="line"><span class="lineno"> 1900</span>      <span class="comment">// accumulator for moments per each of 8 threads</span></div>
<div class="line"><span class="lineno"> 1901</span>      <span class="keywordtype">double</span> momentsAcc[8][10][8];</div>
<div class="line"><span class="lineno"> 1902</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> numpcls_in_cell = pcls.get_numpcls_in_bucket(cx,cy,cz);</div>
<div class="line"><span class="lineno"> 1903</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> bucket_offset = pcls.get_bucket_offset(cx,cy,cz);</div>
<div class="line"><span class="lineno"> 1904</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> bucket_end = bucket_offset+numpcls_in_cell;</div>
<div class="line"><span class="lineno"> 1905</span> </div>
<div class="line"><span class="lineno"> 1906</span>      <span class="comment">// data is not stride-1, so we do *not* use</span></div>
<div class="line"><span class="lineno"> 1907</span>      <span class="comment">// #pragma simd</span></div>
<div class="line"><span class="lineno"> 1908</span>      {</div>
<div class="line"><span class="lineno"> 1909</span>        <span class="comment">// accumulators for moments per each of 8 threads</span></div>
<div class="line"><span class="lineno"> 1910</span>        <span class="keywordtype">double</span> momentsAcc[8][10];</div>
<div class="line"><span class="lineno"> 1911</span>        memset(momentsAcc,0,<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)*8*10);</div>
<div class="line"><span class="lineno"> 1912</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> pidx=bucket_offset; pidx&lt;bucket_end; pidx++)</div>
<div class="line"><span class="lineno"> 1913</span>        {</div>
<div class="line"><span class="lineno"> 1914</span>          <span class="keyword">const</span> <a class="code hl_class" href="../../d8/d2e/class_species_particle.html">SpeciesParticle</a>* pcl = &amp;pcls.get_pcl(pidx);</div>
<div class="line"><span class="lineno"> 1915</span>          <span class="comment">// This depends on the fact that the memory</span></div>
<div class="line"><span class="lineno"> 1916</span>          <span class="comment">// occupied by a particle coincides with</span></div>
<div class="line"><span class="lineno"> 1917</span>          <span class="comment">// the alignment interval (64 bytes)</span></div>
<div class="line"><span class="lineno"> 1918</span>          ALIGNED(pcl);</div>
<div class="line"><span class="lineno"> 1919</span>          <span class="keywordtype">double</span> velmoments[10];</div>
<div class="line"><span class="lineno"> 1920</span>          <span class="keywordtype">double</span> weights[8];</div>
<div class="line"><span class="lineno"> 1921</span>          <span class="comment">// compute the quadratic moments of velocity</span></div>
<div class="line"><span class="lineno"> 1922</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1923</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> ui=pcl-&gt;get_u();</div>
<div class="line"><span class="lineno"> 1924</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> vi=pcl-&gt;get_v();</div>
<div class="line"><span class="lineno"> 1925</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> wi=pcl-&gt;get_w();</div>
<div class="line"><span class="lineno"> 1926</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> uui=ui*ui;</div>
<div class="line"><span class="lineno"> 1927</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> uvi=ui*vi;</div>
<div class="line"><span class="lineno"> 1928</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> uwi=ui*wi;</div>
<div class="line"><span class="lineno"> 1929</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> vvi=vi*vi;</div>
<div class="line"><span class="lineno"> 1930</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> vwi=vi*wi;</div>
<div class="line"><span class="lineno"> 1931</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> wwi=wi*wi;</div>
<div class="line"><span class="lineno"> 1932</span>          <span class="comment">//double velmoments[10];</span></div>
<div class="line"><span class="lineno"> 1933</span>          velmoments[0] = 1.;</div>
<div class="line"><span class="lineno"> 1934</span>          velmoments[1] = ui;</div>
<div class="line"><span class="lineno"> 1935</span>          velmoments[2] = vi;</div>
<div class="line"><span class="lineno"> 1936</span>          velmoments[3] = wi;</div>
<div class="line"><span class="lineno"> 1937</span>          velmoments[4] = uui;</div>
<div class="line"><span class="lineno"> 1938</span>          velmoments[5] = uvi;</div>
<div class="line"><span class="lineno"> 1939</span>          velmoments[6] = uwi;</div>
<div class="line"><span class="lineno"> 1940</span>          velmoments[7] = vvi;</div>
<div class="line"><span class="lineno"> 1941</span>          velmoments[8] = vwi;</div>
<div class="line"><span class="lineno"> 1942</span>          velmoments[9] = wwi;</div>
<div class="line"><span class="lineno"> 1943</span>        </div>
<div class="line"><span class="lineno"> 1944</span>          <span class="comment">// compute the weights to distribute the moments</span></div>
<div class="line"><span class="lineno"> 1945</span>          <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1946</span>          <span class="comment">//double weights[8];</span></div>
<div class="line"><span class="lineno"> 1947</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> abs_xpos = pcl-&gt;get_x();</div>
<div class="line"><span class="lineno"> 1948</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> abs_ypos = pcl-&gt;get_y();</div>
<div class="line"><span class="lineno"> 1949</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> abs_zpos = pcl-&gt;get_z();</div>
<div class="line"><span class="lineno"> 1950</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> rel_xpos = abs_xpos - xstart;</div>
<div class="line"><span class="lineno"> 1951</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> rel_ypos = abs_ypos - ystart;</div>
<div class="line"><span class="lineno"> 1952</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> rel_zpos = abs_zpos - zstart;</div>
<div class="line"><span class="lineno"> 1953</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> cxm1_pos = rel_xpos * inv_dx;</div>
<div class="line"><span class="lineno"> 1954</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> cym1_pos = rel_ypos * inv_dy;</div>
<div class="line"><span class="lineno"> 1955</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> czm1_pos = rel_zpos * inv_dz;</div>
<div class="line"><span class="lineno"> 1956</span>          <span class="comment">//if(true)</span></div>
<div class="line"><span class="lineno"> 1957</span>          <span class="comment">//{</span></div>
<div class="line"><span class="lineno"> 1958</span>          <span class="comment">//  const int cx_inf = int(floor(cxm1_pos));</span></div>
<div class="line"><span class="lineno"> 1959</span>          <span class="comment">//  const int cy_inf = int(floor(cym1_pos));</span></div>
<div class="line"><span class="lineno"> 1960</span>          <span class="comment">//  const int cz_inf = int(floor(czm1_pos));</span></div>
<div class="line"><span class="lineno"> 1961</span>          <span class="comment">//  assert_eq(cx-1,cx_inf);</span></div>
<div class="line"><span class="lineno"> 1962</span>          <span class="comment">//  assert_eq(cy-1,cy_inf);</span></div>
<div class="line"><span class="lineno"> 1963</span>          <span class="comment">//  assert_eq(cz-1,cz_inf);</span></div>
<div class="line"><span class="lineno"> 1964</span>          <span class="comment">//}</span></div>
<div class="line"><span class="lineno"> 1965</span>          <span class="comment">// fraction of the distance from the right of the cell</span></div>
<div class="line"><span class="lineno"> 1966</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> w1x = cx - cxm1_pos;</div>
<div class="line"><span class="lineno"> 1967</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> w1y = cy - cym1_pos;</div>
<div class="line"><span class="lineno"> 1968</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> w1z = cz - czm1_pos;</div>
<div class="line"><span class="lineno"> 1969</span>          <span class="comment">// fraction of distance from the left</span></div>
<div class="line"><span class="lineno"> 1970</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> w0x = 1-w1x;</div>
<div class="line"><span class="lineno"> 1971</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> w0y = 1-w1y;</div>
<div class="line"><span class="lineno"> 1972</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> w0z = 1-w1z;</div>
<div class="line"><span class="lineno"> 1973</span>          <span class="comment">// we are calculating a charge moment.</span></div>
<div class="line"><span class="lineno"> 1974</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> qi=pcl-&gt;get_q();</div>
<div class="line"><span class="lineno"> 1975</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> weight0 = qi*w0x;</div>
<div class="line"><span class="lineno"> 1976</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> weight1 = qi*w1x;</div>
<div class="line"><span class="lineno"> 1977</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> weight00 = weight0*w0y;</div>
<div class="line"><span class="lineno"> 1978</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> weight01 = weight0*w1y;</div>
<div class="line"><span class="lineno"> 1979</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> weight10 = weight1*w0y;</div>
<div class="line"><span class="lineno"> 1980</span>          <span class="keyword">const</span> <span class="keywordtype">double</span> weight11 = weight1*w1y;</div>
<div class="line"><span class="lineno"> 1981</span>          weights[0] = weight00*w0z; <span class="comment">// weight000</span></div>
<div class="line"><span class="lineno"> 1982</span>          weights[1] = weight00*w1z; <span class="comment">// weight001</span></div>
<div class="line"><span class="lineno"> 1983</span>          weights[2] = weight01*w0z; <span class="comment">// weight010</span></div>
<div class="line"><span class="lineno"> 1984</span>          weights[3] = weight01*w1z; <span class="comment">// weight011</span></div>
<div class="line"><span class="lineno"> 1985</span>          weights[4] = weight10*w0z; <span class="comment">// weight100</span></div>
<div class="line"><span class="lineno"> 1986</span>          weights[5] = weight10*w1z; <span class="comment">// weight101</span></div>
<div class="line"><span class="lineno"> 1987</span>          weights[6] = weight11*w0z; <span class="comment">// weight110</span></div>
<div class="line"><span class="lineno"> 1988</span>          weights[7] = weight11*w1z; <span class="comment">// weight111</span></div>
<div class="line"><span class="lineno"> 1989</span>        </div>
<div class="line"><span class="lineno"> 1990</span>          <span class="comment">// add moments for this particle</span></div>
<div class="line"><span class="lineno"> 1991</span>          {</div>
<div class="line"><span class="lineno"> 1992</span>            <span class="comment">// which is the superior order for the following loop?</span></div>
<div class="line"><span class="lineno"> 1993</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>=0; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>&lt;8; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>++)</div>
<div class="line"><span class="lineno"> 1994</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0; m&lt;10; m++)</div>
<div class="line"><span class="lineno"> 1995</span>            {</div>
<div class="line"><span class="lineno"> 1996</span>              momentsAcc[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m] += velmoments[m]*weights[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>];</div>
<div class="line"><span class="lineno"> 1997</span>            }</div>
<div class="line"><span class="lineno"> 1998</span>          }</div>
<div class="line"><span class="lineno"> 1999</span>        }</div>
<div class="line"><span class="lineno"> 2000</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>=0; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>&lt;8; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>++)</div>
<div class="line"><span class="lineno"> 2001</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0; m&lt;10; m++)</div>
<div class="line"><span class="lineno"> 2002</span>        {</div>
<div class="line"><span class="lineno"> 2003</span>          momentsArray[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m] += momentsAcc[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m];</div>
<div class="line"><span class="lineno"> 2004</span>        }</div>
<div class="line"><span class="lineno"> 2005</span>      }</div>
<div class="line"><span class="lineno"> 2006</span>     }</div>
<div class="line"><span class="lineno"> 2007</span>    }</div>
<div class="line"><span class="lineno"> 2008</span><span class="preprocessor">    #pragma omp master</span></div>
<div class="line"><span class="lineno"> 2009</span>    { timeTasks_end_task(TimeTasks::MOMENT_ACCUMULATION); }</div>
<div class="line"><span class="lineno"> 2010</span> </div>
<div class="line"><span class="lineno"> 2011</span>    <span class="comment">// reduction</span></div>
<div class="line"><span class="lineno"> 2012</span><span class="preprocessor">    #pragma omp master</span></div>
<div class="line"><span class="lineno"> 2013</span>    { timeTasks_begin_task(TimeTasks::MOMENT_REDUCTION); }</div>
<div class="line"><span class="lineno"> 2014</span>    {</div>
<div class="line"><span class="lineno"> 2015</span><span class="preprocessor">      #pragma omp for collapse(2)</span></div>
<div class="line"><span class="lineno"> 2016</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){</div>
<div class="line"><span class="lineno"> 2017</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++){</div>
<div class="line"><span class="lineno"> 2018</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno"> 2019</span>      {</div>
<div class="line"><span class="lineno"> 2020</span>        <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] = invVOL*moments[i][j][k][0];</div>
<div class="line"><span class="lineno"> 2021</span>        Jxs  [is][i][j][k] = invVOL*moments[i][j][k][1];</div>
<div class="line"><span class="lineno"> 2022</span>        Jys  [is][i][j][k] = invVOL*moments[i][j][k][2];</div>
<div class="line"><span class="lineno"> 2023</span>        Jzs  [is][i][j][k] = invVOL*moments[i][j][k][3];</div>
<div class="line"><span class="lineno"> 2024</span>        pXXsn[is][i][j][k] = invVOL*moments[i][j][k][4];</div>
<div class="line"><span class="lineno"> 2025</span>        pXYsn[is][i][j][k] = invVOL*moments[i][j][k][5];</div>
<div class="line"><span class="lineno"> 2026</span>        pXZsn[is][i][j][k] = invVOL*moments[i][j][k][6];</div>
<div class="line"><span class="lineno"> 2027</span>        pYYsn[is][i][j][k] = invVOL*moments[i][j][k][7];</div>
<div class="line"><span class="lineno"> 2028</span>        pYZsn[is][i][j][k] = invVOL*moments[i][j][k][8];</div>
<div class="line"><span class="lineno"> 2029</span>        pZZsn[is][i][j][k] = invVOL*moments[i][j][k][9];</div>
<div class="line"><span class="lineno"> 2030</span>      }}}</div>
<div class="line"><span class="lineno"> 2031</span>    }</div>
<div class="line"><span class="lineno"> 2032</span><span class="preprocessor">    #pragma omp master</span></div>
<div class="line"><span class="lineno"> 2033</span>    { timeTasks_end_task(TimeTasks::MOMENT_REDUCTION); }</div>
<div class="line"><span class="lineno"> 2034</span>    <span class="comment">// uncomment this and remove the loop below</span></div>
<div class="line"><span class="lineno"> 2035</span>    <span class="comment">// when we change to use asynchronous communication.</span></div>
<div class="line"><span class="lineno"> 2036</span>    <span class="comment">// communicateGhostP2G(is);</span></div>
<div class="line"><span class="lineno"> 2037</span>  }</div>
<div class="line"><span class="lineno"> 2038</span>  }</div>
<div class="line"><span class="lineno"> 2039</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; i++)</div>
<div class="line"><span class="lineno"> 2040</span>  {</div>
<div class="line"><span class="lineno"> 2041</span>    <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a9f7cfc31e795a75ecaad608f6cb8df25">communicateGhostP2G</a>(i);</div>
<div class="line"><span class="lineno"> 2042</span>  }</div>
<div class="line"><span class="lineno"> 2043</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a2362220c53328d811ae1d26953693c" name="a0a2362220c53328d811ae1d26953693c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a2362220c53328d811ae1d26953693c">&#9670;&nbsp;</a></span>sumMomentsOld()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sumMomentsOld </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d1/da6/class_particles3_dcomm.html">Particles3Dcomm</a> &amp;&#160;</td>
          <td class="paramname"><em>pcls</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00401">401</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  402</span>{</div>
<div class="line"><span class="lineno">  403</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a> *grid = &amp;get_grid();</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dx = 1.0 / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac2608a0f00c2dac18a7d73417ca2c591">dx</a>;</div>
<div class="line"><span class="lineno">  406</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dy = 1.0 / dy;</div>
<div class="line"><span class="lineno">  407</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> inv_dz = 1.0 / dz;</div>
<div class="line"><span class="lineno">  408</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> = grid-&gt;getNXN();</div>
<div class="line"><span class="lineno">  409</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> = grid-&gt;getNYN();</div>
<div class="line"><span class="lineno">  410</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> = grid-&gt;getNZN();</div>
<div class="line"><span class="lineno">  411</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> xstart = grid-&gt;getXstart();</div>
<div class="line"><span class="lineno">  412</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> ystart = grid-&gt;getYstart();</div>
<div class="line"><span class="lineno">  413</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> zstart = grid-&gt;getZstart();</div>
<div class="line"><span class="lineno">  414</span>  <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> x = pcls.getXall();</div>
<div class="line"><span class="lineno">  415</span>  <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> y = pcls.getYall();</div>
<div class="line"><span class="lineno">  416</span>  <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> z = pcls.getZall();</div>
<div class="line"><span class="lineno">  417</span>  <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> u = pcls.getUall();</div>
<div class="line"><span class="lineno">  418</span>  <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> v = pcls.getVall();</div>
<div class="line"><span class="lineno">  419</span>  <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> w = pcls.getWall();</div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordtype">double</span> <span class="keyword">const</span>*<span class="keyword">const</span> q = pcls.getQall();</div>
<div class="line"><span class="lineno">  421</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  422</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> is = pcls.get_species_num();</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nop = pcls.getNOP();</div>
<div class="line"><span class="lineno">  425</span>  <span class="comment">// To make memory use scale to a large number of threads, we</span></div>
<div class="line"><span class="lineno">  426</span>  <span class="comment">// could first apply an efficient parallel sorting algorithm</span></div>
<div class="line"><span class="lineno">  427</span>  <span class="comment">// to the particles and then accumulate moments in smaller</span></div>
<div class="line"><span class="lineno">  428</span>  <span class="comment">// subarrays.</span></div>
<div class="line"><span class="lineno">  429</span>  <span class="comment">//#ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  430</span>  <a class="code hl_class" href="../../d6/d68/class_time_tasks.html">TimeTasks</a> timeTasksAcc;</div>
<div class="line"><span class="lineno">  431</span><span class="preprocessor">  #pragma omp parallel private(timeTasks)</span></div>
<div class="line"><span class="lineno">  432</span>  {</div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordtype">int</span> thread_num = omp_get_thread_num();</div>
<div class="line"><span class="lineno">  434</span>    <a class="code hl_class" href="../../d1/d1c/class_moments10.html">Moments10</a>&amp; speciesMoments10 = <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a497e6c49c5f051a364eb1c0972e215df">fetch_moments10Array</a>(thread_num);</div>
<div class="line"><span class="lineno">  435</span>    speciesMoments10.set_to_zero();</div>
<div class="line"><span class="lineno">  436</span>    <a class="code hl_class" href="../../dc/d69/classi_pic3_d_1_1array__ref4.html">arr4_double</a> moments = speciesMoments10.fetch_arr();</div>
<div class="line"><span class="lineno">  437</span>    <span class="comment">// The following loop is expensive, so it is wise to assume that the</span></div>
<div class="line"><span class="lineno">  438</span>    <span class="comment">// compiler is stupid.  Therefore we should on the one hand</span></div>
<div class="line"><span class="lineno">  439</span>    <span class="comment">// expand things out and on the other hand avoid repeating computations.</span></div>
<div class="line"><span class="lineno">  440</span><span class="preprocessor">    #pragma omp for</span></div>
<div class="line"><span class="lineno">  441</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nop; i++)</div>
<div class="line"><span class="lineno">  442</span>    {</div>
<div class="line"><span class="lineno">  443</span>      <span class="comment">// compute the quadratic moments of velocity</span></div>
<div class="line"><span class="lineno">  444</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  445</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> ui=u[i];</div>
<div class="line"><span class="lineno">  446</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vi=v[i];</div>
<div class="line"><span class="lineno">  447</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> wi=w[i];</div>
<div class="line"><span class="lineno">  448</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> uui=ui*ui;</div>
<div class="line"><span class="lineno">  449</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> uvi=ui*vi;</div>
<div class="line"><span class="lineno">  450</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> uwi=ui*wi;</div>
<div class="line"><span class="lineno">  451</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vvi=vi*vi;</div>
<div class="line"><span class="lineno">  452</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> vwi=vi*wi;</div>
<div class="line"><span class="lineno">  453</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> wwi=wi*wi;</div>
<div class="line"><span class="lineno">  454</span>      <span class="keywordtype">double</span> velmoments[10];</div>
<div class="line"><span class="lineno">  455</span>      velmoments[0] = 1.;</div>
<div class="line"><span class="lineno">  456</span>      velmoments[1] = ui;</div>
<div class="line"><span class="lineno">  457</span>      velmoments[2] = vi;</div>
<div class="line"><span class="lineno">  458</span>      velmoments[3] = wi;</div>
<div class="line"><span class="lineno">  459</span>      velmoments[4] = uui;</div>
<div class="line"><span class="lineno">  460</span>      velmoments[5] = uvi;</div>
<div class="line"><span class="lineno">  461</span>      velmoments[6] = uwi;</div>
<div class="line"><span class="lineno">  462</span>      velmoments[7] = vvi;</div>
<div class="line"><span class="lineno">  463</span>      velmoments[8] = vwi;</div>
<div class="line"><span class="lineno">  464</span>      velmoments[9] = wwi;</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  467</span>      <span class="comment">// compute the weights to distribute the moments</span></div>
<div class="line"><span class="lineno">  468</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  469</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> ix = 2 + int (floor((x[i] - xstart) * inv_dx));</div>
<div class="line"><span class="lineno">  470</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> iy = 2 + int (floor((y[i] - ystart) * inv_dy));</div>
<div class="line"><span class="lineno">  471</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> iz = 2 + int (floor((z[i] - zstart) * inv_dz));</div>
<div class="line"><span class="lineno">  472</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> xi0   = x[i] - grid-&gt;getXN(ix-1);</div>
<div class="line"><span class="lineno">  473</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> eta0  = y[i] - grid-&gt;getYN(iy-1);</div>
<div class="line"><span class="lineno">  474</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zeta0 = z[i] - grid-&gt;getZN(iz-1);</div>
<div class="line"><span class="lineno">  475</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> xi1   = grid-&gt;getXN(ix) - x[i];</div>
<div class="line"><span class="lineno">  476</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> eta1  = grid-&gt;getYN(iy) - y[i];</div>
<div class="line"><span class="lineno">  477</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> zeta1 = grid-&gt;getZN(iz) - z[i];</div>
<div class="line"><span class="lineno">  478</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> qi = q[i];</div>
<div class="line"><span class="lineno">  479</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight000 = qi * xi0 * eta0 * zeta0 * invVOL;</div>
<div class="line"><span class="lineno">  480</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight001 = qi * xi0 * eta0 * zeta1 * invVOL;</div>
<div class="line"><span class="lineno">  481</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight010 = qi * xi0 * eta1 * zeta0 * invVOL;</div>
<div class="line"><span class="lineno">  482</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight011 = qi * xi0 * eta1 * zeta1 * invVOL;</div>
<div class="line"><span class="lineno">  483</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight100 = qi * xi1 * eta0 * zeta0 * invVOL;</div>
<div class="line"><span class="lineno">  484</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight101 = qi * xi1 * eta0 * zeta1 * invVOL;</div>
<div class="line"><span class="lineno">  485</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight110 = qi * xi1 * eta1 * zeta0 * invVOL;</div>
<div class="line"><span class="lineno">  486</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> weight111 = qi * xi1 * eta1 * zeta1 * invVOL;</div>
<div class="line"><span class="lineno">  487</span>      <span class="keywordtype">double</span> weights[8];</div>
<div class="line"><span class="lineno">  488</span>      weights[0] = weight000;</div>
<div class="line"><span class="lineno">  489</span>      weights[1] = weight001;</div>
<div class="line"><span class="lineno">  490</span>      weights[2] = weight010;</div>
<div class="line"><span class="lineno">  491</span>      weights[3] = weight011;</div>
<div class="line"><span class="lineno">  492</span>      weights[4] = weight100;</div>
<div class="line"><span class="lineno">  493</span>      weights[5] = weight101;</div>
<div class="line"><span class="lineno">  494</span>      weights[6] = weight110;</div>
<div class="line"><span class="lineno">  495</span>      weights[7] = weight111;</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>      <span class="comment">// add particle to moments</span></div>
<div class="line"><span class="lineno">  498</span>      {</div>
<div class="line"><span class="lineno">  499</span>        arr1_double_fetch momentsArray[8];</div>
<div class="line"><span class="lineno">  500</span>        momentsArray[0] = moments[ix  ][iy  ][iz  ]; <span class="comment">// moments000 </span></div>
<div class="line"><span class="lineno">  501</span>        momentsArray[1] = moments[ix  ][iy  ][iz-1]; <span class="comment">// moments001 </span></div>
<div class="line"><span class="lineno">  502</span>        momentsArray[2] = moments[ix  ][iy-1][iz  ]; <span class="comment">// moments010 </span></div>
<div class="line"><span class="lineno">  503</span>        momentsArray[3] = moments[ix  ][iy-1][iz-1]; <span class="comment">// moments011 </span></div>
<div class="line"><span class="lineno">  504</span>        momentsArray[4] = moments[ix-1][iy  ][iz  ]; <span class="comment">// moments100 </span></div>
<div class="line"><span class="lineno">  505</span>        momentsArray[5] = moments[ix-1][iy  ][iz-1]; <span class="comment">// moments101 </span></div>
<div class="line"><span class="lineno">  506</span>        momentsArray[6] = moments[ix-1][iy-1][iz  ]; <span class="comment">// moments110 </span></div>
<div class="line"><span class="lineno">  507</span>        momentsArray[7] = moments[ix-1][iy-1][iz-1]; <span class="comment">// moments111 </span></div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0; m&lt;10; m++)</div>
<div class="line"><span class="lineno">  510</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>=0; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>&lt;8; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>++)</div>
<div class="line"><span class="lineno">  511</span>        {</div>
<div class="line"><span class="lineno">  512</span>          momentsArray[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>][m] += velmoments[m]*weights[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>];</div>
<div class="line"><span class="lineno">  513</span>        }</div>
<div class="line"><span class="lineno">  514</span>      }</div>
<div class="line"><span class="lineno">  515</span>    }</div>
<div class="line"><span class="lineno">  516</span>    </div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>    <span class="comment">// reduction</span></div>
<div class="line"><span class="lineno">  519</span>    </div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>    <span class="comment">// reduce arrays</span></div>
<div class="line"><span class="lineno">  522</span>    {</div>
<div class="line"><span class="lineno">  523</span><span class="preprocessor">      #pragma omp critical (reduceMoment0)</span></div>
<div class="line"><span class="lineno">  524</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  525</span>        { <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k] += invVOL*moments[i][j][k][0]; }}</div>
<div class="line"><span class="lineno">  526</span><span class="preprocessor">      #pragma omp critical (reduceMoment1)</span></div>
<div class="line"><span class="lineno">  527</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  528</span>        { Jxs  [is][i][j][k] += invVOL*moments[i][j][k][1]; }}</div>
<div class="line"><span class="lineno">  529</span><span class="preprocessor">      #pragma omp critical (reduceMoment2)</span></div>
<div class="line"><span class="lineno">  530</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  531</span>        { Jys  [is][i][j][k] += invVOL*moments[i][j][k][2]; }}</div>
<div class="line"><span class="lineno">  532</span><span class="preprocessor">      #pragma omp critical (reduceMoment3)</span></div>
<div class="line"><span class="lineno">  533</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  534</span>        { Jzs  [is][i][j][k] += invVOL*moments[i][j][k][3]; }}</div>
<div class="line"><span class="lineno">  535</span><span class="preprocessor">      #pragma omp critical (reduceMoment4)</span></div>
<div class="line"><span class="lineno">  536</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  537</span>        { pXXsn[is][i][j][k] += invVOL*moments[i][j][k][4]; }}</div>
<div class="line"><span class="lineno">  538</span><span class="preprocessor">      #pragma omp critical (reduceMoment5)</span></div>
<div class="line"><span class="lineno">  539</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  540</span>        { pXYsn[is][i][j][k] += invVOL*moments[i][j][k][5]; }}</div>
<div class="line"><span class="lineno">  541</span><span class="preprocessor">      #pragma omp critical (reduceMoment6)</span></div>
<div class="line"><span class="lineno">  542</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  543</span>        { pXZsn[is][i][j][k] += invVOL*moments[i][j][k][6]; }}</div>
<div class="line"><span class="lineno">  544</span><span class="preprocessor">      #pragma omp critical (reduceMoment7)</span></div>
<div class="line"><span class="lineno">  545</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  546</span>        { pYYsn[is][i][j][k] += invVOL*moments[i][j][k][7]; }}</div>
<div class="line"><span class="lineno">  547</span><span class="preprocessor">      #pragma omp critical (reduceMoment8)</span></div>
<div class="line"><span class="lineno">  548</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  549</span>        { pYZsn[is][i][j][k] += invVOL*moments[i][j][k][8]; }}</div>
<div class="line"><span class="lineno">  550</span><span class="preprocessor">      #pragma omp critical (reduceMoment9)</span></div>
<div class="line"><span class="lineno">  551</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>;i++){<span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>;j++) <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>;k++)</div>
<div class="line"><span class="lineno">  552</span>        { pZZsn[is][i][j][k] += invVOL*moments[i][j][k][9]; }}</div>
<div class="line"><span class="lineno">  553</span>    }</div>
<div class="line"><span class="lineno">  554</span>    </div>
<div class="line"><span class="lineno">  555</span><span class="preprocessor">    #pragma omp critical</span></div>
<div class="line"><span class="lineno">  556</span>    timeTasksAcc += timeTasks;</div>
<div class="line"><span class="lineno">  557</span>  }</div>
<div class="line"><span class="lineno">  558</span>  <span class="comment">// reset timeTasks to be its average value for all threads</span></div>
<div class="line"><span class="lineno">  559</span>  timeTasksAcc /= omp_get_max_threads();</div>
<div class="line"><span class="lineno">  560</span>  timeTasks = timeTasksAcc;</div>
<div class="line"><span class="lineno">  561</span>  <a class="code hl_function" href="../../dd/da6/class_e_mfields3_d.html#a9f7cfc31e795a75ecaad608f6cb8df25">communicateGhostP2G</a>(is);</div>
<div class="line"><span class="lineno">  562</span>}</div>
<div class="ttc" id="aclass_time_tasks_html"><div class="ttname"><a href="../../d6/d68/class_time_tasks.html">TimeTasks</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/de5/_time_tasks_8h_source.html#l00033">TimeTasks.h:34</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30e3d07ce73eeef91b4e6f7d1d604f28" name="a30e3d07ce73eeef91b4e6f7d1d604f28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30e3d07ce73eeef91b4e6f7d1d604f28">&#9670;&nbsp;</a></span>sumOverSpecies()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sumOverSpecies </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Sum rhon over species</p>
<p >SPECIES: Sum the charge density of different species on NODES </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03460">3460</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3461</span>{</div>
<div class="line"><span class="lineno"> 3462</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3463</span>    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3464</span>      <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3465</span>        <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++)</div>
<div class="line"><span class="lineno"> 3466</span>          <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ac154c0bebb127df531138a846cfde8e3">rhon</a>[i][j][k] += <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][k];</div>
<div class="line"><span class="lineno"> 3467</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00477">rhon</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

</div>
</div>
<a id="aff1a781c05a7b98517efabdf6352a547" name="aff1a781c05a7b98517efabdf6352a547"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff1a781c05a7b98517efabdf6352a547">&#9670;&nbsp;</a></span>sumOverSpeciesJ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sumOverSpeciesJ </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Sum current over different species</p>
<p >SPECIES: Sum current density for different species </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03470">3470</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3470</span>                                 {</div>
<div class="line"><span class="lineno"> 3471</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++)</div>
<div class="line"><span class="lineno"> 3472</span>    <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 3473</span>      <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 3474</span>        <span class="keywordflow">for</span> (<span class="keyword">register</span> <span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 3475</span>          Jx[i][j][k] += Jxs[is][i][j][k];</div>
<div class="line"><span class="lineno"> 3476</span>          Jy[i][j][k] += Jys[is][i][j][k];</div>
<div class="line"><span class="lineno"> 3477</span>          Jz[i][j][k] += Jzs[is][i][j][k];</div>
<div class="line"><span class="lineno"> 3478</span>        }</div>
<div class="line"><span class="lineno"> 3479</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d9/d0e/_p_s_k_output_8h_source.html#l00353">myOutputAgent&lt; Toa &gt;::output()</a>.</p>

</div>
</div>
<a id="a7cd4c1659be3a8e65c3f42f386b2364f" name="a7cd4c1659be3a8e65c3f42f386b2364f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cd4c1659be3a8e65c3f42f386b2364f">&#9670;&nbsp;</a></span>sustensorLeftX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sustensorLeftX </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susyx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>suszx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the susceptibility on the boundary leftX </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">4687</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4687</span>                                                                              {</div>
<div class="line"><span class="lineno"> 4688</span>  <span class="keywordtype">double</span> beta, omcx, omcy, omcz, denom;</div>
<div class="line"><span class="lineno"> 4689</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 4690</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4691</span>      susxx[j][k] = 1.0;</div>
<div class="line"><span class="lineno"> 4692</span>      susyx[j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4693</span>      suszx[j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4694</span>    }</div>
<div class="line"><span class="lineno"> 4695</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4696</span>    beta = .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>;</div>
<div class="line"><span class="lineno"> 4697</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 4698</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4699</span>        omcx = beta * (Bxn[1][j][k]+Bx_ext[1][j][k]);</div>
<div class="line"><span class="lineno"> 4700</span>        omcy = beta * (Byn[1][j][k]+By_ext[1][j][k]);</div>
<div class="line"><span class="lineno"> 4701</span>        omcz = beta * (Bzn[1][j][k]+Bz_ext[1][j][k]);</div>
<div class="line"><span class="lineno"> 4702</span>        denom = FourPI / 2 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][1][j][k] / (1.0 + omcx * omcx + omcy * omcy + omcz * omcz);</div>
<div class="line"><span class="lineno"> 4703</span>        susxx[j][k] += (  1.0 + omcx * omcx) * denom;</div>
<div class="line"><span class="lineno"> 4704</span>        susyx[j][k] += (-omcz + omcx * omcy) * denom;</div>
<div class="line"><span class="lineno"> 4705</span>        suszx[j][k] += ( omcy + omcx * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4706</span>      }</div>
<div class="line"><span class="lineno"> 4707</span>  }</div>
<div class="line"><span class="lineno"> 4708</span> </div>
<div class="line"><span class="lineno"> 4709</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">delt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">perfectConductorLeft()</a>.</p>

</div>
</div>
<a id="a21a5816d7eb991b7c9a61c7e90279160" name="a21a5816d7eb991b7c9a61c7e90279160"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21a5816d7eb991b7c9a61c7e90279160">&#9670;&nbsp;</a></span>sustensorLeftY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sustensorLeftY </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susxy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susyy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>suszy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the susceptibility on the boundary left </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">4735</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4735</span>                                                                              {</div>
<div class="line"><span class="lineno"> 4736</span>  <span class="keywordtype">double</span> beta, omcx, omcy, omcz, denom;</div>
<div class="line"><span class="lineno"> 4737</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4738</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4739</span>      susxy[i][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4740</span>      susyy[i][k] = 1.0;</div>
<div class="line"><span class="lineno"> 4741</span>      suszy[i][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4742</span>    }</div>
<div class="line"><span class="lineno"> 4743</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4744</span>    beta = .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>;</div>
<div class="line"><span class="lineno"> 4745</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4746</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4747</span>        omcx = beta * (Bxn[i][1][k]+Bx_ext[i][1][k]);</div>
<div class="line"><span class="lineno"> 4748</span>        omcy = beta * (Byn[i][1][k]+By_ext[i][1][k]);</div>
<div class="line"><span class="lineno"> 4749</span>        omcz = beta * (Bzn[i][1][k]+Bz_ext[i][1][k]);</div>
<div class="line"><span class="lineno"> 4750</span>        denom = FourPI / 2 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][1][k] / (1.0 + omcx * omcx + omcy * omcy + omcz * omcz);</div>
<div class="line"><span class="lineno"> 4751</span>        susxy[i][k] += ( omcz + omcx * omcy) * denom;</div>
<div class="line"><span class="lineno"> 4752</span>        susyy[i][k] += (  1.0 + omcy * omcy) * denom;</div>
<div class="line"><span class="lineno"> 4753</span>        suszy[i][k] += (-omcx + omcy * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4754</span>      }</div>
<div class="line"><span class="lineno"> 4755</span>  }</div>
<div class="line"><span class="lineno"> 4756</span> </div>
<div class="line"><span class="lineno"> 4757</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">delt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">perfectConductorLeft()</a>.</p>

</div>
</div>
<a id="aff9869a55d3b0bef113147abd0819667" name="aff9869a55d3b0bef113147abd0819667"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff9869a55d3b0bef113147abd0819667">&#9670;&nbsp;</a></span>sustensorLeftZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sustensorLeftZ </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susxz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>suszz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the susceptibility on the boundary left </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">4783</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4783</span>                                                                              {</div>
<div class="line"><span class="lineno"> 4784</span>  <span class="keywordtype">double</span> beta, omcx, omcy, omcz, denom;</div>
<div class="line"><span class="lineno"> 4785</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4786</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++) {</div>
<div class="line"><span class="lineno"> 4787</span>      susxz[i][j] = 0.0;</div>
<div class="line"><span class="lineno"> 4788</span>      susyz[i][j] = 0.0;</div>
<div class="line"><span class="lineno"> 4789</span>      suszz[i][j] = 1.0;</div>
<div class="line"><span class="lineno"> 4790</span>    }</div>
<div class="line"><span class="lineno"> 4791</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4792</span>    beta = .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>;</div>
<div class="line"><span class="lineno"> 4793</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4794</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++) {</div>
<div class="line"><span class="lineno"> 4795</span>        omcx = beta * (Bxn[i][j][1]+Bx_ext[i][j][1]);</div>
<div class="line"><span class="lineno"> 4796</span>        omcy = beta * (Byn[i][j][1]+By_ext[i][j][1]);</div>
<div class="line"><span class="lineno"> 4797</span>        omcz = beta * (Bzn[i][j][1]+Bz_ext[i][j][1]);</div>
<div class="line"><span class="lineno"> 4798</span>        denom = FourPI / 2 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][1] / (1.0 + omcx * omcx + omcy * omcy + omcz * omcz);</div>
<div class="line"><span class="lineno"> 4799</span>        susxz[i][j] += (-omcy + omcx * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4800</span>        susyz[i][j] += ( omcx + omcy * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4801</span>        suszz[i][j] += (  1.0 + omcz * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4802</span>      }</div>
<div class="line"><span class="lineno"> 4803</span>  }</div>
<div class="line"><span class="lineno"> 4804</span> </div>
<div class="line"><span class="lineno"> 4805</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">delt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">perfectConductorLeft()</a>.</p>

</div>
</div>
<a id="abf8e3a2222c27c4370da9e45e331b46c" name="abf8e3a2222c27c4370da9e45e331b46c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf8e3a2222c27c4370da9e45e331b46c">&#9670;&nbsp;</a></span>sustensorRightX()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sustensorRightX </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susxx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susyx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>suszx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the sysceptibility tensor on the boundary</p>
<p >Calculate the susceptibility on the boundary rightX </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">4711</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4711</span>                                                                               {</div>
<div class="line"><span class="lineno"> 4712</span>  <span class="keywordtype">double</span> beta, omcx, omcy, omcz, denom;</div>
<div class="line"><span class="lineno"> 4713</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 4714</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4715</span>      susxx[j][k] = 1.0;</div>
<div class="line"><span class="lineno"> 4716</span>      susyx[j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4717</span>      suszx[j][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4718</span>    }</div>
<div class="line"><span class="lineno"> 4719</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4720</span>    beta = .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>;</div>
<div class="line"><span class="lineno"> 4721</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++)</div>
<div class="line"><span class="lineno"> 4722</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4723</span>        omcx = beta * (Bxn[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][j][k]+Bx_ext[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][j][k]);</div>
<div class="line"><span class="lineno"> 4724</span>        omcy = beta * (Byn[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][j][k]+By_ext[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][j][k]);</div>
<div class="line"><span class="lineno"> 4725</span>        omcz = beta * (Bzn[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][j][k]+Bz_ext[<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][j][k]);</div>
<div class="line"><span class="lineno"> 4726</span>        denom = FourPI / 2 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a> - 2][j][k] / (1.0 + omcx * omcx + omcy * omcy + omcz * omcz);</div>
<div class="line"><span class="lineno"> 4727</span>        susxx[j][k] += (  1.0 + omcx * omcx) * denom;</div>
<div class="line"><span class="lineno"> 4728</span>        susyx[j][k] += (-omcz + omcx * omcy) * denom;</div>
<div class="line"><span class="lineno"> 4729</span>        suszx[j][k] += ( omcy + omcx * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4730</span>      }</div>
<div class="line"><span class="lineno"> 4731</span>  }</div>
<div class="line"><span class="lineno"> 4732</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">delt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">perfectConductorRight()</a>.</p>

</div>
</div>
<a id="a7be07c6d9ea694ae7ace21ee4ae67b36" name="a7be07c6d9ea694ae7ace21ee4ae67b36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7be07c6d9ea694ae7ace21ee4ae67b36">&#9670;&nbsp;</a></span>sustensorRightY()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sustensorRightY </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susxy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susyy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>suszy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the susceptibility on the boundary right </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">4759</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4759</span>                                                                               {</div>
<div class="line"><span class="lineno"> 4760</span>  <span class="keywordtype">double</span> beta, omcx, omcy, omcz, denom;</div>
<div class="line"><span class="lineno"> 4761</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4762</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4763</span>      susxy[i][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4764</span>      susyy[i][k] = 1.0;</div>
<div class="line"><span class="lineno"> 4765</span>      suszy[i][k] = 0.0;</div>
<div class="line"><span class="lineno"> 4766</span>    }</div>
<div class="line"><span class="lineno"> 4767</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4768</span>    beta = .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>;</div>
<div class="line"><span class="lineno"> 4769</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4770</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a>; k++) {</div>
<div class="line"><span class="lineno"> 4771</span>        omcx = beta * (Bxn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k]+Bx_ext[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k]);</div>
<div class="line"><span class="lineno"> 4772</span>        omcy = beta * (Byn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k]+By_ext[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k]);</div>
<div class="line"><span class="lineno"> 4773</span>        omcz = beta * (Bzn[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k]+Bz_ext[i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k]);</div>
<div class="line"><span class="lineno"> 4774</span>        denom = FourPI / 2 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2][k] / (1.0 + omcx * omcx + omcy * omcy + omcz * omcz);</div>
<div class="line"><span class="lineno"> 4775</span>        susxy[i][k] += ( omcz + omcx * omcy) * denom;</div>
<div class="line"><span class="lineno"> 4776</span>        susyy[i][k] += (  1.0 + omcy * omcy) * denom;</div>
<div class="line"><span class="lineno"> 4777</span>        suszy[i][k] += (-omcx + omcy * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4778</span>      }</div>
<div class="line"><span class="lineno"> 4779</span>  }</div>
<div class="line"><span class="lineno"> 4780</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">delt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">perfectConductorRight()</a>.</p>

</div>
</div>
<a id="a5ba6a96d31f80b1179910a118484cced" name="a5ba6a96d31f80b1179910a118484cced"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ba6a96d31f80b1179910a118484cced">&#9670;&nbsp;</a></span>sustensorRightZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMfields3D::sustensorRightZ </td>
          <td>(</td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susxz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>susyz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **&#160;</td>
          <td class="paramname"><em>suszz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Calculate the susceptibility on the boundary right </p>

<p class="definition">Definition at line <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">4807</a> of file <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4807</span>                                                                               {</div>
<div class="line"><span class="lineno"> 4808</span>  <span class="keywordtype">double</span> beta, omcx, omcy, omcz, denom;</div>
<div class="line"><span class="lineno"> 4809</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4810</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++) {</div>
<div class="line"><span class="lineno"> 4811</span>      susxz[i][j] = 0.0;</div>
<div class="line"><span class="lineno"> 4812</span>      susyz[i][j] = 0.0;</div>
<div class="line"><span class="lineno"> 4813</span>      suszz[i][j] = 1.0;</div>
<div class="line"><span class="lineno"> 4814</span>    }</div>
<div class="line"><span class="lineno"> 4815</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> is = 0; is &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a4a57d80ce246ebe6e9ba52ce3fbbceb9">ns</a>; is++) {</div>
<div class="line"><span class="lineno"> 4816</span>    beta = .5 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a>;</div>
<div class="line"><span class="lineno"> 4817</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#ab06147cd3a362deaa144d6b077f23146">nxn</a>; i++)</div>
<div class="line"><span class="lineno"> 4818</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a>; j++) {</div>
<div class="line"><span class="lineno"> 4819</span>        omcx = beta * (Bxn[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2]+Bx_ext[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2]);</div>
<div class="line"><span class="lineno"> 4820</span>        omcy = beta * (Byn[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2]+By_ext[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2]);</div>
<div class="line"><span class="lineno"> 4821</span>        omcz = beta * (Bzn[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2]+Bz_ext[i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a30e1eb6027a4a332d41b2ba4e49dc532">nzn</a> - 2]);</div>
<div class="line"><span class="lineno"> 4822</span>        denom = FourPI / 2 * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af6423e5405362e6401eb65b1db95fb74">delt</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a206f6017adcc96ec7fc074b5101fb2fb">dt</a> / <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a36c6b4e19eaedb0ec58aae5c2d090cc8">c</a> * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a877f625eaefc4a2a28c6ac7001c89060">qom</a>[is] * <a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#a9e3c3868c15d1829fe30477a940332a6">rhons</a>[is][i][j][<a class="code hl_variable" href="../../dd/da6/class_e_mfields3_d.html#af52fe04e26da970a36638062f93adc10">nyn</a> - 2] / (1.0 + omcx * omcx + omcy * omcy + omcz * omcz);</div>
<div class="line"><span class="lineno"> 4823</span>        susxz[i][j] += (-omcy + omcx * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4824</span>        susyz[i][j] += ( omcx + omcy * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4825</span>        suszz[i][j] += (  1.0 + omcz * omcz) * denom;</div>
<div class="line"><span class="lineno"> 4826</span>      }</div>
<div class="line"><span class="lineno"> 4827</span>  }</div>
<div class="line"><span class="lineno"> 4828</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">c</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">delt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">dt</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">ns</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">nxn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">nyn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">nzn</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">qom</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">rhons</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">perfectConductorRight()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="af93c298892f72654a806b9f755d38b3d" name="af93c298892f72654a806b9f755d38b3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af93c298892f72654a806b9f755d38b3d">&#9670;&nbsp;</a></span>_col</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../db/dfb/class_collective.html">Collective</a>&amp; EMfields3D::_col</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00341">341</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ad5578936b455cf162163b43321c90350" name="ad5578936b455cf162163b43321c90350"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5578936b455cf162163b43321c90350">&#9670;&nbsp;</a></span>_grid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d2/dd3/class_grid3_d_c_u.html">Grid</a>&amp; EMfields3D::_grid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00342">342</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a892dbf10e39181c08f646df47f308d12" name="a892dbf10e39181c08f646df47f308d12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a892dbf10e39181c08f646df47f308d12">&#9670;&nbsp;</a></span>_vct</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d0/dd1/class_v_ctopology3_d.html">VirtualTopology3D</a>&amp; EMfields3D::_vct</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00343">343</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a36e8cc446bb14517409aba077a6bab1b" name="a36e8cc446bb14517409aba077a6bab1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36e8cc446bb14517409aba077a6bab1b">&#9670;&nbsp;</a></span>B0x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::B0x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >GEM challenge parameters </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">360</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02603">fixBcGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02666">fixBforcefree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04961">perfectConductorLeftS()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05007">perfectConductorRightS()</a>.</p>

</div>
</div>
<a id="a727426b7b5e38a44414b3d62f0ff4a43" name="a727426b7b5e38a44414b3d62f0ff4a43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a727426b7b5e38a44414b3d62f0ff4a43">&#9670;&nbsp;</a></span>B0y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::B0y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">360</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="acd41fdb7bae0821184c90d652cbcdd88" name="acd41fdb7bae0821184c90d652cbcdd88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd41fdb7bae0821184c90d652cbcdd88">&#9670;&nbsp;</a></span>B0z</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::B0z</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">360</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a42158c86c46e0ee3ce618cfe52d63b31" name="a42158c86c46e0ee3ce618cfe52d63b31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42158c86c46e0ee3ce618cfe52d63b31">&#9670;&nbsp;</a></span>B1x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::B1x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Earth Model parameters. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00362">362</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>.</p>

</div>
</div>
<a id="a509ac4900a9de054c4963cec5c3ba09e" name="a509ac4900a9de054c4963cec5c3ba09e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a509ac4900a9de054c4963cec5c3ba09e">&#9670;&nbsp;</a></span>B1y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::B1y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00362">362</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ad2a17c5ef59ecca7c620779fa3797e35" name="ad2a17c5ef59ecca7c620779fa3797e35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2a17c5ef59ecca7c620779fa3797e35">&#9670;&nbsp;</a></span>B1z</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::B1z</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00362">362</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="afa41901bd607e777ca21c96d34137f8b" name="afa41901bd607e777ca21c96d34137f8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa41901bd607e777ca21c96d34137f8b">&#9670;&nbsp;</a></span>bcEMfaceXleft</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcEMfaceXleft</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00547">547</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a7d090b86a16ede7b0b8d4abec332e5b9" name="a7d090b86a16ede7b0b8d4abec332e5b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d090b86a16ede7b0b8d4abec332e5b9">&#9670;&nbsp;</a></span>bcEMfaceXright</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcEMfaceXright</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Boundary condition for electric field 0 = perfect conductor 1 = magnetic mirror </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00546">546</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02879">ConstantChargeOpenBC()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02800">ConstantChargeOpenBCv2()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>.</p>

</div>
</div>
<a id="a198a12992bc9ea991dade4ddd1dce304" name="a198a12992bc9ea991dade4ddd1dce304"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a198a12992bc9ea991dade4ddd1dce304">&#9670;&nbsp;</a></span>bcEMfaceYleft</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcEMfaceYleft</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00549">549</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a5956ed9cca9f548f259e3f34902df57e" name="a5956ed9cca9f548f259e3f34902df57e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5956ed9cca9f548f259e3f34902df57e">&#9670;&nbsp;</a></span>bcEMfaceYright</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcEMfaceYright</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00548">548</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a3f05ef08972c7acbf60006f86a835567" name="a3f05ef08972c7acbf60006f86a835567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f05ef08972c7acbf60006f86a835567">&#9670;&nbsp;</a></span>bcEMfaceZleft</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcEMfaceZleft</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00551">551</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ab0fa41eace26cd5faff4d261906f86bb" name="ab0fa41eace26cd5faff4d261906f86bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0fa41eace26cd5faff4d261906f86bb">&#9670;&nbsp;</a></span>bcEMfaceZright</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcEMfaceZright</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00550">550</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a8b775cbee88cf6f0e7c3b307bcb989e7" name="a8b775cbee88cf6f0e7c3b307bcb989e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b775cbee88cf6f0e7c3b307bcb989e7">&#9670;&nbsp;</a></span>bcPHIfaceXleft</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcPHIfaceXleft</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00536">536</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a7a12fc7eab8c39c85f8ff5be174a3c5d" name="a7a12fc7eab8c39c85f8ff5be174a3c5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a12fc7eab8c39c85f8ff5be174a3c5d">&#9670;&nbsp;</a></span>bcPHIfaceXright</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcPHIfaceXright</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Field Boundary Condition 0 = Dirichlet Boundary Condition: specifies the value on the boundary of the domain 1 = Neumann Boundary Condition: specifies the value of derivative on the boundary of the domain 2 = Periodic boundary condition </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00535">535</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>.</p>

</div>
</div>
<a id="afb603b99e5bca9f652183fcd6adda1d5" name="afb603b99e5bca9f652183fcd6adda1d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb603b99e5bca9f652183fcd6adda1d5">&#9670;&nbsp;</a></span>bcPHIfaceYleft</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcPHIfaceYleft</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00538">538</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a2a2c28d27af1b80331b95a4c2e31f909" name="a2a2c28d27af1b80331b95a4c2e31f909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a2c28d27af1b80331b95a4c2e31f909">&#9670;&nbsp;</a></span>bcPHIfaceYright</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcPHIfaceYright</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00537">537</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a5412777977eae74dc1c8b53b54f369ef" name="a5412777977eae74dc1c8b53b54f369ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5412777977eae74dc1c8b53b54f369ef">&#9670;&nbsp;</a></span>bcPHIfaceZleft</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcPHIfaceZleft</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00540">540</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a64d764d3f2ca980eee960633193c01b1" name="a64d764d3f2ca980eee960633193c01b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64d764d3f2ca980eee960633193c01b1">&#9670;&nbsp;</a></span>bcPHIfaceZright</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::bcPHIfaceZright</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00539">539</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="afd0b023f271798468fde342098e488b2" name="afd0b023f271798468fde342098e488b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd0b023f271798468fde342098e488b2">&#9670;&nbsp;</a></span>Bx_ext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Bx_ext</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00505">505</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa979c854e86a1357b52df8364fe33b06" name="aa979c854e86a1357b52df8364fe33b06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa979c854e86a1357b52df8364fe33b06">&#9670;&nbsp;</a></span>Bx_tot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Bx_tot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00509">509</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="acefa72dca852d024eb22a812186e4021" name="acefa72dca852d024eb22a812186e4021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acefa72dca852d024eb22a812186e4021">&#9670;&nbsp;</a></span>Bxc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Bxc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00425">425</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a1a55c9ba9503567e9f91fd558bd667ec" name="a1a55c9ba9503567e9f91fd558bd667ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a55c9ba9503567e9f91fd558bd667ec">&#9670;&nbsp;</a></span>Bxn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Bxn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00431">431</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a1eb9c67179a159337fb7bf9f736c229f" name="a1eb9c67179a159337fb7bf9f736c229f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1eb9c67179a159337fb7bf9f736c229f">&#9670;&nbsp;</a></span>By_ext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::By_ext</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00506">506</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ac6e994f77f91842c2e767c5cc50288ad" name="ac6e994f77f91842c2e767c5cc50288ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6e994f77f91842c2e767c5cc50288ad">&#9670;&nbsp;</a></span>By_tot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::By_tot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00510">510</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a0928f46a5a88a862d6ade6213e087632" name="a0928f46a5a88a862d6ade6213e087632"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0928f46a5a88a862d6ade6213e087632">&#9670;&nbsp;</a></span>Byc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Byc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00426">426</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a0c3ac370a311675e572d1fdac8f39ccf" name="a0c3ac370a311675e572d1fdac8f39ccf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c3ac370a311675e572d1fdac8f39ccf">&#9670;&nbsp;</a></span>Byn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Byn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00432">432</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a7c8d306eced51da033df750a2d5f0274" name="a7c8d306eced51da033df750a2d5f0274"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c8d306eced51da033df750a2d5f0274">&#9670;&nbsp;</a></span>Bz_ext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Bz_ext</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00507">507</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aafc696b6c951889d9778100a70977e68" name="aafc696b6c951889d9778100a70977e68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafc696b6c951889d9778100a70977e68">&#9670;&nbsp;</a></span>Bz_tot</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Bz_tot</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00511">511</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ad6e24e77203fb4f63ba12831cb058878" name="ad6e24e77203fb4f63ba12831cb058878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6e24e77203fb4f63ba12831cb058878">&#9670;&nbsp;</a></span>Bzc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Bzc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00427">427</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a061036230f014c40e4e87a20c79ecb3a" name="a061036230f014c40e4e87a20c79ecb3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a061036230f014c40e4e87a20c79ecb3a">&#9670;&nbsp;</a></span>Bzn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Bzn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00433">433</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a36c6b4e19eaedb0ec58aae5c2d090cc8" name="a36c6b4e19eaedb0ec58aae5c2d090cc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36c6b4e19eaedb0ec58aae5c2d090cc8">&#9670;&nbsp;</a></span>c</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::c</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >light speed </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00345">345</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">PIdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">sumMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">sustensorLeftX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">sustensorLeftY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">sustensorLeftZ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>.</p>

</div>
</div>
<a id="a578657d9f806d7d414c816fd81f5f93c" name="a578657d9f806d7d414c816fd81f5f93c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a578657d9f806d7d414c816fd81f5f93c">&#9670;&nbsp;</a></span>CGtol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::CGtol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >CG tolerance criterium for stopping iterations </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00566">566</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>.</p>

</div>
</div>
<a id="ae6e789a151f7c232b36ba6076c1076a9" name="ae6e789a151f7c232b36ba6076c1076a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6e789a151f7c232b36ba6076c1076a9">&#9670;&nbsp;</a></span>cornertypeC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::cornertypeC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00581">581</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a17c44fca82af3482ed57a4962ac86d77" name="a17c44fca82af3482ed57a4962ac86d77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17c44fca82af3482ed57a4962ac86d77">&#9670;&nbsp;</a></span>cornertypeN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::cornertypeN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00593">593</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="af6423e5405362e6401eb65b1db95fb74" name="af6423e5405362e6401eb65b1db95fb74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6423e5405362e6401eb65b1db95fb74">&#9670;&nbsp;</a></span>delt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::delt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >delt = c*th*dt </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00356">356</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">sustensorLeftX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">sustensorLeftY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">sustensorLeftZ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>.</p>

</div>
</div>
<a id="aa0afa5eb8bc1e272c0af04b33b1209b7" name="aa0afa5eb8bc1e272c0af04b33b1209b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0afa5eb8bc1e272c0af04b33b1209b7">&#9670;&nbsp;</a></span>delta</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::delta</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00360">360</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="abb857044d87a71286870a2b6c35975ee" name="abb857044d87a71286870a2b6c35975ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb857044d87a71286870a2b6c35975ee">&#9670;&nbsp;</a></span>divC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::divC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00463">463</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ac15b1931f27db3db0d53de63848dc78a" name="ac15b1931f27db3db0d53de63848dc78a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac15b1931f27db3db0d53de63848dc78a">&#9670;&nbsp;</a></span>DriftSpecies</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool* EMfields3D::DriftSpecies</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Drift of the species </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00557">557</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>.</p>

</div>
</div>
<a id="a206f6017adcc96ec7fc074b5101fb2fb" name="a206f6017adcc96ec7fc074b5101fb2fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a206f6017adcc96ec7fc074b5101fb2fb">&#9670;&nbsp;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::dt</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >time step </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00349">349</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">perfectConductorLeft()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">perfectConductorRight()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">PIdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">sustensorLeftX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">sustensorLeftY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">sustensorLeftZ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>.</p>

</div>
</div>
<a id="ac2608a0f00c2dac18a7d73417ca2c591" name="ac2608a0f00c2dac18a7d73417ca2c591"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2608a0f00c2dac18a7d73417ca2c591">&#9670;&nbsp;</a></span>dx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::dx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >grid spacing </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">385</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05676">getBenergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05696">getBulkEnergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05663">getEenergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">sumMoments()</a>.</p>

</div>
</div>
<a id="a7d4e9e3efd3d4f9ac32df44e4c77ab7d" name="a7d4e9e3efd3d4f9ac32df44e4c77ab7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d4e9e3efd3d4f9ac32df44e4c77ab7d">&#9670;&nbsp;</a></span>Dx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Dx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00457">457</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa2cf61ea39a598766fd06829b43c68e8" name="aa2cf61ea39a598766fd06829b43c68e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2cf61ea39a598766fd06829b43c68e8">&#9670;&nbsp;</a></span>dy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::dy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">385</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a79c0c4f8abe2e2fd949dac7db78546d3" name="a79c0c4f8abe2e2fd949dac7db78546d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79c0c4f8abe2e2fd949dac7db78546d3">&#9670;&nbsp;</a></span>Dy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Dy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00458">458</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ab804652fd9207fd3a7be632d2da0a2d8" name="ab804652fd9207fd3a7be632d2da0a2d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab804652fd9207fd3a7be632d2da0a2d8">&#9670;&nbsp;</a></span>dz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::dz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">385</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ab7c7814c7f4b04578d1ddb8d82e2cca5" name="ab7c7814c7f4b04578d1ddb8d82e2cca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7c7814c7f4b04578d1ddb8d82e2cca5">&#9670;&nbsp;</a></span>Dz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Dz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00459">459</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="afd63e0151d659e21a59a35cf825fc9d5" name="afd63e0151d659e21a59a35cf825fc9d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd63e0151d659e21a59a35cf825fc9d5">&#9670;&nbsp;</a></span>Ex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Ex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00413">413</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a70c0b71b2cf8c3139727ceacbaca8a0e" name="a70c0b71b2cf8c3139727ceacbaca8a0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70c0b71b2cf8c3139727ceacbaca8a0e">&#9670;&nbsp;</a></span>Exth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Exth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00419">419</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ade5d6e4d6e39f587a722cf9bdc4b5473" name="ade5d6e4d6e39f587a722cf9bdc4b5473"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade5d6e4d6e39f587a722cf9bdc4b5473">&#9670;&nbsp;</a></span>Ey</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Ey</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00414">414</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a88c301536e8e7877fcaf0a30eaec5308" name="a88c301536e8e7877fcaf0a30eaec5308"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88c301536e8e7877fcaf0a30eaec5308">&#9670;&nbsp;</a></span>Eyth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Eyth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00420">420</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ab286b223f9798e3935a314f3697eebbd" name="ab286b223f9798e3935a314f3697eebbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab286b223f9798e3935a314f3697eebbd">&#9670;&nbsp;</a></span>Ez</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Ez</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00415">415</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a099cb2cd52e7204920325895f775fc6f" name="a099cb2cd52e7204920325895f775fc6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a099cb2cd52e7204920325895f775fc6f">&#9670;&nbsp;</a></span>Ezth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Ezth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00421">421</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ae496f72e75874cca69d7ec4c9b62671b" name="ae496f72e75874cca69d7ec4c9b62671b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae496f72e75874cca69d7ec4c9b62671b">&#9670;&nbsp;</a></span>fieldForPcls</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_pfloat</a> EMfields3D::fieldForPcls</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00409">409</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa6a6ca6b2262f611982b2f7345e009e9" name="aa6a6ca6b2262f611982b2f7345e009e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6a6ca6b2262f611982b2f7345e009e9">&#9670;&nbsp;</a></span>FourPI</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::FourPI</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00347">347</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a622e08ba22217c79136661f97cdd31e0" name="a622e08ba22217c79136661f97cdd31e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a622e08ba22217c79136661f97cdd31e0">&#9670;&nbsp;</a></span>ghosttype</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::ghosttype</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00596">596</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a18f9fef7aa44de67fa3f9742d3bb8c0d" name="a18f9fef7aa44de67fa3f9742d3bb8c0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18f9fef7aa44de67fa3f9742d3bb8c0d">&#9670;&nbsp;</a></span>GMREStol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::GMREStol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >GMRES tolerance criterium for stopping iterations </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00568">568</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>.</p>

</div>
</div>
<a id="aaf7aa492bfe607643d07aad8323c08e5" name="aaf7aa492bfe607643d07aad8323c08e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf7aa492bfe607643d07aad8323c08e5">&#9670;&nbsp;</a></span>imageX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::imageX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >and some for MaxwellImage </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00454">454</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">perfectConductorLeft()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">perfectConductorRight()</a>.</p>

</div>
</div>
<a id="a021010fc1f85523aa15d279ec6cd21db" name="a021010fc1f85523aa15d279ec6cd21db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a021010fc1f85523aa15d279ec6cd21db">&#9670;&nbsp;</a></span>imageY</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::imageY</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00455">455</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ad2cc4a3e3626bee386a5b5c2adbd2986" name="ad2cc4a3e3626bee386a5b5c2adbd2986"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2cc4a3e3626bee386a5b5c2adbd2986">&#9670;&nbsp;</a></span>imageZ</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::imageZ</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00456">456</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="afce5b1d4a72afd981e5af2e6db2e11ab" name="afce5b1d4a72afd981e5af2e6db2e11ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afce5b1d4a72afd981e5af2e6db2e11ab">&#9670;&nbsp;</a></span>invVOL</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::invVOL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00385">385</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="acbaf10505c4eec873ac1718a0585c1d3" name="acbaf10505c4eec873ac1718a0585c1d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbaf10505c4eec873ac1718a0585c1d3">&#9670;&nbsp;</a></span>Jx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Jx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00487">487</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a70991244373bdb4b27a3887e3b09c59f" name="a70991244373bdb4b27a3887e3b09c59f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70991244373bdb4b27a3887e3b09c59f">&#9670;&nbsp;</a></span>Jx_ext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Jx_ext</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00514">514</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a0211859e21c477ffa58ce9e556fd92a4" name="a0211859e21c477ffa58ce9e556fd92a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0211859e21c477ffa58ce9e556fd92a4">&#9670;&nbsp;</a></span>Jxh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Jxh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00493">493</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a4f02fd948ce11de9f60c070ab8324964" name="a4f02fd948ce11de9f60c070ab8324964"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f02fd948ce11de9f60c070ab8324964">&#9670;&nbsp;</a></span>Jxs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::Jxs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00499">499</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a1cffaedf9fe02b903e8a68a65339c0c8" name="a1cffaedf9fe02b903e8a68a65339c0c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1cffaedf9fe02b903e8a68a65339c0c8">&#9670;&nbsp;</a></span>Jy</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Jy</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00488">488</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ac4a0aaf59e4e2ed85cad5df8476acf6a" name="ac4a0aaf59e4e2ed85cad5df8476acf6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4a0aaf59e4e2ed85cad5df8476acf6a">&#9670;&nbsp;</a></span>Jy_ext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Jy_ext</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00515">515</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a9a4aed2814ada972dadea02ecefd634a" name="a9a4aed2814ada972dadea02ecefd634a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a4aed2814ada972dadea02ecefd634a">&#9670;&nbsp;</a></span>Jyh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Jyh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00494">494</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa718386e4263b19798b15f879fd28589" name="aa718386e4263b19798b15f879fd28589"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa718386e4263b19798b15f879fd28589">&#9670;&nbsp;</a></span>Jys</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::Jys</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00500">500</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aae2283449ba35676790545748de713fc" name="aae2283449ba35676790545748de713fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae2283449ba35676790545748de713fc">&#9670;&nbsp;</a></span>Jz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Jz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00489">489</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a0fc4b2d97e86e8eec6f2a39e1091874a" name="a0fc4b2d97e86e8eec6f2a39e1091874a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fc4b2d97e86e8eec6f2a39e1091874a">&#9670;&nbsp;</a></span>Jz_ext</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Jz_ext</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00516">516</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="abb66b9b92d950932f33693553da86fd3" name="abb66b9b92d950932f33693553da86fd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb66b9b92d950932f33693553da86fd3">&#9670;&nbsp;</a></span>Jzh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Jzh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00495">495</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ae0496a7a94cf632955eb2d90f1f334cc" name="ae0496a7a94cf632955eb2d90f1f334cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0496a7a94cf632955eb2d90f1f334cc">&#9670;&nbsp;</a></span>Jzs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::Jzs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00501">501</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa5faeefa7eb12e7e655923af87e2c5e7" name="aa5faeefa7eb12e7e655923af87e2c5e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5faeefa7eb12e7e655923af87e2c5e7">&#9670;&nbsp;</a></span>L_square</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::L_square</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Characteristic length. </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00399">399</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>.</p>

</div>
</div>
<a id="aebbab41c0fe44f7001cf5961fa8c1764" name="aebbab41c0fe44f7001cf5961fa8c1764"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebbab41c0fe44f7001cf5961fa8c1764">&#9670;&nbsp;</a></span>Lambda</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::Lambda</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00464">464</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a189435c9228ac2142754edd79d550bab" name="a189435c9228ac2142754edd79d550bab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a189435c9228ac2142754edd79d550bab">&#9670;&nbsp;</a></span>lEndFlag</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool EMfields3D::lEndFlag</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00597">597</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a7ab7ecb259c9728b0d15836e36865540" name="a7ab7ecb259c9728b0d15836e36865540"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ab7ecb259c9728b0d15836e36865540">&#9670;&nbsp;</a></span>Lx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::Lx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >simulation box length - X direction </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00387">387</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>.</p>

</div>
</div>
<a id="a97a89d811b0dc79cd53690e05fbdabc8" name="a97a89d811b0dc79cd53690e05fbdabc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97a89d811b0dc79cd53690e05fbdabc8">&#9670;&nbsp;</a></span>Ly</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::Ly</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >simulation box length - Y direction </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00389">389</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02603">fixBcGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02666">fixBforcefree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>.</p>

</div>
</div>
<a id="afcc5cd4f2a3bb7d91d5a93a230ae76a3" name="afcc5cd4f2a3bb7d91d5a93a230ae76a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcc5cd4f2a3bb7d91d5a93a230ae76a3">&#9670;&nbsp;</a></span>Lz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::Lz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >simulation box length - Z direction </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00391">391</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>.</p>

</div>
</div>
<a id="a2be54a1cb832cdffa4cbf8548d18d882" name="a2be54a1cb832cdffa4cbf8548d18d882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2be54a1cb832cdffa4cbf8548d18d882">&#9670;&nbsp;</a></span>moments10Array</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d1/d1c/class_moments10.html">Moments10</a>** EMfields3D::moments10Array</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00468">468</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a4a57d80ce246ebe6e9ba52ce3fbbceb9" name="a4a57d80ce246ebe6e9ba52ce3fbbceb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a57d80ce246ebe6e9ba52ce3fbbceb9">&#9670;&nbsp;</a></span>ns</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::ns</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >number of particles species </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00358">358</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03223">AddPerturbationRho()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03344">communicateGhostP2G()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02879">ConstantChargeOpenBC()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02800">ConstantChargeOpenBCv2()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03196">initEM_rotate()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">PIdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03432">setZeroPrimaryMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">sumMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03460">sumOverSpecies()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03470">sumOverSpeciesJ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">sustensorLeftX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">sustensorLeftY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">sustensorLeftZ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>.</p>

</div>
</div>
<a id="a8a76656afeb6d85f3d75e7c0287ffa84" name="a8a76656afeb6d85f3d75e7c0287ffa84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a76656afeb6d85f3d75e7c0287ffa84">&#9670;&nbsp;</a></span>nxc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::nxc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >number of cells - X direction, including + 2 (guard cells) </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00371">371</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02603">fixBcGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02666">fixBforcefree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03319">PoissonImage()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>.</p>

</div>
</div>
<a id="ab06147cd3a362deaa144d6b077f23146" name="ab06147cd3a362deaa144d6b077f23146"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab06147cd3a362deaa144d6b077f23146">&#9670;&nbsp;</a></span>nxn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::nxn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >number of nodes - X direction, including + 2 extra nodes for guard cells </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00373">373</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03243">AddPerturbation()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03223">AddPerturbationRho()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02699">adjustNonPeriodicDensities()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03344">communicateGhostP2G()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05676">getBenergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05696">getBulkEnergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05663">getEenergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03196">initEM_rotate()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">perfectConductorLeft()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04961">perfectConductorLeftS()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">perfectConductorRight()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05007">perfectConductorRightS()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">PIdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03023">set_fieldForPcls()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03432">setZeroPrimaryMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02529">smoothE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">sumMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03460">sumOverSpecies()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03470">sumOverSpeciesJ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">sustensorLeftY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">sustensorLeftZ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>.</p>

</div>
</div>
<a id="aac2a4ca79acb7297ddfe0b152cc546bd" name="aac2a4ca79acb7297ddfe0b152cc546bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac2a4ca79acb7297ddfe0b152cc546bd">&#9670;&nbsp;</a></span>nyc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::nyc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >number of cell - Y direction, including + 2 (guard cells) </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00375">375</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02603">fixBcGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02666">fixBforcefree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03319">PoissonImage()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>.</p>

</div>
</div>
<a id="af52fe04e26da970a36638062f93adc10" name="af52fe04e26da970a36638062f93adc10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af52fe04e26da970a36638062f93adc10">&#9670;&nbsp;</a></span>nyn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::nyn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >number of nodes - Y direction, including + 2 extra nodes for guard cells </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00377">377</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03243">AddPerturbation()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03223">AddPerturbationRho()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02699">adjustNonPeriodicDensities()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03344">communicateGhostP2G()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05676">getBenergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05696">getBulkEnergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05663">getEenergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03196">initEM_rotate()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">perfectConductorLeft()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04961">perfectConductorLeftS()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">perfectConductorRight()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05007">perfectConductorRightS()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">PIdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03023">set_fieldForPcls()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03432">setZeroPrimaryMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02470">smooth()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02529">smoothE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">sumMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03460">sumOverSpecies()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03470">sumOverSpeciesJ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">sustensorLeftX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">sustensorLeftZ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>.</p>

</div>
</div>
<a id="ab8ba4df7252b5aab6ba31fe8e2b9be39" name="ab8ba4df7252b5aab6ba31fe8e2b9be39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8ba4df7252b5aab6ba31fe8e2b9be39">&#9670;&nbsp;</a></span>nzc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::nzc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >number of cell - Z direction, including + 2 (guard cells) </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00379">379</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02603">fixBcGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02666">fixBforcefree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03319">PoissonImage()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>.</p>

</div>
</div>
<a id="a30e1eb6027a4a332d41b2ba4e49dc532" name="a30e1eb6027a4a332d41b2ba4e49dc532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30e1eb6027a4a332d41b2ba4e49dc532">&#9670;&nbsp;</a></span>nzn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::nzn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >number of nodes - Z direction, including + 2 extra nodes for guard cells </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00381">381</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02699">adjustNonPeriodicDensities()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03344">communicateGhostP2G()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05676">getBenergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05696">getBulkEnergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05663">getEenergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02333">MaxwellImage()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">perfectConductorLeft()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04961">perfectConductorLeftS()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">perfectConductorRight()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05007">perfectConductorRightS()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">PIdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03023">set_fieldForPcls()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03432">setZeroPrimaryMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02529">smoothE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">sumMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03460">sumOverSpecies()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03470">sumOverSpeciesJ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">sustensorLeftX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">sustensorLeftY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>.</p>

</div>
</div>
<a id="a5f9d78fac6902b1ea3eaf5e298874768" name="a5f9d78fac6902b1ea3eaf5e298874768"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f9d78fac6902b1ea3eaf5e298874768">&#9670;&nbsp;</a></span>PHI</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::PHI</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >PHI: electric potential (indexX, indexY, indexZ), defined on central points between nodes </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00402">402</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, and <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00199">getPHI()</a>.</p>

</div>
</div>
<a id="acd424234905b5fba72af10c3a93abe86" name="acd424234905b5fba72af10c3a93abe86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd424234905b5fba72af10c3a93abe86">&#9670;&nbsp;</a></span>PlanetOffset</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::PlanetOffset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00362">362</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a8ea9ae681b78a8067d4a753a486fa2fc" name="a8ea9ae681b78a8067d4a753a486fa2fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ea9ae681b78a8067d4a753a486fa2fc">&#9670;&nbsp;</a></span>PoissonCorrection</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool EMfields3D::PoissonCorrection</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >boolean for divergence cleaning </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00560">560</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>.</p>

</div>
</div>
<a id="ab8a056e1f1b07efda595f2ea15cc4a9c" name="ab8a056e1f1b07efda595f2ea15cc4a9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8a056e1f1b07efda595f2ea15cc4a9c">&#9670;&nbsp;</a></span>PoissonCorrectionCycle</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::PoissonCorrectionCycle</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00561">561</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a474f702e439f1fc0ec38990ae2fb7158" name="a474f702e439f1fc0ec38990ae2fb7158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a474f702e439f1fc0ec38990ae2fb7158">&#9670;&nbsp;</a></span>procview</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::procview</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00596">596</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa81688dd7301d04e351ea83e207b94b9" name="aa81688dd7301d04e351ea83e207b94b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa81688dd7301d04e351ea83e207b94b9">&#9670;&nbsp;</a></span>procviewXYZ</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::procviewXYZ</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00596">596</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ac0fc1cbc7e72163ee2b3ae1080dec3f5" name="ac0fc1cbc7e72163ee2b3ae1080dec3f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0fc1cbc7e72163ee2b3ae1080dec3f5">&#9670;&nbsp;</a></span>PSI</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::PSI</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >PSI: 3D scalar field used for magnetic field divergence cleaning, defined on central points between nodes </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00404">404</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>.</p>

</div>
</div>
<a id="acbe08ec9affab670a5d0a0c4b06442fe" name="acbe08ec9affab670a5d0a0c4b06442fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbe08ec9affab670a5d0a0c4b06442fe">&#9670;&nbsp;</a></span>pXXsn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::pXXsn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00519">519</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a9551afe01ebc9fa71ce7122f68356105" name="a9551afe01ebc9fa71ce7122f68356105"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9551afe01ebc9fa71ce7122f68356105">&#9670;&nbsp;</a></span>pXYsn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::pXYsn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00520">520</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a7a77bde4a1cd6b33b8975a5328c5ea96" name="a7a77bde4a1cd6b33b8975a5328c5ea96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a77bde4a1cd6b33b8975a5328c5ea96">&#9670;&nbsp;</a></span>pXZsn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::pXZsn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00521">521</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a09afc47efcaa331b958b72197d3693df" name="a09afc47efcaa331b958b72197d3693df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09afc47efcaa331b958b72197d3693df">&#9670;&nbsp;</a></span>pYYsn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::pYYsn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00522">522</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aacd0d6595ed0e8acd2386b13b256db27" name="aacd0d6595ed0e8acd2386b13b256db27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacd0d6595ed0e8acd2386b13b256db27">&#9670;&nbsp;</a></span>pYZsn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::pYZsn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00523">523</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a4c4bd7c7fb5cf5b27e00ef320b0e563b" name="a4c4bd7c7fb5cf5b27e00ef320b0e563b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c4bd7c7fb5cf5b27e00ef320b0e563b">&#9670;&nbsp;</a></span>pZZsn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::pZZsn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00524">524</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a877f625eaefc4a2a28c6ac7001c89060" name="a877f625eaefc4a2a28c6ac7001c89060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a877f625eaefc4a2a28c6ac7001c89060">&#9670;&nbsp;</a></span>qom</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* EMfields3D::qom</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >charge to mass ratio array for different species </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00364">364</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02879">ConstantChargeOpenBC()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02800">ConstantChargeOpenBCv2()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05696">getBulkEnergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02422">PIdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">sustensorLeftX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">sustensorLeftY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">sustensorLeftZ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05714">~EMfields3D()</a>.</p>

</div>
</div>
<a id="a57cb50aa343b780dc7e2d4f9695af5e6" name="a57cb50aa343b780dc7e2d4f9695af5e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57cb50aa343b780dc7e2d4f9695af5e6">&#9670;&nbsp;</a></span>restart1</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::restart1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >RESTART BOOLEAN </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00563">563</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>.</p>

</div>
</div>
<a id="ac592e12b7cc8428fecb8219e9ebe050d" name="ac592e12b7cc8428fecb8219e9ebe050d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac592e12b7cc8428fecb8219e9ebe050d">&#9670;&nbsp;</a></span>rhoc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::rhoc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Charge density, defined on central points of the cell </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00475">475</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03338">interpDensitiesN2C()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>.</p>

</div>
</div>
<a id="af73b86e3e2631057b7b1818f6a1dc382" name="af73b86e3e2631057b7b1818f6a1dc382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af73b86e3e2631057b7b1818f6a1dc382">&#9670;&nbsp;</a></span>rhocs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::rhocs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >SPECIES: charge density for each species, defined on central points of the cell </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00483">483</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03223">AddPerturbationRho()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03196">initEM_rotate()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>.</p>

</div>
</div>
<a id="a43d562d551ea0f165362c5679bbba07b" name="a43d562d551ea0f165362c5679bbba07b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43d562d551ea0f165362c5679bbba07b">&#9670;&nbsp;</a></span>rhoh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::rhoh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Implicit charge density, defined on central points of the cell </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00479">479</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>.</p>

</div>
</div>
<a id="ac13eea1faaf959ca92ff84ad03b0ce79" name="ac13eea1faaf959ca92ff84ad03b0ce79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac13eea1faaf959ca92ff84ad03b0ce79">&#9670;&nbsp;</a></span>rhoINIT</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double* EMfields3D::rhoINIT</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >GEM Challenge background ion </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00555">555</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02879">ConstantChargeOpenBC()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05714">~EMfields3D()</a>.</p>

</div>
</div>
<a id="ac154c0bebb127df531138a846cfde8e3" name="ac154c0bebb127df531138a846cfde8e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac154c0bebb127df531138a846cfde8e3">&#9670;&nbsp;</a></span>rhon</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::rhon</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Charge density, defined on nodes </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00477">477</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03338">interpDensitiesN2C()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03411">setZeroDerivedMoments()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03460">sumOverSpecies()</a>.</p>

</div>
</div>
<a id="a9e3c3868c15d1829fe30477a940332a6" name="a9e3c3868c15d1829fe30477a940332a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e3c3868c15d1829fe30477a940332a6">&#9670;&nbsp;</a></span>rhons</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d8c/structi_pic3_d_1_1array4.html">array4_double</a> EMfields3D::rhons</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >SPECIES: charge density for each species, defined on nodes </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00481">481</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03223">AddPerturbationRho()</a>, <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00609">addRho()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02699">adjustNonPeriodicDensities()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03344">communicateGhostP2G()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02879">ConstantChargeOpenBC()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02800">ConstantChargeOpenBCv2()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05696">getBulkEnergy()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03517">init()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03196">initEM_rotate()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03601">initGEM()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04083">initGEMDipoleLikeTailNoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04175">initGEMnoPert()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04240">initRandomField()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02441">MUdot()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03432">setZeroPrimaryMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00607">sumMoments()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03460">sumOverSpecies()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04687">sustensorLeftX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04735">sustensorLeftY()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04783">sustensorLeftZ()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04711">sustensorRightX()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04759">sustensorRightY()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04807">sustensorRightZ()</a>.</p>

</div>
</div>
<a id="a87a23720e5f4aa33878292413f244855" name="a87a23720e5f4aa33878292413f244855"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87a23720e5f4aa33878292413f244855">&#9670;&nbsp;</a></span>sizeMomentsArray</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::sizeMomentsArray</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00467">467</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a9e00cd79434a2bc1f9eccfa33284768d" name="a9e00cd79434a2bc1f9eccfa33284768d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e00cd79434a2bc1f9eccfa33284768d">&#9670;&nbsp;</a></span>Smooth</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::Smooth</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Smoothing value </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00353">353</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l00061">EMfields3D()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04376">initForceFree()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03683">initNullPoints()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02470">smooth()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02529">smoothE()</a>.</p>

</div>
</div>
<a id="ace7b52de028267a27294870c7396e9b9" name="ace7b52de028267a27294870c7396e9b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace7b52de028267a27294870c7396e9b9">&#9670;&nbsp;</a></span>SmoothNiter</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int EMfields3D::SmoothNiter</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00354">354</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="af082763b2a0d22c827ced87a9e5bf395" name="af082763b2a0d22c827ced87a9e5bf395"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af082763b2a0d22c827ced87a9e5bf395">&#9670;&nbsp;</a></span>temp2X</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::temp2X</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00450">450</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aba287d0311059a43d392a65385d77747" name="aba287d0311059a43d392a65385d77747"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba287d0311059a43d392a65385d77747">&#9670;&nbsp;</a></span>temp2Y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::temp2Y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00451">451</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a2457ebe192a259223b0e70fa9e5d8594" name="a2457ebe192a259223b0e70fa9e5d8594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2457ebe192a259223b0e70fa9e5d8594">&#9670;&nbsp;</a></span>temp2Z</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::temp2Z</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00452">452</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a46c3082575146e5975baaa9177284892" name="a46c3082575146e5975baaa9177284892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46c3082575146e5975baaa9177284892">&#9670;&nbsp;</a></span>tempC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >other temporary arrays (in MaxwellSource) </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00446">446</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02175">MaxwellSource()</a>.</p>

</div>
</div>
<a id="a645c6e812ccf50fd2a726dd8842c95f2" name="a645c6e812ccf50fd2a726dd8842c95f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a645c6e812ccf50fd2a726dd8842c95f2">&#9670;&nbsp;</a></span>tempX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00447">447</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="acb425fcde45789639ababbe2d847d059" name="acb425fcde45789639ababbe2d847d059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb425fcde45789639ababbe2d847d059">&#9670;&nbsp;</a></span>tempXC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempXC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >some temporary arrays (for calculate hat functions) </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00439">439</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03040">calculateB()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>.</p>

</div>
</div>
<a id="a82fb8d93d134e0f26674c20872a7dc69" name="a82fb8d93d134e0f26674c20872a7dc69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82fb8d93d134e0f26674c20872a7dc69">&#9670;&nbsp;</a></span>tempXN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempXN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00442">442</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a5c334155ed3610497a57e787e257b83e" name="a5c334155ed3610497a57e787e257b83e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c334155ed3610497a57e787e257b83e">&#9670;&nbsp;</a></span>tempY</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempY</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00448">448</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa518d56183e2ae1745c261faafe0df67" name="aa518d56183e2ae1745c261faafe0df67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa518d56183e2ae1745c261faafe0df67">&#9670;&nbsp;</a></span>tempYC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempYC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00440">440</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a394fda928d6328882708e6311fa9eab3" name="a394fda928d6328882708e6311fa9eab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a394fda928d6328882708e6311fa9eab3">&#9670;&nbsp;</a></span>tempYN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempYN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00443">443</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a3ee4c30e3ad0573d3d8f39623818dbc0" name="a3ee4c30e3ad0573d3d8f39623818dbc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ee4c30e3ad0573d3d8f39623818dbc0">&#9670;&nbsp;</a></span>tempZ</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempZ</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00449">449</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ae84cee0738f6f6956e1e133817b8f08b" name="ae84cee0738f6f6956e1e133817b8f08b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae84cee0738f6f6956e1e133817b8f08b">&#9670;&nbsp;</a></span>tempZC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempZC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00441">441</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a42584d8f31a1a741f9a3cbf535a8da5b" name="a42584d8f31a1a741f9a3cbf535a8da5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42584d8f31a1a741f9a3cbf535a8da5b">&#9670;&nbsp;</a></span>tempZN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::tempZN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00444">444</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ac87809eafbf98eb3336a670dcb3a2728" name="ac87809eafbf98eb3336a670dcb3a2728"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac87809eafbf98eb3336a670dcb3a2728">&#9670;&nbsp;</a></span>th</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::th</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >decentering parameter </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00351">351</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02081">calculateE()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03276">calculateHatFunctions()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04831">perfectConductorLeft()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04894">perfectConductorRight()</a>.</p>

</div>
</div>
<a id="a50c0294e6845feaa8082d5f213c3b9b5" name="a50c0294e6845feaa8082d5f213c3b9b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50c0294e6845feaa8082d5f213c3b9b5">&#9670;&nbsp;</a></span>ue0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::ue0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Boundary electron speed </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00366">366</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l03758">initTaylorGreen()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04961">perfectConductorLeftS()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l05007">perfectConductorRightS()</a>.</p>

</div>
</div>
<a id="a0c3b82612911af2afd5dfcbb4bdb3944" name="a0c3b82612911af2afd5dfcbb4bdb3944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c3b82612911af2afd5dfcbb4bdb3944">&#9670;&nbsp;</a></span>ve0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::ve0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00366">366</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a881313452b211989b697547147184f18" name="a881313452b211989b697547147184f18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a881313452b211989b697547147184f18">&#9670;&nbsp;</a></span>vectX</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::vectX</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00460">460</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a4979519296d9a82bca93d64c788a1fe2" name="a4979519296d9a82bca93d64c788a1fe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4979519296d9a82bca93d64c788a1fe2">&#9670;&nbsp;</a></span>vectY</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::vectY</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00461">461</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aadad15331f488a86b47b8ff4f49370d3" name="aadad15331f488a86b47b8ff4f49370d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadad15331f488a86b47b8ff4f49370d3">&#9670;&nbsp;</a></span>vectZ</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d57/structi_pic3_d_1_1array3.html">array3_double</a> EMfields3D::vectZ</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00462">462</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa58454dbf57fea70b7a84689ca0af4ab" name="aa58454dbf57fea70b7a84689ca0af4ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa58454dbf57fea70b7a84689ca0af4ab">&#9670;&nbsp;</a></span>we0</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::we0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00366">366</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ac7afadac85c315f7b6c17382a434e45d" name="ac7afadac85c315f7b6c17382a434e45d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7afadac85c315f7b6c17382a434e45d">&#9670;&nbsp;</a></span>x_center</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::x_center</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>source center - X direction <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00393">393</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>.</p>

</div>
</div>
<a id="a91b8bc43a6fa26ce64a8673cd87509c2" name="a91b8bc43a6fa26ce64a8673cd87509c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91b8bc43a6fa26ce64a8673cd87509c2">&#9670;&nbsp;</a></span>xEdgetypeC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::xEdgetypeC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00575">575</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a3a7c038b37a7f8b3d642301c1264888c" name="a3a7c038b37a7f8b3d642301c1264888c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a7c038b37a7f8b3d642301c1264888c">&#9670;&nbsp;</a></span>xEdgetypeC2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::xEdgetypeC2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00578">578</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a7459151b378f338749302fd284baa1e0" name="a7459151b378f338749302fd284baa1e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7459151b378f338749302fd284baa1e0">&#9670;&nbsp;</a></span>xEdgetypeN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::xEdgetypeN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00587">587</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aaa044964a0fef9d1c24fff7c7198bd27" name="aaa044964a0fef9d1c24fff7c7198bd27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa044964a0fef9d1c24fff7c7198bd27">&#9670;&nbsp;</a></span>xEdgetypeN2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::xEdgetypeN2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00590">590</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a4be1f01a0a67c0d5fe8f34e0b8e18811" name="a4be1f01a0a67c0d5fe8f34e0b8e18811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4be1f01a0a67c0d5fe8f34e0b8e18811">&#9670;&nbsp;</a></span>xEnd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::xEnd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00383">383</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aacdcc329cbd6c8872dce11171cc3cba3" name="aacdcc329cbd6c8872dce11171cc3cba3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacdcc329cbd6c8872dce11171cc3cba3">&#9670;&nbsp;</a></span>xStart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::xStart</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >local grid boundaries coordinate </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00383">383</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa1a78928157783731b2b1589117554fe" name="aa1a78928157783731b2b1589117554fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a78928157783731b2b1589117554fe">&#9670;&nbsp;</a></span>xyFacetypeC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::xyFacetypeC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00574">574</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a728b86d713b1afd89102ffdc84d84df2" name="a728b86d713b1afd89102ffdc84d84df2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a728b86d713b1afd89102ffdc84d84df2">&#9670;&nbsp;</a></span>xyFacetypeN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::xyFacetypeN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00586">586</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a654edefc1d71678e9947cc74ddce6240" name="a654edefc1d71678e9947cc74ddce6240"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a654edefc1d71678e9947cc74ddce6240">&#9670;&nbsp;</a></span>xyzcomp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::xyzcomp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00596">596</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aaa83b1187f9e7c4370d02e10789bf306" name="aaa83b1187f9e7c4370d02e10789bf306"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa83b1187f9e7c4370d02e10789bf306">&#9670;&nbsp;</a></span>xzFacetypeC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::xzFacetypeC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00573">573</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="aa8e7e0f4d2555d34dcdfa85f63e79c7f" name="aa8e7e0f4d2555d34dcdfa85f63e79c7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8e7e0f4d2555d34dcdfa85f63e79c7f">&#9670;&nbsp;</a></span>xzFacetypeN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::xzFacetypeN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00585">585</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a71b15b350e24f60d5b4418d274231c93" name="a71b15b350e24f60d5b4418d274231c93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71b15b350e24f60d5b4418d274231c93">&#9670;&nbsp;</a></span>y_center</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::y_center</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>source center - Y direction <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00395">395</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>.</p>

</div>
</div>
<a id="a2affd9bbd5dbf49c442ea5e7cce5fdfe" name="a2affd9bbd5dbf49c442ea5e7cce5fdfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2affd9bbd5dbf49c442ea5e7cce5fdfe">&#9670;&nbsp;</a></span>yEdgetypeC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::yEdgetypeC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00576">576</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a9ac8439f8848b13213de3a7d9d319970" name="a9ac8439f8848b13213de3a7d9d319970"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ac8439f8848b13213de3a7d9d319970">&#9670;&nbsp;</a></span>yEdgetypeC2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::yEdgetypeC2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00579">579</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a2cb3dc5be7043358fec0cdb8a686a574" name="a2cb3dc5be7043358fec0cdb8a686a574"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb3dc5be7043358fec0cdb8a686a574">&#9670;&nbsp;</a></span>yEdgetypeN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::yEdgetypeN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00588">588</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a0eb97bb1ead4a9856ea4d5e2d364a818" name="a0eb97bb1ead4a9856ea4d5e2d364a818"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0eb97bb1ead4a9856ea4d5e2d364a818">&#9670;&nbsp;</a></span>yEdgetypeN2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::yEdgetypeN2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00591">591</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a1e3b1373798ed5be0887f46f0c1005df" name="a1e3b1373798ed5be0887f46f0c1005df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e3b1373798ed5be0887f46f0c1005df">&#9670;&nbsp;</a></span>yEnd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::yEnd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00383">383</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ab45c464c86449a480370d45abb67f9d5" name="ab45c464c86449a480370d45abb67f9d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab45c464c86449a480370d45abb67f9d5">&#9670;&nbsp;</a></span>yStart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::yStart</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00383">383</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ac14e00cd6c8da242bd2f31fb01672b81" name="ac14e00cd6c8da242bd2f31fb01672b81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac14e00cd6c8da242bd2f31fb01672b81">&#9670;&nbsp;</a></span>yzFacetypeC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::yzFacetypeC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00572">572</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="adaac03fd8757278c0387656a2b00df0a" name="adaac03fd8757278c0387656a2b00df0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adaac03fd8757278c0387656a2b00df0a">&#9670;&nbsp;</a></span>yzFacetypeN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::yzFacetypeN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00584">584</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a1ae9e3a80d6602b3f60e56582d236ee1" name="a1ae9e3a80d6602b3f60e56582d236ee1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ae9e3a80d6602b3f60e56582d236ee1">&#9670;&nbsp;</a></span>z_center</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::z_center</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>source center - Z direction <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00397">397</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l02960">ConstantChargePlanet()</a>, <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04435">initBEAM()</a>, and <a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html#l04482">initDipole()</a>.</p>

</div>
</div>
<a id="a0bd274a9002092788baa13e95270808e" name="a0bd274a9002092788baa13e95270808e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bd274a9002092788baa13e95270808e">&#9670;&nbsp;</a></span>zEdgetypeC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::zEdgetypeC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00577">577</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a98c88b3043eb29bd32d2c9d75c3284c7" name="a98c88b3043eb29bd32d2c9d75c3284c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98c88b3043eb29bd32d2c9d75c3284c7">&#9670;&nbsp;</a></span>zEdgetypeC2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::zEdgetypeC2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00580">580</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="ae13e0fdd7aa96b15ec45c8cb670f8065" name="ae13e0fdd7aa96b15ec45c8cb670f8065"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae13e0fdd7aa96b15ec45c8cb670f8065">&#9670;&nbsp;</a></span>zEdgetypeN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::zEdgetypeN</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00589">589</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a0583c828b78a6546a64505b671ad7aab" name="a0583c828b78a6546a64505b671ad7aab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0583c828b78a6546a64505b671ad7aab">&#9670;&nbsp;</a></span>zEdgetypeN2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MPI_Datatype EMfields3D::zEdgetypeN2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00592">592</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a4c234c99ff15e0bb32d399812ae56b11" name="a4c234c99ff15e0bb32d399812ae56b11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c234c99ff15e0bb32d399812ae56b11">&#9670;&nbsp;</a></span>zEnd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::zEnd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00383">383</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<a id="a6d2a294a2433a25502655175d25e76d9" name="a6d2a294a2433a25502655175d25e76d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d2a294a2433a25502655175d25e76d9">&#9670;&nbsp;</a></span>zStart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double EMfields3D::zStart</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html#l00383">383</a> of file <a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="../../dc/d7a/_e_mfields3_d_8h_source.html">EMfields3D.h</a></li>
<li>fields/<a class="el" href="../../d4/d38/_e_mfields3_d_8cpp_source.html">EMfields3D.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dd/da6/class_e_mfields3_d.html">EMfields3D</a></li>
    <li class="footer">Generated on Wed Jul 20 2022 12:25:13 for iPIC3DxPEACE by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
</body>
</html>
